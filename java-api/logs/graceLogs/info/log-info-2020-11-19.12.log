2020-11-19 17:44:17.056 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/55eca4c8af437379e2a22b23718482c6?bkt=en-82d2bca2fdceac3f9e2ca937f93834a320f7708122de744e086323d36a73a913fdeceeb30da36c31&fid=3757516097-778750-933269229020788&time=1605779054&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-kWyWbZnib1D6dUXb3E2XrIhN6kk%3D&to=92&size=15377035&sta_dx=15377035&sta_cs=3301&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1574074433&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=15377035&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-ded070496cc6a1df8df64e462d43ecd25701c3c997673311b30b02e5c04e6179c7e78fb8c9abc550&sl=76480590&expires=8h&rt=pr&r=400950865&mlogid=7508422809295157922&vbdid=2247232042&fin=28%E4%B8%A8Ops%E4%B8%89%E9%83%A8%E6%9B%B2%E4%B9%8B%E4%B8%80%EF%BC%9A%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86.m4a&bflag=92,34-92&rtype=1&dp-logid=7508422809295157922&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=5f2aaa70d2fd14de1734d8ca037459b2ce2697b017c5c0cc&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=28%E4%B8%A8Ops%E4%B8%89%E9%83%A8%E6%9B%B2%E4%B9%8B%E4%B8%80%EF%BC%9A%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86.m4a', 
revision_id=18 where entity_id=18 
 {executed in 0 msec}
2020-11-19 17:44:17.060 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=18 
 {executed in 0 msec}
2020-11-19 17:44:17.061 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|18        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>tt</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-13
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    自己处在独立性的哪个阶段？
    <br>
    <br>在银行的省级分行工作，因为人手不多，所以五个阶段哪个都干过。
    <br>
    <br>第四个阶段回忆一下，应该是从16年发端的。项目诞生之初，出发点很简单。但是随着业务和监管的变化，功能不断增多。加上最初设计结构（不能叫架构，因为一开始的目的很单一，虽然涉及到的模块很多）带来的约束和当初对扩展性的考虑，在新增功能时，这个系统就像小说里的人物一样，开始有了自己的性格，按照诞生时被注入的逻辑不断生长。业务最终有一天会涨到需要被重构的时候。
    <br>
    <br>第五个阶段是从去年开始的，因为直接和一般用户而非银行特定用户打交到，在设计上有了很多实验和探索，基于分行的现状和特点对系统提出了很多定位。同时也产生了更多的想法和思考，希望它可以更好的长大。
    <br>
    <br>也正是这个项目，让自己有了全栈的需要。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |18          |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:44:17.065 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=18 
 {executed in 1 msec}
2020-11-19 17:44:17.066 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>tt</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-13
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    自己处在独立性的哪个阶段？
    <br>
    <br>在银行的省级分行工作，因为人手不多，所以五个阶段哪个都干过。
    <br>
    <br>第四个阶段回忆一下，应该是从16年发端的。项目诞生之初，出发点很简单。但是随着业务和监管的变化，功能不断增多。加上最初设计结构（不能叫架构，因为一开始的目的很单一，虽然涉及到的模块很多）带来的约束和当初对扩展性的考虑，在新增功能时，这个系统就像小说里的人物一样，开始有了自己的性格，按照诞生时被注入的逻辑不断生长。业务最终有一天会涨到需要被重构的时候。
    <br>
    <br>第五个阶段是从去年开始的，因为直接和一般用户而非银行特定用户打交到，在设计上有了很多实验和探索，基于分行的现状和特点对系统提出了很多定位。同时也产生了更多的想法和思考，希望它可以更好的长大。
    <br>
    <br>也正是这个项目，让自己有了全栈的需要。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |18          |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:44:17.069 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=18 
 {executed in 0 msec}
2020-11-19 17:44:17.069 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|18        |book   |0     |zh-hans  |18          |https://static001.geekbang.org/resource/image/8b/40/8b9b89d09859242982e8c7535785e040.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:44:17.073 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=18 
 {executed in 1 msec}
2020-11-19 17:44:17.073 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |18          |https://static001.geekbang.org/resource/image/8b/40/8b9b89d09859242982e8c7535785e040.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:44:17.076 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=18 
 {executed in 0 msec}
2020-11-19 17:44:17.077 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |18          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:17.080 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=18 
 {executed in 0 msec}
2020-11-19 17:44:17.080 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |18          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:17.084 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='558147237664480' 
 {executed in 0 msec}
2020-11-19 17:44:17.084 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|19        |book   |0     |558147237664480  |zh-hans  |19          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:44:17.085 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=19 
 {executed in 0 msec}
2020-11-19 17:44:17.085 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|19  |zh-hans  |book |20c2bad6-83d0-4a26-ad3f-71c160d22e43 |19  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:44:17.088 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.089 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |558147237664480  |zh-hans  |19          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:44:17.092 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=19 
 {executed in 0 msec}
2020-11-19 17:44:17.093 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|19  |1   |2     |1            |1  |19 |0  |0  |0  |1   |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:44:17.096 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.096 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------|-------------|-------|------|------------|---------|------------|
|19        |           |             |book   |0     |full_html   |zh-hans  |19          |
|----------|-----------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:44:17.097 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.098 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------|-------------|-------|------|------------|---------|------------|
|[unread]  |           |             |book   |0     |full_html   |zh-hans  |19          |
|----------|-----------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:44:17.103 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=19 
 {executed in 0 msec}
2020-11-19 17:44:17.104 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title             |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|-----|----|----|
|19  |1605755454 |1605755454 |1                |zh-hans  |0       |1                             |1      |0      |04丨第四章 数据持久化 (7讲) |book |1   |19  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|-----|----|----|

2020-11-19 17:44:17.105 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=19 
 {executed in 1 msec}
2020-11-19 17:44:17.105 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title             |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|----|----|
|[unread] |1605755454 |1605755454 |1                |zh-hans  |0       |1                             |1      |0      |04丨第四章 数据持久化 (7讲) |1   |19  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|------------------|----|----|

2020-11-19 17:44:17.108 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779057, created=1605779057, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='04丨第四章 数据持久化 (7讲)', 
type='book', uid=1, vid=19 where nid=19 
 {executed in 0 msec}
2020-11-19 17:44:17.109 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779057, created=1605779057, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='04丨第四章 
数据持久化 (7讲)', uid=1, vid=19 where nid=19 
 {executed in 1 msec}
2020-11-19 17:44:17.114 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.115 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value |revision_id |
|----------|-------|------|---------|------------------|------------|
|19        |book   |0     |zh-hans  |                  |19          |
|----------|-------|------|---------|------------------|------------|

2020-11-19 17:44:17.118 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.119 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value |revision_id |
|----------|-------|------|---------|------------------|------------|
|[unread]  |book   |0     |zh-hans  |                  |19          |
|----------|-------|------|---------|------------------|------------|

2020-11-19 17:44:17.122 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.123 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------|------|---------------------|---------|------------|
|19        |book   |                    |0     |full_html            |zh-hans  |19          |
|----------|-------|--------------------|------|---------------------|---------|------------|

2020-11-19 17:44:17.126 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.127 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------|------|---------------------|---------|------------|
|[unread]  |book   |                    |0     |full_html            |zh-hans  |19          |
|----------|-------|--------------------|------|---------------------|---------|------------|

2020-11-19 17:44:17.130 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.131 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value |
|----------|-------|------|---------|------------|------------------|
|19        |book   |0     |zh-hans  |19          |                  |
|----------|-------|------|---------|------------|------------------|

2020-11-19 17:44:17.134 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.135 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value |
|----------|-------|------|---------|------------|------------------|
|[unread]  |book   |0     |zh-hans  |19          |                  |
|----------|-------|------|---------|------------|------------------|

2020-11-19 17:44:17.138 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.139 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |19          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:17.142 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=19 
 {executed in 0 msec}
2020-11-19 17:44:17.142 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |19          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:18.018 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='743501003639090' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:44:18.019 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:44:54.421 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='743501003639090' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:44:54.422 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:44:54.425 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('743501003639090', 1, 'net_content') 
 {executed in 1 msec}
2020-11-19 17:44:54.426 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('743501003639090', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:44:54.427 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|31            |
|--------------|

2020-11-19 17:44:54.437 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='743501003639090' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:44:54.437 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:44:54.799 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='743501003639090' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:44:54.800 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:44:54.802 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('743501003639090', 1, 'media') 
 {executed in 1 msec}
2020-11-19 17:44:54.803 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('743501003639090', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:44:54.804 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|32            |
|--------------|

2020-11-19 17:44:54.820 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='743501003639090' 
 {executed in 1 msec}
2020-11-19 17:44:54.820 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|20        |book   |0     |743501003639090  |zh-hans  |20          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:44:54.821 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.822 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|20  |zh-hans  |book |6d399125-d5bb-4182-b971-580c7810a103 |20  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:44:54.825 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.826 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |743501003639090  |zh-hans  |20          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:44:54.829 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.830 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|20  |1   |3     |0            |1  |19 |20 |0  |0  |19  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:44:54.834 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=20 
 {executed in 1 msec}
2020-11-19 17:44:54.842 INFO  jdbc.resultsettable Line:610 - 
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|20        |<div data-slate-editor="true" data-key="1948" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-d7531076 " data-slate-type="paragraph" data-slate-object="block" data-key="1949">
  <span data-slate-object="text" data-key="1950"><span data-slate-leaf="true" data-offset-key="1950:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-f34c857d " data-slate-type="paragraph" data-slate-object="block" data-key="1951">
  <span data-slate-object="text" data-key="1952"><span data-slate-leaf="true" data-offset-key="1952:0" data-first-offset="true"><span data-slate-string="true">又到了特别放送时间，今天我想聊一聊代码审查（Code Review）。在软件工程师日常的开发工作中，</span></span></span><span data-slate-object="text" data-key="1953"><span data-slate-leaf="true" data-offset-key="1953:0" data-first-offset="true"><span class="se-a3686360" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果要挑出一项极其重要，却又很容易被忽视的工作，在我看来代码审查几乎是无可争议的第一。</span></span></span></span>
 </div>
 <div class="se-f4127856 " data-slate-type="paragraph" data-slate-object="block" data-key="1954">
  <span data-slate-object="text" data-key="1955"><span data-slate-leaf="true" data-offset-key="1955:0" data-first-offset="true"><span data-slate-string="true">代码审查是一个低投入、高产出的开发活动，就我个人而言，我从其中学到的习惯、方法和知识，让我获益匪浅。但是，我也在微博、微信上看到程序员朋友们争论代码审查的必要性，甚至包括很多大厂的程序员，还有一些有着许多年经验的程序员。</span></span></span>
 </div>
 <div class="se-e1ab63cf " data-slate-type="paragraph" data-slate-object="block" data-key="1956">
  <span data-slate-object="text" data-key="1957"><span data-slate-leaf="true" data-offset-key="1957:0" data-first-offset="true"><span data-slate-string="true">一开始我觉得有些不可思议，和代价相比，代码审查的好处实在太多了，这有必要费那么大心思去讨论这个必要性吗？后来我意识到，</span></span></span><span data-slate-object="text" data-key="1958"><span data-slate-leaf="true" data-offset-key="1958:0" data-first-offset="true"><span class="se-1f58401f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">造成这个争论的原因，既包括缺乏对于代码审查好处的认识，也包括一些因果逻辑上的混淆。</span></span></span></span><span data-slate-object="text" data-key="1959"><span data-slate-leaf="true" data-offset-key="1959:0" data-first-offset="true"><span data-slate-string="true">我想，今天的特别放送，我就来把代码审查这个事儿聊清楚，希望它能成为你日常开发工作当中认真对待的必选项。</span></span></span>
 </div>
 <div class="se-3cd07a10 " data-slate-type="paragraph" data-slate-object="block" data-key="1960">
  <span data-slate-object="text" data-key="1961"><span data-slate-leaf="true" data-offset-key="1961:0" data-first-offset="true"><span data-slate-string="true">那值得一提的是，对于全栈工程师而言，代码审查又有一点特殊性。因为我们经常要写多个层面的代码，包括前端代码 HTML、CSS、JavaScript，后端逻辑，比如 Java 或者 Python，还很可能写很多的脚本代码，比如 Shell，做各种各样的配置，像是和基于 XML、JSON 的配置文件打交道，还很可能使用 SQL 写持久层的逻辑。这些代码中，既包括命令式的代码，也包括声明式的代码。由于涉及到的代码类型比较广泛，代码审查者就自然会和不同的团队或项目中的角色打交道，也需要在不同的思维模式之间来回切换。</span></span></span>
 </div>
 <h2 class="se-b251eef3" data-slate-type="heading" data-slate-object="block" data-key="1962"><span data-slate-object="text" data-key="1963"><span data-slate-leaf="true" data-offset-key="1963:0" data-first-offset="true"><span data-slate-string="true">代码审查的流程</span></span></span></h2>
 <div class="se-fbab5116 " data-slate-type="paragraph" data-slate-object="block" data-key="1964">
  <span data-slate-object="text" data-key="1965"><span data-slate-leaf="true" data-offset-key="1965:0" data-first-offset="true"><span data-slate-string="true">先来简单介绍一下常见的代码审查的流程。为了开发某个新特性，或者修复某个特定问题，负责的程序员会从代码库的主分支（master branch）上面建立并 check out 一个新的分支，将工作分为一次到若干次的“代码变更”来提交。这每一次的代码变更，都可以组成一次代码审查的单元，有的公司把它叫做 CR（Code Change），有的叫做 PR（Pull Request），还有的叫做 CL（Change List），但无论叫做什么，它一般至少包含这么几项内容：</span></span></span>
 </div>
 <div class="se-43eddf05" data-slate-type="list" data-slate-object="block" data-key="1966">
  <div class="se-3e93b622 se-3537de32" data-slate-type="list-line" data-slate-object="block" data-key="1967">
   <span data-slate-object="text" data-key="1968"><span data-slate-leaf="true" data-offset-key="1968:0" data-first-offset="true"><span class="se-a76cb9a1" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">帮助理解代码的描述</span></span></span></span><span data-slate-object="text" data-key="1969"><span data-slate-leaf="true" data-offset-key="1969:0" data-first-offset="true"><span data-slate-string="true">，如果有问题单（任务）来跟踪，需要包括相关的问题单号或者问题单链接；</span></span></span>
  </div>
  <div class="se-d4ce3b48 se-ebde9687" data-slate-type="list-line" data-slate-object="block" data-key="1970">
   <span data-slate-object="text" data-key="1971"><span data-slate-leaf="true" data-offset-key="1971:0" data-first-offset="true"><span class="se-7de684f3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">实际的代码变更主体</span></span></span></span><span data-slate-object="text" data-key="1972"><span data-slate-leaf="true" data-offset-key="1972:0" data-first-offset="true"><span data-slate-string="true">，包括实际的代码和配置；</span></span></span>
  </div>
  <div class="se-fab01463 se-b86f553a" data-slate-type="list-line" data-slate-object="block" data-key="1973">
   <span data-slate-object="text" data-key="1974"><span data-slate-leaf="true" data-offset-key="1974:0" data-first-offset="true"><span class="se-bdf6b18b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">测试和结果</span></span></span></span><span data-slate-object="text" data-key="1975"><span data-slate-leaf="true" data-offset-key="1975:0" data-first-offset="true"><span data-slate-string="true">，根据项目的情况，它可以具备不同形式，比如单元测试代码，以及手工测试等其它测试执行的结果说明。</span></span></span>
  </div>
 </div>
 <div class="se-77873632 " data-slate-type="paragraph" data-slate-object="block" data-key="1976">
  <span data-slate-object="text" data-key="1977"><span data-slate-leaf="true" data-offset-key="1977:0" data-first-offset="true"><span data-slate-string="true">多数情况下，以上这三项都不可或缺，缺少任何一项都会让代码变更失去一定可审查的价值。</span></span></span>
 </div>
 <div class="se-0a1adfa7 " data-slate-type="paragraph" data-slate-object="block" data-key="1978">
  <span data-slate-object="text" data-key="1979"><span data-slate-leaf="true" data-offset-key="1979:0" data-first-offset="true"><span data-slate-string="true">进行审查的，一般是一起工作的，对代码涉及变更熟悉的其他程序员。这个“熟悉”，既包括业务，也包括技术，二者当中，有一项不具备，就很难做好审查工作，给出有建设性的审查意见。</span></span></span>
 </div>
 <div class="se-7e6dae67 " data-slate-type="paragraph" data-slate-object="block" data-key="1980">
  <span data-slate-object="text" data-key="1981"><span data-slate-leaf="true" data-offset-key="1981:0" data-first-offset="true"><span data-slate-string="true">接下去的交互就在这个代码变更上面了，审查者会提出其问题和建议，变更的作者会选择性采纳并改进变更的描述、代码主体以及测试。</span></span></span><span data-slate-object="text" data-key="1982"><span data-slate-leaf="true" data-offset-key="1982:0" data-first-offset="true"><span class="se-a04fd442" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">双方思考、争辩，以及妥协，目的都是寻求一个切合实际且可以改进代码质量的平衡。</span></span></span></span>
 </div>
 <div class="se-cf790bc3 " data-slate-type="paragraph" data-slate-object="block" data-key="1983">
  <span data-slate-object="text" data-key="1984"><span data-slate-leaf="true" data-offset-key="1984:0" data-first-offset="true"><span data-slate-string="true">如果审查的程序员觉得代码没有太多问题，就会盖上一个“Approved”或者“Shipped”戳，表示认可和通过。这根据项目而定，一般代码变更最少要得到 1~3 个这样的认可，才可以将代码变更合并（merge）到主分支。而主分支的代码，会随着 CI/CD 的流程进入自动化的测试程序，并部署上线（关于这部分你可以参阅 [第 30 讲]）。</span></span></span>
 </div>
 <h2 class="se-a49ee0e8" data-slate-type="heading" data-slate-object="block" data-key="1985"><span data-slate-object="text" data-key="1986"><span data-slate-leaf="true" data-offset-key="1986:0" data-first-offset="true"><span data-slate-string="true">常见的争议</span></span></span></h2>
 <div class="se-df5ebb62 " data-slate-type="paragraph" data-slate-object="block" data-key="1987">
  <span data-slate-object="text" data-key="1988"><span data-slate-leaf="true" data-offset-key="1988:0" data-first-offset="true"><span data-slate-string="true">在介绍代码审查的好处之前，我想先来谈谈争议。因为我观察到</span></span></span><span data-slate-object="text" data-key="1989"><span data-slate-leaf="true" data-offset-key="1989:0" data-first-offset="true"><span class="se-37694582" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">大多数的争议，都不是在否认代码审查的好处，而是聚焦在不进行代码审查的那些“原因”</span></span></span></span><span data-slate-object="text" data-key="1990"><span data-slate-leaf="true" data-offset-key="1990:0" data-first-offset="true"><span data-slate-string="true"> 或者 “借口”上，而有些讽刺的是，我认为</span></span></span><span data-slate-object="text" data-key="1991"><span data-slate-leaf="true" data-offset-key="1991:0" data-first-offset="true"><span class="se-008340cc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这里面大部分的“原因”，所代表着的因果关系并不成立</span></span></span></span><span data-slate-object="text" data-key="1992"><span data-slate-leaf="true" data-offset-key="1992:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
 </div>
 <div class="se-7d5c946b " data-slate-type="paragraph" data-slate-object="block" data-key="1993">
  <span data-slate-object="text" data-key="1994"><span data-slate-leaf="true" data-offset-key="1994:0" data-first-offset="true"><span class="se-26baca3f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 加班要累死了，完成项目都来不及，还做什么代码审查？</span></span></span></span>
 </div>
 <div class="se-4bf5f240 " data-slate-type="paragraph" data-slate-object="block" data-key="1995">
  <span data-slate-object="text" data-key="1996"><span data-slate-leaf="true" data-offset-key="1996:0" data-first-offset="true"><span data-slate-string="true">类似的问题还有，“代码审查拖慢了进度”，“代码审查不利于快速上线”。这是最常见的不做代码审查，或者草草进行代码审查的理由了，但是稍稍一细想，就会发现这里的因果逻辑完全不对。</span></span></span>
 </div>
 <div class="se-b65f0295 " data-slate-type="paragraph" data-slate-object="block" data-key="1997">
  <span data-slate-object="text" data-key="1998"><span data-slate-leaf="true" data-offset-key="1998:0" data-first-offset="true"><span data-slate-string="true">这就像以前国内大兴“敏捷”的时候，有好多程序员，甚至项目经理，觉得因为项目时间紧才要实施敏捷，因为可以少写文档，少做测试，随意变更需求，可这里的因为所以根本是牛头不对马嘴。我记得知乎上有句流行的话叫做，“先问是不是，再问为什么”，这里也可以用，因为项目压力大就让“不做代码审查”来承担后果，这实在是过于牵强了。</span></span></span>
 </div>
 <div class="se-0e642ade " data-slate-type="paragraph" data-slate-object="block" data-key="1999">
  <span data-slate-object="text" data-key="2000"><span data-slate-leaf="true" data-offset-key="2000:0" data-first-offset="true"><span data-slate-string="true">项目压力大，时间紧，可以草草做分析，不做设计，直接编码，不做重构、不做测试、不做审查，直接上线，快及一时，可是造成的损失，最后总是要有谁来背锅的。这个锅很可能，就是上线后无尽的问题，就是恶性循环加班加点地改问题，就是代码一个版本比一个版本烂。当这些问题都焦头烂额，就更不要说团队和程序员的成长了。</span></span></span>
 </div>
 <div class="se-b3abb2a2 " data-slate-type="paragraph" data-slate-object="block" data-key="2001">
  <span data-slate-object="text" data-key="2002"><span data-slate-leaf="true" data-offset-key="2002:0" data-first-offset="true"><span class="se-5d386501" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 代码审查太费时间，改来改去无非是一些格式、注释、命名之类不痛不痒的问题。</span></span></span></span>
 </div>
 <div class="se-a7e4767a " data-slate-type="paragraph" data-slate-object="block" data-key="2003">
  <span data-slate-object="text" data-key="2004"><span data-slate-leaf="true" data-offset-key="2004:0" data-first-offset="true"><span data-slate-string="true">这也是个逻辑不通的论述，虽然这个还比前面那个稍微好一点。只能提出这些“次要问题”，很可能是代码审查的能力不够，而并非代码审查没有价值；或者是代码审查的力度不够，只能提出一些浅表的问题，这个现象其实更为普遍。</span></span></span>
 </div>
 <div class="se-0ed12fc6 " data-slate-type="paragraph" data-slate-object="block" data-key="2005">
  <span data-slate-object="text" data-key="2006"><span data-slate-leaf="true" data-offset-key="2006:0" data-first-offset="true"><span data-slate-string="true">前面已经介绍过了，</span></span></span><span data-slate-object="text" data-key="2007"><span data-slate-leaf="true" data-offset-key="2007:0" data-first-offset="true"><span class="se-bedbeb33" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">一是技术，二是业务，二者缺一都无法做出比较好的审查。</span></span></span></span><span data-slate-object="text" data-key="2008"><span data-slate-leaf="true" data-offset-key="2008:0" data-first-offset="true"><span data-slate-string="true">在某些特殊情况下，有时候确实不具备完备的代码审查条件，我们现在来分业务、技术欠缺的情况进行讨论。</span></span></span>
 </div>
 <div class="se-3b5188e7 " data-slate-type="paragraph" data-slate-object="block" data-key="2009">
  <span data-slate-object="text" data-key="2010"><span data-slate-leaf="true" data-offset-key="2010:0" data-first-offset="true"><span data-slate-string="true">如果团队中有业务达人，但是技术能力不足。比如说，新版本使用的是 Scala 来实现的，但是团队中没有精通 Scala 的程序员，这个时候可以寻找其它团队有 Scala 经验的程序员来重点进行技术层面的代码审查，而自己团队则主要关注于业务逻辑层面。当然，既然是自己团队的代码，所用到的技术要慢慢补起来。</span></span></span>
 </div>
 <div class="se-44e74fb2 " data-slate-type="paragraph" data-slate-object="block" data-key="2011">
  <span data-slate-object="text" data-key="2012"><span data-slate-leaf="true" data-offset-key="2012:0" data-first-offset="true"><span data-slate-string="true">如果团队的成员具备技术能力，但是业务不了解。这种情况也可以进行将业务和技术分开审查这样的类似处理，但是如果业务相对复杂，可以先开一个预审查会，就着代码或者设计文档，简单地将业务逻辑介绍和讨论清楚，再进行审查。</span></span></span>
 </div>
 <div class="se-79df13c4 " data-slate-type="paragraph" data-slate-object="block" data-key="2013">
  <span data-slate-object="text" data-key="2014"><span data-slate-leaf="true" data-offset-key="2014:0" data-first-offset="true"><span class="se-7649458d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 团队的习惯和流程就是不做代码审查，大家都是这么过来的。</span></span></span></span>
 </div>
 <div class="se-25d11d0b " data-slate-type="paragraph" data-slate-object="block" data-key="2015">
  <span data-slate-object="text" data-key="2016"><span data-slate-leaf="true" data-offset-key="2016:0" data-first-offset="true"><span data-slate-string="true">我觉得这也不是一个论述不应该做代码审查的正当理由，类似的还有“绩效考评又不提代码审查”，以及“我上班、码代码、下班、拿钱，审查代码干什么”。大家都不做，并不代表不做就是正确的，如果你赞同代码审查的好处和必要性，那么你的思考会告诉你，应该做这件事情，大家不做并不是一个理由。</span></span></span>
 </div>
 <div class="se-ba3f6627 " data-slate-type="paragraph" data-slate-object="block" data-key="2017">
  <span data-slate-object="text" data-key="2018"><span data-slate-leaf="true" data-offset-key="2018:0" data-first-offset="true"><span data-slate-string="true">如果你发现这件事很难推动，你可以尝试去和你的项目经理聊一聊，或者结合自己的项目以及下面会讲到的代码审查的好处论一论，看看是不是能说服那些没有意识到代码审查好处的程序员和项目经理。当然，这是另外和人沟通以及表达自己观点的事情，如果大家都是朴素的干活拿钱的观点，没有对于代码质量和个人发展更高的追求，或者价值观和你相距十万八千里，改变很困难，你就应该好好思考是不是应该选择更好的团队了。</span></span></span>
 </div>
 <div class="se-d639e4fa " data-slate-type="paragraph" data-slate-object="block" data-key="2019">
  <span data-slate-object="text" data-key="2020"><span data-slate-leaf="true" data-offset-key="2020:0" data-first-offset="true"><span class="se-8a3a2dab" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 代码审查不利于团建，因为经常有程序员因为观点不同在代码审查的时候吵起来。</span></span></span></span>
 </div>
 <div class="se-73bd485f " data-slate-type="paragraph" data-slate-object="block" data-key="2021">
  <span data-slate-object="text" data-key="2022"><span data-slate-leaf="true" data-offset-key="2022:0" data-first-offset="true"><span data-slate-string="true">这依然不是一个正当理由，这就好像说“因为开车容易出交通事故，所以平时不允许开车”这样荒谬的逻辑一样。</span></span></span>
 </div>
 <div class="se-787e0000 " data-slate-type="paragraph" data-slate-object="block" data-key="2023">
  <span data-slate-object="text" data-key="2024"><span data-slate-leaf="true" data-offset-key="2024:0" data-first-offset="true"><span data-slate-string="true">首先，如果有偏执的不愿意合作的程序员，那么不只是代码审查，任何需要沟通和协作的活动都可以把争吵的干柴点燃。对于这样的程序员的管理，或者如何和这样的程序员合作，是另外的一个话题，但这并不能否认代码审查的必要性。当然，在下文讲到实践的部分我会介绍一些小的技巧，帮助你在代码审查中心平气和地说服对方。</span></span></span>
 </div>
 <div class="se-fa85a8d1 " data-slate-type="paragraph" data-slate-object="block" data-key="2025">
  <span data-slate-object="text" data-key="2026"><span data-slate-leaf="true" data-offset-key="2026:0" data-first-offset="true"><span data-slate-string="true">其次，有控制的一定强度内的争执，未必是坏事。有句话叫做“理越辩越明”，除了能做出尽可能合理的决定以外，在争论的过程中，你还会得到分析、思考、权衡、归纳、表达，乃至心理这些综合能力的锻炼，本来它们就不是很容易得到的机会，我们为什么还要放过呢？</span></span></span>
 </div>
 <h2 class="se-01a2229a" data-slate-type="heading" data-slate-object="block" data-key="2027"><span data-slate-object="text" data-key="2028"><span data-slate-leaf="true" data-offset-key="2028:0" data-first-offset="true"><span data-slate-string="true">代码审查的好处</span></span></span></h2>
 <div class="se-79f58971 " data-slate-type="paragraph" data-slate-object="block" data-key="2029">
  <span data-slate-object="text" data-key="2030"><span data-slate-leaf="true" data-offset-key="2030:0" data-first-offset="true"><span data-slate-string="true">下面我们来谈谈代码审查的好处。你可能会想，这有什么可谈的，这好处难道不是发现软件 bug，提高代码质量吗？</span></span></span>
 </div>
 <div class="se-800ca3f4 " data-slate-type="paragraph" data-slate-object="block" data-key="2031">
  <span data-slate-object="text" data-key="2032"><span data-slate-leaf="true" data-offset-key="2032:0" data-first-offset="true"><span data-slate-string="true">别急，代码审查的好处可远远不止这一个，我觉得它还至少包括下面这些好处。</span></span></span>
 </div>
 <div class="se-862ff335 " data-slate-type="paragraph" data-slate-object="block" data-key="2033">
  <span data-slate-object="text" data-key="2034"><span data-slate-leaf="true" data-offset-key="2034:0" data-first-offset="true"><span class="se-0a8762fc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 代码审查是个人和团队提升的最佳途径之一。</span></span></span></span>
 </div>
 <div class="se-ab6e69fc " data-slate-type="paragraph" data-slate-object="block" data-key="2035">
  <span data-slate-object="text" data-key="2036"><span data-slate-leaf="true" data-offset-key="2036:0" data-first-offset="true"><span data-slate-string="true">这里的学习，既包括技术学习，也包括业务学习。和英语学习一样，如果只听 BBC 或者 VOA 的纯正口音，没有任何语法错误，英文反而不容易学好，学英文就要接触生活英语，各种口音，各种不合标准的习惯用法。阅读代码也一样，要学习不同的代码风格和实现。</span></span></span>
 </div>
 <div class="se-f3ed3298 " data-slate-type="paragraph" data-slate-object="block" data-key="2037">
  <span data-slate-object="text" data-key="2038"><span data-slate-leaf="true" data-offset-key="2038:0" data-first-offset="true"><span data-slate-string="true">在做代码审查的时候，如果不理解代码，是无法给出最佳审查的。因此自己会被迫去仔细阅读代码，弄懂每一行每一个变量，而不是给一个 LGTM（“Looks Good To Me”）了事。</span></span></span>
 </div>
 <div class="se-1f838fec " data-slate-type="paragraph" data-slate-object="block" data-key="2039">
  <span data-slate-object="text" data-key="2040"><span data-slate-leaf="true" data-offset-key="2040:0" data-first-offset="true"><span class="se-5eff7d87" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 代码审查是团队关系建设和扩大双方影响力的有效方式。</span></span></span></span>
 </div>
 <div class="se-69b631ea " data-slate-type="paragraph" data-slate-object="block" data-key="2041">
  <span data-slate-object="text" data-key="2042"><span data-slate-leaf="true" data-offset-key="2042:0" data-first-offset="true"><span data-slate-string="true">争论是这个过程中必不可少的一环，争论除了能加深对于问题和解决方法的理解，在不断的反驳和妥协中，也能树立影响力，建立良好的关系。另外值得一提的是，</span></span></span><span data-slate-object="text" data-key="2043"><span data-slate-leaf="true" data-offset-key="2043:0" data-first-offset="true"><span class="se-084680cf" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">代码审查可不是说非得给别人挑刺儿，对于做得特别漂亮的地方，要赞扬，这也是建立良好关系的一种途径。</span></span></span></span><span data-slate-object="text" data-key="2044"><span data-slate-leaf="true" data-offset-key="2044:0" data-first-offset="true"><span data-slate-string="true">从团队合作和交流的角度来说，程序员往往缺乏沟通，每个人不能只专注于自己的那一份代码默默耕耘，而是需要建立自己的影响力的，代码审查过程中的交互，就是一个不可多得的方式。</span></span></span>
 </div>
 <div class="se-18b6558b " data-slate-type="paragraph" data-slate-object="block" data-key="2045">
  <span data-slate-object="text" data-key="2046"><span data-slate-leaf="true" data-offset-key="2046:0" data-first-offset="true"><span class="se-11b1824e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 识别出设计的缺陷，找到安全、性能、依赖和兼容性等测试不易发现的问题。</span></span></span></span>
 </div>
 <div class="se-3345010f " data-slate-type="paragraph" data-slate-object="block" data-key="2047">
  <span data-slate-object="text" data-key="2048"><span data-slate-leaf="true" data-offset-key="2048:0" data-first-offset="true"><span data-slate-string="true">代码审查在整个软件工程流程中还算早、中期，尽早发现问题就能够尽可能地减少修复问题的成本。而且，代码审查能够发现的问题，往往是其它途径不易发现的。因此，从这个角度来讲，代码审查要有方向性，比如主流程和某些重要用例，在审查的时候可以要求代码变更的程序员提供单元测试，或者是手工覆盖的测试结果，这样就可以认定这些分支覆盖到的逻辑是正确的，不需要在审查时额外关注。</span></span></span>
 </div>
 <div class="se-3d0d1eb7 " data-slate-type="paragraph" data-slate-object="block" data-key="2049">
  <span data-slate-object="text" data-key="2050"><span data-slate-leaf="true" data-offset-key="2050:0" data-first-offset="true"><span class="se-8014675d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 设立团队质量标杆的最佳实践方式。</span></span></span></span>
 </div>
 <div class="se-331635c6 " data-slate-type="paragraph" data-slate-object="block" data-key="2051">
  <span data-slate-object="text" data-key="2052"><span data-slate-leaf="true" data-offset-key="2052:0" data-first-offset="true"><span data-slate-string="true">在我经历的团队中，基本上代码审查做得好的，代码质量都高。这不见得是程序员的能力特别出色，而是通过代码审查把这个质量的 bar 顶起来了。你可以想象，一个对别人的代码颇为“挑剔”的人，他会对自己的代码截然相反地糊弄了事，睁一只眼闭一只眼吗？特别对于刚踏入职场的程序员来说，这点尤为重要，要知道一个人刚工作的两三年，对性格、习惯这些关乎职业生涯因素的影响是巨大的，一个好的标杆比任何口号都有效。</span></span></span>
 </div>
 <h2 class="se-84a3f606" data-slate-type="heading" data-slate-object="block" data-key="2053"><span data-slate-object="text" data-key="2054"><span data-slate-leaf="true" data-offset-key="2054:0" data-first-offset="true"><span data-slate-string="true">一些小技巧</span></span></span></h2>
 <div class="se-ff4288ca " data-slate-type="paragraph" data-slate-object="block" data-key="2055">
  <span data-slate-object="text" data-key="2056"><span data-slate-leaf="true" data-offset-key="2056:0" data-first-offset="true"><span data-slate-string="true">最后我们来谈一些小技巧，来帮助这个代码审查的过程顺利进行。</span></span></span>
 </div>
 <div class="se-edb3274f " data-slate-type="paragraph" data-slate-object="block" data-key="2057">
  <span data-slate-object="text" data-key="2058"><span data-slate-leaf="true" data-offset-key="2058:0" data-first-offset="true"><span class="se-f67f2503" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 每次变更所包含的代码量一定要小。</span></span></span></span>
 </div>
 <div class="se-c4d7610d " data-slate-type="paragraph" data-slate-object="block" data-key="2059">
  <span data-slate-object="text" data-key="2060"><span data-slate-leaf="true" data-offset-key="2060:0" data-first-offset="true"><span data-slate-string="true">这一点很重要，代码变更是要给人看的，因此确保变更足够小，能够让它容易理解，审查代码的人，也不会觉得疲劳和有压力。代码清楚了，审查也就可以有效地进行，也更容易得到通过和认可。如果预计代码量大怎么办？可以尝试将其分解成若干个小的变更，一个一个提交。</span></span></span>
 </div>
 <div class="se-d225bbbd " data-slate-type="paragraph" data-slate-object="block" data-key="2061">
  <span data-slate-object="text" data-key="2062"><span data-slate-leaf="true" data-offset-key="2062:0" data-first-offset="true"><span class="se-0c7035de" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 让团队中的“牛人”在代码审查中发挥作用。</span></span></span></span>
 </div>
 <div class="se-1b30efe5 " data-slate-type="paragraph" data-slate-object="block" data-key="2063">
  <span data-slate-object="text" data-key="2064"><span data-slate-leaf="true" data-offset-key="2064:0" data-first-offset="true"><span data-slate-string="true">团队中的核心成员，可以相对来说少做一点实现，多在设计上做一点参与和决策，多把握代码审查这一环节。以前我在某一个团队中，总代码超过了六十万行，我们实施过这样一种管理方式，将代码划分为几个大的模块，每一模块都指定一个技术责任人，他会对该层代码全面负责，所有的代码变更都要经过他的审查。</span></span></span>
 </div>
 <div class="se-565ba037 " data-slate-type="paragraph" data-slate-object="block" data-key="2065">
  <span data-slate-object="text" data-key="2066"><span data-slate-leaf="true" data-offset-key="2066:0" data-first-offset="true"><span class="se-6da4f0ab" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 变更代码的质量要超过当前代码库的平均水准。</span></span></span></span>
 </div>
 <div class="se-b58a689b " data-slate-type="paragraph" data-slate-object="block" data-key="2067">
  <span data-slate-object="text" data-key="2068"><span data-slate-leaf="true" data-offset-key="2068:0" data-first-offset="true"><span data-slate-string="true">代码的审查意见有“建设性意见”和“次要意见”之分，那么那些“次要意见”，例如格式、注释、命名，到底做到什么层次，就会成为一个争论的话题，要求低了代码质量接受不了，而要求高了又会拖慢开发进度。我觉得，这种情况下，可以遵循这样的判断标准：看</span></span></span><span data-slate-object="text" data-key="2069"><span data-slate-leaf="true" data-offset-key="2069:0" data-first-offset="true"><span class="se-80c32077" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">新提交的代码会让当前的代码库代码质量更高了，还是更低了</span></span></span></span><span data-slate-object="text" data-key="2070"><span data-slate-leaf="true" data-offset-key="2070:0" data-first-offset="true"><span data-slate-string="true">，只有高于当前项目平均质量的代码才能合并入主分支。</span></span></span>
 </div>
 <div class="se-8e7f171f " data-slate-type="paragraph" data-slate-object="block" data-key="2071">
  <span data-slate-object="text" data-key="2072"><span data-slate-leaf="true" data-offset-key="2072:0" data-first-offset="true"><span class="se-f3079596" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 新员工代码，骨架代码的代码审查要更为严格。</span></span></span></span>
 </div>
 <div class="se-5dc1880f " data-slate-type="paragraph" data-slate-object="block" data-key="2073">
  <span data-slate-object="text" data-key="2074"><span data-slate-leaf="true" data-offset-key="2074:0" data-first-offset="true"><span data-slate-string="true">对于新员工的代码审查可以稍微严格一些，这有助于培养良好的质量意识和习惯，前面已经提到了，这对于职业生涯都是有益的。“骨架代码”指的是那些与项目业务无关的架构代码，这部分代码从技术的层面来说更加重要，往往也很考验代码功底，代码审查可以更严格一些。</span></span></span>
 </div>
 <div class="se-28283f04 " data-slate-type="paragraph" data-slate-object="block" data-key="2075">
  <span data-slate-object="text" data-key="2076"><span data-slate-leaf="true" data-offset-key="2076:0" data-first-offset="true"><span class="se-af7dfc4e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">5. 及时表达肯定，委婉表达意见。</span></span></span></span>
 </div>
 <div class="se-8f6d880b " data-slate-type="paragraph" data-slate-object="block" data-key="2077">
  <span data-slate-object="text" data-key="2078"><span data-slate-leaf="true" data-offset-key="2078:0" data-first-offset="true"><span data-slate-string="true">只针对代码，不针对人。这听起来很简单，都知道对事不对人的重要性，但是要非常小心不能违背。审查并不是只提反面意见的，在遇到好的实现，不错的想法的时候，可以表示肯定，当然这个数量不宜多，要不然适得其反。至于表达意见方面，我来举几个例子：</span></span></span>
 </div>
 <div class="se-bd9fa8f7" data-slate-type="list" data-slate-object="block" data-key="2079">
  <div class="se-42096a19 se-65181e18" data-slate-type="list-line" data-slate-object="block" data-key="2080">
   <span data-slate-object="text" data-key="2081"><span data-slate-leaf="true" data-offset-key="2081:0" data-first-offset="true"><span data-slate-string="true">对于一些次要问题，我都会标注这个问题是一个 picky 或者 nit 的问题（“挑剔的问题”）。这样的好处在于，明确告知对方，</span></span></span><span data-slate-object="text" data-key="2082"><span data-slate-leaf="true" data-offset-key="2082:0" data-first-offset="true"><span class="se-a42f65f5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我虽然提出了这个问题，但是它没有什么大不了的，如果你坚持不改，我也不打算说服你。</span></span></span></span><span data-slate-object="text" data-key="2083"><span data-slate-leaf="true" data-offset-key="2083:0" data-first-offset="true"><span data-slate-string="true">或者说，我对这个问题持有不同的看法，但是我也并不坚信我的提议更好。</span></span></span>
  </div>
  <div class="se-bd8a03ba se-7ebf213b" data-slate-type="list-line" data-slate-object="block" data-key="2084">
   <span data-slate-object="text" data-key="2085"><span data-slate-leaf="true" data-offset-key="2085:0" data-first-offset="true"><span data-slate-string="true">使用也许、或许、可能、似乎这样表示不确定的语气词（英文中有时可以使用虚拟语气）。这样的好处是，缓和自己表达观点的语气。比如说：“这个地方重构一下，去掉这个循环，也许会更好。”</span></span></span>
  </div>
  <div class="se-bdaf6e59 se-04e974ce" data-slate-type="list-line" data-slate-object="block" data-key="2086">
   <span data-slate-object="text" data-key="2087"><span data-slate-leaf="true" data-offset-key="2087:0" data-first-offset="true"><span data-slate-string="true">间接地表达否定。比如说，你看到对方配置了周期为 60 秒，但是你觉得不对，但又不很确定，你可以这样说：“我有一个疑问，为什么这里要使用 60 秒而不是其他值呢？” 对方可能会反应过来这个值选取得不够恰当。你看，这个方式就是使用疑问，而非直接的否定，这就委婉得多。</span></span></span>
  </div>
  <div class="se-442b3897 se-fcfbfa0d" data-slate-type="list-line" data-slate-object="block" data-key="2088">
   <span data-slate-object="text" data-key="2089"><span data-slate-leaf="true" data-offset-key="2089:0" data-first-offset="true"><span data-slate-string="true">放上例子、讨论的链接，以及其它一些辅助材料证明自己的观点，但是不要直接表述观点，让对方来确认这个观点。比如说：“下面的讨论是关于这个逻辑的另一种实现方式，不知你觉得如何？”</span></span></span>
  </div>
  <div class="se-17eaa537 se-3de1dff1" data-slate-type="list-line" data-slate-object="block" data-key="2090">
   <span data-slate-object="text" data-key="2091"><span data-slate-leaf="true" data-offset-key="2091:0" data-first-offset="true"><span data-slate-string="true">先肯定，再否定。这个我想很多人一直都在用，先摆事实诚恳地说一些同意和正面的话，然后用“不过”、“但是”和“然而”之类的将话锋一转，说出相反的情况，这样也就在言论中比较了优劣，意味着这是经过权衡得出的结论。</span></span></span>
  </div>
 </div>
 <div class="se-03e277aa " data-slate-type="paragraph" data-slate-object="block" data-key="2092">
  <span data-slate-object="text" data-key="2093"><span data-slate-leaf="true" data-offset-key="2093:0" data-first-offset="true"><span class="se-62c18638" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">6. 审查时，代码要过两遍，第一遍抓主要问题，第二遍看次要问题。</span></span></span></span>
 </div>
 <div class="se-2609c04c " data-slate-type="paragraph" data-slate-object="block" data-key="2094">
  <span data-slate-object="text" data-key="2095"><span data-slate-leaf="true" data-offset-key="2095:0" data-first-offset="true"><span data-slate-string="true">代码过两遍的好处在于，可以把代码中的问题有层次地提出来。第一遍的时候，搞清楚代码大致的机制、原理、结构，这样有大的建设性问题可以提出来，等待修复或达成一致。根据第一遍的情况来决定需不需要过第二遍，如果没有大的分歧，可以过第二遍。这第二遍就可以非常仔细了，包括可以提出一些细节问题，也包括格式和命名之类的次要问题。总结一下就是，这种方式的最大好处就在于可以让大的问题被单独提出来，优先解决，让问题的讨论和解决有了层次。</span></span></span>
 </div>
 <h2 class="se-6042f161" data-slate-type="heading" data-slate-object="block" data-key="2096"><span data-slate-object="text" data-key="2097"><span data-slate-leaf="true" data-offset-key="2097:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-307ded98 " data-slate-type="paragraph" data-slate-object="block" data-key="2098">
  <span data-slate-object="text" data-key="2099"><span data-slate-leaf="true" data-offset-key="2099:0" data-first-offset="true"><span data-slate-string="true">今天的特别放送就到这里，在今天的内容中，我结合自己的经历，向你介绍了代码审查的方方面面，主要涉及了“为什么要做代码审查”以及“怎么样做代码审查”这两个方面。</span></span></span>
 </div>
 <div class="se-11978136 " data-slate-type="paragraph" data-slate-object="block" data-key="2100">
  <span data-slate-object="text" data-key="2101"><span data-slate-leaf="true" data-offset-key="2101:0" data-first-offset="true"><span data-slate-string="true">最后留一个小问题吧，欢迎在留言区一起讨论。</span></span></span>
 </div>
 <div class="se-4dd5b40e " data-slate-type="paragraph" data-slate-object="block" data-key="2102">
  <span data-slate-object="text" data-key="2103"><span data-slate-leaf="true" data-offset-key="2103:0" data-first-offset="true"><span data-slate-string="true">你所在的技术团队代码审查是怎么做的，你有没有什么代码审查上的小技巧愿意分享一下呢？</span></span></span>
 </div>
 <div class="se-41c6a425" data-slate-type="image" data-slate-object="block" data-key="2104">
  <img class="se-77042dfa" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |20          |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:44:54.852 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=20 
 {executed in 7 msec}
2020-11-19 17:44:54.859 INFO  jdbc.resultsettable Line:610 - 
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<div data-slate-editor="true" data-key="1948" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-d7531076 " data-slate-type="paragraph" data-slate-object="block" data-key="1949">
  <span data-slate-object="text" data-key="1950"><span data-slate-leaf="true" data-offset-key="1950:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-f34c857d " data-slate-type="paragraph" data-slate-object="block" data-key="1951">
  <span data-slate-object="text" data-key="1952"><span data-slate-leaf="true" data-offset-key="1952:0" data-first-offset="true"><span data-slate-string="true">又到了特别放送时间，今天我想聊一聊代码审查（Code Review）。在软件工程师日常的开发工作中，</span></span></span><span data-slate-object="text" data-key="1953"><span data-slate-leaf="true" data-offset-key="1953:0" data-first-offset="true"><span class="se-a3686360" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果要挑出一项极其重要，却又很容易被忽视的工作，在我看来代码审查几乎是无可争议的第一。</span></span></span></span>
 </div>
 <div class="se-f4127856 " data-slate-type="paragraph" data-slate-object="block" data-key="1954">
  <span data-slate-object="text" data-key="1955"><span data-slate-leaf="true" data-offset-key="1955:0" data-first-offset="true"><span data-slate-string="true">代码审查是一个低投入、高产出的开发活动，就我个人而言，我从其中学到的习惯、方法和知识，让我获益匪浅。但是，我也在微博、微信上看到程序员朋友们争论代码审查的必要性，甚至包括很多大厂的程序员，还有一些有着许多年经验的程序员。</span></span></span>
 </div>
 <div class="se-e1ab63cf " data-slate-type="paragraph" data-slate-object="block" data-key="1956">
  <span data-slate-object="text" data-key="1957"><span data-slate-leaf="true" data-offset-key="1957:0" data-first-offset="true"><span data-slate-string="true">一开始我觉得有些不可思议，和代价相比，代码审查的好处实在太多了，这有必要费那么大心思去讨论这个必要性吗？后来我意识到，</span></span></span><span data-slate-object="text" data-key="1958"><span data-slate-leaf="true" data-offset-key="1958:0" data-first-offset="true"><span class="se-1f58401f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">造成这个争论的原因，既包括缺乏对于代码审查好处的认识，也包括一些因果逻辑上的混淆。</span></span></span></span><span data-slate-object="text" data-key="1959"><span data-slate-leaf="true" data-offset-key="1959:0" data-first-offset="true"><span data-slate-string="true">我想，今天的特别放送，我就来把代码审查这个事儿聊清楚，希望它能成为你日常开发工作当中认真对待的必选项。</span></span></span>
 </div>
 <div class="se-3cd07a10 " data-slate-type="paragraph" data-slate-object="block" data-key="1960">
  <span data-slate-object="text" data-key="1961"><span data-slate-leaf="true" data-offset-key="1961:0" data-first-offset="true"><span data-slate-string="true">那值得一提的是，对于全栈工程师而言，代码审查又有一点特殊性。因为我们经常要写多个层面的代码，包括前端代码 HTML、CSS、JavaScript，后端逻辑，比如 Java 或者 Python，还很可能写很多的脚本代码，比如 Shell，做各种各样的配置，像是和基于 XML、JSON 的配置文件打交道，还很可能使用 SQL 写持久层的逻辑。这些代码中，既包括命令式的代码，也包括声明式的代码。由于涉及到的代码类型比较广泛，代码审查者就自然会和不同的团队或项目中的角色打交道，也需要在不同的思维模式之间来回切换。</span></span></span>
 </div>
 <h2 class="se-b251eef3" data-slate-type="heading" data-slate-object="block" data-key="1962"><span data-slate-object="text" data-key="1963"><span data-slate-leaf="true" data-offset-key="1963:0" data-first-offset="true"><span data-slate-string="true">代码审查的流程</span></span></span></h2>
 <div class="se-fbab5116 " data-slate-type="paragraph" data-slate-object="block" data-key="1964">
  <span data-slate-object="text" data-key="1965"><span data-slate-leaf="true" data-offset-key="1965:0" data-first-offset="true"><span data-slate-string="true">先来简单介绍一下常见的代码审查的流程。为了开发某个新特性，或者修复某个特定问题，负责的程序员会从代码库的主分支（master branch）上面建立并 check out 一个新的分支，将工作分为一次到若干次的“代码变更”来提交。这每一次的代码变更，都可以组成一次代码审查的单元，有的公司把它叫做 CR（Code Change），有的叫做 PR（Pull Request），还有的叫做 CL（Change List），但无论叫做什么，它一般至少包含这么几项内容：</span></span></span>
 </div>
 <div class="se-43eddf05" data-slate-type="list" data-slate-object="block" data-key="1966">
  <div class="se-3e93b622 se-3537de32" data-slate-type="list-line" data-slate-object="block" data-key="1967">
   <span data-slate-object="text" data-key="1968"><span data-slate-leaf="true" data-offset-key="1968:0" data-first-offset="true"><span class="se-a76cb9a1" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">帮助理解代码的描述</span></span></span></span><span data-slate-object="text" data-key="1969"><span data-slate-leaf="true" data-offset-key="1969:0" data-first-offset="true"><span data-slate-string="true">，如果有问题单（任务）来跟踪，需要包括相关的问题单号或者问题单链接；</span></span></span>
  </div>
  <div class="se-d4ce3b48 se-ebde9687" data-slate-type="list-line" data-slate-object="block" data-key="1970">
   <span data-slate-object="text" data-key="1971"><span data-slate-leaf="true" data-offset-key="1971:0" data-first-offset="true"><span class="se-7de684f3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">实际的代码变更主体</span></span></span></span><span data-slate-object="text" data-key="1972"><span data-slate-leaf="true" data-offset-key="1972:0" data-first-offset="true"><span data-slate-string="true">，包括实际的代码和配置；</span></span></span>
  </div>
  <div class="se-fab01463 se-b86f553a" data-slate-type="list-line" data-slate-object="block" data-key="1973">
   <span data-slate-object="text" data-key="1974"><span data-slate-leaf="true" data-offset-key="1974:0" data-first-offset="true"><span class="se-bdf6b18b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">测试和结果</span></span></span></span><span data-slate-object="text" data-key="1975"><span data-slate-leaf="true" data-offset-key="1975:0" data-first-offset="true"><span data-slate-string="true">，根据项目的情况，它可以具备不同形式，比如单元测试代码，以及手工测试等其它测试执行的结果说明。</span></span></span>
  </div>
 </div>
 <div class="se-77873632 " data-slate-type="paragraph" data-slate-object="block" data-key="1976">
  <span data-slate-object="text" data-key="1977"><span data-slate-leaf="true" data-offset-key="1977:0" data-first-offset="true"><span data-slate-string="true">多数情况下，以上这三项都不可或缺，缺少任何一项都会让代码变更失去一定可审查的价值。</span></span></span>
 </div>
 <div class="se-0a1adfa7 " data-slate-type="paragraph" data-slate-object="block" data-key="1978">
  <span data-slate-object="text" data-key="1979"><span data-slate-leaf="true" data-offset-key="1979:0" data-first-offset="true"><span data-slate-string="true">进行审查的，一般是一起工作的，对代码涉及变更熟悉的其他程序员。这个“熟悉”，既包括业务，也包括技术，二者当中，有一项不具备，就很难做好审查工作，给出有建设性的审查意见。</span></span></span>
 </div>
 <div class="se-7e6dae67 " data-slate-type="paragraph" data-slate-object="block" data-key="1980">
  <span data-slate-object="text" data-key="1981"><span data-slate-leaf="true" data-offset-key="1981:0" data-first-offset="true"><span data-slate-string="true">接下去的交互就在这个代码变更上面了，审查者会提出其问题和建议，变更的作者会选择性采纳并改进变更的描述、代码主体以及测试。</span></span></span><span data-slate-object="text" data-key="1982"><span data-slate-leaf="true" data-offset-key="1982:0" data-first-offset="true"><span class="se-a04fd442" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">双方思考、争辩，以及妥协，目的都是寻求一个切合实际且可以改进代码质量的平衡。</span></span></span></span>
 </div>
 <div class="se-cf790bc3 " data-slate-type="paragraph" data-slate-object="block" data-key="1983">
  <span data-slate-object="text" data-key="1984"><span data-slate-leaf="true" data-offset-key="1984:0" data-first-offset="true"><span data-slate-string="true">如果审查的程序员觉得代码没有太多问题，就会盖上一个“Approved”或者“Shipped”戳，表示认可和通过。这根据项目而定，一般代码变更最少要得到 1~3 个这样的认可，才可以将代码变更合并（merge）到主分支。而主分支的代码，会随着 CI/CD 的流程进入自动化的测试程序，并部署上线（关于这部分你可以参阅 [第 30 讲]）。</span></span></span>
 </div>
 <h2 class="se-a49ee0e8" data-slate-type="heading" data-slate-object="block" data-key="1985"><span data-slate-object="text" data-key="1986"><span data-slate-leaf="true" data-offset-key="1986:0" data-first-offset="true"><span data-slate-string="true">常见的争议</span></span></span></h2>
 <div class="se-df5ebb62 " data-slate-type="paragraph" data-slate-object="block" data-key="1987">
  <span data-slate-object="text" data-key="1988"><span data-slate-leaf="true" data-offset-key="1988:0" data-first-offset="true"><span data-slate-string="true">在介绍代码审查的好处之前，我想先来谈谈争议。因为我观察到</span></span></span><span data-slate-object="text" data-key="1989"><span data-slate-leaf="true" data-offset-key="1989:0" data-first-offset="true"><span class="se-37694582" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">大多数的争议，都不是在否认代码审查的好处，而是聚焦在不进行代码审查的那些“原因”</span></span></span></span><span data-slate-object="text" data-key="1990"><span data-slate-leaf="true" data-offset-key="1990:0" data-first-offset="true"><span data-slate-string="true"> 或者 “借口”上，而有些讽刺的是，我认为</span></span></span><span data-slate-object="text" data-key="1991"><span data-slate-leaf="true" data-offset-key="1991:0" data-first-offset="true"><span class="se-008340cc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这里面大部分的“原因”，所代表着的因果关系并不成立</span></span></span></span><span data-slate-object="text" data-key="1992"><span data-slate-leaf="true" data-offset-key="1992:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
 </div>
 <div class="se-7d5c946b " data-slate-type="paragraph" data-slate-object="block" data-key="1993">
  <span data-slate-object="text" data-key="1994"><span data-slate-leaf="true" data-offset-key="1994:0" data-first-offset="true"><span class="se-26baca3f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 加班要累死了，完成项目都来不及，还做什么代码审查？</span></span></span></span>
 </div>
 <div class="se-4bf5f240 " data-slate-type="paragraph" data-slate-object="block" data-key="1995">
  <span data-slate-object="text" data-key="1996"><span data-slate-leaf="true" data-offset-key="1996:0" data-first-offset="true"><span data-slate-string="true">类似的问题还有，“代码审查拖慢了进度”，“代码审查不利于快速上线”。这是最常见的不做代码审查，或者草草进行代码审查的理由了，但是稍稍一细想，就会发现这里的因果逻辑完全不对。</span></span></span>
 </div>
 <div class="se-b65f0295 " data-slate-type="paragraph" data-slate-object="block" data-key="1997">
  <span data-slate-object="text" data-key="1998"><span data-slate-leaf="true" data-offset-key="1998:0" data-first-offset="true"><span data-slate-string="true">这就像以前国内大兴“敏捷”的时候，有好多程序员，甚至项目经理，觉得因为项目时间紧才要实施敏捷，因为可以少写文档，少做测试，随意变更需求，可这里的因为所以根本是牛头不对马嘴。我记得知乎上有句流行的话叫做，“先问是不是，再问为什么”，这里也可以用，因为项目压力大就让“不做代码审查”来承担后果，这实在是过于牵强了。</span></span></span>
 </div>
 <div class="se-0e642ade " data-slate-type="paragraph" data-slate-object="block" data-key="1999">
  <span data-slate-object="text" data-key="2000"><span data-slate-leaf="true" data-offset-key="2000:0" data-first-offset="true"><span data-slate-string="true">项目压力大，时间紧，可以草草做分析，不做设计，直接编码，不做重构、不做测试、不做审查，直接上线，快及一时，可是造成的损失，最后总是要有谁来背锅的。这个锅很可能，就是上线后无尽的问题，就是恶性循环加班加点地改问题，就是代码一个版本比一个版本烂。当这些问题都焦头烂额，就更不要说团队和程序员的成长了。</span></span></span>
 </div>
 <div class="se-b3abb2a2 " data-slate-type="paragraph" data-slate-object="block" data-key="2001">
  <span data-slate-object="text" data-key="2002"><span data-slate-leaf="true" data-offset-key="2002:0" data-first-offset="true"><span class="se-5d386501" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 代码审查太费时间，改来改去无非是一些格式、注释、命名之类不痛不痒的问题。</span></span></span></span>
 </div>
 <div class="se-a7e4767a " data-slate-type="paragraph" data-slate-object="block" data-key="2003">
  <span data-slate-object="text" data-key="2004"><span data-slate-leaf="true" data-offset-key="2004:0" data-first-offset="true"><span data-slate-string="true">这也是个逻辑不通的论述，虽然这个还比前面那个稍微好一点。只能提出这些“次要问题”，很可能是代码审查的能力不够，而并非代码审查没有价值；或者是代码审查的力度不够，只能提出一些浅表的问题，这个现象其实更为普遍。</span></span></span>
 </div>
 <div class="se-0ed12fc6 " data-slate-type="paragraph" data-slate-object="block" data-key="2005">
  <span data-slate-object="text" data-key="2006"><span data-slate-leaf="true" data-offset-key="2006:0" data-first-offset="true"><span data-slate-string="true">前面已经介绍过了，</span></span></span><span data-slate-object="text" data-key="2007"><span data-slate-leaf="true" data-offset-key="2007:0" data-first-offset="true"><span class="se-bedbeb33" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">一是技术，二是业务，二者缺一都无法做出比较好的审查。</span></span></span></span><span data-slate-object="text" data-key="2008"><span data-slate-leaf="true" data-offset-key="2008:0" data-first-offset="true"><span data-slate-string="true">在某些特殊情况下，有时候确实不具备完备的代码审查条件，我们现在来分业务、技术欠缺的情况进行讨论。</span></span></span>
 </div>
 <div class="se-3b5188e7 " data-slate-type="paragraph" data-slate-object="block" data-key="2009">
  <span data-slate-object="text" data-key="2010"><span data-slate-leaf="true" data-offset-key="2010:0" data-first-offset="true"><span data-slate-string="true">如果团队中有业务达人，但是技术能力不足。比如说，新版本使用的是 Scala 来实现的，但是团队中没有精通 Scala 的程序员，这个时候可以寻找其它团队有 Scala 经验的程序员来重点进行技术层面的代码审查，而自己团队则主要关注于业务逻辑层面。当然，既然是自己团队的代码，所用到的技术要慢慢补起来。</span></span></span>
 </div>
 <div class="se-44e74fb2 " data-slate-type="paragraph" data-slate-object="block" data-key="2011">
  <span data-slate-object="text" data-key="2012"><span data-slate-leaf="true" data-offset-key="2012:0" data-first-offset="true"><span data-slate-string="true">如果团队的成员具备技术能力，但是业务不了解。这种情况也可以进行将业务和技术分开审查这样的类似处理，但是如果业务相对复杂，可以先开一个预审查会，就着代码或者设计文档，简单地将业务逻辑介绍和讨论清楚，再进行审查。</span></span></span>
 </div>
 <div class="se-79df13c4 " data-slate-type="paragraph" data-slate-object="block" data-key="2013">
  <span data-slate-object="text" data-key="2014"><span data-slate-leaf="true" data-offset-key="2014:0" data-first-offset="true"><span class="se-7649458d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 团队的习惯和流程就是不做代码审查，大家都是这么过来的。</span></span></span></span>
 </div>
 <div class="se-25d11d0b " data-slate-type="paragraph" data-slate-object="block" data-key="2015">
  <span data-slate-object="text" data-key="2016"><span data-slate-leaf="true" data-offset-key="2016:0" data-first-offset="true"><span data-slate-string="true">我觉得这也不是一个论述不应该做代码审查的正当理由，类似的还有“绩效考评又不提代码审查”，以及“我上班、码代码、下班、拿钱，审查代码干什么”。大家都不做，并不代表不做就是正确的，如果你赞同代码审查的好处和必要性，那么你的思考会告诉你，应该做这件事情，大家不做并不是一个理由。</span></span></span>
 </div>
 <div class="se-ba3f6627 " data-slate-type="paragraph" data-slate-object="block" data-key="2017">
  <span data-slate-object="text" data-key="2018"><span data-slate-leaf="true" data-offset-key="2018:0" data-first-offset="true"><span data-slate-string="true">如果你发现这件事很难推动，你可以尝试去和你的项目经理聊一聊，或者结合自己的项目以及下面会讲到的代码审查的好处论一论，看看是不是能说服那些没有意识到代码审查好处的程序员和项目经理。当然，这是另外和人沟通以及表达自己观点的事情，如果大家都是朴素的干活拿钱的观点，没有对于代码质量和个人发展更高的追求，或者价值观和你相距十万八千里，改变很困难，你就应该好好思考是不是应该选择更好的团队了。</span></span></span>
 </div>
 <div class="se-d639e4fa " data-slate-type="paragraph" data-slate-object="block" data-key="2019">
  <span data-slate-object="text" data-key="2020"><span data-slate-leaf="true" data-offset-key="2020:0" data-first-offset="true"><span class="se-8a3a2dab" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 代码审查不利于团建，因为经常有程序员因为观点不同在代码审查的时候吵起来。</span></span></span></span>
 </div>
 <div class="se-73bd485f " data-slate-type="paragraph" data-slate-object="block" data-key="2021">
  <span data-slate-object="text" data-key="2022"><span data-slate-leaf="true" data-offset-key="2022:0" data-first-offset="true"><span data-slate-string="true">这依然不是一个正当理由，这就好像说“因为开车容易出交通事故，所以平时不允许开车”这样荒谬的逻辑一样。</span></span></span>
 </div>
 <div class="se-787e0000 " data-slate-type="paragraph" data-slate-object="block" data-key="2023">
  <span data-slate-object="text" data-key="2024"><span data-slate-leaf="true" data-offset-key="2024:0" data-first-offset="true"><span data-slate-string="true">首先，如果有偏执的不愿意合作的程序员，那么不只是代码审查，任何需要沟通和协作的活动都可以把争吵的干柴点燃。对于这样的程序员的管理，或者如何和这样的程序员合作，是另外的一个话题，但这并不能否认代码审查的必要性。当然，在下文讲到实践的部分我会介绍一些小的技巧，帮助你在代码审查中心平气和地说服对方。</span></span></span>
 </div>
 <div class="se-fa85a8d1 " data-slate-type="paragraph" data-slate-object="block" data-key="2025">
  <span data-slate-object="text" data-key="2026"><span data-slate-leaf="true" data-offset-key="2026:0" data-first-offset="true"><span data-slate-string="true">其次，有控制的一定强度内的争执，未必是坏事。有句话叫做“理越辩越明”，除了能做出尽可能合理的决定以外，在争论的过程中，你还会得到分析、思考、权衡、归纳、表达，乃至心理这些综合能力的锻炼，本来它们就不是很容易得到的机会，我们为什么还要放过呢？</span></span></span>
 </div>
 <h2 class="se-01a2229a" data-slate-type="heading" data-slate-object="block" data-key="2027"><span data-slate-object="text" data-key="2028"><span data-slate-leaf="true" data-offset-key="2028:0" data-first-offset="true"><span data-slate-string="true">代码审查的好处</span></span></span></h2>
 <div class="se-79f58971 " data-slate-type="paragraph" data-slate-object="block" data-key="2029">
  <span data-slate-object="text" data-key="2030"><span data-slate-leaf="true" data-offset-key="2030:0" data-first-offset="true"><span data-slate-string="true">下面我们来谈谈代码审查的好处。你可能会想，这有什么可谈的，这好处难道不是发现软件 bug，提高代码质量吗？</span></span></span>
 </div>
 <div class="se-800ca3f4 " data-slate-type="paragraph" data-slate-object="block" data-key="2031">
  <span data-slate-object="text" data-key="2032"><span data-slate-leaf="true" data-offset-key="2032:0" data-first-offset="true"><span data-slate-string="true">别急，代码审查的好处可远远不止这一个，我觉得它还至少包括下面这些好处。</span></span></span>
 </div>
 <div class="se-862ff335 " data-slate-type="paragraph" data-slate-object="block" data-key="2033">
  <span data-slate-object="text" data-key="2034"><span data-slate-leaf="true" data-offset-key="2034:0" data-first-offset="true"><span class="se-0a8762fc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 代码审查是个人和团队提升的最佳途径之一。</span></span></span></span>
 </div>
 <div class="se-ab6e69fc " data-slate-type="paragraph" data-slate-object="block" data-key="2035">
  <span data-slate-object="text" data-key="2036"><span data-slate-leaf="true" data-offset-key="2036:0" data-first-offset="true"><span data-slate-string="true">这里的学习，既包括技术学习，也包括业务学习。和英语学习一样，如果只听 BBC 或者 VOA 的纯正口音，没有任何语法错误，英文反而不容易学好，学英文就要接触生活英语，各种口音，各种不合标准的习惯用法。阅读代码也一样，要学习不同的代码风格和实现。</span></span></span>
 </div>
 <div class="se-f3ed3298 " data-slate-type="paragraph" data-slate-object="block" data-key="2037">
  <span data-slate-object="text" data-key="2038"><span data-slate-leaf="true" data-offset-key="2038:0" data-first-offset="true"><span data-slate-string="true">在做代码审查的时候，如果不理解代码，是无法给出最佳审查的。因此自己会被迫去仔细阅读代码，弄懂每一行每一个变量，而不是给一个 LGTM（“Looks Good To Me”）了事。</span></span></span>
 </div>
 <div class="se-1f838fec " data-slate-type="paragraph" data-slate-object="block" data-key="2039">
  <span data-slate-object="text" data-key="2040"><span data-slate-leaf="true" data-offset-key="2040:0" data-first-offset="true"><span class="se-5eff7d87" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 代码审查是团队关系建设和扩大双方影响力的有效方式。</span></span></span></span>
 </div>
 <div class="se-69b631ea " data-slate-type="paragraph" data-slate-object="block" data-key="2041">
  <span data-slate-object="text" data-key="2042"><span data-slate-leaf="true" data-offset-key="2042:0" data-first-offset="true"><span data-slate-string="true">争论是这个过程中必不可少的一环，争论除了能加深对于问题和解决方法的理解，在不断的反驳和妥协中，也能树立影响力，建立良好的关系。另外值得一提的是，</span></span></span><span data-slate-object="text" data-key="2043"><span data-slate-leaf="true" data-offset-key="2043:0" data-first-offset="true"><span class="se-084680cf" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">代码审查可不是说非得给别人挑刺儿，对于做得特别漂亮的地方，要赞扬，这也是建立良好关系的一种途径。</span></span></span></span><span data-slate-object="text" data-key="2044"><span data-slate-leaf="true" data-offset-key="2044:0" data-first-offset="true"><span data-slate-string="true">从团队合作和交流的角度来说，程序员往往缺乏沟通，每个人不能只专注于自己的那一份代码默默耕耘，而是需要建立自己的影响力的，代码审查过程中的交互，就是一个不可多得的方式。</span></span></span>
 </div>
 <div class="se-18b6558b " data-slate-type="paragraph" data-slate-object="block" data-key="2045">
  <span data-slate-object="text" data-key="2046"><span data-slate-leaf="true" data-offset-key="2046:0" data-first-offset="true"><span class="se-11b1824e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 识别出设计的缺陷，找到安全、性能、依赖和兼容性等测试不易发现的问题。</span></span></span></span>
 </div>
 <div class="se-3345010f " data-slate-type="paragraph" data-slate-object="block" data-key="2047">
  <span data-slate-object="text" data-key="2048"><span data-slate-leaf="true" data-offset-key="2048:0" data-first-offset="true"><span data-slate-string="true">代码审查在整个软件工程流程中还算早、中期，尽早发现问题就能够尽可能地减少修复问题的成本。而且，代码审查能够发现的问题，往往是其它途径不易发现的。因此，从这个角度来讲，代码审查要有方向性，比如主流程和某些重要用例，在审查的时候可以要求代码变更的程序员提供单元测试，或者是手工覆盖的测试结果，这样就可以认定这些分支覆盖到的逻辑是正确的，不需要在审查时额外关注。</span></span></span>
 </div>
 <div class="se-3d0d1eb7 " data-slate-type="paragraph" data-slate-object="block" data-key="2049">
  <span data-slate-object="text" data-key="2050"><span data-slate-leaf="true" data-offset-key="2050:0" data-first-offset="true"><span class="se-8014675d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 设立团队质量标杆的最佳实践方式。</span></span></span></span>
 </div>
 <div class="se-331635c6 " data-slate-type="paragraph" data-slate-object="block" data-key="2051">
  <span data-slate-object="text" data-key="2052"><span data-slate-leaf="true" data-offset-key="2052:0" data-first-offset="true"><span data-slate-string="true">在我经历的团队中，基本上代码审查做得好的，代码质量都高。这不见得是程序员的能力特别出色，而是通过代码审查把这个质量的 bar 顶起来了。你可以想象，一个对别人的代码颇为“挑剔”的人，他会对自己的代码截然相反地糊弄了事，睁一只眼闭一只眼吗？特别对于刚踏入职场的程序员来说，这点尤为重要，要知道一个人刚工作的两三年，对性格、习惯这些关乎职业生涯因素的影响是巨大的，一个好的标杆比任何口号都有效。</span></span></span>
 </div>
 <h2 class="se-84a3f606" data-slate-type="heading" data-slate-object="block" data-key="2053"><span data-slate-object="text" data-key="2054"><span data-slate-leaf="true" data-offset-key="2054:0" data-first-offset="true"><span data-slate-string="true">一些小技巧</span></span></span></h2>
 <div class="se-ff4288ca " data-slate-type="paragraph" data-slate-object="block" data-key="2055">
  <span data-slate-object="text" data-key="2056"><span data-slate-leaf="true" data-offset-key="2056:0" data-first-offset="true"><span data-slate-string="true">最后我们来谈一些小技巧，来帮助这个代码审查的过程顺利进行。</span></span></span>
 </div>
 <div class="se-edb3274f " data-slate-type="paragraph" data-slate-object="block" data-key="2057">
  <span data-slate-object="text" data-key="2058"><span data-slate-leaf="true" data-offset-key="2058:0" data-first-offset="true"><span class="se-f67f2503" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 每次变更所包含的代码量一定要小。</span></span></span></span>
 </div>
 <div class="se-c4d7610d " data-slate-type="paragraph" data-slate-object="block" data-key="2059">
  <span data-slate-object="text" data-key="2060"><span data-slate-leaf="true" data-offset-key="2060:0" data-first-offset="true"><span data-slate-string="true">这一点很重要，代码变更是要给人看的，因此确保变更足够小，能够让它容易理解，审查代码的人，也不会觉得疲劳和有压力。代码清楚了，审查也就可以有效地进行，也更容易得到通过和认可。如果预计代码量大怎么办？可以尝试将其分解成若干个小的变更，一个一个提交。</span></span></span>
 </div>
 <div class="se-d225bbbd " data-slate-type="paragraph" data-slate-object="block" data-key="2061">
  <span data-slate-object="text" data-key="2062"><span data-slate-leaf="true" data-offset-key="2062:0" data-first-offset="true"><span class="se-0c7035de" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 让团队中的“牛人”在代码审查中发挥作用。</span></span></span></span>
 </div>
 <div class="se-1b30efe5 " data-slate-type="paragraph" data-slate-object="block" data-key="2063">
  <span data-slate-object="text" data-key="2064"><span data-slate-leaf="true" data-offset-key="2064:0" data-first-offset="true"><span data-slate-string="true">团队中的核心成员，可以相对来说少做一点实现，多在设计上做一点参与和决策，多把握代码审查这一环节。以前我在某一个团队中，总代码超过了六十万行，我们实施过这样一种管理方式，将代码划分为几个大的模块，每一模块都指定一个技术责任人，他会对该层代码全面负责，所有的代码变更都要经过他的审查。</span></span></span>
 </div>
 <div class="se-565ba037 " data-slate-type="paragraph" data-slate-object="block" data-key="2065">
  <span data-slate-object="text" data-key="2066"><span data-slate-leaf="true" data-offset-key="2066:0" data-first-offset="true"><span class="se-6da4f0ab" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 变更代码的质量要超过当前代码库的平均水准。</span></span></span></span>
 </div>
 <div class="se-b58a689b " data-slate-type="paragraph" data-slate-object="block" data-key="2067">
  <span data-slate-object="text" data-key="2068"><span data-slate-leaf="true" data-offset-key="2068:0" data-first-offset="true"><span data-slate-string="true">代码的审查意见有“建设性意见”和“次要意见”之分，那么那些“次要意见”，例如格式、注释、命名，到底做到什么层次，就会成为一个争论的话题，要求低了代码质量接受不了，而要求高了又会拖慢开发进度。我觉得，这种情况下，可以遵循这样的判断标准：看</span></span></span><span data-slate-object="text" data-key="2069"><span data-slate-leaf="true" data-offset-key="2069:0" data-first-offset="true"><span class="se-80c32077" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">新提交的代码会让当前的代码库代码质量更高了，还是更低了</span></span></span></span><span data-slate-object="text" data-key="2070"><span data-slate-leaf="true" data-offset-key="2070:0" data-first-offset="true"><span data-slate-string="true">，只有高于当前项目平均质量的代码才能合并入主分支。</span></span></span>
 </div>
 <div class="se-8e7f171f " data-slate-type="paragraph" data-slate-object="block" data-key="2071">
  <span data-slate-object="text" data-key="2072"><span data-slate-leaf="true" data-offset-key="2072:0" data-first-offset="true"><span class="se-f3079596" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 新员工代码，骨架代码的代码审查要更为严格。</span></span></span></span>
 </div>
 <div class="se-5dc1880f " data-slate-type="paragraph" data-slate-object="block" data-key="2073">
  <span data-slate-object="text" data-key="2074"><span data-slate-leaf="true" data-offset-key="2074:0" data-first-offset="true"><span data-slate-string="true">对于新员工的代码审查可以稍微严格一些，这有助于培养良好的质量意识和习惯，前面已经提到了，这对于职业生涯都是有益的。“骨架代码”指的是那些与项目业务无关的架构代码，这部分代码从技术的层面来说更加重要，往往也很考验代码功底，代码审查可以更严格一些。</span></span></span>
 </div>
 <div class="se-28283f04 " data-slate-type="paragraph" data-slate-object="block" data-key="2075">
  <span data-slate-object="text" data-key="2076"><span data-slate-leaf="true" data-offset-key="2076:0" data-first-offset="true"><span class="se-af7dfc4e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">5. 及时表达肯定，委婉表达意见。</span></span></span></span>
 </div>
 <div class="se-8f6d880b " data-slate-type="paragraph" data-slate-object="block" data-key="2077">
  <span data-slate-object="text" data-key="2078"><span data-slate-leaf="true" data-offset-key="2078:0" data-first-offset="true"><span data-slate-string="true">只针对代码，不针对人。这听起来很简单，都知道对事不对人的重要性，但是要非常小心不能违背。审查并不是只提反面意见的，在遇到好的实现，不错的想法的时候，可以表示肯定，当然这个数量不宜多，要不然适得其反。至于表达意见方面，我来举几个例子：</span></span></span>
 </div>
 <div class="se-bd9fa8f7" data-slate-type="list" data-slate-object="block" data-key="2079">
  <div class="se-42096a19 se-65181e18" data-slate-type="list-line" data-slate-object="block" data-key="2080">
   <span data-slate-object="text" data-key="2081"><span data-slate-leaf="true" data-offset-key="2081:0" data-first-offset="true"><span data-slate-string="true">对于一些次要问题，我都会标注这个问题是一个 picky 或者 nit 的问题（“挑剔的问题”）。这样的好处在于，明确告知对方，</span></span></span><span data-slate-object="text" data-key="2082"><span data-slate-leaf="true" data-offset-key="2082:0" data-first-offset="true"><span class="se-a42f65f5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我虽然提出了这个问题，但是它没有什么大不了的，如果你坚持不改，我也不打算说服你。</span></span></span></span><span data-slate-object="text" data-key="2083"><span data-slate-leaf="true" data-offset-key="2083:0" data-first-offset="true"><span data-slate-string="true">或者说，我对这个问题持有不同的看法，但是我也并不坚信我的提议更好。</span></span></span>
  </div>
  <div class="se-bd8a03ba se-7ebf213b" data-slate-type="list-line" data-slate-object="block" data-key="2084">
   <span data-slate-object="text" data-key="2085"><span data-slate-leaf="true" data-offset-key="2085:0" data-first-offset="true"><span data-slate-string="true">使用也许、或许、可能、似乎这样表示不确定的语气词（英文中有时可以使用虚拟语气）。这样的好处是，缓和自己表达观点的语气。比如说：“这个地方重构一下，去掉这个循环，也许会更好。”</span></span></span>
  </div>
  <div class="se-bdaf6e59 se-04e974ce" data-slate-type="list-line" data-slate-object="block" data-key="2086">
   <span data-slate-object="text" data-key="2087"><span data-slate-leaf="true" data-offset-key="2087:0" data-first-offset="true"><span data-slate-string="true">间接地表达否定。比如说，你看到对方配置了周期为 60 秒，但是你觉得不对，但又不很确定，你可以这样说：“我有一个疑问，为什么这里要使用 60 秒而不是其他值呢？” 对方可能会反应过来这个值选取得不够恰当。你看，这个方式就是使用疑问，而非直接的否定，这就委婉得多。</span></span></span>
  </div>
  <div class="se-442b3897 se-fcfbfa0d" data-slate-type="list-line" data-slate-object="block" data-key="2088">
   <span data-slate-object="text" data-key="2089"><span data-slate-leaf="true" data-offset-key="2089:0" data-first-offset="true"><span data-slate-string="true">放上例子、讨论的链接，以及其它一些辅助材料证明自己的观点，但是不要直接表述观点，让对方来确认这个观点。比如说：“下面的讨论是关于这个逻辑的另一种实现方式，不知你觉得如何？”</span></span></span>
  </div>
  <div class="se-17eaa537 se-3de1dff1" data-slate-type="list-line" data-slate-object="block" data-key="2090">
   <span data-slate-object="text" data-key="2091"><span data-slate-leaf="true" data-offset-key="2091:0" data-first-offset="true"><span data-slate-string="true">先肯定，再否定。这个我想很多人一直都在用，先摆事实诚恳地说一些同意和正面的话，然后用“不过”、“但是”和“然而”之类的将话锋一转，说出相反的情况，这样也就在言论中比较了优劣，意味着这是经过权衡得出的结论。</span></span></span>
  </div>
 </div>
 <div class="se-03e277aa " data-slate-type="paragraph" data-slate-object="block" data-key="2092">
  <span data-slate-object="text" data-key="2093"><span data-slate-leaf="true" data-offset-key="2093:0" data-first-offset="true"><span class="se-62c18638" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">6. 审查时，代码要过两遍，第一遍抓主要问题，第二遍看次要问题。</span></span></span></span>
 </div>
 <div class="se-2609c04c " data-slate-type="paragraph" data-slate-object="block" data-key="2094">
  <span data-slate-object="text" data-key="2095"><span data-slate-leaf="true" data-offset-key="2095:0" data-first-offset="true"><span data-slate-string="true">代码过两遍的好处在于，可以把代码中的问题有层次地提出来。第一遍的时候，搞清楚代码大致的机制、原理、结构，这样有大的建设性问题可以提出来，等待修复或达成一致。根据第一遍的情况来决定需不需要过第二遍，如果没有大的分歧，可以过第二遍。这第二遍就可以非常仔细了，包括可以提出一些细节问题，也包括格式和命名之类的次要问题。总结一下就是，这种方式的最大好处就在于可以让大的问题被单独提出来，优先解决，让问题的讨论和解决有了层次。</span></span></span>
 </div>
 <h2 class="se-6042f161" data-slate-type="heading" data-slate-object="block" data-key="2096"><span data-slate-object="text" data-key="2097"><span data-slate-leaf="true" data-offset-key="2097:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-307ded98 " data-slate-type="paragraph" data-slate-object="block" data-key="2098">
  <span data-slate-object="text" data-key="2099"><span data-slate-leaf="true" data-offset-key="2099:0" data-first-offset="true"><span data-slate-string="true">今天的特别放送就到这里，在今天的内容中，我结合自己的经历，向你介绍了代码审查的方方面面，主要涉及了“为什么要做代码审查”以及“怎么样做代码审查”这两个方面。</span></span></span>
 </div>
 <div class="se-11978136 " data-slate-type="paragraph" data-slate-object="block" data-key="2100">
  <span data-slate-object="text" data-key="2101"><span data-slate-leaf="true" data-offset-key="2101:0" data-first-offset="true"><span data-slate-string="true">最后留一个小问题吧，欢迎在留言区一起讨论。</span></span></span>
 </div>
 <div class="se-4dd5b40e " data-slate-type="paragraph" data-slate-object="block" data-key="2102">
  <span data-slate-object="text" data-key="2103"><span data-slate-leaf="true" data-offset-key="2103:0" data-first-offset="true"><span data-slate-string="true">你所在的技术团队代码审查是怎么做的，你有没有什么代码审查上的小技巧愿意分享一下呢？</span></span></span>
 </div>
 <div class="se-41c6a425" data-slate-type="image" data-slate-object="block" data-key="2104">
  <img class="se-77042dfa" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |20          |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:44:54.867 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.868 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title           |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|-----|----|----|
|20  |1605755492 |1605755492 |1                |zh-hans  |0       |1                             |1      |0      |27丨特别放送：聊一聊代码审查 |book |1   |20  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|-----|----|----|

2020-11-19 17:44:54.869 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.870 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title           |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|----|----|
|[unread] |1605755492 |1605755492 |1                |zh-hans  |0       |1                             |1      |0      |27丨特别放送：聊一聊代码审查 |1   |20  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------|----|----|

2020-11-19 17:44:54.873 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779094, created=1605779094, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='27丨特别放送：聊一聊代码审查', type='book', 
uid=1, vid=20 where nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.873 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779094, created=1605779094, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='27丨特别放送：聊一聊代码审查', 
uid=1, vid=20 where nid=20 
 {executed in 0 msec}
2020-11-19 17:44:54.879 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.880 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|20        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/f0f60b2f3120a31ba31ee49b7ef48b05?bkt=en-038bee77e919b76a52bf15b298797e1df23fbf578db88e256e200918bebcc3e2b81186e9da9a2d66&fid=3757516097-778750-844850042973714&time=1605755491&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-bMlvzBsQhJXezCIkqe2lCo8goyQ%3D&to=92&size=14507245&sta_dx=14507245&sta_cs=3364&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482221&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14507245&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-a19054dcbee80fc696e3474f56b0d3774ecac5cb572e2a7d8403c2ffae7950f578df45db65e7f53f&sl=76480590&expires=8h&rt=pr&r=293286897&mlogid=7502097466067658602&vbdid=2247232042&fin=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a&bflag=92,34-92&rtype=1&dp-logid=7502097466067658602&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=6271d6a92c89ad8bac002b6151d5e854aae3d1de2046b66f&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a |20          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:44:54.884 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/f0f60b2f3120a31ba31ee49b7ef48b05?bkt=en-038bee77e919b76a52bf15b298797e1df23fbf578db88e256e200918bebcc3e2b81186e9da9a2d66&fid=3757516097-778750-485015434516792&time=1605779092&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-xIrzKiT3U8Xs3vnlAP4VDQl%2FgFs%3D&to=92&size=14507245&sta_dx=14507245&sta_cs=3368&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482221&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14507245&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-a19054dcbee80fc696e3474f56b0d3774ecac5cb572e2a7d8403c2ffae7950f578df45db65e7f53f&sl=76480590&expires=8h&rt=pr&r=435690836&mlogid=7508432981708901214&vbdid=2247232042&fin=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a&bflag=92,34-92&rtype=1&dp-logid=7508432981708901214&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=34c17094e7d5a0c9af5bd8717da619af0dcbeef3d498ab8b&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a', 
revision_id=20 where entity_id=20 
 {executed in 1 msec}
2020-11-19 17:44:54.888 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=20 
 {executed in 1 msec}
2020-11-19 17:44:54.888 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/f0f60b2f3120a31ba31ee49b7ef48b05?bkt=en-038bee77e919b76a52bf15b298797e1df23fbf578db88e256e200918bebcc3e2b81186e9da9a2d66&fid=3757516097-778750-844850042973714&time=1605755491&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-bMlvzBsQhJXezCIkqe2lCo8goyQ%3D&to=92&size=14507245&sta_dx=14507245&sta_cs=3364&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482221&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14507245&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-a19054dcbee80fc696e3474f56b0d3774ecac5cb572e2a7d8403c2ffae7950f578df45db65e7f53f&sl=76480590&expires=8h&rt=pr&r=293286897&mlogid=7502097466067658602&vbdid=2247232042&fin=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a&bflag=92,34-92&rtype=1&dp-logid=7502097466067658602&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=6271d6a92c89ad8bac002b6151d5e854aae3d1de2046b66f&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a |20          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:44:54.891 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/f0f60b2f3120a31ba31ee49b7ef48b05?bkt=en-038bee77e919b76a52bf15b298797e1df23fbf578db88e256e200918bebcc3e2b81186e9da9a2d66&fid=3757516097-778750-485015434516792&time=1605779092&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-xIrzKiT3U8Xs3vnlAP4VDQl%2FgFs%3D&to=92&size=14507245&sta_dx=14507245&sta_cs=3368&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482221&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14507245&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-a19054dcbee80fc696e3474f56b0d3774ecac5cb572e2a7d8403c2ffae7950f578df45db65e7f53f&sl=76480590&expires=8h&rt=pr&r=435690836&mlogid=7508432981708901214&vbdid=2247232042&fin=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a&bflag=92,34-92&rtype=1&dp-logid=7508432981708901214&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=34c17094e7d5a0c9af5bd8717da619af0dcbeef3d498ab8b&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=27%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E8%81%8A%E4%B8%80%E8%81%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5.m4a', 
revision_id=20 where entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.895 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.896 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|20        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     提出点个人的理解吧:记得池老师的专利第一季有篇文章&lt;技术leader是否应该写代码&gt;，其实目前技术经理大概有3成的时间在做Code Review。这块曾经和一些同行聊过：就像老师课中所说的，不做基本上上线可能就挂了。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目前Code Review应当有两张方式吧:
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一种是强行做规则-违反规则就不让上线，提交不通过，这块可以用工具去实现；
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一种就是人为的对比工具和审核，毕竟人写代码的人看不到自己的问题的，除非是公司或者部门这块的把关的，例如：sql代码基本上有DBA审核，DBA自己写的就只能自己反复测，自己挖了坑的话还是要自己填的，这个会做的异常谨慎。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;个人觉得Code Review不仅仅重要，不做code review就是挖地雷;自己亲身经历过几次这种事情，这也是为何陈皓老师在他的专栏会去强调这块。好的code review会减少大量的不确定的坑：这个就像我们日常出门上班会确定门是否关好一样。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;说个案例吧：从大公司到中小公司做DBA；CTO和我说数据库慢你优化一下，通过索引解决了出现的典型问题。生产上线前我说我把代码检查一遍，PM说我们的代码都测过没问题，我坚持检查一下-为此双休日没休息加班检查；周一我就扔出了不少所谓的慢且没问题的coding，CTO直接全部门发飙-先解决问题再上线。虽历史问题无力解决，不过常规问题减少了不少。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;故而觉得不做code review基本山就是背着炸药包前进：什么时候炸了都不知道；只不过这块目前都是技术经理或者公司真正的专业人士在做而已。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/5b/08/3c1e650b.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>丁丁历险记</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    笔记
    <br>争议项
    <br>1 加班累死，代码审查脱慢进度。
    <br>2 代码审查做的事无聊。 （改改注释）
    <br>3 习惯如此。
    <br>
    <br>价值观差距太大时，换团队。
    <br>合适的争论 理越辩越明。
    <br>1 个人提升最好途径。
    <br>2 团队关系建设，扩大双方影响力。
    <br>3 识别设计的缺陷，找到测试不易发现的问题。
    <br>4 设立质量标杆。性格习惯。
    <br>
    <br>
    <br>小技巧
    <br>量小 
    <br>牛人
    <br>高于平均
    <br>新员工严格
    <br>适当委婉
    <br>过两遍。
    <br>
    <br>
    <br>思考题 个人小技巧
    <br>&nbsp;1 直接截图，贴上框架代码（为表达意图，往往删掉异常处理）或其它类似实现代码
    <br>
    <br>&nbsp;&nbsp;2 个人习惯，我对一些违背开发原则的事，是和开发同学不断探讨的，
    <br>简单如 dry 好判断的，一定让开发把实现抽取出来。 
    <br>srp dip 这些往往具体问题具体分析，毕竟不能创个变量就上工厂吧，场景是否适合，克制那颗过度封装的心，改为逐步迭代。
    <br>&nbsp;3 改完后，会引一些文章。（我一般选开发接受并修改后，一是此刻他心态更平和，二是刚折腾完，手热。这时候方便适当展开。
    <br>
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |20          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:44:54.900 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.901 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     提出点个人的理解吧:记得池老师的专利第一季有篇文章&lt;技术leader是否应该写代码&gt;，其实目前技术经理大概有3成的时间在做Code Review。这块曾经和一些同行聊过：就像老师课中所说的，不做基本上上线可能就挂了。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目前Code Review应当有两张方式吧:
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一种是强行做规则-违反规则就不让上线，提交不通过，这块可以用工具去实现；
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一种就是人为的对比工具和审核，毕竟人写代码的人看不到自己的问题的，除非是公司或者部门这块的把关的，例如：sql代码基本上有DBA审核，DBA自己写的就只能自己反复测，自己挖了坑的话还是要自己填的，这个会做的异常谨慎。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;个人觉得Code Review不仅仅重要，不做code review就是挖地雷;自己亲身经历过几次这种事情，这也是为何陈皓老师在他的专栏会去强调这块。好的code review会减少大量的不确定的坑：这个就像我们日常出门上班会确定门是否关好一样。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;说个案例吧：从大公司到中小公司做DBA；CTO和我说数据库慢你优化一下，通过索引解决了出现的典型问题。生产上线前我说我把代码检查一遍，PM说我们的代码都测过没问题，我坚持检查一下-为此双休日没休息加班检查；周一我就扔出了不少所谓的慢且没问题的coding，CTO直接全部门发飙-先解决问题再上线。虽历史问题无力解决，不过常规问题减少了不少。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;故而觉得不做code review基本山就是背着炸药包前进：什么时候炸了都不知道；只不过这块目前都是技术经理或者公司真正的专业人士在做而已。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/5b/08/3c1e650b.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>丁丁历险记</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    笔记
    <br>争议项
    <br>1 加班累死，代码审查脱慢进度。
    <br>2 代码审查做的事无聊。 （改改注释）
    <br>3 习惯如此。
    <br>
    <br>价值观差距太大时，换团队。
    <br>合适的争论 理越辩越明。
    <br>1 个人提升最好途径。
    <br>2 团队关系建设，扩大双方影响力。
    <br>3 识别设计的缺陷，找到测试不易发现的问题。
    <br>4 设立质量标杆。性格习惯。
    <br>
    <br>
    <br>小技巧
    <br>量小 
    <br>牛人
    <br>高于平均
    <br>新员工严格
    <br>适当委婉
    <br>过两遍。
    <br>
    <br>
    <br>思考题 个人小技巧
    <br>&nbsp;1 直接截图，贴上框架代码（为表达意图，往往删掉异常处理）或其它类似实现代码
    <br>
    <br>&nbsp;&nbsp;2 个人习惯，我对一些违背开发原则的事，是和开发同学不断探讨的，
    <br>简单如 dry 好判断的，一定让开发把实现抽取出来。 
    <br>srp dip 这些往往具体问题具体分析，毕竟不能创个变量就上工厂吧，场景是否适合，克制那颗过度封装的心，改为逐步迭代。
    <br>&nbsp;3 改完后，会引一些文章。（我一般选开发接受并修改后，一是此刻他心态更平和，二是刚折腾完，手热。这时候方便适当展开。
    <br>
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |20          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:44:54.905 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.906 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|20        |book   |0     |zh-hans  |20          |https://static001.geekbang.org/resource/image/bb/34/bb9aec2f59604409cf2c447ab9d1f134.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:44:54.909 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.909 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |20          |https://static001.geekbang.org/resource/image/bb/34/bb9aec2f59604409cf2c447ab9d1f134.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:44:54.913 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=20 
 {executed in 0 msec}
2020-11-19 17:44:54.913 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |20          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:54.917 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=20 
 {executed in 1 msec}
2020-11-19 17:44:54.917 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |20          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:44:54.921 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='949542636783946' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:44:54.921 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:45:37.817 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='949542636783946' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:45:37.817 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:45:37.818 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('949542636783946', 1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:45:37.818 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('949542636783946', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:45:37.818 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|33            |
|--------------|

2020-11-19 17:45:37.830 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='949542636783946' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:45:37.830 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:45:38.228 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='949542636783946' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:45:38.228 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:45:38.229 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('949542636783946', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:45:38.229 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('949542636783946', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:45:38.230 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|34            |
|--------------|

2020-11-19 17:45:38.242 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='949542636783946' 
 {executed in 1 msec}
2020-11-19 17:45:38.242 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|21        |book   |0     |949542636783946  |zh-hans  |21          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:45:38.243 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=21 
 {executed in 0 msec}
2020-11-19 17:45:38.243 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|21  |zh-hans  |book |d6ba0515-69e5-4256-9914-7073eb727ccd |21  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:45:38.247 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=21 
 {executed in 1 msec}
2020-11-19 17:45:38.247 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |949542636783946  |zh-hans  |21          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:45:38.250 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=21 
 {executed in 0 msec}
2020-11-19 17:45:38.251 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|21  |1   |3     |0            |1  |19 |21 |0  |0  |19  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:45:38.256 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=21 
 {executed in 2 msec}
2020-11-19 17:45:38.269 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|21        |<div data-slate-editor="true" data-key="1203" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-52e0d071 " data-slate-type="paragraph" data-slate-object="block" data-key="1204">
  <span data-slate-object="text" data-key="1205"><span data-slate-leaf="true" data-offset-key="1205:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-5da297c3 " data-slate-type="paragraph" data-slate-object="block" data-key="1206">
  <span data-slate-object="text" data-key="1207"><span data-slate-leaf="true" data-offset-key="1207:0" data-first-offset="true"><span data-slate-string="true">本章我们已经学习了不少持久化，特别是有关存储的技术。那在实际业务中，复杂的问题是一个接着一个的，面对这些琳琅满目的具体技术，我们该怎样运用自己所掌握的知识，做出合理的选择呢？今天我们就来接触一些典型的系统，看看对于它们来说，该做出怎样的持久化设计和技术选型。我相信我们实际接触的系统也有相当程度的类比性，可以带来应用的参考意义。</span></span></span>
 </div>
 <h2 class="se-8f31d6bd" data-slate-type="heading" data-slate-object="block" data-key="1208"><span data-slate-object="text" data-key="1209"><span data-slate-leaf="true" data-offset-key="1209:0" data-first-offset="true"><span data-slate-string="true">搜索引擎</span></span></span></h2>
 <div class="se-9dfa1127 " data-slate-type="paragraph" data-slate-object="block" data-key="1210">
  <span data-slate-object="text" data-key="1211"><span data-slate-leaf="true" data-offset-key="1211:0" data-first-offset="true"><span data-slate-string="true">小到 BBS 网站的帖子搜索，大到互联网数据搜索引擎，搜索引擎可以说是我们日常接触的几大系统之一。可是，搜索数据的存储该怎么设计呢？</span></span></span>
 </div>
 <div class="se-77377082 " data-slate-type="paragraph" data-slate-object="block" data-key="1212">
  <span data-slate-object="text" data-key="1213"><span data-slate-leaf="true" data-offset-key="1213:0" data-first-offset="true"><span data-slate-string="true">有一些反应迅速的程序员朋友，也许会设想这样的存储结构，利用关系数据库，创建这样一个存储文本（文章）的关系数据库表 ARTICLES：</span></span></span>
 </div>
 <div class="se-45ec6ad7" data-slate-type="image" data-slate-object="block" data-key="1214">
  <img class="se-cb1a1007" src="https://static001.geekbang.org/resource/image/45/04/4568eea6b14c67c379e840b2918ee404.jpg">
 </div>
 <div class="se-60c0a33f " data-slate-type="paragraph" data-slate-object="block" data-key="1215">
  <span data-slate-object="text" data-key="1216"><span data-slate-leaf="true" data-offset-key="1216:0" data-first-offset="true"><span data-slate-string="true">那么，假如现在的搜索关键字是“存储”，我们就可以利用字符串匹配的方式来对 CONTENT 列进行匹配查询：</span></span></span>
 </div>
 <div class="se-aa180433 se-1676b1e4" data-slate-type="pre" data-slate-object="block" data-key="1217" data-code-language="sql">
  <div class="se-eb65ed62 se-bbe16f6a">
   <span></span>
  </div>
  <div class="se-c63b3623">
   <div class="se-ea27c756 se-782f781d" data-code-line-number="1"></div>
  </div>
  <div class="se-57bd0d92 ps ps--active-x">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1218">
    <span data-slate-object="text" data-key="1219"><span data-slate-leaf="true" data-offset-key="1219:0" data-first-offset="true"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8383620888" data-annotation-type="annotation"><span data-slate-string="true">select</span></span></span><span data-slate-leaf="true" data-offset-key="1219:1"><span data-slate-string="true"> * </span></span><span data-slate-leaf="true" data-offset-key="1219:2"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_6627615917" data-annotation-type="annotation"><span data-slate-string="true">from</span></span></span><span data-slate-leaf="true" data-offset-key="1219:3"><span data-slate-string="true"> ARTICLES </span></span><span data-slate-leaf="true" data-offset-key="1219:4"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_4550830848" data-annotation-type="annotation"><span data-slate-string="true">where</span></span></span><span data-slate-leaf="true" data-offset-key="1219:5"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:6"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_5965950239" data-annotation-type="annotation"><span data-slate-string="true">CONTENT</span></span></span><span data-slate-leaf="true" data-offset-key="1219:7"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:8"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_5317078084" data-annotation-type="annotation"><span data-slate-string="true">like</span></span></span><span data-slate-leaf="true" data-offset-key="1219:9"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:10"><span class=" gkhl-string" data-slate-object="annotation" data-annotation-key="gkann_8390786565" data-annotation-type="annotation"><span data-slate-string="true">'% 存储 %'</span></span></span><span data-slate-leaf="true" data-offset-key="1219:11"><span data-slate-string="true">;</span></span></span>
   </div>
   <div class="ps__rail-x" style="width: 365px; left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 326px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-a9ae5959 " data-slate-type="paragraph" data-slate-object="block" data-key="1220">
  <span data-slate-object="text" data-key="1221"><span data-slate-leaf="true" data-offset-key="1221:0" data-first-offset="true"><span data-slate-string="true">这很容易就实现了搜索功能。但是，这样的方式有着明显的问题，即使用 % 来进行字符串匹配是非常低效的，因此这样的查询需要遍历整个表（全表扫描）。几篇、几十篇文章的时候，还不是什么问题，但是如果有几十万、几百万的文章，这种方式是完全不可行的。且不说单独的关系数据库表就不能容纳那么大的数据了，就是能够容纳，要扫描一遍，这里的时间代价是难以想象的，就算我们的系统愿意做，用户可都不愿意等啊。</span></span></span>
 </div>
 <div class="se-7abca630 " data-slate-type="paragraph" data-slate-object="block" data-key="1222">
  <span data-slate-object="text" data-key="1223"><span data-slate-leaf="true" data-offset-key="1223:0" data-first-offset="true"><span data-slate-string="true">于是，我们就要引入</span></span></span><span data-slate-object="text" data-key="1224"><span data-slate-leaf="true" data-offset-key="1224:0" data-first-offset="true"><span class="se-3a73ed2a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">“倒排索引”（Inverted Index）</span></span></span></span><span data-slate-object="text" data-key="1225"><span data-slate-leaf="true" data-offset-key="1225:0" data-first-offset="true"><span data-slate-string="true">的技术了。在前面所述的场景下，我们可以把这个概念拆分为两个部分来解释：</span></span></span>
 </div>
 <div class="se-b6f648e1" data-slate-type="list" data-slate-object="block" data-key="1226">
  <div class="se-b5bbb40b se-19f0ce4c" data-slate-type="list-line" data-slate-object="block" data-key="1227">
   <span data-slate-object="text" data-key="1228"><span data-slate-leaf="true" data-offset-key="1228:0" data-first-offset="true"><span data-slate-string="true">“倒排”，指的是存储的结构不再是先定位到文章，再去文章的内容中找寻关键字了；而是反过来，先定位到关键字，再去看关键字属于哪些文章。</span></span></span>
  </div>
  <div class="se-a754c520 se-99a4f6de" data-slate-type="list-line" data-slate-object="block" data-key="1229">
   <span data-slate-object="text" data-key="1230"><span data-slate-leaf="true" data-offset-key="1230:0" data-first-offset="true"><span data-slate-string="true">“索引”，指的是关键字，是被索引起来的，因此查询的速度会比较快。</span></span></span>
  </div>
 </div>
 <div class="se-bcf701e5 " data-slate-type="paragraph" data-slate-object="block" data-key="1231">
  <span data-slate-object="text" data-key="1232"><span data-slate-leaf="true" data-offset-key="1232:0" data-first-offset="true"><span data-slate-string="true">好，那上面的 ARTICLES 表依然存在，但现在需要添加一个关键字表 KEYWORDS，并且，KEYWORD 列需要添加索引，因此这条关键字的记录可以被迅速找到：</span></span></span>
 </div>
 <div class="se-8bdc0855" data-slate-type="image" data-slate-object="block" data-key="1233">
  <img class="se-6c13fd39" src="https://static001.geekbang.org/resource/image/c9/11/c9868489ed7415cdad3f760e0ea5d411.jpg">
 </div>
 <div class="se-c147cc5f " data-slate-type="paragraph" data-slate-object="block" data-key="1234">
  <span data-slate-object="text" data-key="1235"><span data-slate-leaf="true" data-offset-key="1235:0" data-first-offset="true"><span data-slate-string="true">当然，我们还需要一个关联关系表把 KEYWORDS 表和 ARTICLES 表结合起来，KEYWORD_ID 和 ARTICLE_ID 作为联合主键：</span></span></span>
 </div>
 <div class="se-2bb60fa5" data-slate-type="image" data-slate-object="block" data-key="1236">
  <img class="se-5ea40cbd" src="https://static001.geekbang.org/resource/image/ba/9b/ba5a26f2d882314e7d0d1f60c23d979b.jpg">
 </div>
 <div class="se-9319a8c3 " data-slate-type="paragraph" data-slate-object="block" data-key="1237">
  <span data-slate-object="text" data-key="1238"><span data-slate-leaf="true" data-offset-key="1238:0" data-first-offset="true"><span data-slate-string="true">你看，这其实是一个多对多的关系，即同一个关键字可以出现在多篇文章中，而一篇文章可以包含多个不同的关键字。这样，我们可以先根据被索引了的关键字，从 KEYWARDS 表中找到相应的 KEYWORD_ID，进而根据它在上面的关联关系表找到 ARTICLE_ID，再根据它去 ARTICLES 表中找到对应的文章。</span></span></span>
 </div>
 <div class="se-4b982a60 " data-slate-type="paragraph" data-slate-object="block" data-key="1239">
  <span data-slate-object="text" data-key="1240"><span data-slate-leaf="true" data-offset-key="1240:0" data-first-offset="true"><span data-slate-string="true">这看起来是三次查找，但是因为每次都走索引，就免去了全表扫描，在数据量较小的时候速度并不慢，并且，在使用 SQL 实现的时候，这个过程完全可以放到一个 SQL 语句中。在数据量较小的时候，上面的方法已经足够好用了。</span></span></span>
 </div>
 <div class="se-48a44247 " data-slate-type="paragraph" data-slate-object="block" data-key="1241">
  <span data-slate-object="text" data-key="1242"><span data-slate-leaf="true" data-offset-key="1242:0" data-first-offset="true"><span data-slate-string="true">但是，这个方法只解决了全表扫描和字符串 % 匹配查询造成的性能问题，并且，在数据量较大时，并没有解决数据量本身在单机模式下造成的性能问题。</span></span></span>
 </div>
 <div class="se-103de2b9 " data-slate-type="paragraph" data-slate-object="block" data-key="1243">
  <span data-slate-object="text" data-key="1244"><span data-slate-leaf="true" data-offset-key="1244:0" data-first-offset="true"><span data-slate-string="true">于是，我们可以考虑搭建和使用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1245" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1246"><span data-slate-leaf="true" data-offset-key="1246:0" data-first-offset="true"><span data-slate-string="true">Elasticsearch</span></span></span></a><span data-slate-object="text" data-key="1247"><span data-slate-leaf="true" data-offset-key="1247:0" data-first-offset="true"><span data-slate-string="true">，或者干脆使用云上的版本。Elasticsearch 将关键字使用哈希算法分散到多个不同的被称为“Shard”的虚拟节点，并且把它们部署到不同的机器节点上，且每一个 shard 具备指定数量的冗余副本（Replica），这些副本要求被放置到不同的物理机器节点上。通过这样的方式，我们就可以保证每台机器都只管理稳定且可控的数据量，并且保证了搜索服务数据的可用性。</span></span></span>
 </div>
 <div class="se-5195f29f" data-slate-type="image" data-slate-object="block" data-key="1248">
  <img class="se-cd873cd2" src="https://static001.geekbang.org/resource/image/8c/09/8c4e956ca12bccc88ea9fd5d8f461a09.jpg">
 </div>
 <div class="se-9cdf3fd8 " data-slate-type="paragraph" data-slate-object="block" data-key="1249">
  <span data-slate-object="text" data-key="1250"><span data-slate-leaf="true" data-offset-key="1250:0" data-first-offset="true"><span data-slate-string="true">对于每一个关键字，都可以配置指向文章和文章中位置的映射。比如有这样两篇文章：</span></span></span>
 </div>
 <div class="se-1c5eab38" data-slate-type="block-quote" data-slate-object="block" data-key="1251">
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="1252">
   <span data-slate-object="text" data-key="1253"><span data-slate-leaf="true" data-offset-key="1253:0" data-first-offset="true"><span data-slate-string="true">文章 1 的正文是：今天介绍存储技术。</span></span></span>
  </div>
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="1254">
   <span data-slate-object="text" data-key="1255"><span data-slate-leaf="true" data-offset-key="1255:0" data-first-offset="true"><span data-slate-string="true">文章 2 的正文是：存储技术有多种分类。</span></span></span>
  </div>
 </div>
 <div class="se-9b2927f0 " data-slate-type="paragraph" data-slate-object="block" data-key="1256">
  <span data-slate-object="text" data-key="1257"><span data-slate-leaf="true" data-offset-key="1257:0" data-first-offset="true"><span data-slate-string="true">那么，就有如下映射关系（下表仅用于表示在 Shard 中的数据映射，并非关系数据库表）：</span></span></span>
 </div>
 <div class="se-c127bc8b" data-slate-type="image" data-slate-object="block" data-key="1258">
  <img class="se-3e7825f1" src="https://static001.geekbang.org/resource/image/77/68/779702fd2a29ff418711928789bd3b68.jpg">
 </div>
 <div class="se-e3ff29ac " data-slate-type="paragraph" data-slate-object="block" data-key="1259">
  <span data-slate-object="text" data-key="1260"><span data-slate-leaf="true" data-offset-key="1260:0" data-first-offset="true"><span data-slate-string="true">你看，DOCUMENT 这一部分，每一行都可以存放若干个“文章 id : 文中关键字的位置”的组合。</span></span></span>
 </div>
 <h2 class="se-b3a2a24f" data-slate-type="heading" data-slate-object="block" data-key="1261"><span data-slate-object="text" data-key="1262"><span data-slate-leaf="true" data-offset-key="1262:0" data-first-offset="true"><span data-slate-string="true">地理信息系统</span></span></span></h2>
 <div class="se-5dd44887 " data-slate-type="paragraph" data-slate-object="block" data-key="1263">
  <span data-slate-object="text" data-key="1264"><span data-slate-leaf="true" data-offset-key="1264:0" data-first-offset="true"><span data-slate-string="true">有这样一款订餐软件，上面有这样一个功能，在地图上可以列出距离当前用户最近的签约饭馆，并且随着用户缩放地图，还可以控制这个距离的大小。每个饭馆的位置可以简单考虑为经度和纬度组合的坐标（下图来自 Google 地图，仅示意用）。</span></span></span>
 </div>
 <div class="se-49eddde1" data-slate-type="image" data-slate-object="block" data-key="1265">
  <img class="se-5c9ab7e5" src="https://static001.geekbang.org/resource/image/50/9a/500b7bc8394a1b63c7fb89ee4c18cb9a.jpg">
 </div>
 <div class="se-3d802770 " data-slate-type="paragraph" data-slate-object="block" data-key="1266">
  <span data-slate-object="text" data-key="1267"><span data-slate-leaf="true" data-offset-key="1267:0" data-first-offset="true"><span data-slate-string="true">简言之，这个功能就是“显示一定范围内的目标集合”，可它该怎样实现呢？</span></span></span>
 </div>
 <div class="se-cda00e26 " data-slate-type="paragraph" data-slate-object="block" data-key="1268">
  <span data-slate-object="text" data-key="1269"><span data-slate-leaf="true" data-offset-key="1269:0" data-first-offset="true"><span data-slate-string="true">在考虑这个功能以前，我们可以类比地想一想，它其实是一个相当常见且通用的功能，常常应用于订餐、导航软件、旅游网站等等这类 LBS（Location-Based Service，基于位置的服务）应用中，因此这个问题是具有一定典型意义的。</span></span></span>
 </div>
 <div class="se-add40cf8 " data-slate-type="paragraph" data-slate-object="block" data-key="1270">
  <span data-slate-object="text" data-key="1271"><span data-slate-leaf="true" data-offset-key="1271:0" data-first-offset="true"><span data-slate-string="true">这个背后的数据结构以及存储又是怎样的呢？我们顺着这个“经纬度”的思路往下想，那么，如果就把这样的地理信息，放到一张 LOCATIONS 表上，就会是这样：</span></span></span>
 </div>
 <div class="se-9d899f83" data-slate-type="image" data-slate-object="block" data-key="1272">
  <img class="se-2e0b3f72" src="https://static001.geekbang.org/resource/image/bb/43/bb027beec790f8ee207b051b4a5ca943.jpg">
 </div>
 <div class="se-aa18af61 " data-slate-type="paragraph" data-slate-object="block" data-key="1273">
  <span data-slate-object="text" data-key="1274"><span data-slate-leaf="true" data-offset-key="1274:0" data-first-offset="true"><span data-slate-string="true">当然了，还有一张 RESTAURANTS 表：</span></span></span>
 </div>
 <div class="se-c3390074" data-slate-type="image" data-slate-object="block" data-key="1275">
  <img class="se-f588c18e" src="https://static001.geekbang.org/resource/image/ba/02/bafddb5244287066ec676b6c30054c02.jpg">
 </div>
 <div class="se-ff260739 " data-slate-type="paragraph" data-slate-object="block" data-key="1276">
  <span data-slate-object="text" data-key="1277"><span data-slate-leaf="true" data-offset-key="1277:0" data-first-offset="true"><span data-slate-string="true">于是，要查出范围内的饭馆，我们就可以写这样的 SQL：</span></span></span>
 </div>
 <div class="se-12ad3a34 se-c5b873b5" data-slate-type="pre" data-slate-object="block" data-key="1278" data-code-language="sql">
  <div class="se-64f59a01 se-c97d7e52">
   <span></span>
  </div>
  <div class="se-149a68ea">
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="1"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="2"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="3"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="4"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="5"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="6"></div>
  </div>
  <div class="se-2dba92b4 ps">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1279">
    <span data-slate-object="text" data-key="1280"><span data-slate-leaf="true" data-offset-key="1280:0" data-first-offset="true"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_9182086135" data-annotation-type="annotation"><span data-slate-string="true">select</span></span></span><span data-slate-leaf="true" data-offset-key="1280:1"><span data-slate-string="true"> * </span></span><span data-slate-leaf="true" data-offset-key="1280:2"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_9950164498" data-annotation-type="annotation"><span data-slate-string="true">from</span></span></span><span data-slate-leaf="true" data-offset-key="1280:3"><span data-slate-string="true"> LOCATIONS l, RESTAURANTS r </span></span><span data-slate-leaf="true" data-offset-key="1280:4"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_6578944204" data-annotation-type="annotation"><span data-slate-string="true">where</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1281">
    <span data-slate-object="text" data-key="1282"><span data-slate-leaf="true" data-offset-key="1282:0" data-first-offset="true"><span data-slate-string="true"> l.RESTAURANT_ID = r.RESTAURANT_ID </span></span><span data-slate-leaf="true" data-offset-key="1282:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8006659042" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1283">
    <span data-slate-object="text" data-key="1284"><span data-slate-leaf="true" data-offset-key="1284:0" data-first-offset="true"><span data-slate-string="true"> l.LONGITUDE &gt;= 经度下界 </span></span><span data-slate-leaf="true" data-offset-key="1284:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_1539765598" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1285">
    <span data-slate-object="text" data-key="1286"><span data-slate-leaf="true" data-offset-key="1286:0" data-first-offset="true"><span data-slate-string="true"> l.LONGITUDE &lt;= 经度上界 </span></span><span data-slate-leaf="true" data-offset-key="1286:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8496362576" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1287">
    <span data-slate-object="text" data-key="1288"><span data-slate-leaf="true" data-offset-key="1288:0" data-first-offset="true"><span data-slate-string="true"> l.LATITUDE &gt;= 纬度下界 </span></span><span data-slate-leaf="true" data-offset-key="1288:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_1730678695" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1289">
    <span data-slate-object="text" data-key="1290"><span data-slate-leaf="true" data-offset-key="1290:0" data-first-offset="true"><span data-slate-string="true"> l.LATITUDE &lt;= 纬度上界 ;</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-443d2ad4 " data-slate-type="paragraph" data-slate-object="block" data-key="1291">
  <span data-slate-object="text" data-key="1292"><span data-slate-leaf="true" data-offset-key="1292:0" data-first-offset="true"><span data-slate-string="true">其中，这个经度、纬度的上下界，是根据用户所在位置，以及地图缩放程度折算出来的。显然，这需要一个全表扫描，加一个笛卡尔积，复杂度偏高，能否优化一下它呢？在往下阅读前，你可以先想一想。</span></span></span>
 </div>
 <div class="se-09fbb4ec " data-slate-type="paragraph" data-slate-object="block" data-key="1293">
  <span data-slate-object="text" data-key="1294"><span data-slate-leaf="true" data-offset-key="1294:0" data-first-offset="true"><span class="se-419117bb" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">思路 1：给单一维度加索引</span></span></span></span>
 </div>
 <div class="se-08753f00 " data-slate-type="paragraph" data-slate-object="block" data-key="1295">
  <span data-slate-object="text" data-key="1296"><span data-slate-leaf="true" data-offset-key="1296:0" data-first-offset="true"><span data-slate-string="true">嗯，如果经纬度可以分开处理，是不是就可以搞定？比方说，只考虑经度的话，给经度一列建立索引，所有饭馆按照从小到大的顺序排好。这样的话，当给定范围的时候，我们就可以快速找到经度范围内所有满足经度条件的饭馆。从时间复杂度的角度来考虑，在不做额外优化的情况下，以在有序经度列上的二分查找为例，这个复杂度是 log(n)。</span></span></span>
 </div>
 <div class="se-998a42ef " data-slate-type="paragraph" data-slate-object="block" data-key="1297">
  <span data-slate-object="text" data-key="1298"><span data-slate-leaf="true" data-offset-key="1298:0" data-first-offset="true"><span data-slate-string="true">当再考虑纬度的时候，假如有 m 家满足经度条件的饭馆，接下去我们就只能挨个去检查这 m 家饭馆，找出它们中满足纬度条件的了，也就是说，总的时间复杂度是 m*log(n)。这种方法比较简单，在数据量不太大的情况下也没有太大问题，因此这已经是很好的方法了。但是，在某些场景下这个 m 还有可能比较大，那么，有进一步优化的办法吗？</span></span></span>
 </div>
 <div class="se-21662fd6 " data-slate-type="paragraph" data-slate-object="block" data-key="1299">
  <span data-slate-object="text" data-key="1300"><span data-slate-leaf="true" data-offset-key="1300:0" data-first-offset="true"><span class="se-dc0dd7c8" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">思路 2：GeoHash</span></span></span></span>
 </div>
 <div class="se-f2f592b1 " data-slate-type="paragraph" data-slate-object="block" data-key="1301">
  <span data-slate-object="text" data-key="1302"><span data-slate-leaf="true" data-offset-key="1302:0" data-first-offset="true"><span data-slate-string="true">其实，经度和纬度的大致思路可以，但是在框选饭馆的时候，不能把经度和纬度分别框选，而应该结合起来框选，并且把复杂度依然控制在 log(n) 的级别。</span></span></span>
 </div>
 <div class="se-8fec5785 " data-slate-type="paragraph" data-slate-object="block" data-key="1303">
  <span data-slate-object="text" data-key="1304"><span data-slate-leaf="true" data-offset-key="1304:0" data-first-offset="true"><span data-slate-string="true">其中一个办法就是 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1305" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1306"><span data-slate-leaf="true" data-offset-key="1306:0" data-first-offset="true"><span data-slate-string="true">GeoHash</span></span></span></a><span data-slate-object="text" data-key="1307"><span data-slate-leaf="true" data-offset-key="1307:0" data-first-offset="true"><span data-slate-string="true">，它的大致思路就是降维。即把一个经度和纬度的二维坐标用一个一维的数来表示。具体实现上，有一种常见的办法就是把经度和纬度用一个长位数的数来表示，比如：</span></span></span>
 </div>
 <div class="se-0b76b89e se-69479d11" data-slate-type="pre" data-slate-object="block" data-key="1308">
  <div class="se-938d8933 se-34705256">
   <span></span>
  </div>
  <div class="se-b3e75833">
   <div class="se-c74c99dd se-2e1661fb" data-code-line-number="1"></div>
   <div class="se-c74c99dd se-2e1661fb" data-code-line-number="2"></div>
  </div>
  <div class="se-91ab267e ps">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1309">
    <span data-slate-object="text" data-key="1310"><span data-slate-leaf="true" data-offset-key="1310:0" data-first-offset="true"><span data-slate-string="true">经度：101010……</span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1311">
    <span data-slate-object="text" data-key="1312"><span data-slate-leaf="true" data-offset-key="1312:0" data-first-offset="true"><span data-slate-string="true">纬度：100110……</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-e691db67 " data-slate-type="paragraph" data-slate-object="block" data-key="1313">
  <span data-slate-object="text" data-key="1314"><span data-slate-leaf="true" data-offset-key="1314:0" data-first-offset="true"><span data-slate-string="true">接着把二者从左到右挨个位拼接，黑色字符来自经度，蓝色字符来自纬度：</span></span></span>
 </div>
 <div class="se-7a1eefab" data-slate-type="image" data-slate-object="block" data-key="1315">
  <img class="se-6ad67326" src="https://static001.geekbang.org/resource/image/11/af/1142aa596e19561794080a5896667aaf.jpg">
 </div>
 <div class="se-2ba5c56a " data-slate-type="paragraph" data-slate-object="block" data-key="1316">
  <span data-slate-object="text" data-key="1317"><span data-slate-leaf="true" data-offset-key="1317:0" data-first-offset="true"><span data-slate-string="true">在这种方式下，从结果的左边最高位开始，取任意长度截断所得到的前缀，可以用来匹配距离目标位置一定距离范围的所有饭馆。当用户选取的地图范围越大，前缀长度就越长，这个匹配精度也就越高，匹配到的饭馆数量也就越少。通过这种方式，区域不断用前缀的方式来细分，相当于给每个子区域一个标记号码。</span></span></span>
 </div>
 <div class="se-dc2940df " data-slate-type="paragraph" data-slate-object="block" data-key="1318">
  <span data-slate-object="text" data-key="1319"><span data-slate-leaf="true" data-offset-key="1319:0" data-first-offset="true"><span data-slate-string="true">那么，我们数据库表中的经度和纬度就可以合并为一列，再令这一列为主键，或者做索引，就能够进行单列的范围查询了。</span></span></span>
 </div>
 <div class="se-09c23d09" data-slate-type="image" data-slate-object="block" data-key="1320">
  <img class="se-a5587edb" src="https://static001.geekbang.org/resource/image/a7/fa/a703d1d17e273fcc4d1150e9105071fa.jpg">
 </div>
 <div class="se-212284de " data-slate-type="paragraph" data-slate-object="block" data-key="1321">
  <span data-slate-object="text" data-key="1322"><span data-slate-leaf="true" data-offset-key="1322:0" data-first-offset="true"><span data-slate-string="true">最后，我们已经走到这一步了，接下来该怎么把这个表落实到数据库中呢？这就有多种方式可供选择了。比如我们可以使用关系数据库（例如 MySQL），也可以使用 NoSQL 中的键值数据库（例如 Redis 等）。这方面可以根据其它业务需求，以及实际开发的限制来选择，具体选择的策略，请继续阅读下文。</span></span></span>
 </div>
 <h2 class="se-5aaa4c5e" data-slate-type="heading" data-slate-object="block" data-key="1323"><span data-slate-object="text" data-key="1324"><span data-slate-leaf="true" data-offset-key="1324:0" data-first-offset="true"><span data-slate-string="true">SQL or NoSQL？</span></span></span></h2>
 <div class="se-11e1519b " data-slate-type="paragraph" data-slate-object="block" data-key="1325">
  <span data-slate-object="text" data-key="1326"><span data-slate-leaf="true" data-offset-key="1326:0" data-first-offset="true"><span data-slate-string="true">我们在实际的存储系统选择时，经常会涉及到 SQL 数据库和 NoSQL 数据库的选择，也就是关系数据库和非关系数据库的选择。举个例子，如果是电子商务网站（这可能是我们平时听到的最多的例子之一了），应该选择 SQL 还是 NoSQL？</span></span></span>
 </div>
 <h3 class="se-b4c94c19" data-slate-type="heading" data-slate-object="block" data-key="1327"><span data-slate-object="text" data-key="1328"><span data-slate-leaf="true" data-offset-key="1328:0" data-first-offset="true"><span data-slate-string="true">两个前提角度</span></span></span></h3>
 <div class="se-9600f53a " data-slate-type="paragraph" data-slate-object="block" data-key="1329">
  <span data-slate-object="text" data-key="1330"><span data-slate-leaf="true" data-offset-key="1330:0" data-first-offset="true"><span data-slate-string="true">设计和选型方面，有很多问题都不是黑白分明的，而是要拆分开来一块一块分析。我听到过很多“一刀切”的答案，比如有的人说用 MySQL，有的说用 Redis，我认为这样的结论都是不妥的。那么怎样来选择呢？下面我就来介绍一些 SQL 和 NoSQL 选择的原则。但是在讲原则以前，我觉得需要从两个“前提角度”去厘清我们的问题。</span></span></span>
 </div>
 <div class="se-dd3fb78d " data-slate-type="paragraph" data-slate-object="block" data-key="1331">
  <span data-slate-object="text" data-key="1332"><span data-slate-leaf="true" data-offset-key="1332:0" data-first-offset="true"><span data-slate-string="true">以电商网站的设计为例，这两个角度就是这样的。</span></span></span>
 </div>
 <div class="se-bd59005a " data-slate-type="paragraph" data-slate-object="block" data-key="1333">
  <span data-slate-object="text" data-key="1334"><span data-slate-leaf="true" data-offset-key="1334:0" data-first-offset="true"><span class="se-21027aac" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 数据分类</span></span></span></span>
 </div>
 <div class="se-829a4bbd " data-slate-type="paragraph" data-slate-object="block" data-key="1335">
  <span data-slate-object="text" data-key="1336"><span data-slate-leaf="true" data-offset-key="1336:0" data-first-offset="true"><span data-slate-string="true">电子商务网站，这个概念所意味着的数据类型太多了。简单举几个例子：</span></span></span>
 </div>
 <div class="se-bdfb8392" data-slate-type="list" data-slate-object="block" data-key="1337">
  <div class="se-dd6c1d8d se-f9852c91" data-slate-type="list-line" data-slate-object="block" data-key="1338">
   <span data-slate-object="text" data-key="1339"><span data-slate-leaf="true" data-offset-key="1339:0" data-first-offset="true"><span data-slate-string="true">商品元数据，即商品的描述、厂家等等信息；</span></span></span>
  </div>
  <div class="se-de6b1014 se-648a146a" data-slate-type="list-line" data-slate-object="block" data-key="1340">
   <span data-slate-object="text" data-key="1341"><span data-slate-leaf="true" data-offset-key="1341:0" data-first-offset="true"><span data-slate-string="true">媒体数据，比如图片和视频；</span></span></span>
  </div>
  <div class="se-6d656e05 se-2928e737" data-slate-type="list-line" data-slate-object="block" data-key="1342">
   <span data-slate-object="text" data-key="1343"><span data-slate-leaf="true" data-offset-key="1343:0" data-first-offset="true"><span data-slate-string="true">库存数据，包括在某个地点的库房某商品还有多少件库存；</span></span></span>
  </div>
  <div class="se-2461622e se-c88a9c2f" data-slate-type="list-line" data-slate-object="block" data-key="1344">
   <span data-slate-object="text" data-key="1345"><span data-slate-leaf="true" data-offset-key="1345:0" data-first-offset="true"><span data-slate-string="true">交易信息，比如订单、支付、余额管理；</span></span></span>
  </div>
  <div class="se-8b504dc5 se-3136e84d" data-slate-type="list-line" data-slate-object="block" data-key="1346">
   <span data-slate-object="text" data-key="1347"><span data-slate-leaf="true" data-offset-key="1347:0" data-first-offset="true"><span data-slate-string="true">用户信息，涉及的功能包括登陆、注册和用户设置。</span></span></span>
  </div>
 </div>
 <div class="se-4dafeebc " data-slate-type="paragraph" data-slate-object="block" data-key="1348">
  <span data-slate-object="text" data-key="1349"><span data-slate-leaf="true" data-offset-key="1349:0" data-first-offset="true"><span data-slate-string="true">因此，在讨论什么存储适合数据和访问的时候，我们最好明确，到底具体是哪一种类型的数据。毕竟，看起来上面的业务场景将有着巨大差别。</span></span></span>
 </div>
 <div class="se-6512e940 " data-slate-type="paragraph" data-slate-object="block" data-key="1350">
  <span data-slate-object="text" data-key="1351"><span data-slate-leaf="true" data-offset-key="1351:0" data-first-offset="true"><span class="se-aae2a506" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 数据规模</span></span></span></span>
 </div>
 <div class="se-61e78ea8 " data-slate-type="paragraph" data-slate-object="block" data-key="1352">
  <span data-slate-object="text" data-key="1353"><span data-slate-leaf="true" data-offset-key="1353:0" data-first-offset="true"><span data-slate-string="true">电子商务网站有大有小，可别一想到电商网站，脑海里就是淘宝和京东，商品可以上千万，甚至上亿。但其实，我们大多数接触的系统，都不会有那么大的规模，电商网站完全可以小到一个提供在线购物业务的私人体育用品专营店，商品数量可以只有几十到几百。</span></span></span>
 </div>
 <div class="se-a2e7206c " data-slate-type="paragraph" data-slate-object="block" data-key="1354">
  <span data-slate-object="text" data-key="1355"><span data-slate-leaf="true" data-offset-key="1355:0" data-first-offset="true"><span data-slate-string="true">只有把问题做如上的展开并明确以后，我们再去思考和讨论数据结构、一致性、可用性等等这些我们“熟悉”的方面，才准确。因此，从上面的例子来看，</span></span></span><span data-slate-object="text" data-key="1356"><span data-slate-leaf="true" data-offset-key="1356:0" data-first-offset="true"><span class="se-4dbc55ea" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我们在选择技术的时候，很可能要针对每一类数据选择“一组”技术，而不是笼统地选择“一项”技术了。</span></span></span></span>
 </div>
 <h3 class="se-f89eede4" data-slate-type="heading" data-slate-object="block" data-key="1357"><span data-slate-object="text" data-key="1358"><span data-slate-leaf="true" data-offset-key="1358:0" data-first-offset="true"><span data-slate-string="true">选择的思路</span></span></span></h3>
 <div class="se-bdd2adc7 " data-slate-type="paragraph" data-slate-object="block" data-key="1359">
  <span data-slate-object="text" data-key="1360"><span data-slate-leaf="true" data-offset-key="1360:0" data-first-offset="true"><span data-slate-string="true">那么下一步，我们该怎样来选择 SQL 或是 NoSQL 数据库呢？这部分可以说，不同的人有着颇为不同的看法。下面我想根据我的认识，谈谈一个大致的选择思路，请注意这只是一个粗略的基于经验的分类，具体的技术选择还要具体问题具体分析和细化。</span></span></span>
 </div>
 <div class="se-572447cc " data-slate-type="paragraph" data-slate-object="block" data-key="1361">
  <span data-slate-object="text" data-key="1362"><span data-slate-leaf="true" data-offset-key="1362:0" data-first-offset="true"><span class="se-e087d359" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 对于中小型系统，在数据量不大且没有特殊的吞吐量、可用性等要求的情况下，或者在多种关系和非关系数据库都满足业务要求的情况下，优先考虑关系数据库。</span></span></span></span>
 </div>
 <div class="se-ff3acd25 " data-slate-type="paragraph" data-slate-object="block" data-key="1363">
  <span data-slate-object="text" data-key="1364"><span data-slate-leaf="true" data-offset-key="1364:0" data-first-offset="true"><span data-slate-string="true">关系数据库提供了成熟且强大的功能，包括强 schema 定义、关系查询、事务支持等等。关系数据库能够带来较强的扩展能力，未来在业务发展的时候，通过增加索引、增加表、增加列、增加关系查询，就可以迅速解决问题。</span></span></span>
 </div>
 <div class="se-e50f571c " data-slate-type="paragraph" data-slate-object="block" data-key="1365">
  <span data-slate-object="text" data-key="1366"><span data-slate-leaf="true" data-offset-key="1366:0" data-first-offset="true"><span data-slate-string="true">在从内存模型到实际存储数据的 ORM 转换的时候，有非常成熟的且支持程度各异的框架，有的把 ORM 完全自动化，让程序员可以关注在核心业务模型上面；有的则是把 ORM 定义让出来，提供足够的灵活性（这部分可以参见 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1367" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1368"><span data-slate-leaf="true" data-offset-key="1368:0" data-first-offset="true"><span data-slate-string="true">[第 12 讲]</span></span></span></a><span data-slate-object="text" data-key="1369"><span data-slate-leaf="true" data-offset-key="1369:0" data-first-offset="true"><span data-slate-string="true"> 的加餐部分）。</span></span></span>
 </div>
 <div class="se-6dbf9d3f " data-slate-type="paragraph" data-slate-object="block" data-key="1370">
  <span data-slate-object="text" data-key="1371"><span data-slate-leaf="true" data-offset-key="1371:0" data-first-offset="true"><span data-slate-string="true">值得注意的是，</span></span></span><span data-slate-object="text" data-key="1372"><span data-slate-leaf="true" data-offset-key="1372:0" data-first-offset="true"><span class="se-1b4ceec3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">不要觉得 NoSQL 是大数据量的一个必然选择。</span></span></span></span><span data-slate-object="text" data-key="1373"><span data-slate-leaf="true" data-offset-key="1373:0" data-first-offset="true"><span data-slate-string="true">事实上，即便数据量增大，关系数据库有时也依然是一个选择。当然需要明确的是，通常单表在数据量增大时，会产生性能方面的问题，但是可以使用 Sharding 和 Partitioning 技术来缓和（扩展阅读中有这方面技术的介绍）；而数据可用性的问题，也可以使用集群加冗余技术来解决，当然，有得必有失，这种情况下，通常会牺牲一定程度的一致性。</span></span></span>
 </div>
 <div class="se-e24adf9c " data-slate-type="paragraph" data-slate-object="block" data-key="1374">
  <span data-slate-object="text" data-key="1375"><span data-slate-leaf="true" data-offset-key="1375:0" data-first-offset="true"><span data-slate-string="true">那么，这个数据量多大算大到关系数据库无法承担了呢？我可以给你一个事实，即微博和 Twitter 都是使用 MySQL 作为主要推文存储的（你可以参看扩展阅读中的文章），因此你可以看到在实际应用中，关系数据库对于特大数据量的支持也是有成功实践的。</span></span></span>
 </div>
 <div class="se-07301092 " data-slate-type="paragraph" data-slate-object="block" data-key="1376">
  <span data-slate-object="text" data-key="1377"><span data-slate-leaf="true" data-offset-key="1377:0" data-first-offset="true"><span class="se-45e04d74" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 是否具备明确的 schema 定义，是否需要支持关系查询和事务？如果有一项回答“是”，优先考虑关系数据库。</span></span></span></span>
 </div>
 <div class="se-3e96d933 " data-slate-type="paragraph" data-slate-object="block" data-key="1378">
  <span data-slate-object="text" data-key="1379"><span data-slate-leaf="true" data-offset-key="1379:0" data-first-offset="true"><span data-slate-string="true">关系数据库，首当其冲的特点就是“关系”。因此，可能会有朋友说，不对，电商网站的“商品”其实 schema 是不确定的啊——例如，服装一类商品，都有“尺寸”信息；而电器类呢，都有“功率”信息，这样特定类型的属性决定了商品很难被抽象成某一个统一的表啊。</span></span></span>
 </div>
 <div class="se-b1d0a958 " data-slate-type="paragraph" data-slate-object="block" data-key="1380">
  <span data-slate-object="text" data-key="1381"><span data-slate-leaf="true" data-offset-key="1381:0" data-first-offset="true"><span data-slate-string="true">没错，但是为什么要做到如此牵强的“统一”？通用的商品属性，例如厂家、商品唯一编号当然可以放到“统一”的商品表里面，但余下的信息还是可以根据商品类型放到各自类型的特定表里面，这就好像基类和派生类一样，抽象和统一只能做到某一个层次，层次太高反而不利于理解和维护。</span></span></span>
 </div>
 <div class="se-bc84130b " data-slate-type="paragraph" data-slate-object="block" data-key="1382">
  <span data-slate-object="text" data-key="1383"><span data-slate-leaf="true" data-offset-key="1383:0" data-first-offset="true"><span data-slate-string="true">对于一些需要事务的需求，例如订购，往往需要关系数据库的支持。当然，这只是多数情况，NoSQL 也有例外，即允许选择 CAP 中的 CP，具备强一致性且支持事务机制的，例如 DynamoDB。</span></span></span>
 </div>
 <div class="se-a59cd0fe " data-slate-type="paragraph" data-slate-object="block" data-key="1384">
  <span data-slate-object="text" data-key="1385"><span data-slate-leaf="true" data-offset-key="1385:0" data-first-offset="true"><span data-slate-string="true">而有一些系统和数据，则变化很大。比如用户数据，在多数情况下，schema 往往是比较明确的，而且数量上也没有订单等数据一般有特别大的伸缩性要求，因此往往也放到关系数据库里面；但是，在另外一些系统中，用户信息的组成不确定，或者说，schema 不确定，用户信息会放到 JSON 等松散结构的文本中，这种情况下文档数据库也是一个常见的选择；但是在搜索等某些相关功能的实现上，可能又会使用搜索引擎等不同于上面任一者的其它方式。</span></span></span>
 </div>
 <div class="se-e296f663 " data-slate-type="paragraph" data-slate-object="block" data-key="1386">
  <span data-slate-object="text" data-key="1387"><span data-slate-leaf="true" data-offset-key="1387:0" data-first-offset="true"><span class="se-9b44d3b4" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 如果符合结构不定（包括半结构化和无结构化）、高伸缩性、最终一致性、高性能（高吞吐量、高可用性、低时延等）的特点和要求，可以考虑非关系数据库。</span></span></span></span>
 </div>
 <div class="se-60bc4e4c " data-slate-type="paragraph" data-slate-object="block" data-key="1388">
  <span data-slate-object="text" data-key="1389"><span data-slate-leaf="true" data-offset-key="1389:0" data-first-offset="true"><span data-slate-string="true">简单来说，这时的具体技术选择，可以按照这样两个步骤来落地：</span></span></span>
 </div>
 <div class="se-8569bf8c" data-slate-type="list" data-slate-object="block" data-key="1390">
  <div class="se-c15eff32 se-4ecbcce5" data-slate-type="list-line" data-slate-object="block" data-key="1391">
   <span data-slate-object="text" data-key="1392"><span data-slate-leaf="true" data-offset-key="1392:0" data-first-offset="true"><span data-slate-string="true">如果你还记得 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1393" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1394"><span data-slate-leaf="true" data-offset-key="1394:0" data-first-offset="true"><span data-slate-string="true">[第 24 讲]</span></span></span></a><span data-slate-object="text" data-key="1395"><span data-slate-leaf="true" data-offset-key="1395:0" data-first-offset="true"><span data-slate-string="true"> 中介绍的那个 NoSQL 三角，根据一致性、可用性的要求，我们可以选择这个三角中的某一条边；</span></span></span>
  </div>
  <div class="se-33ffd660 se-65c57959" data-slate-type="list-line" data-slate-object="block" data-key="1396">
   <span data-slate-object="text" data-key="1397"><span data-slate-leaf="true" data-offset-key="1397:0" data-first-offset="true"><span data-slate-string="true">而在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1398" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1399"><span data-slate-leaf="true" data-offset-key="1399:0" data-first-offset="true"><span data-slate-string="true">[第 25 讲]</span></span></span></a><span data-slate-object="text" data-key="1400"><span data-slate-leaf="true" data-offset-key="1400:0" data-first-offset="true"><span data-slate-string="true"> 中则介绍了具体的 NoSQL 技术的分类和适用的问题类型，可以依其做进一步选择，比如根据数据结构化的程度，在那条边上，来进一步选择某一类 NoSQL 的存储技术。</span></span></span>
  </div>
 </div>
 <div class="se-b962dfeb " data-slate-type="paragraph" data-slate-object="block" data-key="1401">
  <span data-slate-object="text" data-key="1402"><span data-slate-leaf="true" data-offset-key="1402:0" data-first-offset="true"><span data-slate-string="true">比如说，这个电商问题中提到的媒体数据，即图片和视频，通常来说可用性更为重要，而这一类的大文件，没有内部的 schema，可以考虑使用擅长存放无结构大对象的文档型数据库。当然，也可以直接存放为文件，利用 CDN 的特性同步到离用户更近的节点去，特别对于视频来说，要提供好的用户体验，砸钱到 CDN 服务几乎是必选。</span></span></span>
 </div>
 <div class="se-b2d8a78e " data-slate-type="paragraph" data-slate-object="block" data-key="1403">
  <span data-slate-object="text" data-key="1404"><span data-slate-leaf="true" data-offset-key="1404:0" data-first-offset="true"><span data-slate-string="true">再比如，商品页在很大程度上都是可以缓存的，而缓存基本上都是为了保证可用性而会牺牲一定的一致性。除了上面介绍的 CDN 实现了对媒体内容的缓存以外，商品页本身，或是大部分区域的信息，都是可以利用 Memcached 等缓存服务缓存起来的。</span></span></span>
 </div>
 <h2 class="se-e66a8174" data-slate-type="heading" data-slate-object="block" data-key="1405"><span data-slate-object="text" data-key="1406"><span data-slate-leaf="true" data-offset-key="1406:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-d0e99c76 " data-slate-type="paragraph" data-slate-object="block" data-key="1407">
  <span data-slate-object="text" data-key="1408"><span data-slate-leaf="true" data-offset-key="1408:0" data-first-offset="true"><span data-slate-string="true">到这一章末尾，我们对于数据持久层的介绍就完结了。不妨来回顾一下，设计持久层，都有哪些需要考虑的方面呢？</span></span></span>
 </div>
 <div class="se-cb86d7ac " data-slate-type="paragraph" data-slate-object="block" data-key="1409">
  <span data-slate-object="text" data-key="1410"><span data-slate-leaf="true" data-offset-key="1410:0" data-first-offset="true"><span data-slate-string="true">首先，是代码层面的设计：</span></span></span>
 </div>
 <div class="se-512a1610" data-slate-type="list" data-slate-object="block" data-key="1411">
  <div class="se-0e1a6e24 se-bd4f6812" data-slate-type="list-line" data-slate-object="block" data-key="1412">
   <span data-slate-object="text" data-key="1413"><span data-slate-leaf="true" data-offset-key="1413:0" data-first-offset="true"><span data-slate-string="true">提供数据服务的设计，即 MVC 中模型层的设计，你可以阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1414" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1415"><span data-slate-leaf="true" data-offset-key="1415:0" data-first-offset="true"><span data-slate-string="true">[第 08 讲]</span></span></span></a><span data-slate-object="text" data-key="1416"><span data-slate-leaf="true" data-offset-key="1416:0" data-first-offset="true"><span data-slate-string="true"> 来复习回顾；</span></span></span>
  </div>
  <div class="se-9e7582b9 se-b39ca092" data-slate-type="list-line" data-slate-object="block" data-key="1417">
   <span data-slate-object="text" data-key="1418"><span data-slate-leaf="true" data-offset-key="1418:0" data-first-offset="true"><span data-slate-string="true">对于模型到关系数据库的映射（ORM）和技术选择，在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1419" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1420"><span data-slate-leaf="true" data-offset-key="1420:0" data-first-offset="true"><span data-slate-string="true">[第 12 讲]</span></span></span></a><span data-slate-object="text" data-key="1421"><span data-slate-leaf="true" data-offset-key="1421:0" data-first-offset="true"><span data-slate-string="true"> 的加餐部分有所介绍；</span></span></span>
  </div>
 </div>
 <div class="se-db1f59b8 " data-slate-type="paragraph" data-slate-object="block" data-key="1422">
  <span data-slate-object="text" data-key="1423"><span data-slate-leaf="true" data-offset-key="1423:0" data-first-offset="true"><span data-slate-string="true">其次，是系统层面的设计：</span></span></span>
 </div>
 <div class="se-0f86c164" data-slate-type="list" data-slate-object="block" data-key="1424">
  <div class="se-a39d972b se-354f906f" data-slate-type="list-line" data-slate-object="block" data-key="1425">
   <span data-slate-object="text" data-key="1426"><span data-slate-leaf="true" data-offset-key="1426:0" data-first-offset="true"><span data-slate-string="true">持久层内部或者持久层之上的缓存技术，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1427" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1428"><span data-slate-leaf="true" data-offset-key="1428:0" data-first-offset="true"><span data-slate-string="true">[第 21 讲]</span></span></span></a><span data-slate-object="text" data-key="1429"><span data-slate-leaf="true" data-offset-key="1429:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1430" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1431"><span data-slate-leaf="true" data-offset-key="1431:0" data-first-offset="true"><span data-slate-string="true">[第 22 讲]</span></span></span></a><span data-slate-object="text" data-key="1432"><span data-slate-leaf="true" data-offset-key="1432:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-44902d44 se-8993cd20" data-slate-type="list-line" data-slate-object="block" data-key="1433">
   <span data-slate-object="text" data-key="1434"><span data-slate-leaf="true" data-offset-key="1434:0" data-first-offset="true"><span data-slate-string="true">对于持久化的核心关注点之一 ——一致性，包括存储系统扩容的基础技术一致性哈希，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1435" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1436"><span data-slate-leaf="true" data-offset-key="1436:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="1437"><span data-slate-leaf="true" data-offset-key="1437:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-d5040a73 se-1e71a857" data-slate-type="list-line" data-slate-object="block" data-key="1438">
   <span data-slate-object="text" data-key="1439"><span data-slate-leaf="true" data-offset-key="1439:0" data-first-offset="true"><span data-slate-string="true">关于分布式数据存储涉及到的 CAP 理论和应用，以及相关的 ACID、BASE 原则，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1440" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1441"><span data-slate-leaf="true" data-offset-key="1441:0" data-first-offset="true"><span data-slate-string="true">[第 24 讲]</span></span></span></a><span data-slate-object="text" data-key="1442"><span data-slate-leaf="true" data-offset-key="1442:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-734debb1 se-f413bb1e" data-slate-type="list-line" data-slate-object="block" data-key="1443">
   <span data-slate-object="text" data-key="1444"><span data-slate-leaf="true" data-offset-key="1444:0" data-first-offset="true"><span data-slate-string="true">持久层存储技术的选择，你可以阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1445" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1446"><span data-slate-leaf="true" data-offset-key="1446:0" data-first-offset="true"><span data-slate-string="true">[第 25 讲]</span></span></span></a><span data-slate-object="text" data-key="1447"><span data-slate-leaf="true" data-offset-key="1447:0" data-first-offset="true"><span data-slate-string="true"> 来回顾，更进一步地，今天这一讲提供了一些具体问题实例和技术选择的思路。</span></span></span>
  </div>
 </div>
 <div class="se-ecb750dc " data-slate-type="paragraph" data-slate-object="block" data-key="1448">
  <span data-slate-object="text" data-key="1449"><span data-slate-leaf="true" data-offset-key="1449:0" data-first-offset="true"><span data-slate-string="true">希望通过这些内容的学习，你的持久层部分的知识，可以形成体系，而非零零散散的一个个孤岛。</span></span></span>
 </div>
 <div class="se-c4e9094e " data-slate-type="paragraph" data-slate-object="block" data-key="1450">
  <span data-slate-object="text" data-key="1451"><span data-slate-leaf="true" data-offset-key="1451:0" data-first-offset="true"><span class="se-de40cc0a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">最后，在这里我留一下今天的作业，这是一个开放性的思考题：</span></span></span></span>
 </div>
 <div class="se-a1174733 " data-slate-type="paragraph" data-slate-object="block" data-key="1452">
  <span data-slate-object="text" data-key="1453"><span data-slate-leaf="true" data-offset-key="1453:0" data-first-offset="true"><span data-slate-string="true">假如说，你要实现一个简化了的微信聊天功能，用户可以一对一聊天，也可以加好友，那么，你该怎么选择技术，并怎样设计持久层呢？</span></span></span>
 </div>
 <div class="se-df107d4f " data-slate-type="paragraph" data-slate-object="block" data-key="1454">
  <span data-slate-object="text" data-key="1455"><span data-slate-leaf="true" data-offset-key="1455:0" data-first-offset="true"><span data-slate-string="true">好，今天的内容就到这里，希望你在阅读后能有所收获。关于本章的内容，如果有想法，欢迎和我讨论。</span></span></span>
 </div>
 <h2 class="se-662c4477" data-slate-type="heading" data-slate-object="block" data-key="1456"><span data-slate-object="text" data-key="1457"><span data-slate-leaf="true" data-offset-key="1457:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-52cb61f5" data-slate-type="list" data-slate-object="block" data-key="1458">
  <div class="se-e4a7dd32 se-0e0c4d0d" data-slate-type="list-line" data-slate-object="block" data-key="1459">
   <span data-slate-object="text" data-key="1460"><span data-slate-leaf="true" data-offset-key="1460:0" data-first-offset="true"><span data-slate-string="true">文中介绍了倒排索引，感兴趣的话你可以进一步阅读</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1461" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1462"><span data-slate-leaf="true" data-offset-key="1462:0" data-first-offset="true"><span data-slate-string="true">搜索引擎是如何设计倒排索引的？</span></span></span></a>
  </div>
  <div class="se-9663a5f7 se-99b195ec" data-slate-type="list-line" data-slate-object="block" data-key="1463">
   <span data-slate-object="text" data-key="1464"><span data-slate-leaf="true" data-offset-key="1464:0" data-first-offset="true"><span data-slate-string="true">文中介绍了 GeoHash，在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1465" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1466"><span data-slate-leaf="true" data-offset-key="1466:0" data-first-offset="true"><span data-slate-string="true">geohash.org</span></span></span></a><span data-slate-object="text" data-key="1467"><span data-slate-leaf="true" data-offset-key="1467:0" data-first-offset="true"><span data-slate-string="true"> 的网站上，可以通过给出经纬度坐标，在地图上找到这个实际位置。感兴趣的话，还可以进一步了解：本质上，类似这种二维到一维的降维方式，都属于</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1468" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1469"><span data-slate-leaf="true" data-offset-key="1469:0" data-first-offset="true"><span data-slate-string="true">空间填充曲线</span></span></span></a><span data-slate-object="text" data-key="1470"><span data-slate-leaf="true" data-offset-key="1470:0" data-first-offset="true"><span data-slate-string="true"> ，比如说最有名的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1471" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1472"><span data-slate-leaf="true" data-offset-key="1472:0" data-first-offset="true"><span data-slate-string="true">希尔伯特曲线</span></span></span></a><span data-slate-object="text" data-key="1473"><span data-slate-leaf="true" data-offset-key="1473:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-02e74671 se-38ea89df" data-slate-type="list-line" data-slate-object="block" data-key="1474">
   <span data-slate-object="text" data-key="1475"><span data-slate-leaf="true" data-offset-key="1475:0" data-first-offset="true"><span data-slate-string="true">Sharding 和 Partitioning 是在数据库中常见的“拆分”方式，文中也提到了，但是这两个概念经常被混用，具体含义你可以参考维基百科 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1476" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1477"><span data-slate-leaf="true" data-offset-key="1477:0" data-first-offset="true"><span data-slate-string="true">Shard</span></span></span></a><span data-slate-object="text" data-key="1478"><span data-slate-leaf="true" data-offset-key="1478:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1479" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1480"><span data-slate-leaf="true" data-offset-key="1480:0" data-first-offset="true"><span data-slate-string="true">Partition</span></span></span></a><span data-slate-object="text" data-key="1481"><span data-slate-leaf="true" data-offset-key="1481:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-e8a3342d se-bceb1beb" data-slate-type="list-line" data-slate-object="block" data-key="1482">
   <span data-slate-object="text" data-key="1483"><span data-slate-leaf="true" data-offset-key="1483:0" data-first-offset="true"><span data-slate-string="true">有一篇介绍 Twitter 怎样应用推、拉模式，处理和存储消息，应对高访问量的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1484" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1485"><span data-slate-leaf="true" data-offset-key="1485:0" data-first-offset="true"><span data-slate-string="true">文章</span></span></span></a><span data-slate-object="text" data-key="1486"><span data-slate-leaf="true" data-offset-key="1486:0" data-first-offset="true"><span data-slate-string="true">，相应的，微博的技术专家也写了一篇文章来介绍微博的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1487" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1488"><span data-slate-leaf="true" data-offset-key="1488:0" data-first-offset="true"><span data-slate-string="true">处理方式</span></span></span></a><span data-slate-object="text" data-key="1489"><span data-slate-leaf="true" data-offset-key="1489:0" data-first-offset="true"><span data-slate-string="true">，你可以比较阅读。</span></span></span>
  </div>
 </div>
 <div class="se-4239c344" data-slate-type="image" data-slate-object="block" data-key="1490">
  <img class="se-83bd74b6" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |21          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:45:38.275 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=21 
 {executed in 1 msec}
2020-11-19 17:45:38.289 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<div data-slate-editor="true" data-key="1203" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-52e0d071 " data-slate-type="paragraph" data-slate-object="block" data-key="1204">
  <span data-slate-object="text" data-key="1205"><span data-slate-leaf="true" data-offset-key="1205:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-5da297c3 " data-slate-type="paragraph" data-slate-object="block" data-key="1206">
  <span data-slate-object="text" data-key="1207"><span data-slate-leaf="true" data-offset-key="1207:0" data-first-offset="true"><span data-slate-string="true">本章我们已经学习了不少持久化，特别是有关存储的技术。那在实际业务中，复杂的问题是一个接着一个的，面对这些琳琅满目的具体技术，我们该怎样运用自己所掌握的知识，做出合理的选择呢？今天我们就来接触一些典型的系统，看看对于它们来说，该做出怎样的持久化设计和技术选型。我相信我们实际接触的系统也有相当程度的类比性，可以带来应用的参考意义。</span></span></span>
 </div>
 <h2 class="se-8f31d6bd" data-slate-type="heading" data-slate-object="block" data-key="1208"><span data-slate-object="text" data-key="1209"><span data-slate-leaf="true" data-offset-key="1209:0" data-first-offset="true"><span data-slate-string="true">搜索引擎</span></span></span></h2>
 <div class="se-9dfa1127 " data-slate-type="paragraph" data-slate-object="block" data-key="1210">
  <span data-slate-object="text" data-key="1211"><span data-slate-leaf="true" data-offset-key="1211:0" data-first-offset="true"><span data-slate-string="true">小到 BBS 网站的帖子搜索，大到互联网数据搜索引擎，搜索引擎可以说是我们日常接触的几大系统之一。可是，搜索数据的存储该怎么设计呢？</span></span></span>
 </div>
 <div class="se-77377082 " data-slate-type="paragraph" data-slate-object="block" data-key="1212">
  <span data-slate-object="text" data-key="1213"><span data-slate-leaf="true" data-offset-key="1213:0" data-first-offset="true"><span data-slate-string="true">有一些反应迅速的程序员朋友，也许会设想这样的存储结构，利用关系数据库，创建这样一个存储文本（文章）的关系数据库表 ARTICLES：</span></span></span>
 </div>
 <div class="se-45ec6ad7" data-slate-type="image" data-slate-object="block" data-key="1214">
  <img class="se-cb1a1007" src="https://static001.geekbang.org/resource/image/45/04/4568eea6b14c67c379e840b2918ee404.jpg">
 </div>
 <div class="se-60c0a33f " data-slate-type="paragraph" data-slate-object="block" data-key="1215">
  <span data-slate-object="text" data-key="1216"><span data-slate-leaf="true" data-offset-key="1216:0" data-first-offset="true"><span data-slate-string="true">那么，假如现在的搜索关键字是“存储”，我们就可以利用字符串匹配的方式来对 CONTENT 列进行匹配查询：</span></span></span>
 </div>
 <div class="se-aa180433 se-1676b1e4" data-slate-type="pre" data-slate-object="block" data-key="1217" data-code-language="sql">
  <div class="se-eb65ed62 se-bbe16f6a">
   <span></span>
  </div>
  <div class="se-c63b3623">
   <div class="se-ea27c756 se-782f781d" data-code-line-number="1"></div>
  </div>
  <div class="se-57bd0d92 ps ps--active-x">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1218">
    <span data-slate-object="text" data-key="1219"><span data-slate-leaf="true" data-offset-key="1219:0" data-first-offset="true"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8383620888" data-annotation-type="annotation"><span data-slate-string="true">select</span></span></span><span data-slate-leaf="true" data-offset-key="1219:1"><span data-slate-string="true"> * </span></span><span data-slate-leaf="true" data-offset-key="1219:2"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_6627615917" data-annotation-type="annotation"><span data-slate-string="true">from</span></span></span><span data-slate-leaf="true" data-offset-key="1219:3"><span data-slate-string="true"> ARTICLES </span></span><span data-slate-leaf="true" data-offset-key="1219:4"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_4550830848" data-annotation-type="annotation"><span data-slate-string="true">where</span></span></span><span data-slate-leaf="true" data-offset-key="1219:5"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:6"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_5965950239" data-annotation-type="annotation"><span data-slate-string="true">CONTENT</span></span></span><span data-slate-leaf="true" data-offset-key="1219:7"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:8"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_5317078084" data-annotation-type="annotation"><span data-slate-string="true">like</span></span></span><span data-slate-leaf="true" data-offset-key="1219:9"><span data-slate-string="true"> </span></span><span data-slate-leaf="true" data-offset-key="1219:10"><span class=" gkhl-string" data-slate-object="annotation" data-annotation-key="gkann_8390786565" data-annotation-type="annotation"><span data-slate-string="true">'% 存储 %'</span></span></span><span data-slate-leaf="true" data-offset-key="1219:11"><span data-slate-string="true">;</span></span></span>
   </div>
   <div class="ps__rail-x" style="width: 365px; left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 326px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-a9ae5959 " data-slate-type="paragraph" data-slate-object="block" data-key="1220">
  <span data-slate-object="text" data-key="1221"><span data-slate-leaf="true" data-offset-key="1221:0" data-first-offset="true"><span data-slate-string="true">这很容易就实现了搜索功能。但是，这样的方式有着明显的问题，即使用 % 来进行字符串匹配是非常低效的，因此这样的查询需要遍历整个表（全表扫描）。几篇、几十篇文章的时候，还不是什么问题，但是如果有几十万、几百万的文章，这种方式是完全不可行的。且不说单独的关系数据库表就不能容纳那么大的数据了，就是能够容纳，要扫描一遍，这里的时间代价是难以想象的，就算我们的系统愿意做，用户可都不愿意等啊。</span></span></span>
 </div>
 <div class="se-7abca630 " data-slate-type="paragraph" data-slate-object="block" data-key="1222">
  <span data-slate-object="text" data-key="1223"><span data-slate-leaf="true" data-offset-key="1223:0" data-first-offset="true"><span data-slate-string="true">于是，我们就要引入</span></span></span><span data-slate-object="text" data-key="1224"><span data-slate-leaf="true" data-offset-key="1224:0" data-first-offset="true"><span class="se-3a73ed2a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">“倒排索引”（Inverted Index）</span></span></span></span><span data-slate-object="text" data-key="1225"><span data-slate-leaf="true" data-offset-key="1225:0" data-first-offset="true"><span data-slate-string="true">的技术了。在前面所述的场景下，我们可以把这个概念拆分为两个部分来解释：</span></span></span>
 </div>
 <div class="se-b6f648e1" data-slate-type="list" data-slate-object="block" data-key="1226">
  <div class="se-b5bbb40b se-19f0ce4c" data-slate-type="list-line" data-slate-object="block" data-key="1227">
   <span data-slate-object="text" data-key="1228"><span data-slate-leaf="true" data-offset-key="1228:0" data-first-offset="true"><span data-slate-string="true">“倒排”，指的是存储的结构不再是先定位到文章，再去文章的内容中找寻关键字了；而是反过来，先定位到关键字，再去看关键字属于哪些文章。</span></span></span>
  </div>
  <div class="se-a754c520 se-99a4f6de" data-slate-type="list-line" data-slate-object="block" data-key="1229">
   <span data-slate-object="text" data-key="1230"><span data-slate-leaf="true" data-offset-key="1230:0" data-first-offset="true"><span data-slate-string="true">“索引”，指的是关键字，是被索引起来的，因此查询的速度会比较快。</span></span></span>
  </div>
 </div>
 <div class="se-bcf701e5 " data-slate-type="paragraph" data-slate-object="block" data-key="1231">
  <span data-slate-object="text" data-key="1232"><span data-slate-leaf="true" data-offset-key="1232:0" data-first-offset="true"><span data-slate-string="true">好，那上面的 ARTICLES 表依然存在，但现在需要添加一个关键字表 KEYWORDS，并且，KEYWORD 列需要添加索引，因此这条关键字的记录可以被迅速找到：</span></span></span>
 </div>
 <div class="se-8bdc0855" data-slate-type="image" data-slate-object="block" data-key="1233">
  <img class="se-6c13fd39" src="https://static001.geekbang.org/resource/image/c9/11/c9868489ed7415cdad3f760e0ea5d411.jpg">
 </div>
 <div class="se-c147cc5f " data-slate-type="paragraph" data-slate-object="block" data-key="1234">
  <span data-slate-object="text" data-key="1235"><span data-slate-leaf="true" data-offset-key="1235:0" data-first-offset="true"><span data-slate-string="true">当然，我们还需要一个关联关系表把 KEYWORDS 表和 ARTICLES 表结合起来，KEYWORD_ID 和 ARTICLE_ID 作为联合主键：</span></span></span>
 </div>
 <div class="se-2bb60fa5" data-slate-type="image" data-slate-object="block" data-key="1236">
  <img class="se-5ea40cbd" src="https://static001.geekbang.org/resource/image/ba/9b/ba5a26f2d882314e7d0d1f60c23d979b.jpg">
 </div>
 <div class="se-9319a8c3 " data-slate-type="paragraph" data-slate-object="block" data-key="1237">
  <span data-slate-object="text" data-key="1238"><span data-slate-leaf="true" data-offset-key="1238:0" data-first-offset="true"><span data-slate-string="true">你看，这其实是一个多对多的关系，即同一个关键字可以出现在多篇文章中，而一篇文章可以包含多个不同的关键字。这样，我们可以先根据被索引了的关键字，从 KEYWARDS 表中找到相应的 KEYWORD_ID，进而根据它在上面的关联关系表找到 ARTICLE_ID，再根据它去 ARTICLES 表中找到对应的文章。</span></span></span>
 </div>
 <div class="se-4b982a60 " data-slate-type="paragraph" data-slate-object="block" data-key="1239">
  <span data-slate-object="text" data-key="1240"><span data-slate-leaf="true" data-offset-key="1240:0" data-first-offset="true"><span data-slate-string="true">这看起来是三次查找，但是因为每次都走索引，就免去了全表扫描，在数据量较小的时候速度并不慢，并且，在使用 SQL 实现的时候，这个过程完全可以放到一个 SQL 语句中。在数据量较小的时候，上面的方法已经足够好用了。</span></span></span>
 </div>
 <div class="se-48a44247 " data-slate-type="paragraph" data-slate-object="block" data-key="1241">
  <span data-slate-object="text" data-key="1242"><span data-slate-leaf="true" data-offset-key="1242:0" data-first-offset="true"><span data-slate-string="true">但是，这个方法只解决了全表扫描和字符串 % 匹配查询造成的性能问题，并且，在数据量较大时，并没有解决数据量本身在单机模式下造成的性能问题。</span></span></span>
 </div>
 <div class="se-103de2b9 " data-slate-type="paragraph" data-slate-object="block" data-key="1243">
  <span data-slate-object="text" data-key="1244"><span data-slate-leaf="true" data-offset-key="1244:0" data-first-offset="true"><span data-slate-string="true">于是，我们可以考虑搭建和使用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1245" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1246"><span data-slate-leaf="true" data-offset-key="1246:0" data-first-offset="true"><span data-slate-string="true">Elasticsearch</span></span></span></a><span data-slate-object="text" data-key="1247"><span data-slate-leaf="true" data-offset-key="1247:0" data-first-offset="true"><span data-slate-string="true">，或者干脆使用云上的版本。Elasticsearch 将关键字使用哈希算法分散到多个不同的被称为“Shard”的虚拟节点，并且把它们部署到不同的机器节点上，且每一个 shard 具备指定数量的冗余副本（Replica），这些副本要求被放置到不同的物理机器节点上。通过这样的方式，我们就可以保证每台机器都只管理稳定且可控的数据量，并且保证了搜索服务数据的可用性。</span></span></span>
 </div>
 <div class="se-5195f29f" data-slate-type="image" data-slate-object="block" data-key="1248">
  <img class="se-cd873cd2" src="https://static001.geekbang.org/resource/image/8c/09/8c4e956ca12bccc88ea9fd5d8f461a09.jpg">
 </div>
 <div class="se-9cdf3fd8 " data-slate-type="paragraph" data-slate-object="block" data-key="1249">
  <span data-slate-object="text" data-key="1250"><span data-slate-leaf="true" data-offset-key="1250:0" data-first-offset="true"><span data-slate-string="true">对于每一个关键字，都可以配置指向文章和文章中位置的映射。比如有这样两篇文章：</span></span></span>
 </div>
 <div class="se-1c5eab38" data-slate-type="block-quote" data-slate-object="block" data-key="1251">
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="1252">
   <span data-slate-object="text" data-key="1253"><span data-slate-leaf="true" data-offset-key="1253:0" data-first-offset="true"><span data-slate-string="true">文章 1 的正文是：今天介绍存储技术。</span></span></span>
  </div>
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="1254">
   <span data-slate-object="text" data-key="1255"><span data-slate-leaf="true" data-offset-key="1255:0" data-first-offset="true"><span data-slate-string="true">文章 2 的正文是：存储技术有多种分类。</span></span></span>
  </div>
 </div>
 <div class="se-9b2927f0 " data-slate-type="paragraph" data-slate-object="block" data-key="1256">
  <span data-slate-object="text" data-key="1257"><span data-slate-leaf="true" data-offset-key="1257:0" data-first-offset="true"><span data-slate-string="true">那么，就有如下映射关系（下表仅用于表示在 Shard 中的数据映射，并非关系数据库表）：</span></span></span>
 </div>
 <div class="se-c127bc8b" data-slate-type="image" data-slate-object="block" data-key="1258">
  <img class="se-3e7825f1" src="https://static001.geekbang.org/resource/image/77/68/779702fd2a29ff418711928789bd3b68.jpg">
 </div>
 <div class="se-e3ff29ac " data-slate-type="paragraph" data-slate-object="block" data-key="1259">
  <span data-slate-object="text" data-key="1260"><span data-slate-leaf="true" data-offset-key="1260:0" data-first-offset="true"><span data-slate-string="true">你看，DOCUMENT 这一部分，每一行都可以存放若干个“文章 id : 文中关键字的位置”的组合。</span></span></span>
 </div>
 <h2 class="se-b3a2a24f" data-slate-type="heading" data-slate-object="block" data-key="1261"><span data-slate-object="text" data-key="1262"><span data-slate-leaf="true" data-offset-key="1262:0" data-first-offset="true"><span data-slate-string="true">地理信息系统</span></span></span></h2>
 <div class="se-5dd44887 " data-slate-type="paragraph" data-slate-object="block" data-key="1263">
  <span data-slate-object="text" data-key="1264"><span data-slate-leaf="true" data-offset-key="1264:0" data-first-offset="true"><span data-slate-string="true">有这样一款订餐软件，上面有这样一个功能，在地图上可以列出距离当前用户最近的签约饭馆，并且随着用户缩放地图，还可以控制这个距离的大小。每个饭馆的位置可以简单考虑为经度和纬度组合的坐标（下图来自 Google 地图，仅示意用）。</span></span></span>
 </div>
 <div class="se-49eddde1" data-slate-type="image" data-slate-object="block" data-key="1265">
  <img class="se-5c9ab7e5" src="https://static001.geekbang.org/resource/image/50/9a/500b7bc8394a1b63c7fb89ee4c18cb9a.jpg">
 </div>
 <div class="se-3d802770 " data-slate-type="paragraph" data-slate-object="block" data-key="1266">
  <span data-slate-object="text" data-key="1267"><span data-slate-leaf="true" data-offset-key="1267:0" data-first-offset="true"><span data-slate-string="true">简言之，这个功能就是“显示一定范围内的目标集合”，可它该怎样实现呢？</span></span></span>
 </div>
 <div class="se-cda00e26 " data-slate-type="paragraph" data-slate-object="block" data-key="1268">
  <span data-slate-object="text" data-key="1269"><span data-slate-leaf="true" data-offset-key="1269:0" data-first-offset="true"><span data-slate-string="true">在考虑这个功能以前，我们可以类比地想一想，它其实是一个相当常见且通用的功能，常常应用于订餐、导航软件、旅游网站等等这类 LBS（Location-Based Service，基于位置的服务）应用中，因此这个问题是具有一定典型意义的。</span></span></span>
 </div>
 <div class="se-add40cf8 " data-slate-type="paragraph" data-slate-object="block" data-key="1270">
  <span data-slate-object="text" data-key="1271"><span data-slate-leaf="true" data-offset-key="1271:0" data-first-offset="true"><span data-slate-string="true">这个背后的数据结构以及存储又是怎样的呢？我们顺着这个“经纬度”的思路往下想，那么，如果就把这样的地理信息，放到一张 LOCATIONS 表上，就会是这样：</span></span></span>
 </div>
 <div class="se-9d899f83" data-slate-type="image" data-slate-object="block" data-key="1272">
  <img class="se-2e0b3f72" src="https://static001.geekbang.org/resource/image/bb/43/bb027beec790f8ee207b051b4a5ca943.jpg">
 </div>
 <div class="se-aa18af61 " data-slate-type="paragraph" data-slate-object="block" data-key="1273">
  <span data-slate-object="text" data-key="1274"><span data-slate-leaf="true" data-offset-key="1274:0" data-first-offset="true"><span data-slate-string="true">当然了，还有一张 RESTAURANTS 表：</span></span></span>
 </div>
 <div class="se-c3390074" data-slate-type="image" data-slate-object="block" data-key="1275">
  <img class="se-f588c18e" src="https://static001.geekbang.org/resource/image/ba/02/bafddb5244287066ec676b6c30054c02.jpg">
 </div>
 <div class="se-ff260739 " data-slate-type="paragraph" data-slate-object="block" data-key="1276">
  <span data-slate-object="text" data-key="1277"><span data-slate-leaf="true" data-offset-key="1277:0" data-first-offset="true"><span data-slate-string="true">于是，要查出范围内的饭馆，我们就可以写这样的 SQL：</span></span></span>
 </div>
 <div class="se-12ad3a34 se-c5b873b5" data-slate-type="pre" data-slate-object="block" data-key="1278" data-code-language="sql">
  <div class="se-64f59a01 se-c97d7e52">
   <span></span>
  </div>
  <div class="se-149a68ea">
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="1"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="2"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="3"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="4"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="5"></div>
   <div class="se-157e5abc se-1bcf8bb3" data-code-line-number="6"></div>
  </div>
  <div class="se-2dba92b4 ps">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1279">
    <span data-slate-object="text" data-key="1280"><span data-slate-leaf="true" data-offset-key="1280:0" data-first-offset="true"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_9182086135" data-annotation-type="annotation"><span data-slate-string="true">select</span></span></span><span data-slate-leaf="true" data-offset-key="1280:1"><span data-slate-string="true"> * </span></span><span data-slate-leaf="true" data-offset-key="1280:2"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_9950164498" data-annotation-type="annotation"><span data-slate-string="true">from</span></span></span><span data-slate-leaf="true" data-offset-key="1280:3"><span data-slate-string="true"> LOCATIONS l, RESTAURANTS r </span></span><span data-slate-leaf="true" data-offset-key="1280:4"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_6578944204" data-annotation-type="annotation"><span data-slate-string="true">where</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1281">
    <span data-slate-object="text" data-key="1282"><span data-slate-leaf="true" data-offset-key="1282:0" data-first-offset="true"><span data-slate-string="true"> l.RESTAURANT_ID = r.RESTAURANT_ID </span></span><span data-slate-leaf="true" data-offset-key="1282:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8006659042" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1283">
    <span data-slate-object="text" data-key="1284"><span data-slate-leaf="true" data-offset-key="1284:0" data-first-offset="true"><span data-slate-string="true"> l.LONGITUDE &gt;= 经度下界 </span></span><span data-slate-leaf="true" data-offset-key="1284:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_1539765598" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1285">
    <span data-slate-object="text" data-key="1286"><span data-slate-leaf="true" data-offset-key="1286:0" data-first-offset="true"><span data-slate-string="true"> l.LONGITUDE &lt;= 经度上界 </span></span><span data-slate-leaf="true" data-offset-key="1286:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_8496362576" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1287">
    <span data-slate-object="text" data-key="1288"><span data-slate-leaf="true" data-offset-key="1288:0" data-first-offset="true"><span data-slate-string="true"> l.LATITUDE &gt;= 纬度下界 </span></span><span data-slate-leaf="true" data-offset-key="1288:1"><span class=" gkhl-keyword" data-slate-object="annotation" data-annotation-key="gkann_1730678695" data-annotation-type="annotation"><span data-slate-string="true">and</span></span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1289">
    <span data-slate-object="text" data-key="1290"><span data-slate-leaf="true" data-offset-key="1290:0" data-first-offset="true"><span data-slate-string="true"> l.LATITUDE &lt;= 纬度上界 ;</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-443d2ad4 " data-slate-type="paragraph" data-slate-object="block" data-key="1291">
  <span data-slate-object="text" data-key="1292"><span data-slate-leaf="true" data-offset-key="1292:0" data-first-offset="true"><span data-slate-string="true">其中，这个经度、纬度的上下界，是根据用户所在位置，以及地图缩放程度折算出来的。显然，这需要一个全表扫描，加一个笛卡尔积，复杂度偏高，能否优化一下它呢？在往下阅读前，你可以先想一想。</span></span></span>
 </div>
 <div class="se-09fbb4ec " data-slate-type="paragraph" data-slate-object="block" data-key="1293">
  <span data-slate-object="text" data-key="1294"><span data-slate-leaf="true" data-offset-key="1294:0" data-first-offset="true"><span class="se-419117bb" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">思路 1：给单一维度加索引</span></span></span></span>
 </div>
 <div class="se-08753f00 " data-slate-type="paragraph" data-slate-object="block" data-key="1295">
  <span data-slate-object="text" data-key="1296"><span data-slate-leaf="true" data-offset-key="1296:0" data-first-offset="true"><span data-slate-string="true">嗯，如果经纬度可以分开处理，是不是就可以搞定？比方说，只考虑经度的话，给经度一列建立索引，所有饭馆按照从小到大的顺序排好。这样的话，当给定范围的时候，我们就可以快速找到经度范围内所有满足经度条件的饭馆。从时间复杂度的角度来考虑，在不做额外优化的情况下，以在有序经度列上的二分查找为例，这个复杂度是 log(n)。</span></span></span>
 </div>
 <div class="se-998a42ef " data-slate-type="paragraph" data-slate-object="block" data-key="1297">
  <span data-slate-object="text" data-key="1298"><span data-slate-leaf="true" data-offset-key="1298:0" data-first-offset="true"><span data-slate-string="true">当再考虑纬度的时候，假如有 m 家满足经度条件的饭馆，接下去我们就只能挨个去检查这 m 家饭馆，找出它们中满足纬度条件的了，也就是说，总的时间复杂度是 m*log(n)。这种方法比较简单，在数据量不太大的情况下也没有太大问题，因此这已经是很好的方法了。但是，在某些场景下这个 m 还有可能比较大，那么，有进一步优化的办法吗？</span></span></span>
 </div>
 <div class="se-21662fd6 " data-slate-type="paragraph" data-slate-object="block" data-key="1299">
  <span data-slate-object="text" data-key="1300"><span data-slate-leaf="true" data-offset-key="1300:0" data-first-offset="true"><span class="se-dc0dd7c8" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">思路 2：GeoHash</span></span></span></span>
 </div>
 <div class="se-f2f592b1 " data-slate-type="paragraph" data-slate-object="block" data-key="1301">
  <span data-slate-object="text" data-key="1302"><span data-slate-leaf="true" data-offset-key="1302:0" data-first-offset="true"><span data-slate-string="true">其实，经度和纬度的大致思路可以，但是在框选饭馆的时候，不能把经度和纬度分别框选，而应该结合起来框选，并且把复杂度依然控制在 log(n) 的级别。</span></span></span>
 </div>
 <div class="se-8fec5785 " data-slate-type="paragraph" data-slate-object="block" data-key="1303">
  <span data-slate-object="text" data-key="1304"><span data-slate-leaf="true" data-offset-key="1304:0" data-first-offset="true"><span data-slate-string="true">其中一个办法就是 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1305" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1306"><span data-slate-leaf="true" data-offset-key="1306:0" data-first-offset="true"><span data-slate-string="true">GeoHash</span></span></span></a><span data-slate-object="text" data-key="1307"><span data-slate-leaf="true" data-offset-key="1307:0" data-first-offset="true"><span data-slate-string="true">，它的大致思路就是降维。即把一个经度和纬度的二维坐标用一个一维的数来表示。具体实现上，有一种常见的办法就是把经度和纬度用一个长位数的数来表示，比如：</span></span></span>
 </div>
 <div class="se-0b76b89e se-69479d11" data-slate-type="pre" data-slate-object="block" data-key="1308">
  <div class="se-938d8933 se-34705256">
   <span></span>
  </div>
  <div class="se-b3e75833">
   <div class="se-c74c99dd se-2e1661fb" data-code-line-number="1"></div>
   <div class="se-c74c99dd se-2e1661fb" data-code-line-number="2"></div>
  </div>
  <div class="se-91ab267e ps">
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1309">
    <span data-slate-object="text" data-key="1310"><span data-slate-leaf="true" data-offset-key="1310:0" data-first-offset="true"><span data-slate-string="true">经度：101010……</span></span></span>
   </div>
   <div class="se-3ea883e4 se-5ac6ef5c" data-slate-type="code-line" data-slate-object="block" data-key="1311">
    <span data-slate-object="text" data-key="1312"><span data-slate-leaf="true" data-offset-key="1312:0" data-first-offset="true"><span data-slate-string="true">纬度：100110……</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-e691db67 " data-slate-type="paragraph" data-slate-object="block" data-key="1313">
  <span data-slate-object="text" data-key="1314"><span data-slate-leaf="true" data-offset-key="1314:0" data-first-offset="true"><span data-slate-string="true">接着把二者从左到右挨个位拼接，黑色字符来自经度，蓝色字符来自纬度：</span></span></span>
 </div>
 <div class="se-7a1eefab" data-slate-type="image" data-slate-object="block" data-key="1315">
  <img class="se-6ad67326" src="https://static001.geekbang.org/resource/image/11/af/1142aa596e19561794080a5896667aaf.jpg">
 </div>
 <div class="se-2ba5c56a " data-slate-type="paragraph" data-slate-object="block" data-key="1316">
  <span data-slate-object="text" data-key="1317"><span data-slate-leaf="true" data-offset-key="1317:0" data-first-offset="true"><span data-slate-string="true">在这种方式下，从结果的左边最高位开始，取任意长度截断所得到的前缀，可以用来匹配距离目标位置一定距离范围的所有饭馆。当用户选取的地图范围越大，前缀长度就越长，这个匹配精度也就越高，匹配到的饭馆数量也就越少。通过这种方式，区域不断用前缀的方式来细分，相当于给每个子区域一个标记号码。</span></span></span>
 </div>
 <div class="se-dc2940df " data-slate-type="paragraph" data-slate-object="block" data-key="1318">
  <span data-slate-object="text" data-key="1319"><span data-slate-leaf="true" data-offset-key="1319:0" data-first-offset="true"><span data-slate-string="true">那么，我们数据库表中的经度和纬度就可以合并为一列，再令这一列为主键，或者做索引，就能够进行单列的范围查询了。</span></span></span>
 </div>
 <div class="se-09c23d09" data-slate-type="image" data-slate-object="block" data-key="1320">
  <img class="se-a5587edb" src="https://static001.geekbang.org/resource/image/a7/fa/a703d1d17e273fcc4d1150e9105071fa.jpg">
 </div>
 <div class="se-212284de " data-slate-type="paragraph" data-slate-object="block" data-key="1321">
  <span data-slate-object="text" data-key="1322"><span data-slate-leaf="true" data-offset-key="1322:0" data-first-offset="true"><span data-slate-string="true">最后，我们已经走到这一步了，接下来该怎么把这个表落实到数据库中呢？这就有多种方式可供选择了。比如我们可以使用关系数据库（例如 MySQL），也可以使用 NoSQL 中的键值数据库（例如 Redis 等）。这方面可以根据其它业务需求，以及实际开发的限制来选择，具体选择的策略，请继续阅读下文。</span></span></span>
 </div>
 <h2 class="se-5aaa4c5e" data-slate-type="heading" data-slate-object="block" data-key="1323"><span data-slate-object="text" data-key="1324"><span data-slate-leaf="true" data-offset-key="1324:0" data-first-offset="true"><span data-slate-string="true">SQL or NoSQL？</span></span></span></h2>
 <div class="se-11e1519b " data-slate-type="paragraph" data-slate-object="block" data-key="1325">
  <span data-slate-object="text" data-key="1326"><span data-slate-leaf="true" data-offset-key="1326:0" data-first-offset="true"><span data-slate-string="true">我们在实际的存储系统选择时，经常会涉及到 SQL 数据库和 NoSQL 数据库的选择，也就是关系数据库和非关系数据库的选择。举个例子，如果是电子商务网站（这可能是我们平时听到的最多的例子之一了），应该选择 SQL 还是 NoSQL？</span></span></span>
 </div>
 <h3 class="se-b4c94c19" data-slate-type="heading" data-slate-object="block" data-key="1327"><span data-slate-object="text" data-key="1328"><span data-slate-leaf="true" data-offset-key="1328:0" data-first-offset="true"><span data-slate-string="true">两个前提角度</span></span></span></h3>
 <div class="se-9600f53a " data-slate-type="paragraph" data-slate-object="block" data-key="1329">
  <span data-slate-object="text" data-key="1330"><span data-slate-leaf="true" data-offset-key="1330:0" data-first-offset="true"><span data-slate-string="true">设计和选型方面，有很多问题都不是黑白分明的，而是要拆分开来一块一块分析。我听到过很多“一刀切”的答案，比如有的人说用 MySQL，有的说用 Redis，我认为这样的结论都是不妥的。那么怎样来选择呢？下面我就来介绍一些 SQL 和 NoSQL 选择的原则。但是在讲原则以前，我觉得需要从两个“前提角度”去厘清我们的问题。</span></span></span>
 </div>
 <div class="se-dd3fb78d " data-slate-type="paragraph" data-slate-object="block" data-key="1331">
  <span data-slate-object="text" data-key="1332"><span data-slate-leaf="true" data-offset-key="1332:0" data-first-offset="true"><span data-slate-string="true">以电商网站的设计为例，这两个角度就是这样的。</span></span></span>
 </div>
 <div class="se-bd59005a " data-slate-type="paragraph" data-slate-object="block" data-key="1333">
  <span data-slate-object="text" data-key="1334"><span data-slate-leaf="true" data-offset-key="1334:0" data-first-offset="true"><span class="se-21027aac" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 数据分类</span></span></span></span>
 </div>
 <div class="se-829a4bbd " data-slate-type="paragraph" data-slate-object="block" data-key="1335">
  <span data-slate-object="text" data-key="1336"><span data-slate-leaf="true" data-offset-key="1336:0" data-first-offset="true"><span data-slate-string="true">电子商务网站，这个概念所意味着的数据类型太多了。简单举几个例子：</span></span></span>
 </div>
 <div class="se-bdfb8392" data-slate-type="list" data-slate-object="block" data-key="1337">
  <div class="se-dd6c1d8d se-f9852c91" data-slate-type="list-line" data-slate-object="block" data-key="1338">
   <span data-slate-object="text" data-key="1339"><span data-slate-leaf="true" data-offset-key="1339:0" data-first-offset="true"><span data-slate-string="true">商品元数据，即商品的描述、厂家等等信息；</span></span></span>
  </div>
  <div class="se-de6b1014 se-648a146a" data-slate-type="list-line" data-slate-object="block" data-key="1340">
   <span data-slate-object="text" data-key="1341"><span data-slate-leaf="true" data-offset-key="1341:0" data-first-offset="true"><span data-slate-string="true">媒体数据，比如图片和视频；</span></span></span>
  </div>
  <div class="se-6d656e05 se-2928e737" data-slate-type="list-line" data-slate-object="block" data-key="1342">
   <span data-slate-object="text" data-key="1343"><span data-slate-leaf="true" data-offset-key="1343:0" data-first-offset="true"><span data-slate-string="true">库存数据，包括在某个地点的库房某商品还有多少件库存；</span></span></span>
  </div>
  <div class="se-2461622e se-c88a9c2f" data-slate-type="list-line" data-slate-object="block" data-key="1344">
   <span data-slate-object="text" data-key="1345"><span data-slate-leaf="true" data-offset-key="1345:0" data-first-offset="true"><span data-slate-string="true">交易信息，比如订单、支付、余额管理；</span></span></span>
  </div>
  <div class="se-8b504dc5 se-3136e84d" data-slate-type="list-line" data-slate-object="block" data-key="1346">
   <span data-slate-object="text" data-key="1347"><span data-slate-leaf="true" data-offset-key="1347:0" data-first-offset="true"><span data-slate-string="true">用户信息，涉及的功能包括登陆、注册和用户设置。</span></span></span>
  </div>
 </div>
 <div class="se-4dafeebc " data-slate-type="paragraph" data-slate-object="block" data-key="1348">
  <span data-slate-object="text" data-key="1349"><span data-slate-leaf="true" data-offset-key="1349:0" data-first-offset="true"><span data-slate-string="true">因此，在讨论什么存储适合数据和访问的时候，我们最好明确，到底具体是哪一种类型的数据。毕竟，看起来上面的业务场景将有着巨大差别。</span></span></span>
 </div>
 <div class="se-6512e940 " data-slate-type="paragraph" data-slate-object="block" data-key="1350">
  <span data-slate-object="text" data-key="1351"><span data-slate-leaf="true" data-offset-key="1351:0" data-first-offset="true"><span class="se-aae2a506" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 数据规模</span></span></span></span>
 </div>
 <div class="se-61e78ea8 " data-slate-type="paragraph" data-slate-object="block" data-key="1352">
  <span data-slate-object="text" data-key="1353"><span data-slate-leaf="true" data-offset-key="1353:0" data-first-offset="true"><span data-slate-string="true">电子商务网站有大有小，可别一想到电商网站，脑海里就是淘宝和京东，商品可以上千万，甚至上亿。但其实，我们大多数接触的系统，都不会有那么大的规模，电商网站完全可以小到一个提供在线购物业务的私人体育用品专营店，商品数量可以只有几十到几百。</span></span></span>
 </div>
 <div class="se-a2e7206c " data-slate-type="paragraph" data-slate-object="block" data-key="1354">
  <span data-slate-object="text" data-key="1355"><span data-slate-leaf="true" data-offset-key="1355:0" data-first-offset="true"><span data-slate-string="true">只有把问题做如上的展开并明确以后，我们再去思考和讨论数据结构、一致性、可用性等等这些我们“熟悉”的方面，才准确。因此，从上面的例子来看，</span></span></span><span data-slate-object="text" data-key="1356"><span data-slate-leaf="true" data-offset-key="1356:0" data-first-offset="true"><span class="se-4dbc55ea" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我们在选择技术的时候，很可能要针对每一类数据选择“一组”技术，而不是笼统地选择“一项”技术了。</span></span></span></span>
 </div>
 <h3 class="se-f89eede4" data-slate-type="heading" data-slate-object="block" data-key="1357"><span data-slate-object="text" data-key="1358"><span data-slate-leaf="true" data-offset-key="1358:0" data-first-offset="true"><span data-slate-string="true">选择的思路</span></span></span></h3>
 <div class="se-bdd2adc7 " data-slate-type="paragraph" data-slate-object="block" data-key="1359">
  <span data-slate-object="text" data-key="1360"><span data-slate-leaf="true" data-offset-key="1360:0" data-first-offset="true"><span data-slate-string="true">那么下一步，我们该怎样来选择 SQL 或是 NoSQL 数据库呢？这部分可以说，不同的人有着颇为不同的看法。下面我想根据我的认识，谈谈一个大致的选择思路，请注意这只是一个粗略的基于经验的分类，具体的技术选择还要具体问题具体分析和细化。</span></span></span>
 </div>
 <div class="se-572447cc " data-slate-type="paragraph" data-slate-object="block" data-key="1361">
  <span data-slate-object="text" data-key="1362"><span data-slate-leaf="true" data-offset-key="1362:0" data-first-offset="true"><span class="se-e087d359" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 对于中小型系统，在数据量不大且没有特殊的吞吐量、可用性等要求的情况下，或者在多种关系和非关系数据库都满足业务要求的情况下，优先考虑关系数据库。</span></span></span></span>
 </div>
 <div class="se-ff3acd25 " data-slate-type="paragraph" data-slate-object="block" data-key="1363">
  <span data-slate-object="text" data-key="1364"><span data-slate-leaf="true" data-offset-key="1364:0" data-first-offset="true"><span data-slate-string="true">关系数据库提供了成熟且强大的功能，包括强 schema 定义、关系查询、事务支持等等。关系数据库能够带来较强的扩展能力，未来在业务发展的时候，通过增加索引、增加表、增加列、增加关系查询，就可以迅速解决问题。</span></span></span>
 </div>
 <div class="se-e50f571c " data-slate-type="paragraph" data-slate-object="block" data-key="1365">
  <span data-slate-object="text" data-key="1366"><span data-slate-leaf="true" data-offset-key="1366:0" data-first-offset="true"><span data-slate-string="true">在从内存模型到实际存储数据的 ORM 转换的时候，有非常成熟的且支持程度各异的框架，有的把 ORM 完全自动化，让程序员可以关注在核心业务模型上面；有的则是把 ORM 定义让出来，提供足够的灵活性（这部分可以参见 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1367" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1368"><span data-slate-leaf="true" data-offset-key="1368:0" data-first-offset="true"><span data-slate-string="true">[第 12 讲]</span></span></span></a><span data-slate-object="text" data-key="1369"><span data-slate-leaf="true" data-offset-key="1369:0" data-first-offset="true"><span data-slate-string="true"> 的加餐部分）。</span></span></span>
 </div>
 <div class="se-6dbf9d3f " data-slate-type="paragraph" data-slate-object="block" data-key="1370">
  <span data-slate-object="text" data-key="1371"><span data-slate-leaf="true" data-offset-key="1371:0" data-first-offset="true"><span data-slate-string="true">值得注意的是，</span></span></span><span data-slate-object="text" data-key="1372"><span data-slate-leaf="true" data-offset-key="1372:0" data-first-offset="true"><span class="se-1b4ceec3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">不要觉得 NoSQL 是大数据量的一个必然选择。</span></span></span></span><span data-slate-object="text" data-key="1373"><span data-slate-leaf="true" data-offset-key="1373:0" data-first-offset="true"><span data-slate-string="true">事实上，即便数据量增大，关系数据库有时也依然是一个选择。当然需要明确的是，通常单表在数据量增大时，会产生性能方面的问题，但是可以使用 Sharding 和 Partitioning 技术来缓和（扩展阅读中有这方面技术的介绍）；而数据可用性的问题，也可以使用集群加冗余技术来解决，当然，有得必有失，这种情况下，通常会牺牲一定程度的一致性。</span></span></span>
 </div>
 <div class="se-e24adf9c " data-slate-type="paragraph" data-slate-object="block" data-key="1374">
  <span data-slate-object="text" data-key="1375"><span data-slate-leaf="true" data-offset-key="1375:0" data-first-offset="true"><span data-slate-string="true">那么，这个数据量多大算大到关系数据库无法承担了呢？我可以给你一个事实，即微博和 Twitter 都是使用 MySQL 作为主要推文存储的（你可以参看扩展阅读中的文章），因此你可以看到在实际应用中，关系数据库对于特大数据量的支持也是有成功实践的。</span></span></span>
 </div>
 <div class="se-07301092 " data-slate-type="paragraph" data-slate-object="block" data-key="1376">
  <span data-slate-object="text" data-key="1377"><span data-slate-leaf="true" data-offset-key="1377:0" data-first-offset="true"><span class="se-45e04d74" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 是否具备明确的 schema 定义，是否需要支持关系查询和事务？如果有一项回答“是”，优先考虑关系数据库。</span></span></span></span>
 </div>
 <div class="se-3e96d933 " data-slate-type="paragraph" data-slate-object="block" data-key="1378">
  <span data-slate-object="text" data-key="1379"><span data-slate-leaf="true" data-offset-key="1379:0" data-first-offset="true"><span data-slate-string="true">关系数据库，首当其冲的特点就是“关系”。因此，可能会有朋友说，不对，电商网站的“商品”其实 schema 是不确定的啊——例如，服装一类商品，都有“尺寸”信息；而电器类呢，都有“功率”信息，这样特定类型的属性决定了商品很难被抽象成某一个统一的表啊。</span></span></span>
 </div>
 <div class="se-b1d0a958 " data-slate-type="paragraph" data-slate-object="block" data-key="1380">
  <span data-slate-object="text" data-key="1381"><span data-slate-leaf="true" data-offset-key="1381:0" data-first-offset="true"><span data-slate-string="true">没错，但是为什么要做到如此牵强的“统一”？通用的商品属性，例如厂家、商品唯一编号当然可以放到“统一”的商品表里面，但余下的信息还是可以根据商品类型放到各自类型的特定表里面，这就好像基类和派生类一样，抽象和统一只能做到某一个层次，层次太高反而不利于理解和维护。</span></span></span>
 </div>
 <div class="se-bc84130b " data-slate-type="paragraph" data-slate-object="block" data-key="1382">
  <span data-slate-object="text" data-key="1383"><span data-slate-leaf="true" data-offset-key="1383:0" data-first-offset="true"><span data-slate-string="true">对于一些需要事务的需求，例如订购，往往需要关系数据库的支持。当然，这只是多数情况，NoSQL 也有例外，即允许选择 CAP 中的 CP，具备强一致性且支持事务机制的，例如 DynamoDB。</span></span></span>
 </div>
 <div class="se-a59cd0fe " data-slate-type="paragraph" data-slate-object="block" data-key="1384">
  <span data-slate-object="text" data-key="1385"><span data-slate-leaf="true" data-offset-key="1385:0" data-first-offset="true"><span data-slate-string="true">而有一些系统和数据，则变化很大。比如用户数据，在多数情况下，schema 往往是比较明确的，而且数量上也没有订单等数据一般有特别大的伸缩性要求，因此往往也放到关系数据库里面；但是，在另外一些系统中，用户信息的组成不确定，或者说，schema 不确定，用户信息会放到 JSON 等松散结构的文本中，这种情况下文档数据库也是一个常见的选择；但是在搜索等某些相关功能的实现上，可能又会使用搜索引擎等不同于上面任一者的其它方式。</span></span></span>
 </div>
 <div class="se-e296f663 " data-slate-type="paragraph" data-slate-object="block" data-key="1386">
  <span data-slate-object="text" data-key="1387"><span data-slate-leaf="true" data-offset-key="1387:0" data-first-offset="true"><span class="se-9b44d3b4" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 如果符合结构不定（包括半结构化和无结构化）、高伸缩性、最终一致性、高性能（高吞吐量、高可用性、低时延等）的特点和要求，可以考虑非关系数据库。</span></span></span></span>
 </div>
 <div class="se-60bc4e4c " data-slate-type="paragraph" data-slate-object="block" data-key="1388">
  <span data-slate-object="text" data-key="1389"><span data-slate-leaf="true" data-offset-key="1389:0" data-first-offset="true"><span data-slate-string="true">简单来说，这时的具体技术选择，可以按照这样两个步骤来落地：</span></span></span>
 </div>
 <div class="se-8569bf8c" data-slate-type="list" data-slate-object="block" data-key="1390">
  <div class="se-c15eff32 se-4ecbcce5" data-slate-type="list-line" data-slate-object="block" data-key="1391">
   <span data-slate-object="text" data-key="1392"><span data-slate-leaf="true" data-offset-key="1392:0" data-first-offset="true"><span data-slate-string="true">如果你还记得 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1393" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1394"><span data-slate-leaf="true" data-offset-key="1394:0" data-first-offset="true"><span data-slate-string="true">[第 24 讲]</span></span></span></a><span data-slate-object="text" data-key="1395"><span data-slate-leaf="true" data-offset-key="1395:0" data-first-offset="true"><span data-slate-string="true"> 中介绍的那个 NoSQL 三角，根据一致性、可用性的要求，我们可以选择这个三角中的某一条边；</span></span></span>
  </div>
  <div class="se-33ffd660 se-65c57959" data-slate-type="list-line" data-slate-object="block" data-key="1396">
   <span data-slate-object="text" data-key="1397"><span data-slate-leaf="true" data-offset-key="1397:0" data-first-offset="true"><span data-slate-string="true">而在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1398" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1399"><span data-slate-leaf="true" data-offset-key="1399:0" data-first-offset="true"><span data-slate-string="true">[第 25 讲]</span></span></span></a><span data-slate-object="text" data-key="1400"><span data-slate-leaf="true" data-offset-key="1400:0" data-first-offset="true"><span data-slate-string="true"> 中则介绍了具体的 NoSQL 技术的分类和适用的问题类型，可以依其做进一步选择，比如根据数据结构化的程度，在那条边上，来进一步选择某一类 NoSQL 的存储技术。</span></span></span>
  </div>
 </div>
 <div class="se-b962dfeb " data-slate-type="paragraph" data-slate-object="block" data-key="1401">
  <span data-slate-object="text" data-key="1402"><span data-slate-leaf="true" data-offset-key="1402:0" data-first-offset="true"><span data-slate-string="true">比如说，这个电商问题中提到的媒体数据，即图片和视频，通常来说可用性更为重要，而这一类的大文件，没有内部的 schema，可以考虑使用擅长存放无结构大对象的文档型数据库。当然，也可以直接存放为文件，利用 CDN 的特性同步到离用户更近的节点去，特别对于视频来说，要提供好的用户体验，砸钱到 CDN 服务几乎是必选。</span></span></span>
 </div>
 <div class="se-b2d8a78e " data-slate-type="paragraph" data-slate-object="block" data-key="1403">
  <span data-slate-object="text" data-key="1404"><span data-slate-leaf="true" data-offset-key="1404:0" data-first-offset="true"><span data-slate-string="true">再比如，商品页在很大程度上都是可以缓存的，而缓存基本上都是为了保证可用性而会牺牲一定的一致性。除了上面介绍的 CDN 实现了对媒体内容的缓存以外，商品页本身，或是大部分区域的信息，都是可以利用 Memcached 等缓存服务缓存起来的。</span></span></span>
 </div>
 <h2 class="se-e66a8174" data-slate-type="heading" data-slate-object="block" data-key="1405"><span data-slate-object="text" data-key="1406"><span data-slate-leaf="true" data-offset-key="1406:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-d0e99c76 " data-slate-type="paragraph" data-slate-object="block" data-key="1407">
  <span data-slate-object="text" data-key="1408"><span data-slate-leaf="true" data-offset-key="1408:0" data-first-offset="true"><span data-slate-string="true">到这一章末尾，我们对于数据持久层的介绍就完结了。不妨来回顾一下，设计持久层，都有哪些需要考虑的方面呢？</span></span></span>
 </div>
 <div class="se-cb86d7ac " data-slate-type="paragraph" data-slate-object="block" data-key="1409">
  <span data-slate-object="text" data-key="1410"><span data-slate-leaf="true" data-offset-key="1410:0" data-first-offset="true"><span data-slate-string="true">首先，是代码层面的设计：</span></span></span>
 </div>
 <div class="se-512a1610" data-slate-type="list" data-slate-object="block" data-key="1411">
  <div class="se-0e1a6e24 se-bd4f6812" data-slate-type="list-line" data-slate-object="block" data-key="1412">
   <span data-slate-object="text" data-key="1413"><span data-slate-leaf="true" data-offset-key="1413:0" data-first-offset="true"><span data-slate-string="true">提供数据服务的设计，即 MVC 中模型层的设计，你可以阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1414" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1415"><span data-slate-leaf="true" data-offset-key="1415:0" data-first-offset="true"><span data-slate-string="true">[第 08 讲]</span></span></span></a><span data-slate-object="text" data-key="1416"><span data-slate-leaf="true" data-offset-key="1416:0" data-first-offset="true"><span data-slate-string="true"> 来复习回顾；</span></span></span>
  </div>
  <div class="se-9e7582b9 se-b39ca092" data-slate-type="list-line" data-slate-object="block" data-key="1417">
   <span data-slate-object="text" data-key="1418"><span data-slate-leaf="true" data-offset-key="1418:0" data-first-offset="true"><span data-slate-string="true">对于模型到关系数据库的映射（ORM）和技术选择，在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1419" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1420"><span data-slate-leaf="true" data-offset-key="1420:0" data-first-offset="true"><span data-slate-string="true">[第 12 讲]</span></span></span></a><span data-slate-object="text" data-key="1421"><span data-slate-leaf="true" data-offset-key="1421:0" data-first-offset="true"><span data-slate-string="true"> 的加餐部分有所介绍；</span></span></span>
  </div>
 </div>
 <div class="se-db1f59b8 " data-slate-type="paragraph" data-slate-object="block" data-key="1422">
  <span data-slate-object="text" data-key="1423"><span data-slate-leaf="true" data-offset-key="1423:0" data-first-offset="true"><span data-slate-string="true">其次，是系统层面的设计：</span></span></span>
 </div>
 <div class="se-0f86c164" data-slate-type="list" data-slate-object="block" data-key="1424">
  <div class="se-a39d972b se-354f906f" data-slate-type="list-line" data-slate-object="block" data-key="1425">
   <span data-slate-object="text" data-key="1426"><span data-slate-leaf="true" data-offset-key="1426:0" data-first-offset="true"><span data-slate-string="true">持久层内部或者持久层之上的缓存技术，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1427" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1428"><span data-slate-leaf="true" data-offset-key="1428:0" data-first-offset="true"><span data-slate-string="true">[第 21 讲]</span></span></span></a><span data-slate-object="text" data-key="1429"><span data-slate-leaf="true" data-offset-key="1429:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1430" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1431"><span data-slate-leaf="true" data-offset-key="1431:0" data-first-offset="true"><span data-slate-string="true">[第 22 讲]</span></span></span></a><span data-slate-object="text" data-key="1432"><span data-slate-leaf="true" data-offset-key="1432:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-44902d44 se-8993cd20" data-slate-type="list-line" data-slate-object="block" data-key="1433">
   <span data-slate-object="text" data-key="1434"><span data-slate-leaf="true" data-offset-key="1434:0" data-first-offset="true"><span data-slate-string="true">对于持久化的核心关注点之一 ——一致性，包括存储系统扩容的基础技术一致性哈希，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1435" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1436"><span data-slate-leaf="true" data-offset-key="1436:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="1437"><span data-slate-leaf="true" data-offset-key="1437:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-d5040a73 se-1e71a857" data-slate-type="list-line" data-slate-object="block" data-key="1438">
   <span data-slate-object="text" data-key="1439"><span data-slate-leaf="true" data-offset-key="1439:0" data-first-offset="true"><span data-slate-string="true">关于分布式数据存储涉及到的 CAP 理论和应用，以及相关的 ACID、BASE 原则，请参阅 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1440" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1441"><span data-slate-leaf="true" data-offset-key="1441:0" data-first-offset="true"><span data-slate-string="true">[第 24 讲]</span></span></span></a><span data-slate-object="text" data-key="1442"><span data-slate-leaf="true" data-offset-key="1442:0" data-first-offset="true"><span data-slate-string="true">；</span></span></span>
  </div>
  <div class="se-734debb1 se-f413bb1e" data-slate-type="list-line" data-slate-object="block" data-key="1443">
   <span data-slate-object="text" data-key="1444"><span data-slate-leaf="true" data-offset-key="1444:0" data-first-offset="true"><span data-slate-string="true">持久层存储技术的选择，你可以阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1445" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1446"><span data-slate-leaf="true" data-offset-key="1446:0" data-first-offset="true"><span data-slate-string="true">[第 25 讲]</span></span></span></a><span data-slate-object="text" data-key="1447"><span data-slate-leaf="true" data-offset-key="1447:0" data-first-offset="true"><span data-slate-string="true"> 来回顾，更进一步地，今天这一讲提供了一些具体问题实例和技术选择的思路。</span></span></span>
  </div>
 </div>
 <div class="se-ecb750dc " data-slate-type="paragraph" data-slate-object="block" data-key="1448">
  <span data-slate-object="text" data-key="1449"><span data-slate-leaf="true" data-offset-key="1449:0" data-first-offset="true"><span data-slate-string="true">希望通过这些内容的学习，你的持久层部分的知识，可以形成体系，而非零零散散的一个个孤岛。</span></span></span>
 </div>
 <div class="se-c4e9094e " data-slate-type="paragraph" data-slate-object="block" data-key="1450">
  <span data-slate-object="text" data-key="1451"><span data-slate-leaf="true" data-offset-key="1451:0" data-first-offset="true"><span class="se-de40cc0a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">最后，在这里我留一下今天的作业，这是一个开放性的思考题：</span></span></span></span>
 </div>
 <div class="se-a1174733 " data-slate-type="paragraph" data-slate-object="block" data-key="1452">
  <span data-slate-object="text" data-key="1453"><span data-slate-leaf="true" data-offset-key="1453:0" data-first-offset="true"><span data-slate-string="true">假如说，你要实现一个简化了的微信聊天功能，用户可以一对一聊天，也可以加好友，那么，你该怎么选择技术，并怎样设计持久层呢？</span></span></span>
 </div>
 <div class="se-df107d4f " data-slate-type="paragraph" data-slate-object="block" data-key="1454">
  <span data-slate-object="text" data-key="1455"><span data-slate-leaf="true" data-offset-key="1455:0" data-first-offset="true"><span data-slate-string="true">好，今天的内容就到这里，希望你在阅读后能有所收获。关于本章的内容，如果有想法，欢迎和我讨论。</span></span></span>
 </div>
 <h2 class="se-662c4477" data-slate-type="heading" data-slate-object="block" data-key="1456"><span data-slate-object="text" data-key="1457"><span data-slate-leaf="true" data-offset-key="1457:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-52cb61f5" data-slate-type="list" data-slate-object="block" data-key="1458">
  <div class="se-e4a7dd32 se-0e0c4d0d" data-slate-type="list-line" data-slate-object="block" data-key="1459">
   <span data-slate-object="text" data-key="1460"><span data-slate-leaf="true" data-offset-key="1460:0" data-first-offset="true"><span data-slate-string="true">文中介绍了倒排索引，感兴趣的话你可以进一步阅读</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1461" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1462"><span data-slate-leaf="true" data-offset-key="1462:0" data-first-offset="true"><span data-slate-string="true">搜索引擎是如何设计倒排索引的？</span></span></span></a>
  </div>
  <div class="se-9663a5f7 se-99b195ec" data-slate-type="list-line" data-slate-object="block" data-key="1463">
   <span data-slate-object="text" data-key="1464"><span data-slate-leaf="true" data-offset-key="1464:0" data-first-offset="true"><span data-slate-string="true">文中介绍了 GeoHash，在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1465" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1466"><span data-slate-leaf="true" data-offset-key="1466:0" data-first-offset="true"><span data-slate-string="true">geohash.org</span></span></span></a><span data-slate-object="text" data-key="1467"><span data-slate-leaf="true" data-offset-key="1467:0" data-first-offset="true"><span data-slate-string="true"> 的网站上，可以通过给出经纬度坐标，在地图上找到这个实际位置。感兴趣的话，还可以进一步了解：本质上，类似这种二维到一维的降维方式，都属于</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1468" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1469"><span data-slate-leaf="true" data-offset-key="1469:0" data-first-offset="true"><span data-slate-string="true">空间填充曲线</span></span></span></a><span data-slate-object="text" data-key="1470"><span data-slate-leaf="true" data-offset-key="1470:0" data-first-offset="true"><span data-slate-string="true"> ，比如说最有名的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1471" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1472"><span data-slate-leaf="true" data-offset-key="1472:0" data-first-offset="true"><span data-slate-string="true">希尔伯特曲线</span></span></span></a><span data-slate-object="text" data-key="1473"><span data-slate-leaf="true" data-offset-key="1473:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-02e74671 se-38ea89df" data-slate-type="list-line" data-slate-object="block" data-key="1474">
   <span data-slate-object="text" data-key="1475"><span data-slate-leaf="true" data-offset-key="1475:0" data-first-offset="true"><span data-slate-string="true">Sharding 和 Partitioning 是在数据库中常见的“拆分”方式，文中也提到了，但是这两个概念经常被混用，具体含义你可以参考维基百科 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1476" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1477"><span data-slate-leaf="true" data-offset-key="1477:0" data-first-offset="true"><span data-slate-string="true">Shard</span></span></span></a><span data-slate-object="text" data-key="1478"><span data-slate-leaf="true" data-offset-key="1478:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1479" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1480"><span data-slate-leaf="true" data-offset-key="1480:0" data-first-offset="true"><span data-slate-string="true">Partition</span></span></span></a><span data-slate-object="text" data-key="1481"><span data-slate-leaf="true" data-offset-key="1481:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-e8a3342d se-bceb1beb" data-slate-type="list-line" data-slate-object="block" data-key="1482">
   <span data-slate-object="text" data-key="1483"><span data-slate-leaf="true" data-offset-key="1483:0" data-first-offset="true"><span data-slate-string="true">有一篇介绍 Twitter 怎样应用推、拉模式，处理和存储消息，应对高访问量的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1484" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1485"><span data-slate-leaf="true" data-offset-key="1485:0" data-first-offset="true"><span data-slate-string="true">文章</span></span></span></a><span data-slate-object="text" data-key="1486"><span data-slate-leaf="true" data-offset-key="1486:0" data-first-offset="true"><span data-slate-string="true">，相应的，微博的技术专家也写了一篇文章来介绍微博的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1487" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="1488"><span data-slate-leaf="true" data-offset-key="1488:0" data-first-offset="true"><span data-slate-string="true">处理方式</span></span></span></a><span data-slate-object="text" data-key="1489"><span data-slate-leaf="true" data-offset-key="1489:0" data-first-offset="true"><span data-slate-string="true">，你可以比较阅读。</span></span></span>
  </div>
 </div>
 <div class="se-4239c344" data-slate-type="image" data-slate-object="block" data-key="1490">
  <img class="se-83bd74b6" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |21          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:45:38.299 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=21 
 {executed in 0 msec}
2020-11-19 17:45:38.300 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title              |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|
|21  |1605755536 |1605755536 |1                |zh-hans  |0       |1                             |1      |0      |26丨设计数据持久层（下）：案例介绍 |book |1   |21  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|

2020-11-19 17:45:38.301 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=21 
 {executed in 1 msec}
2020-11-19 17:45:38.301 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title              |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|
|[unread] |1605755536 |1605755536 |1                |zh-hans  |0       |1                             |1      |0      |26丨设计数据持久层（下）：案例介绍 |1   |21  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|

2020-11-19 17:45:38.304 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779138, created=1605779138, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='26丨设计数据持久层（下）：案例介绍', 
type='book', uid=1, vid=21 where nid=21 
 {executed in 0 msec}
2020-11-19 17:45:38.305 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779138, created=1605779138, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='26丨设计数据持久层（下）：案例介绍', 
uid=1, vid=21 where nid=21 
 {executed in 0 msec}
2020-11-19 17:45:38.311 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.312 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |revision_id |
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|21        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/69831b6ffd61a77bbf8928aeb000e6ab?bkt=en-e031c0692dcd5a217b3dbdf932e2c981a54940cf40121a2082791018387bbb0c2cada7fdba81ea12&fid=3757516097-778750-51115534142328&time=1605755534&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-zVGpVtjq9o2VIZm5bC1VMExmnpI%3D&to=92&size=16747028&sta_dx=16747028&sta_cs=3360&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482234&mtime=1605754779&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16747028&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6f1d6e25542ebceb28f486fba5b6b268039114e57ac3075ca4c68a1997fff52def8d6c39aab6c654&sl=76480590&expires=8h&rt=pr&r=650360059&mlogid=7502109159607608419&vbdid=2247232042&fin=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a&bflag=92,34-92&rtype=1&dp-logid=7502109159607608419&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=f042c2604f2a31c54a1db07bd0e257e8c1ad0963b01caba7&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a |21          |
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:45:38.316 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/69831b6ffd61a77bbf8928aeb000e6ab?bkt=en-e031c0692dcd5a217b3dbdf932e2c981a54940cf40121a2082791018387bbb0c2cada7fdba81ea12&fid=3757516097-778750-998823858358372&time=1605779136&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2BFbLpx028i%2BHpcpaAh29Cb%2BE3Dg%3D&to=92&size=16747028&sta_dx=16747028&sta_cs=3364&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482234&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16747028&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6f1d6e25542ebceb28f486fba5b6b268039114e57ac3075ca4c68a1997fff52def8d6c39aab6c654&sl=76480590&expires=8h&rt=pr&r=175539442&mlogid=7508444640915882087&vbdid=2247232042&fin=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a&bflag=92,34-92&rtype=1&dp-logid=7508444640915882087&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=2a4e4e2e8357dfbe2a4d1434a1bf6e9ea3bce1a9a23636c4&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a', 
revision_id=21 where entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.320 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.321 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |revision_id |
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/69831b6ffd61a77bbf8928aeb000e6ab?bkt=en-e031c0692dcd5a217b3dbdf932e2c981a54940cf40121a2082791018387bbb0c2cada7fdba81ea12&fid=3757516097-778750-51115534142328&time=1605755534&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-zVGpVtjq9o2VIZm5bC1VMExmnpI%3D&to=92&size=16747028&sta_dx=16747028&sta_cs=3360&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482234&mtime=1605754779&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16747028&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6f1d6e25542ebceb28f486fba5b6b268039114e57ac3075ca4c68a1997fff52def8d6c39aab6c654&sl=76480590&expires=8h&rt=pr&r=650360059&mlogid=7502109159607608419&vbdid=2247232042&fin=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a&bflag=92,34-92&rtype=1&dp-logid=7502109159607608419&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=f042c2604f2a31c54a1db07bd0e257e8c1ad0963b01caba7&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a |21          |
|----------|-------|------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:45:38.324 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/69831b6ffd61a77bbf8928aeb000e6ab?bkt=en-e031c0692dcd5a217b3dbdf932e2c981a54940cf40121a2082791018387bbb0c2cada7fdba81ea12&fid=3757516097-778750-998823858358372&time=1605779136&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2BFbLpx028i%2BHpcpaAh29Cb%2BE3Dg%3D&to=92&size=16747028&sta_dx=16747028&sta_cs=3364&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482234&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16747028&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6f1d6e25542ebceb28f486fba5b6b268039114e57ac3075ca4c68a1997fff52def8d6c39aab6c654&sl=76480590&expires=8h&rt=pr&r=175539442&mlogid=7508444640915882087&vbdid=2247232042&fin=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a&bflag=92,34-92&rtype=1&dp-logid=7508444640915882087&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=2a4e4e2e8357dfbe2a4d1434a1bf6e9ea3bce1a9a23636c4&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=26%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D.m4a', 
revision_id=21 where entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.328 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.329 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|21        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>靠人品去赢</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-08
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    其实类似微信的通讯工具，他会在你本地有个类似NoSQL的东西，搜个关键字什么的都支持，但是你发现你要找更久的，他会弹出一个框，你可以设置日期其实这个最后要走的关系型数据库去查询。毕竟大家都把NoSQL作为自己的中间件，提高响应缓冲服务器压力之类的，到最后数据还是要乖乖的存在MySQL这些关系型数据库。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-08
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    关于老师今天的题目给出两种答案：
    <br>一种是文档型数据库mongodb。虽然是NOSQL阵营，但是其支持类SQL且用的是JSON，而现在mysql5.7开始的版本用sql，但是支持JSON；主要是文档型数据库适合这种场景；
    <br>另外一种方式就是redis+MySQL：其原因不言而喻了，太多类似方式了
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |21          |
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:45:38.333 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.334 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>靠人品去赢</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-08
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    其实类似微信的通讯工具，他会在你本地有个类似NoSQL的东西，搜个关键字什么的都支持，但是你发现你要找更久的，他会弹出一个框，你可以设置日期其实这个最后要走的关系型数据库去查询。毕竟大家都把NoSQL作为自己的中间件，提高响应缓冲服务器压力之类的，到最后数据还是要乖乖的存在MySQL这些关系型数据库。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-08
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    关于老师今天的题目给出两种答案：
    <br>一种是文档型数据库mongodb。虽然是NOSQL阵营，但是其支持类SQL且用的是JSON，而现在mysql5.7开始的版本用sql，但是支持JSON；主要是文档型数据库适合这种场景；
    <br>另外一种方式就是redis+MySQL：其原因不言而喻了，太多类似方式了
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |21          |
|----------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:45:38.338 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=21 
 {executed in 1 msec}
2020-11-19 17:45:38.338 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|21        |book   |0     |zh-hans  |21          |https://static001.geekbang.org/resource/image/00/83/00c71b7e18e2ce331b1554c56b761e83.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:45:38.341 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.342 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |21          |https://static001.geekbang.org/resource/image/00/83/00c71b7e18e2ce331b1554c56b761e83.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:45:38.345 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.346 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |21          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:45:38.350 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=21 
 {executed in 0 msec}
2020-11-19 17:45:38.350 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |21          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:45:38.353 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='621380814168731' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:45:38.354 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:46:27.834 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='621380814168731' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:46:27.834 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:46:27.835 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('621380814168731', 1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:46:27.835 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('621380814168731', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:46:27.835 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|35            |
|--------------|

2020-11-19 17:46:27.848 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='621380814168731' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:46:27.848 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:46:28.253 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='621380814168731' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:46:28.254 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:46:28.255 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('621380814168731', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:46:28.256 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('621380814168731', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:46:28.257 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|36            |
|--------------|

2020-11-19 17:46:28.271 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='621380814168731' 
 {executed in 0 msec}
2020-11-19 17:46:28.272 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|22        |book   |0     |621380814168731  |zh-hans  |22          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:46:28.273 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=22 
 {executed in 0 msec}
2020-11-19 17:46:28.274 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|22  |zh-hans  |book |60eba5ed-5ae9-457c-ba43-ac163987e306 |22  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:46:28.280 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=22 
 {executed in 1 msec}
2020-11-19 17:46:28.281 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |621380814168731  |zh-hans  |22          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:46:28.286 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=22 
 {executed in 0 msec}
2020-11-19 17:46:28.287 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|22  |1   |3     |0            |1  |19 |22 |0  |0  |19  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:46:28.292 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=22 
 {executed in 1 msec}
2020-11-19 17:46:28.304 INFO  jdbc.resultsettable Line:610 - 
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|22        |<div data-slate-editor="true" data-key="467" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-4c683b7a " data-slate-type="paragraph" data-slate-object="block" data-key="468">
  <span data-slate-object="text" data-key="469"><span data-slate-leaf="true" data-offset-key="469:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-4699f57b " data-slate-type="paragraph" data-slate-object="block" data-key="470">
  <span data-slate-object="text" data-key="471"><span data-slate-leaf="true" data-offset-key="471:0" data-first-offset="true"><span data-slate-string="true">在基于 Web 的全栈技术下，每一层的设计都有共同点，当然，也有各自的特殊之处。你可以回想一下，我们曾经在第一章谈到的客户端和服务端交互以及 Web API 的设计，在第三章谈到的前端的设计，在第二章谈到的服务端 MVC 各层的设计，从前到后。那么，本章余下的内容，我们就来让整个设计层面上的体系变得完整，讲一讲最后面一层的数据持久层怎样设计。</span></span></span>
 </div>
 <div class="se-20d6ea08 " data-slate-type="paragraph" data-slate-object="block" data-key="472">
  <span data-slate-object="text" data-key="473"><span data-slate-leaf="true" data-offset-key="473:0" data-first-offset="true"><span data-slate-string="true">持久层的设计包括持久化框架选择、持久层代码设计，以及存储技术选型等等，考虑到这其中有部分内容我们在第二章谈论 MVC 模型层的时候已经讲到过了，那么在这一讲和下一讲中，我就会先偏重于持久层的数据存储技术本身，再结合实际的设计案例来介绍怎样选择合适的技术来解决那些经典的实际问题。</span></span></span>
 </div>
 <h2 class="se-3e0c1df4" data-slate-type="heading" data-slate-object="block" data-key="474"><span data-slate-object="text" data-key="475"><span data-slate-leaf="true" data-offset-key="475:0" data-first-offset="true"><span data-slate-string="true">关系数据库</span></span></span></h2>
 <div class="se-459be200 " data-slate-type="paragraph" data-slate-object="block" data-key="476">
  <span data-slate-object="text" data-key="477"><span data-slate-leaf="true" data-offset-key="477:0" data-first-offset="true"><span data-slate-string="true">关系数据库就是以“关系模型”为基础而建立的数据库，这里的关系模型说的是数据可以通过数学上的关系表示和关联起来，也就是说，关系模型最终可以通过二维表格的结构来表达。关系数据库除了带来了明确的 schema 和关系以外，还带来了对事务的支持，也就是对于强一致性的支持。</span></span></span>
 </div>
 <h3 class="se-a0b0804c" data-slate-type="heading" data-slate-object="block" data-key="478"><span data-slate-object="text" data-key="479"><span data-slate-leaf="true" data-offset-key="479:0" data-first-offset="true"><span data-slate-string="true">数据库范式</span></span></span></h3>
 <div class="se-13ead61a " data-slate-type="paragraph" data-slate-object="block" data-key="480">
  <span data-slate-object="text" data-key="481"><span data-slate-leaf="true" data-offset-key="481:0" data-first-offset="true"><span data-slate-string="true">数据库的表设计，可以说是全栈工程师经常需要面对的问题。而这部分，其实是有“套路”可循的，其中一些常见的规范要求，就被总结为不同的“范式”（Normal Form）。它可以说是数据库表设计的基础，对于数据库表设计很有实际的指导意义。我注意到有很多程序员朋友都不太清楚不同范式的实际含义，那么今天，就请让我通过一个尽可能简单的图书管理系统的例子，来把它讲清楚。</span></span></span>
 </div>
 <div class="se-0010ca9f " data-slate-type="paragraph" data-slate-object="block" data-key="482">
  <span data-slate-object="text" data-key="483"><span data-slate-leaf="true" data-offset-key="483:0" data-first-offset="true"><span class="se-6cf15ec5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 第一范式（1 NF）</span></span></span></span>
 </div>
 <div class="se-63f48f2a " data-slate-type="paragraph" data-slate-object="block" data-key="484">
  <span data-slate-object="text" data-key="485"><span data-slate-leaf="true" data-offset-key="485:0" data-first-offset="true"><span class="se-400eb895" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一范式要求每个属性值都是不可再分的。</span></span></span></span><span data-slate-object="text" data-key="486"><span data-slate-leaf="true" data-offset-key="486:0" data-first-offset="true"><span data-slate-string="true">满足 1NF 的关系被称为规范化的关系，1NF 也是关系模式应具备的最起码的条件。比如下面这样的 Books 表：</span></span></span>
 </div>
 <div class="se-4a73075a" data-slate-type="image" data-slate-object="block" data-key="487">
  <img class="se-92583f1c" src="https://static001.geekbang.org/resource/image/c3/e0/c3e7821cd54c491b0aff7e12026573e0.jpg">
 </div>
 <div class="se-732158d6 " data-slate-type="paragraph" data-slate-object="block" data-key="488">
  <span data-slate-object="text" data-key="489"><span data-slate-leaf="true" data-offset-key="489:0" data-first-offset="true"><span data-slate-string="true">你看，在上面这张表中，有两本书重名了，都叫“Life”，但是国际标准书号 ISBN 是不同的。放在了同一个属性 ISBN 中，并非不可再分，这显然违反了第一范式。那解决这个问题的办法就是拆分：</span></span></span>
 </div>
 <div class="se-031d56f2" data-slate-type="image" data-slate-object="block" data-key="490">
  <img class="se-2815cafa" src="https://static001.geekbang.org/resource/image/60/9a/60bb114c4dfe64f3341c34cc4b0b859a.jpg">
 </div>
 <div class="se-d7072796 " data-slate-type="paragraph" data-slate-object="block" data-key="491">
  <span data-slate-object="text" data-key="492"><span data-slate-leaf="true" data-offset-key="492:0" data-first-offset="true"><span class="se-471d924a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 第二范式（2 NF）</span></span></span></span>
 </div>
 <div class="se-73b52486 " data-slate-type="paragraph" data-slate-object="block" data-key="493">
  <span data-slate-object="text" data-key="494"><span data-slate-leaf="true" data-offset-key="494:0" data-first-offset="true"><span class="se-84a10c1c" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二范式要求去除局部依赖。</span></span></span></span><span data-slate-object="text" data-key="495"><span data-slate-leaf="true" data-offset-key="495:0" data-first-offset="true"><span data-slate-string="true">也就是说，表中的属性完全依赖于全部主键，而不是部分主键。</span></span></span>
 </div>
 <div class="se-19443d70" data-slate-type="image" data-slate-object="block" data-key="496">
  <img class="se-ca8b0007" src="https://static001.geekbang.org/resource/image/80/fe/803754244fa279d784a6af203d74fdfe.jpg">
 </div>
 <div class="se-ba84dac4 " data-slate-type="paragraph" data-slate-object="block" data-key="497">
  <span data-slate-object="text" data-key="498"><span data-slate-leaf="true" data-offset-key="498:0" data-first-offset="true"><span data-slate-string="true">你看，在上面这张表中，原本的设计是想让 BOOK_ID 和 AUTHOR_ID 组成联合主键，但是，BOOK_NAME 仅仅依赖于部分主键 BOOK_ID，而 AUTHOR_NAME 也仅仅依赖于部分主键 AUTHOR_ID，违背了第二范式 。解决的办法依然是拆分，把这个可以独立被依赖的部分主键拿出去，上面的表可以拆成下面这样两张表：</span></span></span>
 </div>
 <div class="se-91ed7888" data-slate-type="image" data-slate-object="block" data-key="499">
  <img class="se-fea73ba2" src="https://static001.geekbang.org/resource/image/9d/cb/9d6f9f22b2b5feab01cd6ea1de9582cb.jpg">
 </div>
 <div class="se-0753e8df" data-slate-type="image" data-slate-object="block" data-key="500">
  <img class="se-f104e218" src="https://static001.geekbang.org/resource/image/98/c3/9874e9af23ebd64c5278654a78cfacc3.jpg">
 </div>
 <div class="se-99ac8501 " data-slate-type="paragraph" data-slate-object="block" data-key="501">
  <span data-slate-object="text" data-key="502"><span data-slate-leaf="true" data-offset-key="502:0" data-first-offset="true"><span data-slate-string="true">从这个拆分中我们也可以看到，原表被拆成了 N 对 1 关系的两个表，而被不合范式依赖的那个“部分主键”，变成了“1”这头的主键。</span></span></span>
 </div>
 <div class="se-1530cf40 " data-slate-type="paragraph" data-slate-object="block" data-key="503">
  <span data-slate-object="text" data-key="504"><span data-slate-leaf="true" data-offset-key="504:0" data-first-offset="true"><span class="se-161efc41" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 第三范式（3 NF）</span></span></span></span>
 </div>
 <div class="se-31b179f4 " data-slate-type="paragraph" data-slate-object="block" data-key="505">
  <span data-slate-object="text" data-key="506"><span data-slate-leaf="true" data-offset-key="506:0" data-first-offset="true"><span class="se-a3a9814f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第三范式要求去除非主属性的传递依赖。</span></span></span></span><span data-slate-object="text" data-key="507"><span data-slate-leaf="true" data-offset-key="507:0" data-first-offset="true"><span data-slate-string="true">即在第二范式的基础上，非主属性必须直接依赖于主键，而不能传递依赖于主键。</span></span></span>
 </div>
 <div class="se-2ad5ef85" data-slate-type="image" data-slate-object="block" data-key="508">
  <img class="se-5df8d228" src="https://static001.geekbang.org/resource/image/88/29/889a89fd92fab3a818aae622f3655e29.jpg">
 </div>
 <div class="se-b75bf620 " data-slate-type="paragraph" data-slate-object="block" data-key="509">
  <span data-slate-object="text" data-key="510"><span data-slate-leaf="true" data-offset-key="510:0" data-first-offset="true"><span data-slate-string="true">你看上面这张表，主键是 BOOK_ID，而 CATEGORY_ID 是非关键字段，并非直接依赖于主键，而是通过这样的传递依赖：</span></span></span>
 </div>
 <div class="se-abef622b" data-slate-type="block-quote" data-slate-object="block" data-key="511">
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="512">
   <span data-slate-object="text" data-key="513"><span data-slate-leaf="true" data-offset-key="513:0" data-first-offset="true"><span data-slate-string="true">CATEGORY_NAME → CATEGORY_ID → BOOK_ID</span></span></span>
  </div>
 </div>
 <div class="se-591fbfd7 " data-slate-type="paragraph" data-slate-object="block" data-key="514">
  <span data-slate-object="text" data-key="515"><span data-slate-leaf="true" data-offset-key="515:0" data-first-offset="true"><span data-slate-string="true">因此，为了消除这个传递依赖，我们还是拆表，让这个传递链中间的非关键字段自立门户：</span></span></span>
 </div>
 <div class="se-34354de5" data-slate-type="image" data-slate-object="block" data-key="516">
  <img class="se-cd6306d9" src="https://static001.geekbang.org/resource/image/ec/4f/ec8cb2f6b80835e76d0631dcd1fe764f.jpg">
 </div>
 <div class="se-193ae5bc" data-slate-type="image" data-slate-object="block" data-key="517">
  <img class="se-c85a8824" src="https://static001.geekbang.org/resource/image/73/51/73c47a542f083d6b372056588dc10551.jpg">
 </div>
 <div class="se-e35cee36 " data-slate-type="paragraph" data-slate-object="block" data-key="518">
  <span data-slate-object="text" data-key="519"><span data-slate-leaf="true" data-offset-key="519:0" data-first-offset="true"><span data-slate-string="true">一般我们在设计中分析到第三范式就打住了，很少有情况会考虑更为严格的范式。例如，BC 范式和第三范式就很像，但是，第三范式只是消除了非主属性对主属性的传递依赖，而 BC 范式更进一步，要求消除主属性对主属性的传递依赖，从而，消除所有属性对主属性的传递依赖。</span></span></span>
 </div>
 <div class="se-ba489f11 " data-slate-type="paragraph" data-slate-object="block" data-key="520">
  <span data-slate-object="text" data-key="521"><span data-slate-leaf="true" data-offset-key="521:0" data-first-offset="true"><span data-slate-string="true">当然，还有第四、第五范式等等，要求更加严格，解耦更加彻底，但却不太常用了，如果你想进一步了解，可以参阅维基百科的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="522" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="523"><span data-slate-leaf="true" data-offset-key="523:0" data-first-offset="true"><span data-slate-string="true">词条</span></span></span></a><span data-slate-object="text" data-key="524"><span data-slate-leaf="true" data-offset-key="524:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
 </div>
 <div class="se-45d68fc3 " data-slate-type="paragraph" data-slate-object="block" data-key="525">
  <span data-slate-object="text" data-key="526"><span data-slate-leaf="true" data-offset-key="526:0" data-first-offset="true"><span data-slate-string="true">范式的程度更高，冗余度便更低。但正如同我们在第二章介绍的“拆分”大法一样，每一次范式的升级都意味着一个拆表的过程，一旦过度解耦，拆分出太多零散的表，对于程序员的理解，脑海中数据模型的建立，甚至包括联表操作的 I/O 性能，都是不利的。因此我们需要“权衡”，掌握好这个度，</span></span></span><span data-slate-object="text" data-key="527"><span data-slate-leaf="true" data-offset-key="527:0" data-first-offset="true"><span class="se-a9197cbc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这一原则，和我们介绍过的分层设计是一致的。</span></span></span></span>
 </div>
 <h2 class="se-c21a1d6a" data-slate-type="heading" data-slate-object="block" data-key="528"><span data-slate-object="text" data-key="529"><span data-slate-leaf="true" data-offset-key="529:0" data-first-offset="true"><span data-slate-string="true">NoSQL</span></span></span></h2>
 <div class="se-86fbcce6 " data-slate-type="paragraph" data-slate-object="block" data-key="530">
  <span data-slate-object="text" data-key="531"><span data-slate-leaf="true" data-offset-key="531:0" data-first-offset="true"><span data-slate-string="true">在上一讲中，我已经介绍了 NoSQL 的概念。在 NoSQL 出现以前，设计大型网站等 Web 应用的时候，全栈工程师的武器库里可供使用的选择，要局限得多。尤其是对一些量大且非结构化的数据，缺乏特别理想的解决方法，工程师有时不得不采用一些非常规的特殊方案，而更多时候我们只能在传统关系数据库的基础上，使用数据库的 Sharding 和 Partition 这样的操作。</span></span></span>
 </div>
 <div class="se-a372041d " data-slate-type="paragraph" data-slate-object="block" data-key="532">
  <span data-slate-object="text" data-key="533"><span data-slate-leaf="true" data-offset-key="533:0" data-first-offset="true"><span data-slate-string="true">虽然那时候在数据规模上面临的挑战远没有现在大，可那个时候 DBA（Database Administrator）在市场上可以说是炙手可热，一旦出了问题，有时甚至还得请专门的数据库厂商的专家，这其中的费用极其高昂，是以分钟计算的。</span></span></span>
 </div>
 <div class="se-202d657f " data-slate-type="paragraph" data-slate-object="block" data-key="534">
  <span data-slate-object="text" data-key="535"><span data-slate-leaf="true" data-offset-key="535:0" data-first-offset="true"><span data-slate-string="true">如今，你可能听说过许多互联网企业去 IOE 的故事（IOE 指的是 IBM 的小型机、Oracle 数据库、EMC 存储设备这三者），其中阿里巴巴的版本听起来还颇为传奇。事实上，这可不只是只有国内的阿里巴巴曾经努力做的事情，还是全球许多大型互联网企业都曾经或正在做的事情，也包括 Amazon。我曾经在 Amazon 的销量预测团队中工作，当时我们团队可以说就在整个亚马逊最大的传统（非云上）关系数据库上工作，里面存放了全部商品库存、销量等有关的信息。</span></span></span>
 </div>
 <div class="se-24eea97f " data-slate-type="paragraph" data-slate-object="block" data-key="536">
  <span data-slate-object="text" data-key="537"><span data-slate-leaf="true" data-offset-key="537:0" data-first-offset="true"><span data-slate-string="true">Web 2.0 时代的到来，为互联网应用带来了深远的影响，</span></span></span><span data-slate-object="text" data-key="538"><span data-slate-leaf="true" data-offset-key="538:0" data-first-offset="true"><span class="se-3edd519e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">用户代替传统媒体，成为了 Web 2.0 时代主要的数据制造者。海量、不定结构、弱关联关系、高可用性和低一致性要求的数据特点，让关系数据库力不从心；而 NoSQL 则具有更好的横向扩展性、海量数据支持、易维护和廉价等等优势，犹如一剂特效药，成为了市场上这个数据难题的大杀器。</span></span></span></span>
 </div>
 <div class="se-3de9d264 " data-slate-type="paragraph" data-slate-object="block" data-key="539">
  <span data-slate-object="text" data-key="540"><span data-slate-leaf="true" data-offset-key="540:0" data-first-offset="true"><span data-slate-string="true">当然，现实中依然存在大量需要强一致性和关系查询的业务场景，因此关系数据库依然是我们倚赖的重要工具。可是，</span></span></span><span data-slate-object="text" data-key="541"><span data-slate-leaf="true" data-offset-key="541:0" data-first-offset="true"><span class="se-72b7de94" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">依然使用关系数据库并不代表依然靠互联网企业自己亲力亲为地做繁重的数据库管理工作</span></span></span></span><span data-slate-object="text" data-key="542"><span data-slate-leaf="true" data-offset-key="542:0" data-first-offset="true"><span data-slate-string="true">，关系数据库云服务的崛起将传统的数据库管理工作自动化，于是普通的软件工程师也可以完成以往 DBA 才能完成的工作了。从这里也能看出，DBA 也确实是一个技术变更影响技术人才市场需求的典型例子。</span></span></span>
 </div>
 <div class="se-3fb47d43 " data-slate-type="paragraph" data-slate-object="block" data-key="543">
  <span data-slate-object="text" data-key="544"><span data-slate-leaf="true" data-offset-key="544:0" data-first-offset="true"><span data-slate-string="true">综上，这个数据的问题就有了两个层次的解决方案：</span></span></span>
 </div>
 <div class="se-0f6e180b" data-slate-type="list" data-slate-object="block" data-key="545">
  <div class="se-eed21a15 se-351625cf" data-slate-type="list-line" data-slate-object="block" data-key="546">
   <span data-slate-object="text" data-key="547"><span data-slate-leaf="true" data-offset-key="547:0" data-first-offset="true"><span data-slate-string="true">出现了更适合业务的非关系数据库服务，也就是 NoSQL；</span></span></span>
  </div>
  <div class="se-84132874 se-55764645" data-slate-type="list-line" data-slate-object="block" data-key="548">
   <span data-slate-object="text" data-key="549"><span data-slate-leaf="true" data-offset-key="549:0" data-first-offset="true"><span data-slate-string="true">把关系数据库搬到云上，从而让互联网企业从繁重的数据库管理工作中解脱出来，例如 RDS。</span></span></span>
  </div>
 </div>
 <h3 class="se-77a017c4" data-slate-type="heading" data-slate-object="block" data-key="550"><span data-slate-object="text" data-key="551"><span data-slate-leaf="true" data-offset-key="551:0" data-first-offset="true"><span data-slate-string="true">NoSQL 数据库的分类</span></span></span></h3>
 <div class="se-aa8e2306 " data-slate-type="paragraph" data-slate-object="block" data-key="552">
  <span data-slate-object="text" data-key="553"><span data-slate-leaf="true" data-offset-key="553:0" data-first-offset="true"><span data-slate-string="true">别看 NoSQL 的数据库那么多，它们大致可以被分为这样几类，每一类也都有自己的优势和劣势。在介绍每一类的时候，我会以我比较熟悉的 AWS 上的实现来具体介绍，当然，很可能你见过的是其它的例子（比如非云上的本地版本，再比如不同的云服务厂商都会提供自己的实现），但在原理层面都是类似的。</span></span></span>
 </div>
 <div class="se-421ee8bf " data-slate-type="paragraph" data-slate-object="block" data-key="554">
  <span data-slate-object="text" data-key="555"><span data-slate-leaf="true" data-offset-key="555:0" data-first-offset="true"><span class="se-31c1284b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 键值（Key-value）数据库</span></span></span></span>
 </div>
 <div class="se-e9c7a7f4 " data-slate-type="paragraph" data-slate-object="block" data-key="556">
  <span data-slate-object="text" data-key="557"><span data-slate-leaf="true" data-offset-key="557:0" data-first-offset="true"><span data-slate-string="true">这一类 NoSQL 的数据库，采用的是 key-value 这样的访问模型，也就是说，可以根据一个唯一的 key 来获取所需要的值，这个 key 被称为主键，而这个根据 key 来获取 value 的访问的过程是通过 Hash 算法来实现的。本地的 Redis 或者云上的 DynamoDB 都属于这一类。</span></span></span>
 </div>
 <div class="se-2a36e0a1 " data-slate-type="paragraph" data-slate-object="block" data-key="558">
  <span data-slate-object="text" data-key="559"><span data-slate-leaf="true" data-offset-key="559:0" data-first-offset="true"><span data-slate-string="true">以 DynamoDB 为例，它的 key 由 Partition Key 和 Sort Key 两级组成，即前者用来找到数据存在哪一个存储单元（Storage Unit），而后者用来找到 value 在存储单元上的具体位置。通常来说，这个二级 Hash 的过程时间开销并不会随着数据量的增大而增大，下图来自</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="560" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="561"><span data-slate-leaf="true" data-offset-key="561:0" data-first-offset="true"><span data-slate-string="true">官方的 Blog</span></span></span></a><span data-slate-object="text" data-key="562"><span data-slate-leaf="true" data-offset-key="562:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span>
 </div>
 <div class="se-dd1fb50f" data-slate-type="image" data-slate-object="block" data-key="563">
  <img class="se-cc46a08c" src="https://static001.geekbang.org/resource/image/6e/b3/6e087df74ef924619966e74fdcd0f5b3.jpg">
 </div>
 <div class="se-25f12bab " data-slate-type="paragraph" data-slate-object="block" data-key="564">
  <span data-slate-object="text" data-key="565"><span data-slate-leaf="true" data-offset-key="565:0" data-first-offset="true"><span data-slate-string="true">DynamoDB 表结构看起来和传统的关系数据库有些像，并且每一行的 schema 可以完全不同，即“列”可以是任意的。每张表的数据支持有限的范围查询，包括主键的范围查询，以及索引列的范围查询。其中，索引的数量是有着明确限制的，一种是全局的（相当于 Partition Key + Sort Key），每张表上限 20 个；一种是本地的（相当于 Partition Key 已经确定，只通过 Sort Key 索引），每张表上限 5 个。</span></span></span>
 </div>
 <div class="se-ec5b7687 " data-slate-type="paragraph" data-slate-object="block" data-key="566">
  <span data-slate-object="text" data-key="567"><span data-slate-leaf="true" data-offset-key="567:0" data-first-offset="true"><span class="se-34c1e2fc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 列式（Columnar）数据库</span></span></span></span>
 </div>
 <div class="se-9a4e72eb " data-slate-type="paragraph" data-slate-object="block" data-key="568">
  <span data-slate-object="text" data-key="569"><span data-slate-leaf="true" data-offset-key="569:0" data-first-offset="true"><span data-slate-string="true">经典的数据库是面向行的，即数据在存储的时候，每一行的数据是放在一起的，这样数据库在读取磁盘上连续数据的时候，实际每次可以一气读取若干行。如果需要完整地查询出特定某些行的数据，行数据库是高效的。且看下面的示例，来自 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="570" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="571"><span data-slate-leaf="true" data-offset-key="571:0" data-first-offset="true"><span data-slate-string="true">Redshift 官方文档</span></span></span></a><span data-slate-object="text" data-key="572"><span data-slate-leaf="true" data-offset-key="572:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span>
 </div>
 <div class="se-9616fb84" data-slate-type="image" data-slate-object="block" data-key="573">
  <img class="se-6ff49b22" src="https://static001.geekbang.org/resource/image/b1/1b/b1a304f40d3d8f006a3a1e79f663af1b.jpg">
 </div>
 <div class="se-92252cc5 " data-slate-type="paragraph" data-slate-object="block" data-key="574">
  <span data-slate-object="text" data-key="575"><span data-slate-leaf="true" data-offset-key="575:0" data-first-offset="true"><span data-slate-string="true">但是列式数据库不一样，它是将每一列的数据放在一起。这样的话，如果我们的处理逻辑是要求取出所有数据中的特定列，那么列数据库就是更好的选择：</span></span></span>
 </div>
 <div class="se-3b801bbd" data-slate-type="image" data-slate-object="block" data-key="576">
  <img class="se-98bf94ad" src="https://static001.geekbang.org/resource/image/68/0a/6827c62314d7a7dc40053a8d1ea7aa0a.jpg">
 </div>
 <div class="se-7735f5f9 " data-slate-type="paragraph" data-slate-object="block" data-key="577">
  <span data-slate-object="text" data-key="578"><span data-slate-leaf="true" data-offset-key="578:0" data-first-offset="true"><span data-slate-string="true">事实上，对于数据库来说，磁盘的读、写本身，往往还不是最慢的，最慢的是寻址操作。因此，无论是行数据库还是列数据库，如果根据实际需要，我们的实际访问能够从随机访问变成顺序访问，那么就可以极大地提高效率。在大数据处理中经常使用的 HBase 和云上的 Redshift 都属于这一类。</span></span></span>
 </div>
 <div class="se-e50a9e7b " data-slate-type="paragraph" data-slate-object="block" data-key="579">
  <span data-slate-object="text" data-key="580"><span data-slate-leaf="true" data-offset-key="580:0" data-first-offset="true"><span data-slate-string="true">和行数据库相比，列数据库还有一些其它的好处。比如说，对于很多数据来说，某一个特定列都是满足某种特定的格式的，那么列数据库就可以根据这种格式来执行特定的压缩操作。</span></span></span>
 </div>
 <div class="se-3e89d77d " data-slate-type="paragraph" data-slate-object="block" data-key="581">
  <span data-slate-object="text" data-key="582"><span data-slate-leaf="true" data-offset-key="582:0" data-first-offset="true"><span class="se-9a05d129" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 文档（Document）数据库</span></span></span></span>
 </div>
 <div class="se-752a59f9 " data-slate-type="paragraph" data-slate-object="block" data-key="583">
  <span data-slate-object="text" data-key="584"><span data-slate-leaf="true" data-offset-key="584:0" data-first-offset="true"><span data-slate-string="true">文档数据库是前面提到的键值数据库的演化版，值是以某一种特定的文档格式来存储的，比如 JSON、XML 等等。也就是说，文档携带的数据，是已经指定了既定的编码、格式等等信息的。某一些文档数据库针对文档的特点，提供了对于文档内容查询的功能，这是比原始的键值数据库功能上强大的地方。本地的 MongoDB 和 AWS 上的 DocumentDB 都属于这个类型。</span></span></span>
 </div>
 <div class="se-8ef37fd3 " data-slate-type="paragraph" data-slate-object="block" data-key="585">
  <span data-slate-object="text" data-key="586"><span data-slate-leaf="true" data-offset-key="586:0" data-first-offset="true"><span class="se-040c6cd9" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 对象（Object）数据库</span></span></span></span>
 </div>
 <div class="se-b3c59eb0 " data-slate-type="paragraph" data-slate-object="block" data-key="587">
  <span data-slate-object="text" data-key="588"><span data-slate-leaf="true" data-offset-key="588:0" data-first-offset="true"><span data-slate-string="true">和上面介绍的文档数据库类似，当 value 变成一个可序列化的对象，特别是一个大对象的时候，它就被归类为对象数据库了。AWS 上最常用的 NoSQL 存储，除了前面介绍过的 DynamoDB，就是 S3 了，它相对成本更为低廉，耐久性（durability，数据不丢失的级别）非常高（达到了 11 个 9），并且存储对象可以很大，因此用户经常把它当做一个“文件系统”来存放各种类型的文件，而把 key 设计成操作系统文件路径这样一级一级的形式，S3 也就被称为“文件系统”。但是，实际上 S3 的“文件”还是和我们所熟悉的操作系统的文件系统有着很大的区别。</span></span></span>
 </div>
 <div class="se-0ccbabbf " data-slate-type="paragraph" data-slate-object="block" data-key="589">
  <span data-slate-object="text" data-key="590"><span data-slate-leaf="true" data-offset-key="590:0" data-first-offset="true"><span data-slate-string="true">当然，还有一些其它的类型，包括图形（Graph）数据库、搜索（Search）数据库等等，我就不一一列举了。</span></span></span>
 </div>
 <h2 class="se-6c4fb3c0" data-slate-type="heading" data-slate-object="block" data-key="591"><span data-slate-object="text" data-key="592"><span data-slate-leaf="true" data-offset-key="592:0" data-first-offset="true"><span data-slate-string="true">演进趋势</span></span></span></h2>
 <div class="se-23780c79 " data-slate-type="paragraph" data-slate-object="block" data-key="593">
  <span data-slate-object="text" data-key="594"><span data-slate-leaf="true" data-offset-key="594:0" data-first-offset="true"><span data-slate-string="true">我们在这一章已经从一致性、可用性等方面了解了关系数据库和非关系数据库各自的优势，我想，对这两方面，你应该已经有了自己的认识。现在，我想再补充两个角度，让比较更为全面，分别是扩展性和数据的结构性，我们一起来看看持久层的存储技术的演进趋势。</span></span></span>
 </div>
 <h3 class="se-addbc312" data-slate-type="heading" data-slate-object="block" data-key="595"><span data-slate-object="text" data-key="596"><span data-slate-leaf="true" data-offset-key="596:0" data-first-offset="true"><span data-slate-string="true">1. 从 Scale Up 到 Scale Out</span></span></span></h3>
 <div class="se-4c9105fc " data-slate-type="paragraph" data-slate-object="block" data-key="597">
  <span data-slate-object="text" data-key="598"><span data-slate-leaf="true" data-offset-key="598:0" data-first-offset="true"><span data-slate-string="true">先回顾一下“扩展性”（Scalability，也有翻译为“伸缩性”的）这个概念。</span></span></span>
 </div>
 <div class="se-3b7f4385 " data-slate-type="paragraph" data-slate-object="block" data-key="599">
  <span data-slate-object="text" data-key="600"><span data-slate-leaf="true" data-offset-key="600:0" data-first-offset="true"><span data-slate-string="true">按理说，扩展性是包括“纵向（垂直）扩展”和“横向（水平）扩展”的。当然，如今使用这个词的时候，我们往往特指的是“Scale Out”，也就是横向扩展，说白了，就是通过在同一层上增加硬件资源的方式来增加扩展性，从而提高系统的吞吐量或容量。比如说，增加机器。NoSQL 技术往往具备很强的横向扩展能力，至于其中的一个典型原理，你可以回顾一下 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="601" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="602"><span data-slate-leaf="true" data-offset-key="602:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="603"><span data-slate-leaf="true" data-offset-key="603:0" data-first-offset="true"><span data-slate-string="true"> 的选修课堂“一致性哈希”，你就会明白，为什么 NoSQL 技术可以很方便地在同一层增加硬件资源了。</span></span></span>
 </div>
 <div class="se-fd8b8955 " data-slate-type="paragraph" data-slate-object="block" data-key="604">
  <span data-slate-object="text" data-key="605"><span data-slate-leaf="true" data-offset-key="605:0" data-first-offset="true"><span data-slate-string="true">可是，你知道吗，在很早以前，人们谈“扩展性”的时候，默认指的却是“Scale Up”。它指的是在硬件设施数量不变的基础上，通过增加单个硬件设施的性能和容量来达到同样的“扩展”目的。比如说，把同一台机器的 CPU 换成更好的，把内存升级，把磁盘换成容量更大的，等等。毕竟，在那时候，程序员对于很多问题的思考都还普遍停留在“单机”的层面上。</span></span></span>
 </div>
 <div class="se-6d8bad39 " data-slate-type="paragraph" data-slate-object="block" data-key="606">
  <span data-slate-object="text" data-key="607"><span data-slate-leaf="true" data-offset-key="607:0" data-first-offset="true"><span data-slate-string="true">为什么横向扩展如此重要，以至于成为了“扩展性”的默认指代？</span></span></span>
 </div>
 <div class="se-0b92dd20 " data-slate-type="paragraph" data-slate-object="block" data-key="608">
  <span data-slate-object="text" data-key="609"><span data-slate-leaf="true" data-offset-key="609:0" data-first-offset="true"><span data-slate-string="true">原因很简单，单个硬件设施的性能提升是非常有限的，而且极其昂贵。我记得我刚工作那会儿，去国内某电信运营商开局，众所周知他们“不差钱”，为了提升性能，我们做了很多 Scale Up 的工作，包括把 CPU 升级成了 96 核的。可是你看看现在的互联网公司，哪个会这么玩？因此在现实中，多数情况下，扩容这件事情上，Scale Out 是唯一的选择。</span></span></span>
 </div>
 <h3 class="se-fd8b403e" data-slate-type="heading" data-slate-object="block" data-key="610"><span data-slate-object="text" data-key="611"><span data-slate-leaf="true" data-offset-key="611:0" data-first-offset="true"><span data-slate-string="true">2. 从结构化数据到非结构化数据</span></span></span></h3>
 <div class="se-b01a5ffa " data-slate-type="paragraph" data-slate-object="block" data-key="612">
  <span data-slate-object="text" data-key="613"><span data-slate-leaf="true" data-offset-key="613:0" data-first-offset="true"><span data-slate-string="true">我们使用关系数据库的时候，每一行数据都是严格符合表结构的定义，有多少列，每一列的类型是什么，等等，我们把这类数据叫做“结构化”（structured）数据，而这个确定的“结构”，就是 schema。结构化的数据具备最佳的查询、校验和关联能力。</span></span></span>
 </div>
 <div class="se-95489a06 " data-slate-type="paragraph" data-slate-object="block" data-key="614">
  <span data-slate-object="text" data-key="615"><span data-slate-leaf="true" data-offset-key="615:0" data-first-offset="true"><span data-slate-string="true">但是当我们使用 DynamoDB 这样的 NoSQL 数据库的时候，我们发现，每一行数据依然可以分成一列一列的，但是有多少列，或者每一列的类型，或者表示的具体含义，却变得不再固定了。这时候我们说，这样的结构依然存在，但是共通的部分明显比结构化数据少多了，于是我们把它们叫做“半结构化”（semi-structured）的数据。</span></span></span>
 </div>
 <div class="se-7ef3952a " data-slate-type="paragraph" data-slate-object="block" data-key="616">
  <span data-slate-object="text" data-key="617"><span data-slate-leaf="true" data-offset-key="617:0" data-first-offset="true"><span data-slate-string="true">再一般化，就是“非结构化”（non-structured）数据了，上面说的 S3 就是一个很好的例子。即便 S3 上存储的文件是符合某种结构的（比如 JSON），我们也无法利用这个存储服务来完成依据结构而进行的查询等等操作了。</span></span></span>
 </div>
 <div class="se-3f523c6d " data-slate-type="paragraph" data-slate-object="block" data-key="618">
  <span data-slate-object="text" data-key="619"><span data-slate-leaf="true" data-offset-key="619:0" data-first-offset="true"><span data-slate-string="true">无论是同步还是异步的数据处理，我们总是希望数据的结构性越强越好，因为“结构”本质上意味着“规则”，越强的结构，就越容易使用简单直白的代码逻辑去处理。可是，恰恰相反的是，</span></span></span><span data-slate-object="text" data-key="620"><span data-slate-leaf="true" data-offset-key="620:0" data-first-offset="true"><span class="se-28c9c7a4" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我们在现实中遇到的绝大多数的数据，都是非结构化的</span></span></span></span><span data-slate-object="text" data-key="621"><span data-slate-leaf="true" data-offset-key="621:0" data-first-offset="true"><span data-slate-string="true">，或者说，很难用某一种特定的规则去套。</span></span></span>
 </div>
 <h2 class="se-1cd0b8d2" data-slate-type="heading" data-slate-object="block" data-key="622"><span data-slate-object="text" data-key="623"><span data-slate-leaf="true" data-offset-key="623:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-be664b45 " data-slate-type="paragraph" data-slate-object="block" data-key="624">
  <span data-slate-object="text" data-key="625"><span data-slate-leaf="true" data-offset-key="625:0" data-first-offset="true"><span data-slate-string="true">今天我们从不同角度学习了关系数据库和非关系数据库，掌握了一些存储设计的原理和技巧，希望你可以将内容慢慢消化。</span></span></span>
 </div>
 <div class="se-e5a431b2 " data-slate-type="paragraph" data-slate-object="block" data-key="626">
  <span data-slate-object="text" data-key="627"><span data-slate-leaf="true" data-offset-key="627:0" data-first-offset="true"><span data-slate-string="true">下面是今天的提问环节了，我想换个形式。</span></span></span>
 </div>
 <div class="se-84de571d " data-slate-type="paragraph" data-slate-object="block" data-key="628">
  <span data-slate-object="text" data-key="629"><span data-slate-leaf="true" data-offset-key="629:0" data-first-offset="true"><span data-slate-string="true">我们已经学习了几种常见的数据库范式，下面这张图书馆用户表的数据库表的设计是不合理的，你觉得它满足了第几范式呢？并且，你能不能通过学到的拆分方法，分析一下它的问题，把它进一步优化，消除冗余呢？</span></span></span>
 </div>
 <div class="se-30048552" data-slate-type="image" data-slate-object="block" data-key="630">
  <img class="se-69cd6a0b" src="https://static001.geekbang.org/resource/image/7a/27/7a609fd55a0882a88a95a1dc43fc9c27.jpg">
 </div>
 <div class="se-eb54cec2 " data-slate-type="paragraph" data-slate-object="block" data-key="631">
  <span data-slate-object="text" data-key="632"><span data-slate-leaf="true" data-offset-key="632:0" data-first-offset="true"><span data-slate-string="true">好，今天的内容就到这里。如果有思考、有问题，欢迎在留言区发言，我们一起讨论。</span></span></span>
 </div>
 <h2 class="se-e52599c0" data-slate-type="heading" data-slate-object="block" data-key="633"><span data-slate-object="text" data-key="634"><span data-slate-leaf="true" data-offset-key="634:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-ac4c6aff" data-slate-type="list" data-slate-object="block" data-key="635">
  <div class="se-0749ff05 se-38c26b52" data-slate-type="list-line" data-slate-object="block" data-key="636">
   <span data-slate-object="text" data-key="637"><span data-slate-leaf="true" data-offset-key="637:0" data-first-offset="true"><span data-slate-string="true">文中提到了 Web 2.0 的概念，我推荐你阅读 Web 2.0 的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="638" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="639"><span data-slate-leaf="true" data-offset-key="639:0" data-first-offset="true"><span data-slate-string="true">维基百科词条</span></span></span></a><span data-slate-object="text" data-key="640"><span data-slate-leaf="true" data-offset-key="640:0" data-first-offset="true"><span data-slate-string="true">，以及 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="641" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="642"><span data-slate-leaf="true" data-offset-key="642:0" data-first-offset="true"><span data-slate-string="true">Web 2.0 网站的九个特点</span></span></span></a><span data-slate-object="text" data-key="643"><span data-slate-leaf="true" data-offset-key="643:0" data-first-offset="true"><span data-slate-string="true">这篇文章，以对它有一个明确的认识。</span></span></span>
  </div>
  <div class="se-9e189aa0 se-3f8e64d4" data-slate-type="list-line" data-slate-object="block" data-key="644">
   <span data-slate-object="text" data-key="645"><span data-slate-leaf="true" data-offset-key="645:0" data-first-offset="true"><span data-slate-string="true">对于 NoSQL 的一些特定的术语，以及数据库的分类和比较，推荐你阅读这篇</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="646" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="647"><span data-slate-leaf="true" data-offset-key="647:0" data-first-offset="true"><span data-slate-string="true">什么是 NoSQL？</span></span></span></a>
  </div>
  <div class="se-c89c117b se-dbef1a4e" data-slate-type="list-line" data-slate-object="block" data-key="648">
   <span data-slate-object="text" data-key="649"><span data-slate-leaf="true" data-offset-key="649:0" data-first-offset="true"><span data-slate-string="true">文中介绍了去 IOE 的事儿，正好 Amazon 最近宣称他们正式完成了从 Oracle 关系数据库迁移离开的工作，感兴趣的话可以</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="650" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="651"><span data-slate-leaf="true" data-offset-key="651:0" data-first-offset="true"><span data-slate-string="true">看一看</span></span></span></a><span data-slate-object="text" data-key="652"><span data-slate-leaf="true" data-offset-key="652:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-134e68ec se-eca9ebf2" data-slate-type="list-line" data-slate-object="block" data-key="653">
   <span data-slate-object="text" data-key="654"><span data-slate-leaf="true" data-offset-key="654:0" data-first-offset="true"><span data-slate-string="true">对于分布式存储感兴趣，并且阅读能力还可以的话，有一些经典论文可以是进一步学习的对象，但请注意它们不是我们这个阶段或当前学习周期内需要学习的内容。比如 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="655" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="656"><span data-slate-leaf="true" data-offset-key="656:0" data-first-offset="true"><span data-slate-string="true">Dynamo: Amazon’s Highly Available Key-value Store</span></span></span></a><span data-slate-object="text" data-key="657"><span data-slate-leaf="true" data-offset-key="657:0" data-first-offset="true"><span data-slate-string="true"> 这篇，中文译文可以</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="658" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="659"><span data-slate-leaf="true" data-offset-key="659:0" data-first-offset="true"><span data-slate-string="true">参考这篇</span></span></span></a><span data-slate-object="text" data-key="660"><span data-slate-leaf="true" data-offset-key="660:0" data-first-offset="true"><span data-slate-string="true">，它影响了后来很多分布式系统的设计和发展，我几年前也学习并写了一些</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="661" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="662"><span data-slate-leaf="true" data-offset-key="662:0" data-first-offset="true"><span data-slate-string="true">自己的理解</span></span></span></a><span data-slate-object="text" data-key="663"><span data-slate-leaf="true" data-offset-key="663:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-c5065b2e se-aa0fb418" data-slate-type="list-line" data-slate-object="block" data-key="664">
   <span data-slate-object="text" data-key="665"><span data-slate-leaf="true" data-offset-key="665:0" data-first-offset="true"><span data-slate-string="true">再就是 Google 著名的“三驾马车”了，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="666" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="667"><span data-slate-leaf="true" data-offset-key="667:0" data-first-offset="true"><span data-slate-string="true">GFS</span></span></span></a><span data-slate-object="text" data-key="668"><span data-slate-leaf="true" data-offset-key="668:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="669" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="670"><span data-slate-leaf="true" data-offset-key="670:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="671"><span data-slate-leaf="true" data-offset-key="671:0" data-first-offset="true"><span data-slate-string="true">），</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="672" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="673"><span data-slate-leaf="true" data-offset-key="673:0" data-first-offset="true"><span data-slate-string="true">MapReduce</span></span></span></a><span data-slate-object="text" data-key="674"><span data-slate-leaf="true" data-offset-key="674:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="675" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="676"><span data-slate-leaf="true" data-offset-key="676:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="677"><span data-slate-leaf="true" data-offset-key="677:0" data-first-offset="true"><span data-slate-string="true">） 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="678" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="679"><span data-slate-leaf="true" data-offset-key="679:0" data-first-offset="true"><span data-slate-string="true">BigTable</span></span></span></a><span data-slate-object="text" data-key="680"><span data-slate-leaf="true" data-offset-key="680:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="681" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="682"><span data-slate-leaf="true" data-offset-key="682:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="683"><span data-slate-leaf="true" data-offset-key="683:0" data-first-offset="true"><span data-slate-string="true">）。我仅仅把它们放在这里，只是供感兴趣且有一定论文阅读能力的程序员朋友参考，而对于本专栏全栈的学习来说，不接触它们是完全没问题的。</span></span></span>
  </div>
 </div>
 <div class="se-08281a2d" data-slate-type="image" data-slate-object="block" data-key="684">
  <img class="se-135dc37d" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |22          |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:46:28.309 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=22 
 {executed in 1 msec}
2020-11-19 17:46:28.319 INFO  jdbc.resultsettable Line:610 - 
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<div data-slate-editor="true" data-key="467" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-4c683b7a " data-slate-type="paragraph" data-slate-object="block" data-key="468">
  <span data-slate-object="text" data-key="469"><span data-slate-leaf="true" data-offset-key="469:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-4699f57b " data-slate-type="paragraph" data-slate-object="block" data-key="470">
  <span data-slate-object="text" data-key="471"><span data-slate-leaf="true" data-offset-key="471:0" data-first-offset="true"><span data-slate-string="true">在基于 Web 的全栈技术下，每一层的设计都有共同点，当然，也有各自的特殊之处。你可以回想一下，我们曾经在第一章谈到的客户端和服务端交互以及 Web API 的设计，在第三章谈到的前端的设计，在第二章谈到的服务端 MVC 各层的设计，从前到后。那么，本章余下的内容，我们就来让整个设计层面上的体系变得完整，讲一讲最后面一层的数据持久层怎样设计。</span></span></span>
 </div>
 <div class="se-20d6ea08 " data-slate-type="paragraph" data-slate-object="block" data-key="472">
  <span data-slate-object="text" data-key="473"><span data-slate-leaf="true" data-offset-key="473:0" data-first-offset="true"><span data-slate-string="true">持久层的设计包括持久化框架选择、持久层代码设计，以及存储技术选型等等，考虑到这其中有部分内容我们在第二章谈论 MVC 模型层的时候已经讲到过了，那么在这一讲和下一讲中，我就会先偏重于持久层的数据存储技术本身，再结合实际的设计案例来介绍怎样选择合适的技术来解决那些经典的实际问题。</span></span></span>
 </div>
 <h2 class="se-3e0c1df4" data-slate-type="heading" data-slate-object="block" data-key="474"><span data-slate-object="text" data-key="475"><span data-slate-leaf="true" data-offset-key="475:0" data-first-offset="true"><span data-slate-string="true">关系数据库</span></span></span></h2>
 <div class="se-459be200 " data-slate-type="paragraph" data-slate-object="block" data-key="476">
  <span data-slate-object="text" data-key="477"><span data-slate-leaf="true" data-offset-key="477:0" data-first-offset="true"><span data-slate-string="true">关系数据库就是以“关系模型”为基础而建立的数据库，这里的关系模型说的是数据可以通过数学上的关系表示和关联起来，也就是说，关系模型最终可以通过二维表格的结构来表达。关系数据库除了带来了明确的 schema 和关系以外，还带来了对事务的支持，也就是对于强一致性的支持。</span></span></span>
 </div>
 <h3 class="se-a0b0804c" data-slate-type="heading" data-slate-object="block" data-key="478"><span data-slate-object="text" data-key="479"><span data-slate-leaf="true" data-offset-key="479:0" data-first-offset="true"><span data-slate-string="true">数据库范式</span></span></span></h3>
 <div class="se-13ead61a " data-slate-type="paragraph" data-slate-object="block" data-key="480">
  <span data-slate-object="text" data-key="481"><span data-slate-leaf="true" data-offset-key="481:0" data-first-offset="true"><span data-slate-string="true">数据库的表设计，可以说是全栈工程师经常需要面对的问题。而这部分，其实是有“套路”可循的，其中一些常见的规范要求，就被总结为不同的“范式”（Normal Form）。它可以说是数据库表设计的基础，对于数据库表设计很有实际的指导意义。我注意到有很多程序员朋友都不太清楚不同范式的实际含义，那么今天，就请让我通过一个尽可能简单的图书管理系统的例子，来把它讲清楚。</span></span></span>
 </div>
 <div class="se-0010ca9f " data-slate-type="paragraph" data-slate-object="block" data-key="482">
  <span data-slate-object="text" data-key="483"><span data-slate-leaf="true" data-offset-key="483:0" data-first-offset="true"><span class="se-6cf15ec5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 第一范式（1 NF）</span></span></span></span>
 </div>
 <div class="se-63f48f2a " data-slate-type="paragraph" data-slate-object="block" data-key="484">
  <span data-slate-object="text" data-key="485"><span data-slate-leaf="true" data-offset-key="485:0" data-first-offset="true"><span class="se-400eb895" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一范式要求每个属性值都是不可再分的。</span></span></span></span><span data-slate-object="text" data-key="486"><span data-slate-leaf="true" data-offset-key="486:0" data-first-offset="true"><span data-slate-string="true">满足 1NF 的关系被称为规范化的关系，1NF 也是关系模式应具备的最起码的条件。比如下面这样的 Books 表：</span></span></span>
 </div>
 <div class="se-4a73075a" data-slate-type="image" data-slate-object="block" data-key="487">
  <img class="se-92583f1c" src="https://static001.geekbang.org/resource/image/c3/e0/c3e7821cd54c491b0aff7e12026573e0.jpg">
 </div>
 <div class="se-732158d6 " data-slate-type="paragraph" data-slate-object="block" data-key="488">
  <span data-slate-object="text" data-key="489"><span data-slate-leaf="true" data-offset-key="489:0" data-first-offset="true"><span data-slate-string="true">你看，在上面这张表中，有两本书重名了，都叫“Life”，但是国际标准书号 ISBN 是不同的。放在了同一个属性 ISBN 中，并非不可再分，这显然违反了第一范式。那解决这个问题的办法就是拆分：</span></span></span>
 </div>
 <div class="se-031d56f2" data-slate-type="image" data-slate-object="block" data-key="490">
  <img class="se-2815cafa" src="https://static001.geekbang.org/resource/image/60/9a/60bb114c4dfe64f3341c34cc4b0b859a.jpg">
 </div>
 <div class="se-d7072796 " data-slate-type="paragraph" data-slate-object="block" data-key="491">
  <span data-slate-object="text" data-key="492"><span data-slate-leaf="true" data-offset-key="492:0" data-first-offset="true"><span class="se-471d924a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 第二范式（2 NF）</span></span></span></span>
 </div>
 <div class="se-73b52486 " data-slate-type="paragraph" data-slate-object="block" data-key="493">
  <span data-slate-object="text" data-key="494"><span data-slate-leaf="true" data-offset-key="494:0" data-first-offset="true"><span class="se-84a10c1c" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二范式要求去除局部依赖。</span></span></span></span><span data-slate-object="text" data-key="495"><span data-slate-leaf="true" data-offset-key="495:0" data-first-offset="true"><span data-slate-string="true">也就是说，表中的属性完全依赖于全部主键，而不是部分主键。</span></span></span>
 </div>
 <div class="se-19443d70" data-slate-type="image" data-slate-object="block" data-key="496">
  <img class="se-ca8b0007" src="https://static001.geekbang.org/resource/image/80/fe/803754244fa279d784a6af203d74fdfe.jpg">
 </div>
 <div class="se-ba84dac4 " data-slate-type="paragraph" data-slate-object="block" data-key="497">
  <span data-slate-object="text" data-key="498"><span data-slate-leaf="true" data-offset-key="498:0" data-first-offset="true"><span data-slate-string="true">你看，在上面这张表中，原本的设计是想让 BOOK_ID 和 AUTHOR_ID 组成联合主键，但是，BOOK_NAME 仅仅依赖于部分主键 BOOK_ID，而 AUTHOR_NAME 也仅仅依赖于部分主键 AUTHOR_ID，违背了第二范式 。解决的办法依然是拆分，把这个可以独立被依赖的部分主键拿出去，上面的表可以拆成下面这样两张表：</span></span></span>
 </div>
 <div class="se-91ed7888" data-slate-type="image" data-slate-object="block" data-key="499">
  <img class="se-fea73ba2" src="https://static001.geekbang.org/resource/image/9d/cb/9d6f9f22b2b5feab01cd6ea1de9582cb.jpg">
 </div>
 <div class="se-0753e8df" data-slate-type="image" data-slate-object="block" data-key="500">
  <img class="se-f104e218" src="https://static001.geekbang.org/resource/image/98/c3/9874e9af23ebd64c5278654a78cfacc3.jpg">
 </div>
 <div class="se-99ac8501 " data-slate-type="paragraph" data-slate-object="block" data-key="501">
  <span data-slate-object="text" data-key="502"><span data-slate-leaf="true" data-offset-key="502:0" data-first-offset="true"><span data-slate-string="true">从这个拆分中我们也可以看到，原表被拆成了 N 对 1 关系的两个表，而被不合范式依赖的那个“部分主键”，变成了“1”这头的主键。</span></span></span>
 </div>
 <div class="se-1530cf40 " data-slate-type="paragraph" data-slate-object="block" data-key="503">
  <span data-slate-object="text" data-key="504"><span data-slate-leaf="true" data-offset-key="504:0" data-first-offset="true"><span class="se-161efc41" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 第三范式（3 NF）</span></span></span></span>
 </div>
 <div class="se-31b179f4 " data-slate-type="paragraph" data-slate-object="block" data-key="505">
  <span data-slate-object="text" data-key="506"><span data-slate-leaf="true" data-offset-key="506:0" data-first-offset="true"><span class="se-a3a9814f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第三范式要求去除非主属性的传递依赖。</span></span></span></span><span data-slate-object="text" data-key="507"><span data-slate-leaf="true" data-offset-key="507:0" data-first-offset="true"><span data-slate-string="true">即在第二范式的基础上，非主属性必须直接依赖于主键，而不能传递依赖于主键。</span></span></span>
 </div>
 <div class="se-2ad5ef85" data-slate-type="image" data-slate-object="block" data-key="508">
  <img class="se-5df8d228" src="https://static001.geekbang.org/resource/image/88/29/889a89fd92fab3a818aae622f3655e29.jpg">
 </div>
 <div class="se-b75bf620 " data-slate-type="paragraph" data-slate-object="block" data-key="509">
  <span data-slate-object="text" data-key="510"><span data-slate-leaf="true" data-offset-key="510:0" data-first-offset="true"><span data-slate-string="true">你看上面这张表，主键是 BOOK_ID，而 CATEGORY_ID 是非关键字段，并非直接依赖于主键，而是通过这样的传递依赖：</span></span></span>
 </div>
 <div class="se-abef622b" data-slate-type="block-quote" data-slate-object="block" data-key="511">
  <div class="se-62ca44c0" data-slate-type="quote-line" data-slate-object="block" data-key="512">
   <span data-slate-object="text" data-key="513"><span data-slate-leaf="true" data-offset-key="513:0" data-first-offset="true"><span data-slate-string="true">CATEGORY_NAME → CATEGORY_ID → BOOK_ID</span></span></span>
  </div>
 </div>
 <div class="se-591fbfd7 " data-slate-type="paragraph" data-slate-object="block" data-key="514">
  <span data-slate-object="text" data-key="515"><span data-slate-leaf="true" data-offset-key="515:0" data-first-offset="true"><span data-slate-string="true">因此，为了消除这个传递依赖，我们还是拆表，让这个传递链中间的非关键字段自立门户：</span></span></span>
 </div>
 <div class="se-34354de5" data-slate-type="image" data-slate-object="block" data-key="516">
  <img class="se-cd6306d9" src="https://static001.geekbang.org/resource/image/ec/4f/ec8cb2f6b80835e76d0631dcd1fe764f.jpg">
 </div>
 <div class="se-193ae5bc" data-slate-type="image" data-slate-object="block" data-key="517">
  <img class="se-c85a8824" src="https://static001.geekbang.org/resource/image/73/51/73c47a542f083d6b372056588dc10551.jpg">
 </div>
 <div class="se-e35cee36 " data-slate-type="paragraph" data-slate-object="block" data-key="518">
  <span data-slate-object="text" data-key="519"><span data-slate-leaf="true" data-offset-key="519:0" data-first-offset="true"><span data-slate-string="true">一般我们在设计中分析到第三范式就打住了，很少有情况会考虑更为严格的范式。例如，BC 范式和第三范式就很像，但是，第三范式只是消除了非主属性对主属性的传递依赖，而 BC 范式更进一步，要求消除主属性对主属性的传递依赖，从而，消除所有属性对主属性的传递依赖。</span></span></span>
 </div>
 <div class="se-ba489f11 " data-slate-type="paragraph" data-slate-object="block" data-key="520">
  <span data-slate-object="text" data-key="521"><span data-slate-leaf="true" data-offset-key="521:0" data-first-offset="true"><span data-slate-string="true">当然，还有第四、第五范式等等，要求更加严格，解耦更加彻底，但却不太常用了，如果你想进一步了解，可以参阅维基百科的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="522" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="523"><span data-slate-leaf="true" data-offset-key="523:0" data-first-offset="true"><span data-slate-string="true">词条</span></span></span></a><span data-slate-object="text" data-key="524"><span data-slate-leaf="true" data-offset-key="524:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
 </div>
 <div class="se-45d68fc3 " data-slate-type="paragraph" data-slate-object="block" data-key="525">
  <span data-slate-object="text" data-key="526"><span data-slate-leaf="true" data-offset-key="526:0" data-first-offset="true"><span data-slate-string="true">范式的程度更高，冗余度便更低。但正如同我们在第二章介绍的“拆分”大法一样，每一次范式的升级都意味着一个拆表的过程，一旦过度解耦，拆分出太多零散的表，对于程序员的理解，脑海中数据模型的建立，甚至包括联表操作的 I/O 性能，都是不利的。因此我们需要“权衡”，掌握好这个度，</span></span></span><span data-slate-object="text" data-key="527"><span data-slate-leaf="true" data-offset-key="527:0" data-first-offset="true"><span class="se-a9197cbc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这一原则，和我们介绍过的分层设计是一致的。</span></span></span></span>
 </div>
 <h2 class="se-c21a1d6a" data-slate-type="heading" data-slate-object="block" data-key="528"><span data-slate-object="text" data-key="529"><span data-slate-leaf="true" data-offset-key="529:0" data-first-offset="true"><span data-slate-string="true">NoSQL</span></span></span></h2>
 <div class="se-86fbcce6 " data-slate-type="paragraph" data-slate-object="block" data-key="530">
  <span data-slate-object="text" data-key="531"><span data-slate-leaf="true" data-offset-key="531:0" data-first-offset="true"><span data-slate-string="true">在上一讲中，我已经介绍了 NoSQL 的概念。在 NoSQL 出现以前，设计大型网站等 Web 应用的时候，全栈工程师的武器库里可供使用的选择，要局限得多。尤其是对一些量大且非结构化的数据，缺乏特别理想的解决方法，工程师有时不得不采用一些非常规的特殊方案，而更多时候我们只能在传统关系数据库的基础上，使用数据库的 Sharding 和 Partition 这样的操作。</span></span></span>
 </div>
 <div class="se-a372041d " data-slate-type="paragraph" data-slate-object="block" data-key="532">
  <span data-slate-object="text" data-key="533"><span data-slate-leaf="true" data-offset-key="533:0" data-first-offset="true"><span data-slate-string="true">虽然那时候在数据规模上面临的挑战远没有现在大，可那个时候 DBA（Database Administrator）在市场上可以说是炙手可热，一旦出了问题，有时甚至还得请专门的数据库厂商的专家，这其中的费用极其高昂，是以分钟计算的。</span></span></span>
 </div>
 <div class="se-202d657f " data-slate-type="paragraph" data-slate-object="block" data-key="534">
  <span data-slate-object="text" data-key="535"><span data-slate-leaf="true" data-offset-key="535:0" data-first-offset="true"><span data-slate-string="true">如今，你可能听说过许多互联网企业去 IOE 的故事（IOE 指的是 IBM 的小型机、Oracle 数据库、EMC 存储设备这三者），其中阿里巴巴的版本听起来还颇为传奇。事实上，这可不只是只有国内的阿里巴巴曾经努力做的事情，还是全球许多大型互联网企业都曾经或正在做的事情，也包括 Amazon。我曾经在 Amazon 的销量预测团队中工作，当时我们团队可以说就在整个亚马逊最大的传统（非云上）关系数据库上工作，里面存放了全部商品库存、销量等有关的信息。</span></span></span>
 </div>
 <div class="se-24eea97f " data-slate-type="paragraph" data-slate-object="block" data-key="536">
  <span data-slate-object="text" data-key="537"><span data-slate-leaf="true" data-offset-key="537:0" data-first-offset="true"><span data-slate-string="true">Web 2.0 时代的到来，为互联网应用带来了深远的影响，</span></span></span><span data-slate-object="text" data-key="538"><span data-slate-leaf="true" data-offset-key="538:0" data-first-offset="true"><span class="se-3edd519e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">用户代替传统媒体，成为了 Web 2.0 时代主要的数据制造者。海量、不定结构、弱关联关系、高可用性和低一致性要求的数据特点，让关系数据库力不从心；而 NoSQL 则具有更好的横向扩展性、海量数据支持、易维护和廉价等等优势，犹如一剂特效药，成为了市场上这个数据难题的大杀器。</span></span></span></span>
 </div>
 <div class="se-3de9d264 " data-slate-type="paragraph" data-slate-object="block" data-key="539">
  <span data-slate-object="text" data-key="540"><span data-slate-leaf="true" data-offset-key="540:0" data-first-offset="true"><span data-slate-string="true">当然，现实中依然存在大量需要强一致性和关系查询的业务场景，因此关系数据库依然是我们倚赖的重要工具。可是，</span></span></span><span data-slate-object="text" data-key="541"><span data-slate-leaf="true" data-offset-key="541:0" data-first-offset="true"><span class="se-72b7de94" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">依然使用关系数据库并不代表依然靠互联网企业自己亲力亲为地做繁重的数据库管理工作</span></span></span></span><span data-slate-object="text" data-key="542"><span data-slate-leaf="true" data-offset-key="542:0" data-first-offset="true"><span data-slate-string="true">，关系数据库云服务的崛起将传统的数据库管理工作自动化，于是普通的软件工程师也可以完成以往 DBA 才能完成的工作了。从这里也能看出，DBA 也确实是一个技术变更影响技术人才市场需求的典型例子。</span></span></span>
 </div>
 <div class="se-3fb47d43 " data-slate-type="paragraph" data-slate-object="block" data-key="543">
  <span data-slate-object="text" data-key="544"><span data-slate-leaf="true" data-offset-key="544:0" data-first-offset="true"><span data-slate-string="true">综上，这个数据的问题就有了两个层次的解决方案：</span></span></span>
 </div>
 <div class="se-0f6e180b" data-slate-type="list" data-slate-object="block" data-key="545">
  <div class="se-eed21a15 se-351625cf" data-slate-type="list-line" data-slate-object="block" data-key="546">
   <span data-slate-object="text" data-key="547"><span data-slate-leaf="true" data-offset-key="547:0" data-first-offset="true"><span data-slate-string="true">出现了更适合业务的非关系数据库服务，也就是 NoSQL；</span></span></span>
  </div>
  <div class="se-84132874 se-55764645" data-slate-type="list-line" data-slate-object="block" data-key="548">
   <span data-slate-object="text" data-key="549"><span data-slate-leaf="true" data-offset-key="549:0" data-first-offset="true"><span data-slate-string="true">把关系数据库搬到云上，从而让互联网企业从繁重的数据库管理工作中解脱出来，例如 RDS。</span></span></span>
  </div>
 </div>
 <h3 class="se-77a017c4" data-slate-type="heading" data-slate-object="block" data-key="550"><span data-slate-object="text" data-key="551"><span data-slate-leaf="true" data-offset-key="551:0" data-first-offset="true"><span data-slate-string="true">NoSQL 数据库的分类</span></span></span></h3>
 <div class="se-aa8e2306 " data-slate-type="paragraph" data-slate-object="block" data-key="552">
  <span data-slate-object="text" data-key="553"><span data-slate-leaf="true" data-offset-key="553:0" data-first-offset="true"><span data-slate-string="true">别看 NoSQL 的数据库那么多，它们大致可以被分为这样几类，每一类也都有自己的优势和劣势。在介绍每一类的时候，我会以我比较熟悉的 AWS 上的实现来具体介绍，当然，很可能你见过的是其它的例子（比如非云上的本地版本，再比如不同的云服务厂商都会提供自己的实现），但在原理层面都是类似的。</span></span></span>
 </div>
 <div class="se-421ee8bf " data-slate-type="paragraph" data-slate-object="block" data-key="554">
  <span data-slate-object="text" data-key="555"><span data-slate-leaf="true" data-offset-key="555:0" data-first-offset="true"><span class="se-31c1284b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">1. 键值（Key-value）数据库</span></span></span></span>
 </div>
 <div class="se-e9c7a7f4 " data-slate-type="paragraph" data-slate-object="block" data-key="556">
  <span data-slate-object="text" data-key="557"><span data-slate-leaf="true" data-offset-key="557:0" data-first-offset="true"><span data-slate-string="true">这一类 NoSQL 的数据库，采用的是 key-value 这样的访问模型，也就是说，可以根据一个唯一的 key 来获取所需要的值，这个 key 被称为主键，而这个根据 key 来获取 value 的访问的过程是通过 Hash 算法来实现的。本地的 Redis 或者云上的 DynamoDB 都属于这一类。</span></span></span>
 </div>
 <div class="se-2a36e0a1 " data-slate-type="paragraph" data-slate-object="block" data-key="558">
  <span data-slate-object="text" data-key="559"><span data-slate-leaf="true" data-offset-key="559:0" data-first-offset="true"><span data-slate-string="true">以 DynamoDB 为例，它的 key 由 Partition Key 和 Sort Key 两级组成，即前者用来找到数据存在哪一个存储单元（Storage Unit），而后者用来找到 value 在存储单元上的具体位置。通常来说，这个二级 Hash 的过程时间开销并不会随着数据量的增大而增大，下图来自</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="560" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="561"><span data-slate-leaf="true" data-offset-key="561:0" data-first-offset="true"><span data-slate-string="true">官方的 Blog</span></span></span></a><span data-slate-object="text" data-key="562"><span data-slate-leaf="true" data-offset-key="562:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span>
 </div>
 <div class="se-dd1fb50f" data-slate-type="image" data-slate-object="block" data-key="563">
  <img class="se-cc46a08c" src="https://static001.geekbang.org/resource/image/6e/b3/6e087df74ef924619966e74fdcd0f5b3.jpg">
 </div>
 <div class="se-25f12bab " data-slate-type="paragraph" data-slate-object="block" data-key="564">
  <span data-slate-object="text" data-key="565"><span data-slate-leaf="true" data-offset-key="565:0" data-first-offset="true"><span data-slate-string="true">DynamoDB 表结构看起来和传统的关系数据库有些像，并且每一行的 schema 可以完全不同，即“列”可以是任意的。每张表的数据支持有限的范围查询，包括主键的范围查询，以及索引列的范围查询。其中，索引的数量是有着明确限制的，一种是全局的（相当于 Partition Key + Sort Key），每张表上限 20 个；一种是本地的（相当于 Partition Key 已经确定，只通过 Sort Key 索引），每张表上限 5 个。</span></span></span>
 </div>
 <div class="se-ec5b7687 " data-slate-type="paragraph" data-slate-object="block" data-key="566">
  <span data-slate-object="text" data-key="567"><span data-slate-leaf="true" data-offset-key="567:0" data-first-offset="true"><span class="se-34c1e2fc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">2. 列式（Columnar）数据库</span></span></span></span>
 </div>
 <div class="se-9a4e72eb " data-slate-type="paragraph" data-slate-object="block" data-key="568">
  <span data-slate-object="text" data-key="569"><span data-slate-leaf="true" data-offset-key="569:0" data-first-offset="true"><span data-slate-string="true">经典的数据库是面向行的，即数据在存储的时候，每一行的数据是放在一起的，这样数据库在读取磁盘上连续数据的时候，实际每次可以一气读取若干行。如果需要完整地查询出特定某些行的数据，行数据库是高效的。且看下面的示例，来自 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="570" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="571"><span data-slate-leaf="true" data-offset-key="571:0" data-first-offset="true"><span data-slate-string="true">Redshift 官方文档</span></span></span></a><span data-slate-object="text" data-key="572"><span data-slate-leaf="true" data-offset-key="572:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span>
 </div>
 <div class="se-9616fb84" data-slate-type="image" data-slate-object="block" data-key="573">
  <img class="se-6ff49b22" src="https://static001.geekbang.org/resource/image/b1/1b/b1a304f40d3d8f006a3a1e79f663af1b.jpg">
 </div>
 <div class="se-92252cc5 " data-slate-type="paragraph" data-slate-object="block" data-key="574">
  <span data-slate-object="text" data-key="575"><span data-slate-leaf="true" data-offset-key="575:0" data-first-offset="true"><span data-slate-string="true">但是列式数据库不一样，它是将每一列的数据放在一起。这样的话，如果我们的处理逻辑是要求取出所有数据中的特定列，那么列数据库就是更好的选择：</span></span></span>
 </div>
 <div class="se-3b801bbd" data-slate-type="image" data-slate-object="block" data-key="576">
  <img class="se-98bf94ad" src="https://static001.geekbang.org/resource/image/68/0a/6827c62314d7a7dc40053a8d1ea7aa0a.jpg">
 </div>
 <div class="se-7735f5f9 " data-slate-type="paragraph" data-slate-object="block" data-key="577">
  <span data-slate-object="text" data-key="578"><span data-slate-leaf="true" data-offset-key="578:0" data-first-offset="true"><span data-slate-string="true">事实上，对于数据库来说，磁盘的读、写本身，往往还不是最慢的，最慢的是寻址操作。因此，无论是行数据库还是列数据库，如果根据实际需要，我们的实际访问能够从随机访问变成顺序访问，那么就可以极大地提高效率。在大数据处理中经常使用的 HBase 和云上的 Redshift 都属于这一类。</span></span></span>
 </div>
 <div class="se-e50a9e7b " data-slate-type="paragraph" data-slate-object="block" data-key="579">
  <span data-slate-object="text" data-key="580"><span data-slate-leaf="true" data-offset-key="580:0" data-first-offset="true"><span data-slate-string="true">和行数据库相比，列数据库还有一些其它的好处。比如说，对于很多数据来说，某一个特定列都是满足某种特定的格式的，那么列数据库就可以根据这种格式来执行特定的压缩操作。</span></span></span>
 </div>
 <div class="se-3e89d77d " data-slate-type="paragraph" data-slate-object="block" data-key="581">
  <span data-slate-object="text" data-key="582"><span data-slate-leaf="true" data-offset-key="582:0" data-first-offset="true"><span class="se-9a05d129" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3. 文档（Document）数据库</span></span></span></span>
 </div>
 <div class="se-752a59f9 " data-slate-type="paragraph" data-slate-object="block" data-key="583">
  <span data-slate-object="text" data-key="584"><span data-slate-leaf="true" data-offset-key="584:0" data-first-offset="true"><span data-slate-string="true">文档数据库是前面提到的键值数据库的演化版，值是以某一种特定的文档格式来存储的，比如 JSON、XML 等等。也就是说，文档携带的数据，是已经指定了既定的编码、格式等等信息的。某一些文档数据库针对文档的特点，提供了对于文档内容查询的功能，这是比原始的键值数据库功能上强大的地方。本地的 MongoDB 和 AWS 上的 DocumentDB 都属于这个类型。</span></span></span>
 </div>
 <div class="se-8ef37fd3 " data-slate-type="paragraph" data-slate-object="block" data-key="585">
  <span data-slate-object="text" data-key="586"><span data-slate-leaf="true" data-offset-key="586:0" data-first-offset="true"><span class="se-040c6cd9" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">4. 对象（Object）数据库</span></span></span></span>
 </div>
 <div class="se-b3c59eb0 " data-slate-type="paragraph" data-slate-object="block" data-key="587">
  <span data-slate-object="text" data-key="588"><span data-slate-leaf="true" data-offset-key="588:0" data-first-offset="true"><span data-slate-string="true">和上面介绍的文档数据库类似，当 value 变成一个可序列化的对象，特别是一个大对象的时候，它就被归类为对象数据库了。AWS 上最常用的 NoSQL 存储，除了前面介绍过的 DynamoDB，就是 S3 了，它相对成本更为低廉，耐久性（durability，数据不丢失的级别）非常高（达到了 11 个 9），并且存储对象可以很大，因此用户经常把它当做一个“文件系统”来存放各种类型的文件，而把 key 设计成操作系统文件路径这样一级一级的形式，S3 也就被称为“文件系统”。但是，实际上 S3 的“文件”还是和我们所熟悉的操作系统的文件系统有着很大的区别。</span></span></span>
 </div>
 <div class="se-0ccbabbf " data-slate-type="paragraph" data-slate-object="block" data-key="589">
  <span data-slate-object="text" data-key="590"><span data-slate-leaf="true" data-offset-key="590:0" data-first-offset="true"><span data-slate-string="true">当然，还有一些其它的类型，包括图形（Graph）数据库、搜索（Search）数据库等等，我就不一一列举了。</span></span></span>
 </div>
 <h2 class="se-6c4fb3c0" data-slate-type="heading" data-slate-object="block" data-key="591"><span data-slate-object="text" data-key="592"><span data-slate-leaf="true" data-offset-key="592:0" data-first-offset="true"><span data-slate-string="true">演进趋势</span></span></span></h2>
 <div class="se-23780c79 " data-slate-type="paragraph" data-slate-object="block" data-key="593">
  <span data-slate-object="text" data-key="594"><span data-slate-leaf="true" data-offset-key="594:0" data-first-offset="true"><span data-slate-string="true">我们在这一章已经从一致性、可用性等方面了解了关系数据库和非关系数据库各自的优势，我想，对这两方面，你应该已经有了自己的认识。现在，我想再补充两个角度，让比较更为全面，分别是扩展性和数据的结构性，我们一起来看看持久层的存储技术的演进趋势。</span></span></span>
 </div>
 <h3 class="se-addbc312" data-slate-type="heading" data-slate-object="block" data-key="595"><span data-slate-object="text" data-key="596"><span data-slate-leaf="true" data-offset-key="596:0" data-first-offset="true"><span data-slate-string="true">1. 从 Scale Up 到 Scale Out</span></span></span></h3>
 <div class="se-4c9105fc " data-slate-type="paragraph" data-slate-object="block" data-key="597">
  <span data-slate-object="text" data-key="598"><span data-slate-leaf="true" data-offset-key="598:0" data-first-offset="true"><span data-slate-string="true">先回顾一下“扩展性”（Scalability，也有翻译为“伸缩性”的）这个概念。</span></span></span>
 </div>
 <div class="se-3b7f4385 " data-slate-type="paragraph" data-slate-object="block" data-key="599">
  <span data-slate-object="text" data-key="600"><span data-slate-leaf="true" data-offset-key="600:0" data-first-offset="true"><span data-slate-string="true">按理说，扩展性是包括“纵向（垂直）扩展”和“横向（水平）扩展”的。当然，如今使用这个词的时候，我们往往特指的是“Scale Out”，也就是横向扩展，说白了，就是通过在同一层上增加硬件资源的方式来增加扩展性，从而提高系统的吞吐量或容量。比如说，增加机器。NoSQL 技术往往具备很强的横向扩展能力，至于其中的一个典型原理，你可以回顾一下 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="601" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="602"><span data-slate-leaf="true" data-offset-key="602:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="603"><span data-slate-leaf="true" data-offset-key="603:0" data-first-offset="true"><span data-slate-string="true"> 的选修课堂“一致性哈希”，你就会明白，为什么 NoSQL 技术可以很方便地在同一层增加硬件资源了。</span></span></span>
 </div>
 <div class="se-fd8b8955 " data-slate-type="paragraph" data-slate-object="block" data-key="604">
  <span data-slate-object="text" data-key="605"><span data-slate-leaf="true" data-offset-key="605:0" data-first-offset="true"><span data-slate-string="true">可是，你知道吗，在很早以前，人们谈“扩展性”的时候，默认指的却是“Scale Up”。它指的是在硬件设施数量不变的基础上，通过增加单个硬件设施的性能和容量来达到同样的“扩展”目的。比如说，把同一台机器的 CPU 换成更好的，把内存升级，把磁盘换成容量更大的，等等。毕竟，在那时候，程序员对于很多问题的思考都还普遍停留在“单机”的层面上。</span></span></span>
 </div>
 <div class="se-6d8bad39 " data-slate-type="paragraph" data-slate-object="block" data-key="606">
  <span data-slate-object="text" data-key="607"><span data-slate-leaf="true" data-offset-key="607:0" data-first-offset="true"><span data-slate-string="true">为什么横向扩展如此重要，以至于成为了“扩展性”的默认指代？</span></span></span>
 </div>
 <div class="se-0b92dd20 " data-slate-type="paragraph" data-slate-object="block" data-key="608">
  <span data-slate-object="text" data-key="609"><span data-slate-leaf="true" data-offset-key="609:0" data-first-offset="true"><span data-slate-string="true">原因很简单，单个硬件设施的性能提升是非常有限的，而且极其昂贵。我记得我刚工作那会儿，去国内某电信运营商开局，众所周知他们“不差钱”，为了提升性能，我们做了很多 Scale Up 的工作，包括把 CPU 升级成了 96 核的。可是你看看现在的互联网公司，哪个会这么玩？因此在现实中，多数情况下，扩容这件事情上，Scale Out 是唯一的选择。</span></span></span>
 </div>
 <h3 class="se-fd8b403e" data-slate-type="heading" data-slate-object="block" data-key="610"><span data-slate-object="text" data-key="611"><span data-slate-leaf="true" data-offset-key="611:0" data-first-offset="true"><span data-slate-string="true">2. 从结构化数据到非结构化数据</span></span></span></h3>
 <div class="se-b01a5ffa " data-slate-type="paragraph" data-slate-object="block" data-key="612">
  <span data-slate-object="text" data-key="613"><span data-slate-leaf="true" data-offset-key="613:0" data-first-offset="true"><span data-slate-string="true">我们使用关系数据库的时候，每一行数据都是严格符合表结构的定义，有多少列，每一列的类型是什么，等等，我们把这类数据叫做“结构化”（structured）数据，而这个确定的“结构”，就是 schema。结构化的数据具备最佳的查询、校验和关联能力。</span></span></span>
 </div>
 <div class="se-95489a06 " data-slate-type="paragraph" data-slate-object="block" data-key="614">
  <span data-slate-object="text" data-key="615"><span data-slate-leaf="true" data-offset-key="615:0" data-first-offset="true"><span data-slate-string="true">但是当我们使用 DynamoDB 这样的 NoSQL 数据库的时候，我们发现，每一行数据依然可以分成一列一列的，但是有多少列，或者每一列的类型，或者表示的具体含义，却变得不再固定了。这时候我们说，这样的结构依然存在，但是共通的部分明显比结构化数据少多了，于是我们把它们叫做“半结构化”（semi-structured）的数据。</span></span></span>
 </div>
 <div class="se-7ef3952a " data-slate-type="paragraph" data-slate-object="block" data-key="616">
  <span data-slate-object="text" data-key="617"><span data-slate-leaf="true" data-offset-key="617:0" data-first-offset="true"><span data-slate-string="true">再一般化，就是“非结构化”（non-structured）数据了，上面说的 S3 就是一个很好的例子。即便 S3 上存储的文件是符合某种结构的（比如 JSON），我们也无法利用这个存储服务来完成依据结构而进行的查询等等操作了。</span></span></span>
 </div>
 <div class="se-3f523c6d " data-slate-type="paragraph" data-slate-object="block" data-key="618">
  <span data-slate-object="text" data-key="619"><span data-slate-leaf="true" data-offset-key="619:0" data-first-offset="true"><span data-slate-string="true">无论是同步还是异步的数据处理，我们总是希望数据的结构性越强越好，因为“结构”本质上意味着“规则”，越强的结构，就越容易使用简单直白的代码逻辑去处理。可是，恰恰相反的是，</span></span></span><span data-slate-object="text" data-key="620"><span data-slate-leaf="true" data-offset-key="620:0" data-first-offset="true"><span class="se-28c9c7a4" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我们在现实中遇到的绝大多数的数据，都是非结构化的</span></span></span></span><span data-slate-object="text" data-key="621"><span data-slate-leaf="true" data-offset-key="621:0" data-first-offset="true"><span data-slate-string="true">，或者说，很难用某一种特定的规则去套。</span></span></span>
 </div>
 <h2 class="se-1cd0b8d2" data-slate-type="heading" data-slate-object="block" data-key="622"><span data-slate-object="text" data-key="623"><span data-slate-leaf="true" data-offset-key="623:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-be664b45 " data-slate-type="paragraph" data-slate-object="block" data-key="624">
  <span data-slate-object="text" data-key="625"><span data-slate-leaf="true" data-offset-key="625:0" data-first-offset="true"><span data-slate-string="true">今天我们从不同角度学习了关系数据库和非关系数据库，掌握了一些存储设计的原理和技巧，希望你可以将内容慢慢消化。</span></span></span>
 </div>
 <div class="se-e5a431b2 " data-slate-type="paragraph" data-slate-object="block" data-key="626">
  <span data-slate-object="text" data-key="627"><span data-slate-leaf="true" data-offset-key="627:0" data-first-offset="true"><span data-slate-string="true">下面是今天的提问环节了，我想换个形式。</span></span></span>
 </div>
 <div class="se-84de571d " data-slate-type="paragraph" data-slate-object="block" data-key="628">
  <span data-slate-object="text" data-key="629"><span data-slate-leaf="true" data-offset-key="629:0" data-first-offset="true"><span data-slate-string="true">我们已经学习了几种常见的数据库范式，下面这张图书馆用户表的数据库表的设计是不合理的，你觉得它满足了第几范式呢？并且，你能不能通过学到的拆分方法，分析一下它的问题，把它进一步优化，消除冗余呢？</span></span></span>
 </div>
 <div class="se-30048552" data-slate-type="image" data-slate-object="block" data-key="630">
  <img class="se-69cd6a0b" src="https://static001.geekbang.org/resource/image/7a/27/7a609fd55a0882a88a95a1dc43fc9c27.jpg">
 </div>
 <div class="se-eb54cec2 " data-slate-type="paragraph" data-slate-object="block" data-key="631">
  <span data-slate-object="text" data-key="632"><span data-slate-leaf="true" data-offset-key="632:0" data-first-offset="true"><span data-slate-string="true">好，今天的内容就到这里。如果有思考、有问题，欢迎在留言区发言，我们一起讨论。</span></span></span>
 </div>
 <h2 class="se-e52599c0" data-slate-type="heading" data-slate-object="block" data-key="633"><span data-slate-object="text" data-key="634"><span data-slate-leaf="true" data-offset-key="634:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-ac4c6aff" data-slate-type="list" data-slate-object="block" data-key="635">
  <div class="se-0749ff05 se-38c26b52" data-slate-type="list-line" data-slate-object="block" data-key="636">
   <span data-slate-object="text" data-key="637"><span data-slate-leaf="true" data-offset-key="637:0" data-first-offset="true"><span data-slate-string="true">文中提到了 Web 2.0 的概念，我推荐你阅读 Web 2.0 的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="638" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="639"><span data-slate-leaf="true" data-offset-key="639:0" data-first-offset="true"><span data-slate-string="true">维基百科词条</span></span></span></a><span data-slate-object="text" data-key="640"><span data-slate-leaf="true" data-offset-key="640:0" data-first-offset="true"><span data-slate-string="true">，以及 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="641" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="642"><span data-slate-leaf="true" data-offset-key="642:0" data-first-offset="true"><span data-slate-string="true">Web 2.0 网站的九个特点</span></span></span></a><span data-slate-object="text" data-key="643"><span data-slate-leaf="true" data-offset-key="643:0" data-first-offset="true"><span data-slate-string="true">这篇文章，以对它有一个明确的认识。</span></span></span>
  </div>
  <div class="se-9e189aa0 se-3f8e64d4" data-slate-type="list-line" data-slate-object="block" data-key="644">
   <span data-slate-object="text" data-key="645"><span data-slate-leaf="true" data-offset-key="645:0" data-first-offset="true"><span data-slate-string="true">对于 NoSQL 的一些特定的术语，以及数据库的分类和比较，推荐你阅读这篇</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="646" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="647"><span data-slate-leaf="true" data-offset-key="647:0" data-first-offset="true"><span data-slate-string="true">什么是 NoSQL？</span></span></span></a>
  </div>
  <div class="se-c89c117b se-dbef1a4e" data-slate-type="list-line" data-slate-object="block" data-key="648">
   <span data-slate-object="text" data-key="649"><span data-slate-leaf="true" data-offset-key="649:0" data-first-offset="true"><span data-slate-string="true">文中介绍了去 IOE 的事儿，正好 Amazon 最近宣称他们正式完成了从 Oracle 关系数据库迁移离开的工作，感兴趣的话可以</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="650" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="651"><span data-slate-leaf="true" data-offset-key="651:0" data-first-offset="true"><span data-slate-string="true">看一看</span></span></span></a><span data-slate-object="text" data-key="652"><span data-slate-leaf="true" data-offset-key="652:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-134e68ec se-eca9ebf2" data-slate-type="list-line" data-slate-object="block" data-key="653">
   <span data-slate-object="text" data-key="654"><span data-slate-leaf="true" data-offset-key="654:0" data-first-offset="true"><span data-slate-string="true">对于分布式存储感兴趣，并且阅读能力还可以的话，有一些经典论文可以是进一步学习的对象，但请注意它们不是我们这个阶段或当前学习周期内需要学习的内容。比如 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="655" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="656"><span data-slate-leaf="true" data-offset-key="656:0" data-first-offset="true"><span data-slate-string="true">Dynamo: Amazon’s Highly Available Key-value Store</span></span></span></a><span data-slate-object="text" data-key="657"><span data-slate-leaf="true" data-offset-key="657:0" data-first-offset="true"><span data-slate-string="true"> 这篇，中文译文可以</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="658" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="659"><span data-slate-leaf="true" data-offset-key="659:0" data-first-offset="true"><span data-slate-string="true">参考这篇</span></span></span></a><span data-slate-object="text" data-key="660"><span data-slate-leaf="true" data-offset-key="660:0" data-first-offset="true"><span data-slate-string="true">，它影响了后来很多分布式系统的设计和发展，我几年前也学习并写了一些</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="661" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="662"><span data-slate-leaf="true" data-offset-key="662:0" data-first-offset="true"><span data-slate-string="true">自己的理解</span></span></span></a><span data-slate-object="text" data-key="663"><span data-slate-leaf="true" data-offset-key="663:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-c5065b2e se-aa0fb418" data-slate-type="list-line" data-slate-object="block" data-key="664">
   <span data-slate-object="text" data-key="665"><span data-slate-leaf="true" data-offset-key="665:0" data-first-offset="true"><span data-slate-string="true">再就是 Google 著名的“三驾马车”了，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="666" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="667"><span data-slate-leaf="true" data-offset-key="667:0" data-first-offset="true"><span data-slate-string="true">GFS</span></span></span></a><span data-slate-object="text" data-key="668"><span data-slate-leaf="true" data-offset-key="668:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="669" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="670"><span data-slate-leaf="true" data-offset-key="670:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="671"><span data-slate-leaf="true" data-offset-key="671:0" data-first-offset="true"><span data-slate-string="true">），</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="672" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="673"><span data-slate-leaf="true" data-offset-key="673:0" data-first-offset="true"><span data-slate-string="true">MapReduce</span></span></span></a><span data-slate-object="text" data-key="674"><span data-slate-leaf="true" data-offset-key="674:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="675" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="676"><span data-slate-leaf="true" data-offset-key="676:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="677"><span data-slate-leaf="true" data-offset-key="677:0" data-first-offset="true"><span data-slate-string="true">） 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="678" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="679"><span data-slate-leaf="true" data-offset-key="679:0" data-first-offset="true"><span data-slate-string="true">BigTable</span></span></span></a><span data-slate-object="text" data-key="680"><span data-slate-leaf="true" data-offset-key="680:0" data-first-offset="true"><span data-slate-string="true">（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="681" class="se-6b9cf0a6 se-ecf2599b"><span data-slate-object="text" data-key="682"><span data-slate-leaf="true" data-offset-key="682:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="683"><span data-slate-leaf="true" data-offset-key="683:0" data-first-offset="true"><span data-slate-string="true">）。我仅仅把它们放在这里，只是供感兴趣且有一定论文阅读能力的程序员朋友参考，而对于本专栏全栈的学习来说，不接触它们是完全没问题的。</span></span></span>
  </div>
 </div>
 <div class="se-08281a2d" data-slate-type="image" data-slate-object="block" data-key="684">
  <img class="se-135dc37d" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |22          |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:46:28.328 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=22 
 {executed in 0 msec}
2020-11-19 17:46:28.329 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title              |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|
|22  |1605755586 |1605755586 |1                |zh-hans  |0       |1                             |1      |0      |25丨设计数据持久层（上）：理论分析 |book |1   |22  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|-----|----|----|

2020-11-19 17:46:28.330 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=22 
 {executed in 1 msec}
2020-11-19 17:46:28.330 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title              |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|
|[unread] |1605755586 |1605755586 |1                |zh-hans  |0       |1                             |1      |0      |25丨设计数据持久层（上）：理论分析 |1   |22  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------|----|----|

2020-11-19 17:46:28.333 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779188, created=1605779188, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='25丨设计数据持久层（上）：理论分析', 
type='book', uid=1, vid=22 where nid=22 
 {executed in 0 msec}
2020-11-19 17:46:28.334 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779188, created=1605779188, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='25丨设计数据持久层（上）：理论分析', 
uid=1, vid=22 where nid=22 
 {executed in 0 msec}
2020-11-19 17:46:28.340 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.341 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|22        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/fbab08d74cc6169a57381ff4259c74bf?bkt=en-06f5c65000af0ed616ce60e50ed3f9062db5915337bac64871a94498f4e0d80f09738bd10e6f9f3d&fid=3757516097-778750-895344502640512&time=1605755585&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-qAj%2F%2FFWg%2BOuRdfF8WeQGIcfm3PA%3D&to=92&size=15689341&sta_dx=15689341&sta_cs=3365&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482219&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=15689341&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6ac6e7505f6f224eb450b795cdcd62bef110b77f49969dcf26b067fb0f2048eb50b666e8ee84c8f0&sl=76480590&expires=8h&rt=pr&r=137199328&mlogid=7502122666148805039&vbdid=2247232042&fin=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a&bflag=92,34-92&rtype=1&dp-logid=7502122666148805039&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=39965399e74cce845ee535e0c17f5077e432c6bc4c65cd14&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a |22          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:46:28.344 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/fbab08d74cc6169a57381ff4259c74bf?bkt=en-06f5c65000af0ed616ce60e50ed3f9062db5915337bac64871a94498f4e0d80f09738bd10e6f9f3d&fid=3757516097-778750-267315225886483&time=1605779186&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-UjEfvmgs640rYrthfrKyjGn5gvE%3D&to=92&size=15689341&sta_dx=15689341&sta_cs=3370&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482219&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=15689341&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6ac6e7505f6f224eb450b795cdcd62bef110b77f49969dcf26b067fb0f2048eb50b666e8ee84c8f0&sl=76480590&expires=8h&rt=pr&r=715564909&mlogid=7508458059768932098&vbdid=2247232042&fin=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a&bflag=92,34-92&rtype=1&dp-logid=7508458059768932098&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=34c17094e7d5a0c9d9c0bd88a1eddc6379d4d78e62a6a8e9&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a', 
revision_id=22 where entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.348 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.349 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/fbab08d74cc6169a57381ff4259c74bf?bkt=en-06f5c65000af0ed616ce60e50ed3f9062db5915337bac64871a94498f4e0d80f09738bd10e6f9f3d&fid=3757516097-778750-895344502640512&time=1605755585&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-qAj%2F%2FFWg%2BOuRdfF8WeQGIcfm3PA%3D&to=92&size=15689341&sta_dx=15689341&sta_cs=3365&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482219&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=15689341&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6ac6e7505f6f224eb450b795cdcd62bef110b77f49969dcf26b067fb0f2048eb50b666e8ee84c8f0&sl=76480590&expires=8h&rt=pr&r=137199328&mlogid=7502122666148805039&vbdid=2247232042&fin=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a&bflag=92,34-92&rtype=1&dp-logid=7502122666148805039&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=39965399e74cce845ee535e0c17f5077e432c6bc4c65cd14&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a |22          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:46:28.352 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/fbab08d74cc6169a57381ff4259c74bf?bkt=en-06f5c65000af0ed616ce60e50ed3f9062db5915337bac64871a94498f4e0d80f09738bd10e6f9f3d&fid=3757516097-778750-267315225886483&time=1605779186&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-UjEfvmgs640rYrthfrKyjGn5gvE%3D&to=92&size=15689341&sta_dx=15689341&sta_cs=3370&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1573482219&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=15689341&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6ac6e7505f6f224eb450b795cdcd62bef110b77f49969dcf26b067fb0f2048eb50b666e8ee84c8f0&sl=76480590&expires=8h&rt=pr&r=715564909&mlogid=7508458059768932098&vbdid=2247232042&fin=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a&bflag=92,34-92&rtype=1&dp-logid=7508458059768932098&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=34c17094e7d5a0c9d9c0bd88a1eddc6379d4d78e62a6a8e9&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=25%E4%B8%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90.m4a', 
revision_id=22 where entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.356 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.358 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|22        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>Middleware</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-07
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    如果设计的话，可能差分成四张表
    <br>1：用户表（用户id、用户名）
    <br>2：图书表（图片编号、图书名称）
    <br>3：借阅表（图书编号、用户编号、借阅时间）
    <br>4：归还表（图书编号、用户编号、归还时间）
    <br>当然实际情况字段可能不止这些
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍，如果没有特殊原因，借阅表和归还表可以合并。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-06
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     老师的扩展阅读确实不错：强化和补充了不少知识，对于进一步学习和提升以及真正掌握知识的这块还是蛮有用的；希望老师能在这个环节更好的分享一些东西，谢谢。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下面来回答今天的问题：其实问题非常典型-两张表的东西放在了一张表里。另外指出老师在提供表时所疏漏的一点，字段名没有注释，实际工作中字段名没有注释一律不让通过-生产系统想都不要想上；DBA会明确告诉开发，注释写好了再发过来。开发手上其实都是DBA给的相关要求，不达要求不要发过来，合规了才给上。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;根据字段名只能大致猜测：应当拆分成用户表和用户使用表。具体做法如下：
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1）user_id、user_name作为用户基本信息表，当然这张表可能还会有一些其他的基本信息；如：phone 手机号码 address 用户住址之类的等等信息；
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2）book_id,book_name,brrow_date,return_date作为用户借书表，这张表追加一个userid与用户基本信息表关联。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个应当是正确的设计方式：至于范式这块我就不解释了；正确的拆分我是给出了。范式的概念不光在表的设计有，索引的设计同样有；实践中修正久了就成习惯了。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其实键值数据库和文档数据库其中不少思想还是借鉴了关系型数据库，不然不会出现大量的no sql数据库支持类sql。基于sql 的一些缺乏灵活性上的改变而已。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍，不过关于其中的 2) 拆分得不完整：把 borrow_date、return_date 可以拆到另外一张借书关系表里面去，因为对于同一本书，book_name 这样的信息不应该出现超过一次：<br><br>图书信息表：<br>book_id / book_name<br><br>借书关系表：<br>book_id / borrower_id / borrow_date / return_date</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |22          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:46:28.362 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.363 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>Middleware</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-07
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    如果设计的话，可能差分成四张表
    <br>1：用户表（用户id、用户名）
    <br>2：图书表（图片编号、图书名称）
    <br>3：借阅表（图书编号、用户编号、借阅时间）
    <br>4：归还表（图书编号、用户编号、归还时间）
    <br>当然实际情况字段可能不止这些
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍，如果没有特殊原因，借阅表和归还表可以合并。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>leslie</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-06
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     老师的扩展阅读确实不错：强化和补充了不少知识，对于进一步学习和提升以及真正掌握知识的这块还是蛮有用的；希望老师能在这个环节更好的分享一些东西，谢谢。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下面来回答今天的问题：其实问题非常典型-两张表的东西放在了一张表里。另外指出老师在提供表时所疏漏的一点，字段名没有注释，实际工作中字段名没有注释一律不让通过-生产系统想都不要想上；DBA会明确告诉开发，注释写好了再发过来。开发手上其实都是DBA给的相关要求，不达要求不要发过来，合规了才给上。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;根据字段名只能大致猜测：应当拆分成用户表和用户使用表。具体做法如下：
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1）user_id、user_name作为用户基本信息表，当然这张表可能还会有一些其他的基本信息；如：phone 手机号码 address 用户住址之类的等等信息；
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2）book_id,book_name,brrow_date,return_date作为用户借书表，这张表追加一个userid与用户基本信息表关联。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个应当是正确的设计方式：至于范式这块我就不解释了；正确的拆分我是给出了。范式的概念不光在表的设计有，索引的设计同样有；实践中修正久了就成习惯了。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其实键值数据库和文档数据库其中不少思想还是借鉴了关系型数据库，不然不会出现大量的no sql数据库支持类sql。基于sql 的一些缺乏灵活性上的改变而已。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍，不过关于其中的 2) 拆分得不完整：把 borrow_date、return_date 可以拆到另外一张借书关系表里面去，因为对于同一本书，book_name 这样的信息不应该出现超过一次：<br><br>图书信息表：<br>book_id / book_name<br><br>借书关系表：<br>book_id / borrower_id / borrow_date / return_date</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |22          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:46:28.366 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.367 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|22        |book   |0     |zh-hans  |22          |https://static001.geekbang.org/resource/image/6b/ce/6b363fd4e755b2daa218b5f24341a2ce.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:46:28.370 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.371 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |22          |https://static001.geekbang.org/resource/image/6b/ce/6b363fd4e755b2daa218b5f24341a2ce.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:46:28.374 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=22 
 {executed in 0 msec}
2020-11-19 17:46:28.375 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |22          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:46:28.379 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=22 
 {executed in 1 msec}
2020-11-19 17:46:28.379 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |22          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:46:28.383 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='11297792373936' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:46:28.383 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:47:17.849 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='11297792373936' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:47:17.849 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:47:17.850 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('11297792373936', 1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:47:17.851 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('11297792373936', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:47:17.851 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|37            |
|--------------|

2020-11-19 17:47:17.868 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='11297792373936' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:47:17.868 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:47:18.273 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='11297792373936' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:47:18.274 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:47:18.275 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('11297792373936', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:47:18.276 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('11297792373936', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:47:18.276 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|38            |
|--------------|

2020-11-19 17:47:18.294 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='11297792373936' 
 {executed in 0 msec}
2020-11-19 17:47:18.294 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|23        |book   |0     |11297792373936   |zh-hans  |23          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:47:18.295 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=23 
 {executed in 0 msec}
2020-11-19 17:47:18.296 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|23  |zh-hans  |book |09253b52-8bd8-4338-b876-e267745a7f56 |23  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:47:18.300 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.301 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |11297792373936   |zh-hans  |23          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:47:18.305 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=23 
 {executed in 1 msec}
2020-11-19 17:47:18.305 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|23  |1   |3     |0            |1  |19 |23 |0  |0  |19  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:47:18.310 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=23 
 {executed in 1 msec}
2020-11-19 17:47:18.321 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|23        |<div data-slate-editor="true" data-key="2016" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-8ffcd355 " data-slate-type="paragraph" data-slate-object="block" data-key="2017">
  <span data-slate-object="text" data-key="2018"><span data-slate-leaf="true" data-offset-key="2018:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-bb715cee " data-slate-type="paragraph" data-slate-object="block" data-key="2019">
  <span data-slate-object="text" data-key="2020"><span data-slate-leaf="true" data-offset-key="2020:0" data-first-offset="true"><span data-slate-string="true">在上一讲中我们着重讲了持久层的一致性，其实，它是分布式系统的一个基础理论。你可能会问，学习基于 Web 的全栈技能，也需要学习一些分布式系统的技术吗？是的！特别是我们在学习其持久层的时候，我们还真得学习一些分布式系统的基础理论，从而正确理解和使用我们熟悉的这些持久层技术。</span></span></span>
 </div>
 <div class="se-c0276940 " data-slate-type="paragraph" data-slate-object="block" data-key="2021">
  <span data-slate-object="text" data-key="2022"><span data-slate-leaf="true" data-offset-key="2022:0" data-first-offset="true"><span data-slate-string="true">CAP 理论就是分布式系统技术中一个必须要掌握的内容，也是在项目早期和设计阶段实实在在地影响我们技术选型、技术决策的内容。</span></span></span>
 </div>
 <h2 class="se-7d5b3d8c" data-slate-type="heading" data-slate-object="block" data-key="2023"><span data-slate-object="text" data-key="2024"><span data-slate-leaf="true" data-offset-key="2024:0" data-first-offset="true"><span data-slate-string="true">理解概念</span></span></span></h2>
 <div class="se-a4e47f45 " data-slate-type="paragraph" data-slate-object="block" data-key="2025">
  <span data-slate-object="text" data-key="2026"><span data-slate-leaf="true" data-offset-key="2026:0" data-first-offset="true"><span data-slate-string="true">我想，你已经很熟悉一致性了。今天，在一致性之后，我们也要涉及到 CAP 的另外的两个方面——可用性和分区容忍性。</span></span></span>
 </div>
 <h3 class="se-f3673ae0" data-slate-type="heading" data-slate-object="block" data-key="2027"><span data-slate-object="text" data-key="2028"><span data-slate-leaf="true" data-offset-key="2028:0" data-first-offset="true"><span data-slate-string="true">1. CAP 的概念</span></span></span></h3>
 <div class="se-dc510a12 " data-slate-type="paragraph" data-slate-object="block" data-key="2029">
  <span data-slate-object="text" data-key="2030"><span data-slate-leaf="true" data-offset-key="2030:0" data-first-offset="true"><span data-slate-string="true">CAP 理论，又叫做布鲁尔理论（Brewer’s Theorem），指的是在一个共享数据的分布式存储系统中，下面三者最多只能同时保证二者，对这三者简单描述如下：</span></span></span>
 </div>
 <div class="se-3291d248" data-slate-type="list" data-slate-object="block" data-key="2031">
  <div class="se-874f7571 se-3fdf6096" data-slate-type="list-line" data-slate-object="block" data-key="2032">
   <span data-slate-object="text" data-key="2033"><span data-slate-leaf="true" data-offset-key="2033:0" data-first-offset="true"><span data-slate-string="true">一致性（Consistency）：读操作得到最近一次写入的数据（其实就是上一讲我们讲的强一致性）；</span></span></span>
  </div>
  <div class="se-07ffcc41 se-0c7151b7" data-slate-type="list-line" data-slate-object="block" data-key="2034">
   <span data-slate-object="text" data-key="2035"><span data-slate-leaf="true" data-offset-key="2035:0" data-first-offset="true"><span data-slate-string="true">可用性（Availability）：请求在限定时间内从非失败的节点得到非失败的响应；</span></span></span>
  </div>
  <div class="se-22f37ad2 se-0b4acec8" data-slate-type="list-line" data-slate-object="block" data-key="2036">
   <span data-slate-object="text" data-key="2037"><span data-slate-leaf="true" data-offset-key="2037:0" data-first-offset="true"><span data-slate-string="true">分区容忍性（Partition Tolerance）：系统允许节点间网络消息的丢失或延迟（出现分区）。</span></span></span>
  </div>
 </div>
 <div class="se-3899434c " data-slate-type="paragraph" data-slate-object="block" data-key="2038">
  <span data-slate-object="text" data-key="2039"><span data-slate-leaf="true" data-offset-key="2039:0" data-first-offset="true"><span data-slate-string="true">下面，请让我进一步说明，从而帮助你理解。</span></span></span>
 </div>
 <div class="se-02d777bb " data-slate-type="paragraph" data-slate-object="block" data-key="2040">
  <span data-slate-object="text" data-key="2041"><span data-slate-leaf="true" data-offset-key="2041:0" data-first-offset="true"><span class="se-48ae1582" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">一致性，这里体现了这个存储系统对统一数据提供的读写操作是线性化的。</span></span></span></span><span data-slate-object="text" data-key="2042"><span data-slate-leaf="true" data-offset-key="2042:0" data-first-offset="true"><span data-slate-string="true">如果客户端写入数据，并且写操作返回成功给客户端，那么在下一次读取的时候（下一次写入以前），如果系统返回了“非失败”的响应，就一定是读出了完整、正确（最新）的那份数据，而不会读取到过期数据，也不会读取到中间数据。</span></span></span>
 </div>
 <div class="se-bc22c3ea " data-slate-type="paragraph" data-slate-object="block" data-key="2043">
  <span data-slate-object="text" data-key="2044"><span data-slate-leaf="true" data-offset-key="2044:0" data-first-offset="true"><span class="se-006edf28" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">可用性，体现的是存储系统持续提供服务的能力</span></span></span></span><span data-slate-object="text" data-key="2045"><span data-slate-leaf="true" data-offset-key="2045:0" data-first-offset="true"><span data-slate-string="true">，这里表现在两个方面：</span></span></span>
 </div>
 <div class="se-588dc21c" data-slate-type="list" data-slate-object="block" data-key="2046">
  <div class="se-d907c046 se-294ce592" data-slate-type="list-line" data-slate-object="block" data-key="2047">
   <span data-slate-object="text" data-key="2048"><span data-slate-leaf="true" data-offset-key="2048:0" data-first-offset="true"><span class="se-f20542f5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">返回“非失败”的响应</span></span></span></span><span data-slate-object="text" data-key="2049"><span data-slate-leaf="true" data-offset-key="2049:0" data-first-offset="true"><span data-slate-string="true">，就是说，不是光有响应就可以了，系统得是在实实在在地提供服务，而不是在报错；</span></span></span>
  </div>
  <div class="se-ed137b01 se-89a18af0" data-slate-type="list-line" data-slate-object="block" data-key="2050">
   <span data-slate-object="text" data-key="2051"><span data-slate-leaf="true" data-offset-key="2051:0" data-first-offset="true"><span class="se-269de1b2" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在限定时间内返回</span></span></span></span><span data-slate-object="text" data-key="2052"><span data-slate-leaf="true" data-offset-key="2052:0" data-first-offset="true"><span data-slate-string="true">，就是说，这个响应是预期时间内返回的，而不出现请求超时。</span></span></span>
  </div>
 </div>
 <div class="se-0e207b76 " data-slate-type="paragraph" data-slate-object="block" data-key="2053">
  <span data-slate-object="text" data-key="2054"><span data-slate-leaf="true" data-offset-key="2054:0" data-first-offset="true"><span data-slate-string="true">请注意，这里说的是“非失败”响应，而并没有说“正确”的响应。也就是说，返回了数据，但可以是过期的，可以是中间数据，因为数据是否“正确”并非由可用性来保证，而是由一致性来保证的。系统的单个节点可能会在任意时间内故障、出错，但是系统总能够靠处于非失败（non-failing）状态的其它节点来继续提供服务，保证可用性。</span></span></span>
 </div>
 <div class="se-44d57f4a " data-slate-type="paragraph" data-slate-object="block" data-key="2055">
  <span data-slate-object="text" data-key="2056"><span data-slate-leaf="true" data-offset-key="2056:0" data-first-offset="true"><span class="se-c80c446a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">分区容忍性，体现了系统是否能够接纳基于数据的网络分区。</span></span></span></span><span data-slate-object="text" data-key="2057"><span data-slate-leaf="true" data-offset-key="2057:0" data-first-offset="true"><span data-slate-string="true">只要出现了网络故障，无论什么原因导致某个节点和系统的其它节点失去了联系，节点间的数据同步操作无法被“及时”完成，那么，即便它依然可以对外（客户端）提供服务，网络分区也已经出现了。</span></span></span>
 </div>
 <div class="se-4a345791 " data-slate-type="paragraph" data-slate-object="block" data-key="2058">
  <span data-slate-object="text" data-key="2059"><span data-slate-leaf="true" data-offset-key="2059:0" data-first-offset="true"><span data-slate-string="true">当然，如果数据只有一份，不存在其它节点保存的副本，或不需要跨节点的数据共享，那么，这就不存在“分区”，这样的分布式存储系统也就不是 CAP 关心的对象。</span></span></span>
 </div>
 <h3 class="se-870c1392" data-slate-type="heading" data-slate-object="block" data-key="2060"><span data-slate-object="text" data-key="2061"><span data-slate-leaf="true" data-offset-key="2061:0" data-first-offset="true"><span data-slate-string="true">2. 进一步理解</span></span></span></h3>
 <div class="se-c9e4a0d8 " data-slate-type="paragraph" data-slate-object="block" data-key="2062">
  <span data-slate-object="text" data-key="2063"><span data-slate-leaf="true" data-offset-key="2063:0" data-first-offset="true"><span data-slate-string="true">如果你觉得模糊，没关系，让我使用一个简单的图示来帮你理解。</span></span></span>
 </div>
 <div class="se-68a3a2a6" data-slate-type="image" data-slate-object="block" data-key="2064">
  <img class="se-b7c09a95" src="https://static001.geekbang.org/resource/image/9a/4b/9a552d641a142f77650b5fd07988174b.jpg">
 </div>
 <div class="se-51d96ebc " data-slate-type="paragraph" data-slate-object="block" data-key="2065">
  <span data-slate-object="text" data-key="2066"><span data-slate-leaf="true" data-offset-key="2066:0" data-first-offset="true"><span data-slate-string="true">有这样一个存储系统，存在两个节点 A 和 B，各自存放一份数据拷贝。那么在正常情况下，客户端无论写数据到 A 还是 B，都需要将数据同步到另一个节点，再返回成功。比如图示中带序号的四个箭头：</span></span></span>
 </div>
 <div class="se-ca1a7bb3" data-slate-type="list" data-slate-object="block" data-key="2067">
  <div class="se-87de0c2a se-ac73d95f" data-slate-type="list-line" data-slate-object="block" data-key="2068">
   <span data-slate-object="text" data-key="2069"><span data-slate-leaf="true" data-offset-key="2069:0" data-first-offset="true"><span data-slate-string="true">箭头 ①，客户端写数据到节点 A；</span></span></span>
  </div>
  <div class="se-4b74bb03 se-efae570b" data-slate-type="list-line" data-slate-object="block" data-key="2070">
   <span data-slate-object="text" data-key="2071"><span data-slate-leaf="true" data-offset-key="2071:0" data-first-offset="true"><span data-slate-string="true">箭头 ②，节点 A 同步数据变更到节点 B；</span></span></span>
  </div>
  <div class="se-a389c569 se-90ee5f77" data-slate-type="list-line" data-slate-object="block" data-key="2072">
   <span data-slate-object="text" data-key="2073"><span data-slate-leaf="true" data-offset-key="2073:0" data-first-offset="true"><span data-slate-string="true">箭头 ③，节点 B 返回成功响应到节点 A；</span></span></span>
  </div>
  <div class="se-4f2d7c1a se-a796ce92" data-slate-type="list-line" data-slate-object="block" data-key="2074">
   <span data-slate-object="text" data-key="2075"><span data-slate-leaf="true" data-offset-key="2075:0" data-first-offset="true"><span data-slate-string="true">箭头 ④，节点 A 返回成功响应给客户端。</span></span></span>
  </div>
 </div>
 <div class="se-dd3297dd " data-slate-type="paragraph" data-slate-object="block" data-key="2076">
  <span data-slate-object="text" data-key="2077"><span data-slate-leaf="true" data-offset-key="2077:0" data-first-offset="true"><span data-slate-string="true">不知道你有没有回想起 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2078" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2079"><span data-slate-leaf="true" data-offset-key="2079:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="2080"><span data-slate-leaf="true" data-offset-key="2080:0" data-first-offset="true"><span data-slate-string="true"> 中的 Multi-Master 架构，对，但唯一需要特别指出的不同是，节点间数据拷贝是同步进行的，需要完成拷贝以后再返回响应，因为我们需要保证一致性。</span></span></span>
 </div>
 <div class="se-e2bf571b " data-slate-type="paragraph" data-slate-object="block" data-key="2081">
  <span data-slate-object="text" data-key="2082"><span data-slate-leaf="true" data-offset-key="2082:0" data-first-offset="true"><span data-slate-string="true">之后，客户端尝试读取刚写入的数据，无论是从节点 A 还是 B，都可以得到准确的数据：</span></span></span>
 </div>
 <div class="se-c0a79c67" data-slate-type="image" data-slate-object="block" data-key="2083">
  <img class="se-d45e07ab" src="https://static001.geekbang.org/resource/image/8f/8a/8fe1b2a21d18314edd93fc7d0aa9998a.jpg">
 </div>
 <div class="se-cebdcaa7 " data-slate-type="paragraph" data-slate-object="block" data-key="2084">
  <span data-slate-object="text" data-key="2085"><span data-slate-leaf="true" data-offset-key="2085:0" data-first-offset="true"><span data-slate-string="true">好，这种情况下数据在 A、B 上都是一致的，并且系统也是可用的。</span></span></span>
 </div>
 <div class="se-b94f1bb9 " data-slate-type="paragraph" data-slate-object="block" data-key="2086">
  <span data-slate-object="text" data-key="2087"><span data-slate-leaf="true" data-offset-key="2087:0" data-first-offset="true"><span data-slate-string="true">但是，现在网络突然出现故障，A 和 B 之间的数据拷贝通道被打断了，也就是说，分区发生了。这时候客户端再写入 A 就会出现以下情况：</span></span></span>
 </div>
 <div class="se-5ac50258" data-slate-type="image" data-slate-object="block" data-key="2088">
  <img class="se-5f8614f1" src="https://static001.geekbang.org/resource/image/9e/88/9e08dd2874a9bc6810d7813057dcef88.jpg">
 </div>
 <div class="se-5df71744 " data-slate-type="paragraph" data-slate-object="block" data-key="2089">
  <span data-slate-object="text" data-key="2090"><span data-slate-leaf="true" data-offset-key="2090:0" data-first-offset="true"><span data-slate-string="true">你看，这时候节点 A 已经无法将数据“及时”同步到节点 B 了， 那么，节点 A 是否应该将数据写入自己，并返回“成功”给客户端呢？它陷入了两难：</span></span></span>
 </div>
 <div class="se-39f40e3f" data-slate-type="list" data-slate-object="block" data-key="2091">
  <div class="se-9995d047 se-eb522c0c" data-slate-type="list-line" data-slate-object="block" data-key="2092">
   <span data-slate-object="text" data-key="2093"><span data-slate-leaf="true" data-offset-key="2093:0" data-first-offset="true"><span class="se-8083af52" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果写入并返回成功，满足系统的可用性，就意味着丢失了数据一致性。</span></span></span></span><span data-slate-object="text" data-key="2094"><span data-slate-leaf="true" data-offset-key="2094:0" data-first-offset="true"><span data-slate-string="true">因为节点 A 的数据是最新的，而节点 B 的数据是过期的。</span></span></span>
  </div>
  <div class="se-3f6f2048 se-5e6a0007" data-slate-type="list-line" data-slate-object="block" data-key="2095">
   <span data-slate-object="text" data-key="2096"><span data-slate-leaf="true" data-offset-key="2096:0" data-first-offset="true"><span class="se-5f58ba2b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果不写入数据，而直接返回失败</span></span></span></span><span data-slate-object="text" data-key="2097"><span data-slate-leaf="true" data-offset-key="2097:0" data-first-offset="true"><span data-slate-string="true">，即节点 A 拒绝写操作，那么 A 和 B 节点上的</span></span></span><span data-slate-object="text" data-key="2098"><span data-slate-leaf="true" data-offset-key="2098:0" data-first-offset="true"><span class="se-7abf6b1d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">数据依然满足一致性（写入失败，但依然都是相互一致的老数据），但是整个系统失去了可用性。</span></span></span></span>
  </div>
 </div>
 <div class="se-25aa2e69 " data-slate-type="paragraph" data-slate-object="block" data-key="2099">
  <span data-slate-object="text" data-key="2100"><span data-slate-leaf="true" data-offset-key="2100:0" data-first-offset="true"><span data-slate-string="true">你看，我们怎么也无法同时保证一致性、可用性和分区容忍性这三者。</span></span></span>
 </div>
 <h3 class="se-bb63dd42" data-slate-type="heading" data-slate-object="block" data-key="2101"><span data-slate-object="text" data-key="2102"><span data-slate-leaf="true" data-offset-key="2102:0" data-first-offset="true"><span data-slate-string="true">3. 三选二 ？</span></span></span></h3>
 <div class="se-2d89d578 " data-slate-type="paragraph" data-slate-object="block" data-key="2103">
  <span data-slate-object="text" data-key="2104"><span data-slate-leaf="true" data-offset-key="2104:0" data-first-offset="true"><span data-slate-string="true">紧接着我要谈一谈对于 CAP 理论一个很大的误解——三选二。从上面对于 CAP 的描述来看， CAP 的应用似乎就是一个三选二的选择题，但事实上，完全不是这样的。</span></span></span>
 </div>
 <div class="se-dbf6c945 " data-slate-type="paragraph" data-slate-object="block" data-key="2105">
  <span data-slate-object="text" data-key="2106"><span data-slate-leaf="true" data-offset-key="2106:0" data-first-offset="true"><span data-slate-string="true">开门见山地说，</span></span></span><span data-slate-object="text" data-key="2107"><span data-slate-leaf="true" data-offset-key="2107:0" data-first-offset="true"><span class="se-bed370e5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在讨论 CAP 定理的时候，P，也就是分区容忍性，是必选项。</span></span></span></span><span data-slate-object="text" data-key="2108"><span data-slate-leaf="true" data-offset-key="2108:0" data-first-offset="true"><span data-slate-string="true">具体来说，跨区域的系统，分区容忍性往往是不可以拿掉的，因为无论是硬件损坏、机房断电，还是地震海啸，都是无法预料、无法避免的，任何时间都可能出现网络故障而发生分区，因此工程师能做的，就是从 CP 和 AP 中选择合适的那一个。</span></span></span>
 </div>
 <div class="se-a3a09fde " data-slate-type="paragraph" data-slate-object="block" data-key="2109">
  <span data-slate-object="text" data-key="2110"><span data-slate-leaf="true" data-offset-key="2110:0" data-first-offset="true"><span data-slate-string="true">你可以想想上面我拿图示举的那个例子，在分区发生的时候，最多只能保证一致性和可用性一个。也就是说，CAP 理论不是三选二的，而是二选一，当然，具体选哪个，我们需要“权衡”。</span></span></span>
 </div>
 <div class="se-2e93da40 " data-slate-type="paragraph" data-slate-object="block" data-key="2111">
  <span data-slate-object="text" data-key="2112"><span data-slate-leaf="true" data-offset-key="2112:0" data-first-offset="true"><span data-slate-string="true">需要特别说明的是，</span></span></span><span data-slate-object="text" data-key="2113"><span data-slate-leaf="true" data-offset-key="2113:0" data-first-offset="true"><span class="se-2a2445b1" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这里说的是只能“保证”一致性和可用性二者之一，而不是说，在系统正常运行时，二者不可能“同时满足”。</span></span></span></span><span data-slate-object="text" data-key="2114"><span data-slate-leaf="true" data-offset-key="2114:0" data-first-offset="true"><span data-slate-string="true">在系统运行正常的时候，网络分区没有出现，那么技术上我们是可能同时满足一致性和可用性两者的。</span></span></span>
 </div>
 <div class="se-4d0eb7c1 " data-slate-type="paragraph" data-slate-object="block" data-key="2115">
  <span data-slate-object="text" data-key="2116"><span data-slate-leaf="true" data-offset-key="2116:0" data-first-offset="true"><span data-slate-string="true">这时你可能会问，难道没有 CA，即同时“保证”一致性和可用性，而牺牲掉分区容忍性的系统吗？</span></span></span>
 </div>
 <div class="se-50ad8753 " data-slate-type="paragraph" data-slate-object="block" data-key="2117">
  <span data-slate-object="text" data-key="2118"><span data-slate-leaf="true" data-offset-key="2118:0" data-first-offset="true"><span data-slate-string="true">有！</span></span></span><span data-slate-object="text" data-key="2119"><span data-slate-leaf="true" data-offset-key="2119:0" data-first-offset="true"><span class="se-83e76ecc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">但请注意，那其实已经不是 CAP 理论关心的对象了，因为 CAP 要求的是节点间的数据交换和数据共享。</span></span></span></span><span data-slate-object="text" data-key="2120"><span data-slate-leaf="true" data-offset-key="2120:0" data-first-offset="true"><span data-slate-string="true">任何时候都不会有分区发生，这种系统基本上有这样两种形式：</span></span></span>
 </div>
 <div class="se-efda4e6f" data-slate-type="list" data-slate-object="block" data-key="2121">
  <div class="se-e5693294 se-3c56f0bb" data-slate-type="list-line" data-slate-object="block" data-key="2122">
   <span data-slate-object="text" data-key="2123"><span data-slate-leaf="true" data-offset-key="2123:0" data-first-offset="true"><span class="se-5b6b373f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">单节点系统</span></span></span></span><span data-slate-object="text" data-key="2124"><span data-slate-leaf="true" data-offset-key="2124:0" data-first-offset="true"><span data-slate-string="true">，这很好理解，没有节点间数据的交换，那么无论网络出不出故障，系统始终只包含一个节点。比方说，传统的关系型数据库，像 MySQL 或者 OracleDB，在单节点的配置下。</span></span></span>
  </div>
  <div class="se-a7fd697d se-b587a492" data-slate-type="list-line" data-slate-object="block" data-key="2125">
   <span data-slate-object="text" data-key="2126"><span data-slate-leaf="true" data-offset-key="2126:0" data-first-offset="true"><span class="se-742e61f2" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">虽然是多节点，但是节点间没有数据共享和数据交换</span></span></span></span><span data-slate-object="text" data-key="2127"><span data-slate-leaf="true" data-offset-key="2127:0" data-first-offset="true"><span data-slate-string="true">——即节点上的数据不需要拷贝到其它节点上。比方说，无数据副本（Replica）配置的集群 Elasticsearch 或 Memcached，在经过 hash 以后，每个节点都存放着单份不同的数据。这种情况看起来也算分布式存储，但是节点之间是互相独立的。</span></span></span>
  </div>
 </div>
 <h2 class="se-fe58bddb" data-slate-type="heading" data-slate-object="block" data-key="2128"><span data-slate-object="text" data-key="2129"><span data-slate-leaf="true" data-offset-key="2129:0" data-first-offset="true"><span data-slate-string="true">存储技术的选择：NoSQL 三角形</span></span></span></h2>
 <div class="se-71017131 " data-slate-type="paragraph" data-slate-object="block" data-key="2130">
  <span data-slate-object="text" data-key="2131"><span data-slate-leaf="true" data-offset-key="2131:0" data-first-offset="true"><span data-slate-string="true">在谈到根据 CAP 来选择技术的时候，我想先来介绍一下 NoSQL，你将会看到它们大量地分布在下面“NoSQL 三角形”的 CP 和 AP 两条边上。</span></span></span>
 </div>
 <div class="se-507b2583 " data-slate-type="paragraph" data-slate-object="block" data-key="2132">
  <span data-slate-object="text" data-key="2133"><span data-slate-leaf="true" data-offset-key="2133:0" data-first-offset="true"><span data-slate-string="true">那么，到底什么是 NoSQL 呢？我们可以简单地认为，NoSQL 是“非关系数据库”，和它相对应的是传统的“关系数据库”。它被设计出来的目的，并非要取代关系数据库，而是成为关系数据库的补充，即“Not Only SQL”。</span></span></span>
 </div>
 <div class="se-ee3972a9 " data-slate-type="paragraph" data-slate-object="block" data-key="2134">
  <span data-slate-object="text" data-key="2135"><span data-slate-leaf="true" data-offset-key="2135:0" data-first-offset="true"><span data-slate-string="true">也就是说，它放弃了对于“关系”的支持，</span></span></span><span data-slate-object="text" data-key="2136"><span data-slate-leaf="true" data-offset-key="2136:0" data-first-offset="true"><span class="se-5e295b79" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">损失了强结构定义和关系查询等能力，但是它往往可以具备比关系数据库高得多的性能和横向扩展性（scalability）等优势。</span></span></span></span><span data-slate-object="text" data-key="2137"><span data-slate-leaf="true" data-offset-key="2137:0" data-first-offset="true"><span data-slate-string="true">这在 Web 2.0 时代对于一些关系数据库不擅长的场景，例如数据量巨大，数据之间的关联关系较弱，数据结构（schema）多变，强可用性要求和低一致性要求等等，NoSQL 可以发挥其最大的价值。</span></span></span>
 </div>
 <div class="se-5abfb6df " data-slate-type="paragraph" data-slate-object="block" data-key="2138">
  <span data-slate-object="text" data-key="2139"><span data-slate-leaf="true" data-offset-key="2139:0" data-first-offset="true"><span data-slate-string="true">在实际业务中，我们可以利用 CAP 定理来权衡和帮助选择合适的存储技术，且看下面这张 NoSQL 系统的 CAP 三角形（来自 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2140" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2141"><span data-slate-leaf="true" data-offset-key="2141:0" data-first-offset="true"><span data-slate-string="true">Visual Guide to NoSQL Systems</span></span></span></a><span data-slate-object="text" data-key="2142"><span data-slate-leaf="true" data-offset-key="2142:0" data-first-offset="true"><span data-slate-string="true">）。尺有所短，寸有所长，我们可以从 CAP 的角度来理解这些技术的优劣。</span></span></span>
 </div>
 <div class="se-9f073759" data-slate-type="image" data-slate-object="block" data-key="2143">
  <img class="se-3c0938fe" src="https://static001.geekbang.org/resource/image/90/52/90a6c7ddb6556fa206f95a80a7a6c652.jpg">
 </div>
 <div class="se-8e792848 " data-slate-type="paragraph" data-slate-object="block" data-key="2144">
  <span data-slate-object="text" data-key="2145"><span data-slate-leaf="true" data-offset-key="2145:0" data-first-offset="true"><span data-slate-string="true">从图中可以发现，关系数据几乎都落在了 CA 一侧，但是请注意，技术也在不断更新，许多关系数据库如今也可以通过配置而形成其它节点的数据冗余；有时，我们则是在其上方自己实现数据冗余，比如配置数据库的数据同步到备份数据库。</span></span></span>
 </div>
 <div class="se-6f4b7603 " data-slate-type="paragraph" data-slate-object="block" data-key="2146">
  <span data-slate-object="text" data-key="2147"><span data-slate-leaf="true" data-offset-key="2147:0" data-first-offset="true"><span data-slate-string="true">无论哪一种方法，一旦其它节点用于数据冗余的数据副本出现，这个存储系统就落到上述三角形的另外两边去了。</span></span></span>
 </div>
 <div class="se-afbcd395 " data-slate-type="paragraph" data-slate-object="block" data-key="2148">
  <span data-slate-object="text" data-key="2149"><span data-slate-leaf="true" data-offset-key="2149:0" data-first-offset="true"><span data-slate-string="true">云上的 NoSQL 存储服务，多数落在了 AP 一侧，这也和 NoSQL 运动可用性优先保证而降级一致性的主题符合。比如 Amazon 的 DynamoDB，但是这个也是可以通过不同的设置选项来改变的，比如 DynamoDB 默认采用最终一致性，但也允许配置为强一致性，那时它就落到了 CP 上面。</span></span></span>
 </div>
 <h3 class="se-9ff094d2" data-slate-type="heading" data-slate-object="block" data-key="2150"><span data-slate-object="text" data-key="2151"><span data-slate-leaf="true" data-offset-key="2151:0" data-first-offset="true"><span data-slate-string="true">实际场景</span></span></span></h3>
 <div class="se-db7c32a4 " data-slate-type="paragraph" data-slate-object="block" data-key="2152">
  <span data-slate-object="text" data-key="2153"><span data-slate-leaf="true" data-offset-key="2153:0" data-first-offset="true"><span data-slate-string="true">接着我们考虑几个实际应用场景，看看该采用哪一条边的技术呢？既然是基于 Web 的全栈工程师的技术学习，我就来举两个基于网站应用的例子。</span></span></span>
 </div>
 <div class="se-1d05b047 " data-slate-type="paragraph" data-slate-object="block" data-key="2154">
  <span data-slate-object="text" data-key="2155"><span data-slate-leaf="true" data-offset-key="2155:0" data-first-offset="true"><span data-slate-string="true">还记得我们在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2156" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2157"><span data-slate-leaf="true" data-offset-key="2157:0" data-first-offset="true"><span data-slate-string="true">[第 09 讲]</span></span></span></a><span data-slate-object="text" data-key="2158"><span data-slate-leaf="true" data-offset-key="2158:0" data-first-offset="true"><span data-slate-string="true"> 中谈到的页面聚合吗？对于门户网站来说，无论是显示的数据，还是图片、样式等等静态资源，通过 CDN 的方式，都可以把副本存放在离用户较近的节点，这样它们的获取可以减少延迟，提高用户体验。因此，这些系统联合起来，就形成了一个可以使用 CAP 讨论的分布式系统。</span></span></span>
 </div>
 <div class="se-a019917c " data-slate-type="paragraph" data-slate-object="block" data-key="2159">
  <span data-slate-object="text" data-key="2160"><span data-slate-leaf="true" data-offset-key="2160:0" data-first-offset="true"><span data-slate-string="true">那么，很容易理解的是，且不用说网络故障而发生分区的情况，即便在正常情况下，这些信息并不需要具备那么严格的“即时性”，新闻早显示、晚显示几秒钟，乃至几分钟，都不是什么问题，上海的读者比北京的读者晚看到一会儿，也不是什么问题。但是，大型网站页面打不开，就是一个问题了，这显然会影响用户的体验。因此，从这个角度说，我们可以牺牲一致性，但需要尽量保证可用性，因此这是一个选择 AP 的例子。</span></span></span>
 </div>
 <div class="se-a6a7aa03 " data-slate-type="paragraph" data-slate-object="block" data-key="2161">
  <span data-slate-object="text" data-key="2162"><span data-slate-leaf="true" data-offset-key="2162:0" data-first-offset="true"><span data-slate-string="true">事实上，对于大型的系统而言，我们往往不需要严格的一致性，但是我们希望保证可用性，因此在大多数情况下我们都会选择 AP。但是，有时情况却未必如此。</span></span></span>
 </div>
 <div class="se-23bb7246 " data-slate-type="paragraph" data-slate-object="block" data-key="2163">
  <span data-slate-object="text" data-key="2164"><span data-slate-leaf="true" data-offset-key="2164:0" data-first-offset="true"><span data-slate-string="true">再举一个例子，航空公司卖机票，在不考虑超售的情况下，一座一票，航空公司的网站当然可以采用上面类似的做法；有时，甚至在正常的情况下，余票的显示都可以不是非常准确的（比如显示“有票”可以避免显示这个具体数字）。但是，当客户真正在选座售票的时候，即扣款和出票的时候就不是这样的了，一致性必须优先保证。因为如果可用性保证不了，即有时候订票失败，用户最多也就是牢骚几句，这还可以接受，但要是出现一致性问题，即两个人订了同一个座位的票，那就是很严重的问题了。</span></span></span>
 </div>
 <div class="se-324952e7 " data-slate-type="paragraph" data-slate-object="block" data-key="2165">
  <span data-slate-object="text" data-key="2166"><span data-slate-leaf="true" data-offset-key="2166:0" data-first-offset="true"><span data-slate-string="true">最后，我想说的是，这里的选择是一个带有灰度的过程，并非只有 0 和 1 这两个绝对的答案，我们还是需要具体问题具体分析，不要一刀切。</span></span></span>
 </div>
 <div class="se-7ba58467 " data-slate-type="paragraph" data-slate-object="block" data-key="2167">
  <span data-slate-object="text" data-key="2168"><span data-slate-leaf="true" data-offset-key="2168:0" data-first-offset="true"><span class="se-f5d113ac" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">从特性上说，甚至可以部分特性做到 CP，部分做到 AP，这都是有可能的。</span></span></span></span><span data-slate-object="text" data-key="2169"><span data-slate-leaf="true" data-offset-key="2169:0" data-first-offset="true"><span data-slate-string="true">比如说，涉及钱的问题一定是 CP 吗？不一定，ATM 机就是一个很经典的例子，在网络故障发生时，ATM 会处于 stand-alone 模式，在这种模式下，用户依然可以执行查询余额等操作（很可能数额不准确），甚至还可以取款，但是这时的取款会有所限制，例如限制一个额度（银行承担风险），或者是限制只能给某些银行的卡取款，毕竟可用性和一致性的丢失会带来不同的风险和后果，两害相权取其轻。</span></span></span>
 </div>
 <h2 class="se-dad141d9" data-slate-type="heading" data-slate-object="block" data-key="2170"><span data-slate-object="text" data-key="2171"><span data-slate-leaf="true" data-offset-key="2171:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-f6980603 " data-slate-type="paragraph" data-slate-object="block" data-key="2172">
  <span data-slate-object="text" data-key="2173"><span data-slate-leaf="true" data-offset-key="2173:0" data-first-offset="true"><span data-slate-string="true">今天我们学习和理解了 CAP 理论，并且了解了一些实际应用的例子。希望你能够通过今天的内容，彻底掌握其原理，并能够逐渐在设计中应用起来，特别是在技术选型做“权衡”的时候。</span></span></span>
 </div>
 <div class="se-0f94c6da " data-slate-type="paragraph" data-slate-object="block" data-key="2174">
  <span data-slate-object="text" data-key="2175"><span data-slate-leaf="true" data-offset-key="2175:0" data-first-offset="true"><span data-slate-string="true">现在，我们来看一下今天的思考题吧：</span></span></span>
 </div>
 <div class="se-d6d16b00" data-slate-type="list" data-slate-object="block" data-key="2176">
  <div class="se-98bc4e3a se-870a2a93" data-slate-type="list-line" data-slate-object="block" data-key="2177">
   <span data-slate-object="text" data-key="2178"><span data-slate-leaf="true" data-offset-key="2178:0" data-first-offset="true"><span data-slate-string="true">你是否了解或是接触过分布式系统，特别是分布式存储系统，它是否能归类到 NoSQL 三角形中的某一条边上呢？</span></span></span>
  </div>
  <div class="se-9af0b8ac se-01407cf6" data-slate-type="list-line" data-slate-object="block" data-key="2179">
   <span data-slate-object="text" data-key="2180"><span data-slate-leaf="true" data-offset-key="2180:0" data-first-offset="true"><span data-slate-string="true">互联网上的绝大多数系统都是可以牺牲一致性，而优先保证可用性的，但也有一些例外。你能举出几个即便牺牲可用性，也要保证数据一致性的例子来吗？</span></span></span>
  </div>
 </div>
 <div class="se-8205a713 " data-slate-type="paragraph" data-slate-object="block" data-key="2181">
  <span data-slate-object="text" data-key="2182"><span data-slate-leaf="true" data-offset-key="2182:0" data-first-offset="true"><span data-slate-string="true">今天的主要内容就到这里，欢迎你在留言区进行讨论，也欢迎你继续学习下面的选修课堂。</span></span></span>
 </div>
 <h2 class="se-b64d87b3" data-slate-type="heading" data-slate-object="block" data-key="2183"><span data-slate-object="text" data-key="2184"><span data-slate-leaf="true" data-offset-key="2184:0" data-first-offset="true"><span data-slate-string="true">选修课堂：从 ACID 到 BASE</span></span></span></h2>
 <div class="se-cdde2f74 " data-slate-type="paragraph" data-slate-object="block" data-key="2185">
  <span data-slate-object="text" data-key="2186"><span data-slate-leaf="true" data-offset-key="2186:0" data-first-offset="true"><span data-slate-string="true">ACID 和 BASE，正好是英文里“酸”和“碱”的意思。有意思的是，关系数据库和非关系数据库，它们各自的重要特性，也恰恰可以用酸和碱来体现。下面我来简单做个比较，你可以从中感受一下二者的差异和对立性，为我们后两讲介绍技术选型打下基础。</span></span></span>
 </div>
 <div class="se-d17428e2 " data-slate-type="paragraph" data-slate-object="block" data-key="2187">
  <span data-slate-object="text" data-key="2188"><span data-slate-leaf="true" data-offset-key="2188:0" data-first-offset="true"><span data-slate-string="true">先说说 ACID。</span></span></span>
 </div>
 <div class="se-0072424a " data-slate-type="paragraph" data-slate-object="block" data-key="2189">
  <span data-slate-object="text" data-key="2190"><span data-slate-leaf="true" data-offset-key="2190:0" data-first-offset="true"><span data-slate-string="true">关系数据库的一大优势，就是可以通过事务的支持来实现强一致性，而事务，通常可以包含这样几个特性。</span></span></span>
 </div>
 <div class="se-f0994de6" data-slate-type="list" data-slate-object="block" data-key="2191">
  <div class="se-8598c06e se-bd528b47" data-slate-type="list-line" data-slate-object="block" data-key="2192">
   <span data-slate-object="text" data-key="2193"><span data-slate-leaf="true" data-offset-key="2193:0" data-first-offset="true"><span data-slate-string="true">Atomicity：原子性，指的是无论事务执行的过程有多么复杂，要么提交成功改变状态，要么提交失败回滚到提交前的状态，这些过程是原子化的，不存在第三种状态。</span></span></span>
  </div>
  <div class="se-a66158ce se-3119a3ff" data-slate-type="list-line" data-slate-object="block" data-key="2194">
   <span data-slate-object="text" data-key="2195"><span data-slate-leaf="true" data-offset-key="2195:0" data-first-offset="true"><span data-slate-string="true">Consistency：一致性，这里的一致性和我们前面介绍的一致性含义略有不同，它指的是事务开始前、结束后，数据库的完整性都没有被破坏，所有键、数据类型、检查、触发器等等都依然有效。</span></span></span>
  </div>
  <div class="se-65d94ceb se-e83b6ab1" data-slate-type="list-line" data-slate-object="block" data-key="2196">
   <span data-slate-object="text" data-key="2197"><span data-slate-leaf="true" data-offset-key="2197:0" data-first-offset="true"><span data-slate-string="true">Isolation：隔离性，指的是多个并发事务同一时间对于数据进行读写的能力，同时执行，互不影响。事务隔离分为四大级别，不同的数据库默认实现在不同的级别，我在扩展阅读中放置了一些学习材料，感兴趣的话可以进一步学习。</span></span></span>
  </div>
  <div class="se-0cada005 se-27005c01" data-slate-type="list-line" data-slate-object="block" data-key="2198">
   <span data-slate-object="text" data-key="2199"><span data-slate-leaf="true" data-offset-key="2199:0" data-first-offset="true"><span data-slate-string="true">Durability：持久性，一旦事务成功提交，那么改变是永久性的。</span></span></span>
  </div>
 </div>
 <div class="se-a41e323b " data-slate-type="paragraph" data-slate-object="block" data-key="2200">
  <span data-slate-object="text" data-key="2201"><span data-slate-leaf="true" data-offset-key="2201:0" data-first-offset="true"><span data-slate-string="true">接着说说 BASE。</span></span></span>
 </div>
 <div class="se-645c784f " data-slate-type="paragraph" data-slate-object="block" data-key="2202">
  <span data-slate-object="text" data-key="2203"><span data-slate-leaf="true" data-offset-key="2203:0" data-first-offset="true"><span data-slate-string="true">前面已经谈到了 NoSQL，CAP、最终一致性，再加上 BASE，被称作 NoSQL 的三大基石。而 BASE，是基于 CAP 衍生出来，对于其牺牲一致性和保证可用性的这一分支，落实到具体实践中的经验总结，在大规模互联网分布式系统的设计中具有指导意义。</span></span></span>
 </div>
 <div class="se-963520ab" data-slate-type="list" data-slate-object="block" data-key="2204">
  <div class="se-e5e455d8 se-0402bf3e" data-slate-type="list-line" data-slate-object="block" data-key="2205">
   <span data-slate-object="text" data-key="2206"><span data-slate-leaf="true" data-offset-key="2206:0" data-first-offset="true"><span data-slate-string="true">BA：基本可用，即 Basically Available。这就是说，为了保障核心特性的“基本可用”，无论是次要特性的功能上，还是性能上，都可以牺牲。严格说来，这都是在“可用性”方面做的妥协。例如电商网站在双十一等访问压力较大的期间，可以关闭某一些次要特性，将购物支付等核心特性保证起来。如果你还记得 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2207" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2208"><span data-slate-leaf="true" data-offset-key="2208:0" data-first-offset="true"><span data-slate-string="true">[第 17 讲]</span></span></span></a><span data-slate-object="text" data-key="2209"><span data-slate-leaf="true" data-offset-key="2209:0" data-first-offset="true"><span data-slate-string="true"> 中的“优雅降级”，那么你应该知道，这里说的就是优雅降级中一个常见的应用场景。</span></span></span>
  </div>
  <div class="se-3d994dca se-d053043f" data-slate-type="list-line" data-slate-object="block" data-key="2210">
   <span data-slate-object="text" data-key="2211"><span data-slate-leaf="true" data-offset-key="2211:0" data-first-offset="true"><span data-slate-string="true">S：软状态，即 Soft State。说的是允许系统中的数据存在中间状态，这也一样，为了可用性，而牺牲了一致性。</span></span></span>
  </div>
  <div class="se-3c09f5dc se-2401c1b5" data-slate-type="list-line" data-slate-object="block" data-key="2212">
   <span data-slate-object="text" data-key="2213"><span data-slate-leaf="true" data-offset-key="2213:0" data-first-offset="true"><span data-slate-string="true">E：最终一致性，即 Eventually Consistent。S 和 E 两点其实说的是一个事情，一致性的牺牲是可行且有限度的，某个数据变更后的时间窗口内出现了不一致的情况，但是之后数据会恢复到一致的状态。举例来说，上文提到过的 CDN 系统便是如此，再比如社交媒体发布后的互动，像点赞、评论等功能，这些数据可以延迟一会儿显示，但是超过了一定的时间窗口还不同步到就会是问题。</span></span></span>
  </div>
 </div>
 <h2 class="se-8f9a40ac" data-slate-type="heading" data-slate-object="block" data-key="2214"><span data-slate-object="text" data-key="2215"><span data-slate-leaf="true" data-offset-key="2215:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-d02f5f8f" data-slate-type="list" data-slate-object="block" data-key="2216">
  <div class="se-79729d5f se-e77e8c16" data-slate-type="list-line" data-slate-object="block" data-key="2217">
   <a data-slate-type="link" data-slate-object="inline" data-key="2218" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2219"><span data-slate-leaf="true" data-offset-key="2219:0" data-first-offset="true"><span data-slate-string="true">Towards Robust Distributed Systems</span></span></span></a><span data-slate-object="text" data-key="2220"><span data-slate-leaf="true" data-offset-key="2220:0" data-first-offset="true"><span data-slate-string="true">，这是一个胶片，来自 Eric Brewer 最早谈及 CAP 理论的一个分享；而 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2221" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2222"><span data-slate-leaf="true" data-offset-key="2222:0" data-first-offset="true"><span data-slate-string="true">Brewer’s CAP Theorem</span></span></span></a><span data-slate-object="text" data-key="2223"><span data-slate-leaf="true" data-offset-key="2223:0" data-first-offset="true"><span data-slate-string="true">，这一篇是对 CAP 理论证明的论文，想看中文的话可以看看这篇</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2224" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2225"><span data-slate-leaf="true" data-offset-key="2225:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="2226"><span data-slate-leaf="true" data-offset-key="2226:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-306dd2b7 se-b3b30d3f" data-slate-type="list-line" data-slate-object="block" data-key="2227">
   <span data-slate-object="text" data-key="2228"><span data-slate-leaf="true" data-offset-key="2228:0" data-first-offset="true"><span data-slate-string="true">文中提到了 NoSQL 的概念，CAP 的三角形一图中也有一些实现的例子，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2229" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2230"><span data-slate-leaf="true" data-offset-key="2230:0" data-first-offset="true"><span data-slate-string="true">NoSQL Databases</span></span></span></a><span data-slate-object="text" data-key="2231"><span data-slate-leaf="true" data-offset-key="2231:0" data-first-offset="true"><span data-slate-string="true"> 这个网站列出了比较全面的 NoSQL 数据库列表，可供查询。</span></span></span>
  </div>
  <div class="se-8cbc431a se-4c4b2103" data-slate-type="list-line" data-slate-object="block" data-key="2232">
   <span data-slate-object="text" data-key="2233"><span data-slate-leaf="true" data-offset-key="2233:0" data-first-offset="true"><span data-slate-string="true">文中提到了某些存储服务能够通过配置在 CAP 的三角形上切换。比如 DynamoDB，它是一个 NoSQL 的键 / 值文档数据库，就可以配置为 CP，也可以配置为 AP，官方的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2234" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2235"><span data-slate-leaf="true" data-offset-key="2235:0" data-first-offset="true"><span data-slate-string="true">读取一致性</span></span></span></a><span data-slate-object="text" data-key="2236"><span data-slate-leaf="true" data-offset-key="2236:0" data-first-offset="true"><span data-slate-string="true">这篇文章做了简要说明；再比如 S3，它是一个云上的对象存储服务，它的一致性根据对象创建和对象修改而有所不同，你可以看一下</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2237" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2238"><span data-slate-leaf="true" data-offset-key="2238:0" data-first-offset="true"><span data-slate-string="true">官方的这个说明</span></span></span></a><span data-slate-object="text" data-key="2239"><span data-slate-leaf="true" data-offset-key="2239:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-7df1841c se-802e4653" data-slate-type="list-line" data-slate-object="block" data-key="2240">
   <span data-slate-object="text" data-key="2241"><span data-slate-leaf="true" data-offset-key="2241:0" data-first-offset="true"><span data-slate-string="true">如果对 BASE 感兴趣，你可以看看这篇最原始的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2242" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2243"><span data-slate-leaf="true" data-offset-key="2243:0" data-first-offset="true"><span data-slate-string="true">Base: An Acid Alternative</span></span></span></a><span data-slate-object="text" data-key="2244"><span data-slate-leaf="true" data-offset-key="2244:0" data-first-offset="true"><span data-slate-string="true">，想看中文译文的话可以看看</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2245" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2246"><span data-slate-leaf="true" data-offset-key="2246:0" data-first-offset="true"><span data-slate-string="true">这篇</span></span></span></a><span data-slate-object="text" data-key="2247"><span data-slate-leaf="true" data-offset-key="2247:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-66d76c24 se-17239546" data-slate-type="list-line" data-slate-object="block" data-key="2248">
   <span data-slate-object="text" data-key="2249"><span data-slate-leaf="true" data-offset-key="2249:0" data-first-offset="true"><span data-slate-string="true">对于文中提到的事务隔离，感兴趣可以进一步参见</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2250" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2251"><span data-slate-leaf="true" data-offset-key="2251:0" data-first-offset="true"><span data-slate-string="true">维基百科</span></span></span></a><span data-slate-object="text" data-key="2252"><span data-slate-leaf="true" data-offset-key="2252:0" data-first-offset="true"><span data-slate-string="true">，还有一篇美团技术团队写的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2253" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2254"><span data-slate-leaf="true" data-offset-key="2254:0" data-first-offset="true"><span data-slate-string="true">Innodb 中的事务隔离级别和锁的关系</span></span></span></a><span data-slate-object="text" data-key="2255"><span data-slate-leaf="true" data-offset-key="2255:0" data-first-offset="true"><span data-slate-string="true">，也是很好的针对事务隔离的学习材料。</span></span></span>
  </div>
 </div>
 <div class="se-e269788d" data-slate-type="image" data-slate-object="block" data-key="2256">
  <img class="se-8066cd69" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |23          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:47:18.326 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=23 
 {executed in 1 msec}
2020-11-19 17:47:18.337 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<div data-slate-editor="true" data-key="2016" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-8ffcd355 " data-slate-type="paragraph" data-slate-object="block" data-key="2017">
  <span data-slate-object="text" data-key="2018"><span data-slate-leaf="true" data-offset-key="2018:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-bb715cee " data-slate-type="paragraph" data-slate-object="block" data-key="2019">
  <span data-slate-object="text" data-key="2020"><span data-slate-leaf="true" data-offset-key="2020:0" data-first-offset="true"><span data-slate-string="true">在上一讲中我们着重讲了持久层的一致性，其实，它是分布式系统的一个基础理论。你可能会问，学习基于 Web 的全栈技能，也需要学习一些分布式系统的技术吗？是的！特别是我们在学习其持久层的时候，我们还真得学习一些分布式系统的基础理论，从而正确理解和使用我们熟悉的这些持久层技术。</span></span></span>
 </div>
 <div class="se-c0276940 " data-slate-type="paragraph" data-slate-object="block" data-key="2021">
  <span data-slate-object="text" data-key="2022"><span data-slate-leaf="true" data-offset-key="2022:0" data-first-offset="true"><span data-slate-string="true">CAP 理论就是分布式系统技术中一个必须要掌握的内容，也是在项目早期和设计阶段实实在在地影响我们技术选型、技术决策的内容。</span></span></span>
 </div>
 <h2 class="se-7d5b3d8c" data-slate-type="heading" data-slate-object="block" data-key="2023"><span data-slate-object="text" data-key="2024"><span data-slate-leaf="true" data-offset-key="2024:0" data-first-offset="true"><span data-slate-string="true">理解概念</span></span></span></h2>
 <div class="se-a4e47f45 " data-slate-type="paragraph" data-slate-object="block" data-key="2025">
  <span data-slate-object="text" data-key="2026"><span data-slate-leaf="true" data-offset-key="2026:0" data-first-offset="true"><span data-slate-string="true">我想，你已经很熟悉一致性了。今天，在一致性之后，我们也要涉及到 CAP 的另外的两个方面——可用性和分区容忍性。</span></span></span>
 </div>
 <h3 class="se-f3673ae0" data-slate-type="heading" data-slate-object="block" data-key="2027"><span data-slate-object="text" data-key="2028"><span data-slate-leaf="true" data-offset-key="2028:0" data-first-offset="true"><span data-slate-string="true">1. CAP 的概念</span></span></span></h3>
 <div class="se-dc510a12 " data-slate-type="paragraph" data-slate-object="block" data-key="2029">
  <span data-slate-object="text" data-key="2030"><span data-slate-leaf="true" data-offset-key="2030:0" data-first-offset="true"><span data-slate-string="true">CAP 理论，又叫做布鲁尔理论（Brewer’s Theorem），指的是在一个共享数据的分布式存储系统中，下面三者最多只能同时保证二者，对这三者简单描述如下：</span></span></span>
 </div>
 <div class="se-3291d248" data-slate-type="list" data-slate-object="block" data-key="2031">
  <div class="se-874f7571 se-3fdf6096" data-slate-type="list-line" data-slate-object="block" data-key="2032">
   <span data-slate-object="text" data-key="2033"><span data-slate-leaf="true" data-offset-key="2033:0" data-first-offset="true"><span data-slate-string="true">一致性（Consistency）：读操作得到最近一次写入的数据（其实就是上一讲我们讲的强一致性）；</span></span></span>
  </div>
  <div class="se-07ffcc41 se-0c7151b7" data-slate-type="list-line" data-slate-object="block" data-key="2034">
   <span data-slate-object="text" data-key="2035"><span data-slate-leaf="true" data-offset-key="2035:0" data-first-offset="true"><span data-slate-string="true">可用性（Availability）：请求在限定时间内从非失败的节点得到非失败的响应；</span></span></span>
  </div>
  <div class="se-22f37ad2 se-0b4acec8" data-slate-type="list-line" data-slate-object="block" data-key="2036">
   <span data-slate-object="text" data-key="2037"><span data-slate-leaf="true" data-offset-key="2037:0" data-first-offset="true"><span data-slate-string="true">分区容忍性（Partition Tolerance）：系统允许节点间网络消息的丢失或延迟（出现分区）。</span></span></span>
  </div>
 </div>
 <div class="se-3899434c " data-slate-type="paragraph" data-slate-object="block" data-key="2038">
  <span data-slate-object="text" data-key="2039"><span data-slate-leaf="true" data-offset-key="2039:0" data-first-offset="true"><span data-slate-string="true">下面，请让我进一步说明，从而帮助你理解。</span></span></span>
 </div>
 <div class="se-02d777bb " data-slate-type="paragraph" data-slate-object="block" data-key="2040">
  <span data-slate-object="text" data-key="2041"><span data-slate-leaf="true" data-offset-key="2041:0" data-first-offset="true"><span class="se-48ae1582" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">一致性，这里体现了这个存储系统对统一数据提供的读写操作是线性化的。</span></span></span></span><span data-slate-object="text" data-key="2042"><span data-slate-leaf="true" data-offset-key="2042:0" data-first-offset="true"><span data-slate-string="true">如果客户端写入数据，并且写操作返回成功给客户端，那么在下一次读取的时候（下一次写入以前），如果系统返回了“非失败”的响应，就一定是读出了完整、正确（最新）的那份数据，而不会读取到过期数据，也不会读取到中间数据。</span></span></span>
 </div>
 <div class="se-bc22c3ea " data-slate-type="paragraph" data-slate-object="block" data-key="2043">
  <span data-slate-object="text" data-key="2044"><span data-slate-leaf="true" data-offset-key="2044:0" data-first-offset="true"><span class="se-006edf28" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">可用性，体现的是存储系统持续提供服务的能力</span></span></span></span><span data-slate-object="text" data-key="2045"><span data-slate-leaf="true" data-offset-key="2045:0" data-first-offset="true"><span data-slate-string="true">，这里表现在两个方面：</span></span></span>
 </div>
 <div class="se-588dc21c" data-slate-type="list" data-slate-object="block" data-key="2046">
  <div class="se-d907c046 se-294ce592" data-slate-type="list-line" data-slate-object="block" data-key="2047">
   <span data-slate-object="text" data-key="2048"><span data-slate-leaf="true" data-offset-key="2048:0" data-first-offset="true"><span class="se-f20542f5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">返回“非失败”的响应</span></span></span></span><span data-slate-object="text" data-key="2049"><span data-slate-leaf="true" data-offset-key="2049:0" data-first-offset="true"><span data-slate-string="true">，就是说，不是光有响应就可以了，系统得是在实实在在地提供服务，而不是在报错；</span></span></span>
  </div>
  <div class="se-ed137b01 se-89a18af0" data-slate-type="list-line" data-slate-object="block" data-key="2050">
   <span data-slate-object="text" data-key="2051"><span data-slate-leaf="true" data-offset-key="2051:0" data-first-offset="true"><span class="se-269de1b2" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在限定时间内返回</span></span></span></span><span data-slate-object="text" data-key="2052"><span data-slate-leaf="true" data-offset-key="2052:0" data-first-offset="true"><span data-slate-string="true">，就是说，这个响应是预期时间内返回的，而不出现请求超时。</span></span></span>
  </div>
 </div>
 <div class="se-0e207b76 " data-slate-type="paragraph" data-slate-object="block" data-key="2053">
  <span data-slate-object="text" data-key="2054"><span data-slate-leaf="true" data-offset-key="2054:0" data-first-offset="true"><span data-slate-string="true">请注意，这里说的是“非失败”响应，而并没有说“正确”的响应。也就是说，返回了数据，但可以是过期的，可以是中间数据，因为数据是否“正确”并非由可用性来保证，而是由一致性来保证的。系统的单个节点可能会在任意时间内故障、出错，但是系统总能够靠处于非失败（non-failing）状态的其它节点来继续提供服务，保证可用性。</span></span></span>
 </div>
 <div class="se-44d57f4a " data-slate-type="paragraph" data-slate-object="block" data-key="2055">
  <span data-slate-object="text" data-key="2056"><span data-slate-leaf="true" data-offset-key="2056:0" data-first-offset="true"><span class="se-c80c446a" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">分区容忍性，体现了系统是否能够接纳基于数据的网络分区。</span></span></span></span><span data-slate-object="text" data-key="2057"><span data-slate-leaf="true" data-offset-key="2057:0" data-first-offset="true"><span data-slate-string="true">只要出现了网络故障，无论什么原因导致某个节点和系统的其它节点失去了联系，节点间的数据同步操作无法被“及时”完成，那么，即便它依然可以对外（客户端）提供服务，网络分区也已经出现了。</span></span></span>
 </div>
 <div class="se-4a345791 " data-slate-type="paragraph" data-slate-object="block" data-key="2058">
  <span data-slate-object="text" data-key="2059"><span data-slate-leaf="true" data-offset-key="2059:0" data-first-offset="true"><span data-slate-string="true">当然，如果数据只有一份，不存在其它节点保存的副本，或不需要跨节点的数据共享，那么，这就不存在“分区”，这样的分布式存储系统也就不是 CAP 关心的对象。</span></span></span>
 </div>
 <h3 class="se-870c1392" data-slate-type="heading" data-slate-object="block" data-key="2060"><span data-slate-object="text" data-key="2061"><span data-slate-leaf="true" data-offset-key="2061:0" data-first-offset="true"><span data-slate-string="true">2. 进一步理解</span></span></span></h3>
 <div class="se-c9e4a0d8 " data-slate-type="paragraph" data-slate-object="block" data-key="2062">
  <span data-slate-object="text" data-key="2063"><span data-slate-leaf="true" data-offset-key="2063:0" data-first-offset="true"><span data-slate-string="true">如果你觉得模糊，没关系，让我使用一个简单的图示来帮你理解。</span></span></span>
 </div>
 <div class="se-68a3a2a6" data-slate-type="image" data-slate-object="block" data-key="2064">
  <img class="se-b7c09a95" src="https://static001.geekbang.org/resource/image/9a/4b/9a552d641a142f77650b5fd07988174b.jpg">
 </div>
 <div class="se-51d96ebc " data-slate-type="paragraph" data-slate-object="block" data-key="2065">
  <span data-slate-object="text" data-key="2066"><span data-slate-leaf="true" data-offset-key="2066:0" data-first-offset="true"><span data-slate-string="true">有这样一个存储系统，存在两个节点 A 和 B，各自存放一份数据拷贝。那么在正常情况下，客户端无论写数据到 A 还是 B，都需要将数据同步到另一个节点，再返回成功。比如图示中带序号的四个箭头：</span></span></span>
 </div>
 <div class="se-ca1a7bb3" data-slate-type="list" data-slate-object="block" data-key="2067">
  <div class="se-87de0c2a se-ac73d95f" data-slate-type="list-line" data-slate-object="block" data-key="2068">
   <span data-slate-object="text" data-key="2069"><span data-slate-leaf="true" data-offset-key="2069:0" data-first-offset="true"><span data-slate-string="true">箭头 ①，客户端写数据到节点 A；</span></span></span>
  </div>
  <div class="se-4b74bb03 se-efae570b" data-slate-type="list-line" data-slate-object="block" data-key="2070">
   <span data-slate-object="text" data-key="2071"><span data-slate-leaf="true" data-offset-key="2071:0" data-first-offset="true"><span data-slate-string="true">箭头 ②，节点 A 同步数据变更到节点 B；</span></span></span>
  </div>
  <div class="se-a389c569 se-90ee5f77" data-slate-type="list-line" data-slate-object="block" data-key="2072">
   <span data-slate-object="text" data-key="2073"><span data-slate-leaf="true" data-offset-key="2073:0" data-first-offset="true"><span data-slate-string="true">箭头 ③，节点 B 返回成功响应到节点 A；</span></span></span>
  </div>
  <div class="se-4f2d7c1a se-a796ce92" data-slate-type="list-line" data-slate-object="block" data-key="2074">
   <span data-slate-object="text" data-key="2075"><span data-slate-leaf="true" data-offset-key="2075:0" data-first-offset="true"><span data-slate-string="true">箭头 ④，节点 A 返回成功响应给客户端。</span></span></span>
  </div>
 </div>
 <div class="se-dd3297dd " data-slate-type="paragraph" data-slate-object="block" data-key="2076">
  <span data-slate-object="text" data-key="2077"><span data-slate-leaf="true" data-offset-key="2077:0" data-first-offset="true"><span data-slate-string="true">不知道你有没有回想起 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2078" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2079"><span data-slate-leaf="true" data-offset-key="2079:0" data-first-offset="true"><span data-slate-string="true">[第 23 讲]</span></span></span></a><span data-slate-object="text" data-key="2080"><span data-slate-leaf="true" data-offset-key="2080:0" data-first-offset="true"><span data-slate-string="true"> 中的 Multi-Master 架构，对，但唯一需要特别指出的不同是，节点间数据拷贝是同步进行的，需要完成拷贝以后再返回响应，因为我们需要保证一致性。</span></span></span>
 </div>
 <div class="se-e2bf571b " data-slate-type="paragraph" data-slate-object="block" data-key="2081">
  <span data-slate-object="text" data-key="2082"><span data-slate-leaf="true" data-offset-key="2082:0" data-first-offset="true"><span data-slate-string="true">之后，客户端尝试读取刚写入的数据，无论是从节点 A 还是 B，都可以得到准确的数据：</span></span></span>
 </div>
 <div class="se-c0a79c67" data-slate-type="image" data-slate-object="block" data-key="2083">
  <img class="se-d45e07ab" src="https://static001.geekbang.org/resource/image/8f/8a/8fe1b2a21d18314edd93fc7d0aa9998a.jpg">
 </div>
 <div class="se-cebdcaa7 " data-slate-type="paragraph" data-slate-object="block" data-key="2084">
  <span data-slate-object="text" data-key="2085"><span data-slate-leaf="true" data-offset-key="2085:0" data-first-offset="true"><span data-slate-string="true">好，这种情况下数据在 A、B 上都是一致的，并且系统也是可用的。</span></span></span>
 </div>
 <div class="se-b94f1bb9 " data-slate-type="paragraph" data-slate-object="block" data-key="2086">
  <span data-slate-object="text" data-key="2087"><span data-slate-leaf="true" data-offset-key="2087:0" data-first-offset="true"><span data-slate-string="true">但是，现在网络突然出现故障，A 和 B 之间的数据拷贝通道被打断了，也就是说，分区发生了。这时候客户端再写入 A 就会出现以下情况：</span></span></span>
 </div>
 <div class="se-5ac50258" data-slate-type="image" data-slate-object="block" data-key="2088">
  <img class="se-5f8614f1" src="https://static001.geekbang.org/resource/image/9e/88/9e08dd2874a9bc6810d7813057dcef88.jpg">
 </div>
 <div class="se-5df71744 " data-slate-type="paragraph" data-slate-object="block" data-key="2089">
  <span data-slate-object="text" data-key="2090"><span data-slate-leaf="true" data-offset-key="2090:0" data-first-offset="true"><span data-slate-string="true">你看，这时候节点 A 已经无法将数据“及时”同步到节点 B 了， 那么，节点 A 是否应该将数据写入自己，并返回“成功”给客户端呢？它陷入了两难：</span></span></span>
 </div>
 <div class="se-39f40e3f" data-slate-type="list" data-slate-object="block" data-key="2091">
  <div class="se-9995d047 se-eb522c0c" data-slate-type="list-line" data-slate-object="block" data-key="2092">
   <span data-slate-object="text" data-key="2093"><span data-slate-leaf="true" data-offset-key="2093:0" data-first-offset="true"><span class="se-8083af52" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果写入并返回成功，满足系统的可用性，就意味着丢失了数据一致性。</span></span></span></span><span data-slate-object="text" data-key="2094"><span data-slate-leaf="true" data-offset-key="2094:0" data-first-offset="true"><span data-slate-string="true">因为节点 A 的数据是最新的，而节点 B 的数据是过期的。</span></span></span>
  </div>
  <div class="se-3f6f2048 se-5e6a0007" data-slate-type="list-line" data-slate-object="block" data-key="2095">
   <span data-slate-object="text" data-key="2096"><span data-slate-leaf="true" data-offset-key="2096:0" data-first-offset="true"><span class="se-5f58ba2b" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果不写入数据，而直接返回失败</span></span></span></span><span data-slate-object="text" data-key="2097"><span data-slate-leaf="true" data-offset-key="2097:0" data-first-offset="true"><span data-slate-string="true">，即节点 A 拒绝写操作，那么 A 和 B 节点上的</span></span></span><span data-slate-object="text" data-key="2098"><span data-slate-leaf="true" data-offset-key="2098:0" data-first-offset="true"><span class="se-7abf6b1d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">数据依然满足一致性（写入失败，但依然都是相互一致的老数据），但是整个系统失去了可用性。</span></span></span></span>
  </div>
 </div>
 <div class="se-25aa2e69 " data-slate-type="paragraph" data-slate-object="block" data-key="2099">
  <span data-slate-object="text" data-key="2100"><span data-slate-leaf="true" data-offset-key="2100:0" data-first-offset="true"><span data-slate-string="true">你看，我们怎么也无法同时保证一致性、可用性和分区容忍性这三者。</span></span></span>
 </div>
 <h3 class="se-bb63dd42" data-slate-type="heading" data-slate-object="block" data-key="2101"><span data-slate-object="text" data-key="2102"><span data-slate-leaf="true" data-offset-key="2102:0" data-first-offset="true"><span data-slate-string="true">3. 三选二 ？</span></span></span></h3>
 <div class="se-2d89d578 " data-slate-type="paragraph" data-slate-object="block" data-key="2103">
  <span data-slate-object="text" data-key="2104"><span data-slate-leaf="true" data-offset-key="2104:0" data-first-offset="true"><span data-slate-string="true">紧接着我要谈一谈对于 CAP 理论一个很大的误解——三选二。从上面对于 CAP 的描述来看， CAP 的应用似乎就是一个三选二的选择题，但事实上，完全不是这样的。</span></span></span>
 </div>
 <div class="se-dbf6c945 " data-slate-type="paragraph" data-slate-object="block" data-key="2105">
  <span data-slate-object="text" data-key="2106"><span data-slate-leaf="true" data-offset-key="2106:0" data-first-offset="true"><span data-slate-string="true">开门见山地说，</span></span></span><span data-slate-object="text" data-key="2107"><span data-slate-leaf="true" data-offset-key="2107:0" data-first-offset="true"><span class="se-bed370e5" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在讨论 CAP 定理的时候，P，也就是分区容忍性，是必选项。</span></span></span></span><span data-slate-object="text" data-key="2108"><span data-slate-leaf="true" data-offset-key="2108:0" data-first-offset="true"><span data-slate-string="true">具体来说，跨区域的系统，分区容忍性往往是不可以拿掉的，因为无论是硬件损坏、机房断电，还是地震海啸，都是无法预料、无法避免的，任何时间都可能出现网络故障而发生分区，因此工程师能做的，就是从 CP 和 AP 中选择合适的那一个。</span></span></span>
 </div>
 <div class="se-a3a09fde " data-slate-type="paragraph" data-slate-object="block" data-key="2109">
  <span data-slate-object="text" data-key="2110"><span data-slate-leaf="true" data-offset-key="2110:0" data-first-offset="true"><span data-slate-string="true">你可以想想上面我拿图示举的那个例子，在分区发生的时候，最多只能保证一致性和可用性一个。也就是说，CAP 理论不是三选二的，而是二选一，当然，具体选哪个，我们需要“权衡”。</span></span></span>
 </div>
 <div class="se-2e93da40 " data-slate-type="paragraph" data-slate-object="block" data-key="2111">
  <span data-slate-object="text" data-key="2112"><span data-slate-leaf="true" data-offset-key="2112:0" data-first-offset="true"><span data-slate-string="true">需要特别说明的是，</span></span></span><span data-slate-object="text" data-key="2113"><span data-slate-leaf="true" data-offset-key="2113:0" data-first-offset="true"><span class="se-2a2445b1" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这里说的是只能“保证”一致性和可用性二者之一，而不是说，在系统正常运行时，二者不可能“同时满足”。</span></span></span></span><span data-slate-object="text" data-key="2114"><span data-slate-leaf="true" data-offset-key="2114:0" data-first-offset="true"><span data-slate-string="true">在系统运行正常的时候，网络分区没有出现，那么技术上我们是可能同时满足一致性和可用性两者的。</span></span></span>
 </div>
 <div class="se-4d0eb7c1 " data-slate-type="paragraph" data-slate-object="block" data-key="2115">
  <span data-slate-object="text" data-key="2116"><span data-slate-leaf="true" data-offset-key="2116:0" data-first-offset="true"><span data-slate-string="true">这时你可能会问，难道没有 CA，即同时“保证”一致性和可用性，而牺牲掉分区容忍性的系统吗？</span></span></span>
 </div>
 <div class="se-50ad8753 " data-slate-type="paragraph" data-slate-object="block" data-key="2117">
  <span data-slate-object="text" data-key="2118"><span data-slate-leaf="true" data-offset-key="2118:0" data-first-offset="true"><span data-slate-string="true">有！</span></span></span><span data-slate-object="text" data-key="2119"><span data-slate-leaf="true" data-offset-key="2119:0" data-first-offset="true"><span class="se-83e76ecc" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">但请注意，那其实已经不是 CAP 理论关心的对象了，因为 CAP 要求的是节点间的数据交换和数据共享。</span></span></span></span><span data-slate-object="text" data-key="2120"><span data-slate-leaf="true" data-offset-key="2120:0" data-first-offset="true"><span data-slate-string="true">任何时候都不会有分区发生，这种系统基本上有这样两种形式：</span></span></span>
 </div>
 <div class="se-efda4e6f" data-slate-type="list" data-slate-object="block" data-key="2121">
  <div class="se-e5693294 se-3c56f0bb" data-slate-type="list-line" data-slate-object="block" data-key="2122">
   <span data-slate-object="text" data-key="2123"><span data-slate-leaf="true" data-offset-key="2123:0" data-first-offset="true"><span class="se-5b6b373f" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">单节点系统</span></span></span></span><span data-slate-object="text" data-key="2124"><span data-slate-leaf="true" data-offset-key="2124:0" data-first-offset="true"><span data-slate-string="true">，这很好理解，没有节点间数据的交换，那么无论网络出不出故障，系统始终只包含一个节点。比方说，传统的关系型数据库，像 MySQL 或者 OracleDB，在单节点的配置下。</span></span></span>
  </div>
  <div class="se-a7fd697d se-b587a492" data-slate-type="list-line" data-slate-object="block" data-key="2125">
   <span data-slate-object="text" data-key="2126"><span data-slate-leaf="true" data-offset-key="2126:0" data-first-offset="true"><span class="se-742e61f2" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">虽然是多节点，但是节点间没有数据共享和数据交换</span></span></span></span><span data-slate-object="text" data-key="2127"><span data-slate-leaf="true" data-offset-key="2127:0" data-first-offset="true"><span data-slate-string="true">——即节点上的数据不需要拷贝到其它节点上。比方说，无数据副本（Replica）配置的集群 Elasticsearch 或 Memcached，在经过 hash 以后，每个节点都存放着单份不同的数据。这种情况看起来也算分布式存储，但是节点之间是互相独立的。</span></span></span>
  </div>
 </div>
 <h2 class="se-fe58bddb" data-slate-type="heading" data-slate-object="block" data-key="2128"><span data-slate-object="text" data-key="2129"><span data-slate-leaf="true" data-offset-key="2129:0" data-first-offset="true"><span data-slate-string="true">存储技术的选择：NoSQL 三角形</span></span></span></h2>
 <div class="se-71017131 " data-slate-type="paragraph" data-slate-object="block" data-key="2130">
  <span data-slate-object="text" data-key="2131"><span data-slate-leaf="true" data-offset-key="2131:0" data-first-offset="true"><span data-slate-string="true">在谈到根据 CAP 来选择技术的时候，我想先来介绍一下 NoSQL，你将会看到它们大量地分布在下面“NoSQL 三角形”的 CP 和 AP 两条边上。</span></span></span>
 </div>
 <div class="se-507b2583 " data-slate-type="paragraph" data-slate-object="block" data-key="2132">
  <span data-slate-object="text" data-key="2133"><span data-slate-leaf="true" data-offset-key="2133:0" data-first-offset="true"><span data-slate-string="true">那么，到底什么是 NoSQL 呢？我们可以简单地认为，NoSQL 是“非关系数据库”，和它相对应的是传统的“关系数据库”。它被设计出来的目的，并非要取代关系数据库，而是成为关系数据库的补充，即“Not Only SQL”。</span></span></span>
 </div>
 <div class="se-ee3972a9 " data-slate-type="paragraph" data-slate-object="block" data-key="2134">
  <span data-slate-object="text" data-key="2135"><span data-slate-leaf="true" data-offset-key="2135:0" data-first-offset="true"><span data-slate-string="true">也就是说，它放弃了对于“关系”的支持，</span></span></span><span data-slate-object="text" data-key="2136"><span data-slate-leaf="true" data-offset-key="2136:0" data-first-offset="true"><span class="se-5e295b79" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">损失了强结构定义和关系查询等能力，但是它往往可以具备比关系数据库高得多的性能和横向扩展性（scalability）等优势。</span></span></span></span><span data-slate-object="text" data-key="2137"><span data-slate-leaf="true" data-offset-key="2137:0" data-first-offset="true"><span data-slate-string="true">这在 Web 2.0 时代对于一些关系数据库不擅长的场景，例如数据量巨大，数据之间的关联关系较弱，数据结构（schema）多变，强可用性要求和低一致性要求等等，NoSQL 可以发挥其最大的价值。</span></span></span>
 </div>
 <div class="se-5abfb6df " data-slate-type="paragraph" data-slate-object="block" data-key="2138">
  <span data-slate-object="text" data-key="2139"><span data-slate-leaf="true" data-offset-key="2139:0" data-first-offset="true"><span data-slate-string="true">在实际业务中，我们可以利用 CAP 定理来权衡和帮助选择合适的存储技术，且看下面这张 NoSQL 系统的 CAP 三角形（来自 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2140" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2141"><span data-slate-leaf="true" data-offset-key="2141:0" data-first-offset="true"><span data-slate-string="true">Visual Guide to NoSQL Systems</span></span></span></a><span data-slate-object="text" data-key="2142"><span data-slate-leaf="true" data-offset-key="2142:0" data-first-offset="true"><span data-slate-string="true">）。尺有所短，寸有所长，我们可以从 CAP 的角度来理解这些技术的优劣。</span></span></span>
 </div>
 <div class="se-9f073759" data-slate-type="image" data-slate-object="block" data-key="2143">
  <img class="se-3c0938fe" src="https://static001.geekbang.org/resource/image/90/52/90a6c7ddb6556fa206f95a80a7a6c652.jpg">
 </div>
 <div class="se-8e792848 " data-slate-type="paragraph" data-slate-object="block" data-key="2144">
  <span data-slate-object="text" data-key="2145"><span data-slate-leaf="true" data-offset-key="2145:0" data-first-offset="true"><span data-slate-string="true">从图中可以发现，关系数据几乎都落在了 CA 一侧，但是请注意，技术也在不断更新，许多关系数据库如今也可以通过配置而形成其它节点的数据冗余；有时，我们则是在其上方自己实现数据冗余，比如配置数据库的数据同步到备份数据库。</span></span></span>
 </div>
 <div class="se-6f4b7603 " data-slate-type="paragraph" data-slate-object="block" data-key="2146">
  <span data-slate-object="text" data-key="2147"><span data-slate-leaf="true" data-offset-key="2147:0" data-first-offset="true"><span data-slate-string="true">无论哪一种方法，一旦其它节点用于数据冗余的数据副本出现，这个存储系统就落到上述三角形的另外两边去了。</span></span></span>
 </div>
 <div class="se-afbcd395 " data-slate-type="paragraph" data-slate-object="block" data-key="2148">
  <span data-slate-object="text" data-key="2149"><span data-slate-leaf="true" data-offset-key="2149:0" data-first-offset="true"><span data-slate-string="true">云上的 NoSQL 存储服务，多数落在了 AP 一侧，这也和 NoSQL 运动可用性优先保证而降级一致性的主题符合。比如 Amazon 的 DynamoDB，但是这个也是可以通过不同的设置选项来改变的，比如 DynamoDB 默认采用最终一致性，但也允许配置为强一致性，那时它就落到了 CP 上面。</span></span></span>
 </div>
 <h3 class="se-9ff094d2" data-slate-type="heading" data-slate-object="block" data-key="2150"><span data-slate-object="text" data-key="2151"><span data-slate-leaf="true" data-offset-key="2151:0" data-first-offset="true"><span data-slate-string="true">实际场景</span></span></span></h3>
 <div class="se-db7c32a4 " data-slate-type="paragraph" data-slate-object="block" data-key="2152">
  <span data-slate-object="text" data-key="2153"><span data-slate-leaf="true" data-offset-key="2153:0" data-first-offset="true"><span data-slate-string="true">接着我们考虑几个实际应用场景，看看该采用哪一条边的技术呢？既然是基于 Web 的全栈工程师的技术学习，我就来举两个基于网站应用的例子。</span></span></span>
 </div>
 <div class="se-1d05b047 " data-slate-type="paragraph" data-slate-object="block" data-key="2154">
  <span data-slate-object="text" data-key="2155"><span data-slate-leaf="true" data-offset-key="2155:0" data-first-offset="true"><span data-slate-string="true">还记得我们在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2156" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2157"><span data-slate-leaf="true" data-offset-key="2157:0" data-first-offset="true"><span data-slate-string="true">[第 09 讲]</span></span></span></a><span data-slate-object="text" data-key="2158"><span data-slate-leaf="true" data-offset-key="2158:0" data-first-offset="true"><span data-slate-string="true"> 中谈到的页面聚合吗？对于门户网站来说，无论是显示的数据，还是图片、样式等等静态资源，通过 CDN 的方式，都可以把副本存放在离用户较近的节点，这样它们的获取可以减少延迟，提高用户体验。因此，这些系统联合起来，就形成了一个可以使用 CAP 讨论的分布式系统。</span></span></span>
 </div>
 <div class="se-a019917c " data-slate-type="paragraph" data-slate-object="block" data-key="2159">
  <span data-slate-object="text" data-key="2160"><span data-slate-leaf="true" data-offset-key="2160:0" data-first-offset="true"><span data-slate-string="true">那么，很容易理解的是，且不用说网络故障而发生分区的情况，即便在正常情况下，这些信息并不需要具备那么严格的“即时性”，新闻早显示、晚显示几秒钟，乃至几分钟，都不是什么问题，上海的读者比北京的读者晚看到一会儿，也不是什么问题。但是，大型网站页面打不开，就是一个问题了，这显然会影响用户的体验。因此，从这个角度说，我们可以牺牲一致性，但需要尽量保证可用性，因此这是一个选择 AP 的例子。</span></span></span>
 </div>
 <div class="se-a6a7aa03 " data-slate-type="paragraph" data-slate-object="block" data-key="2161">
  <span data-slate-object="text" data-key="2162"><span data-slate-leaf="true" data-offset-key="2162:0" data-first-offset="true"><span data-slate-string="true">事实上，对于大型的系统而言，我们往往不需要严格的一致性，但是我们希望保证可用性，因此在大多数情况下我们都会选择 AP。但是，有时情况却未必如此。</span></span></span>
 </div>
 <div class="se-23bb7246 " data-slate-type="paragraph" data-slate-object="block" data-key="2163">
  <span data-slate-object="text" data-key="2164"><span data-slate-leaf="true" data-offset-key="2164:0" data-first-offset="true"><span data-slate-string="true">再举一个例子，航空公司卖机票，在不考虑超售的情况下，一座一票，航空公司的网站当然可以采用上面类似的做法；有时，甚至在正常的情况下，余票的显示都可以不是非常准确的（比如显示“有票”可以避免显示这个具体数字）。但是，当客户真正在选座售票的时候，即扣款和出票的时候就不是这样的了，一致性必须优先保证。因为如果可用性保证不了，即有时候订票失败，用户最多也就是牢骚几句，这还可以接受，但要是出现一致性问题，即两个人订了同一个座位的票，那就是很严重的问题了。</span></span></span>
 </div>
 <div class="se-324952e7 " data-slate-type="paragraph" data-slate-object="block" data-key="2165">
  <span data-slate-object="text" data-key="2166"><span data-slate-leaf="true" data-offset-key="2166:0" data-first-offset="true"><span data-slate-string="true">最后，我想说的是，这里的选择是一个带有灰度的过程，并非只有 0 和 1 这两个绝对的答案，我们还是需要具体问题具体分析，不要一刀切。</span></span></span>
 </div>
 <div class="se-7ba58467 " data-slate-type="paragraph" data-slate-object="block" data-key="2167">
  <span data-slate-object="text" data-key="2168"><span data-slate-leaf="true" data-offset-key="2168:0" data-first-offset="true"><span class="se-f5d113ac" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">从特性上说，甚至可以部分特性做到 CP，部分做到 AP，这都是有可能的。</span></span></span></span><span data-slate-object="text" data-key="2169"><span data-slate-leaf="true" data-offset-key="2169:0" data-first-offset="true"><span data-slate-string="true">比如说，涉及钱的问题一定是 CP 吗？不一定，ATM 机就是一个很经典的例子，在网络故障发生时，ATM 会处于 stand-alone 模式，在这种模式下，用户依然可以执行查询余额等操作（很可能数额不准确），甚至还可以取款，但是这时的取款会有所限制，例如限制一个额度（银行承担风险），或者是限制只能给某些银行的卡取款，毕竟可用性和一致性的丢失会带来不同的风险和后果，两害相权取其轻。</span></span></span>
 </div>
 <h2 class="se-dad141d9" data-slate-type="heading" data-slate-object="block" data-key="2170"><span data-slate-object="text" data-key="2171"><span data-slate-leaf="true" data-offset-key="2171:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-f6980603 " data-slate-type="paragraph" data-slate-object="block" data-key="2172">
  <span data-slate-object="text" data-key="2173"><span data-slate-leaf="true" data-offset-key="2173:0" data-first-offset="true"><span data-slate-string="true">今天我们学习和理解了 CAP 理论，并且了解了一些实际应用的例子。希望你能够通过今天的内容，彻底掌握其原理，并能够逐渐在设计中应用起来，特别是在技术选型做“权衡”的时候。</span></span></span>
 </div>
 <div class="se-0f94c6da " data-slate-type="paragraph" data-slate-object="block" data-key="2174">
  <span data-slate-object="text" data-key="2175"><span data-slate-leaf="true" data-offset-key="2175:0" data-first-offset="true"><span data-slate-string="true">现在，我们来看一下今天的思考题吧：</span></span></span>
 </div>
 <div class="se-d6d16b00" data-slate-type="list" data-slate-object="block" data-key="2176">
  <div class="se-98bc4e3a se-870a2a93" data-slate-type="list-line" data-slate-object="block" data-key="2177">
   <span data-slate-object="text" data-key="2178"><span data-slate-leaf="true" data-offset-key="2178:0" data-first-offset="true"><span data-slate-string="true">你是否了解或是接触过分布式系统，特别是分布式存储系统，它是否能归类到 NoSQL 三角形中的某一条边上呢？</span></span></span>
  </div>
  <div class="se-9af0b8ac se-01407cf6" data-slate-type="list-line" data-slate-object="block" data-key="2179">
   <span data-slate-object="text" data-key="2180"><span data-slate-leaf="true" data-offset-key="2180:0" data-first-offset="true"><span data-slate-string="true">互联网上的绝大多数系统都是可以牺牲一致性，而优先保证可用性的，但也有一些例外。你能举出几个即便牺牲可用性，也要保证数据一致性的例子来吗？</span></span></span>
  </div>
 </div>
 <div class="se-8205a713 " data-slate-type="paragraph" data-slate-object="block" data-key="2181">
  <span data-slate-object="text" data-key="2182"><span data-slate-leaf="true" data-offset-key="2182:0" data-first-offset="true"><span data-slate-string="true">今天的主要内容就到这里，欢迎你在留言区进行讨论，也欢迎你继续学习下面的选修课堂。</span></span></span>
 </div>
 <h2 class="se-b64d87b3" data-slate-type="heading" data-slate-object="block" data-key="2183"><span data-slate-object="text" data-key="2184"><span data-slate-leaf="true" data-offset-key="2184:0" data-first-offset="true"><span data-slate-string="true">选修课堂：从 ACID 到 BASE</span></span></span></h2>
 <div class="se-cdde2f74 " data-slate-type="paragraph" data-slate-object="block" data-key="2185">
  <span data-slate-object="text" data-key="2186"><span data-slate-leaf="true" data-offset-key="2186:0" data-first-offset="true"><span data-slate-string="true">ACID 和 BASE，正好是英文里“酸”和“碱”的意思。有意思的是，关系数据库和非关系数据库，它们各自的重要特性，也恰恰可以用酸和碱来体现。下面我来简单做个比较，你可以从中感受一下二者的差异和对立性，为我们后两讲介绍技术选型打下基础。</span></span></span>
 </div>
 <div class="se-d17428e2 " data-slate-type="paragraph" data-slate-object="block" data-key="2187">
  <span data-slate-object="text" data-key="2188"><span data-slate-leaf="true" data-offset-key="2188:0" data-first-offset="true"><span data-slate-string="true">先说说 ACID。</span></span></span>
 </div>
 <div class="se-0072424a " data-slate-type="paragraph" data-slate-object="block" data-key="2189">
  <span data-slate-object="text" data-key="2190"><span data-slate-leaf="true" data-offset-key="2190:0" data-first-offset="true"><span data-slate-string="true">关系数据库的一大优势，就是可以通过事务的支持来实现强一致性，而事务，通常可以包含这样几个特性。</span></span></span>
 </div>
 <div class="se-f0994de6" data-slate-type="list" data-slate-object="block" data-key="2191">
  <div class="se-8598c06e se-bd528b47" data-slate-type="list-line" data-slate-object="block" data-key="2192">
   <span data-slate-object="text" data-key="2193"><span data-slate-leaf="true" data-offset-key="2193:0" data-first-offset="true"><span data-slate-string="true">Atomicity：原子性，指的是无论事务执行的过程有多么复杂，要么提交成功改变状态，要么提交失败回滚到提交前的状态，这些过程是原子化的，不存在第三种状态。</span></span></span>
  </div>
  <div class="se-a66158ce se-3119a3ff" data-slate-type="list-line" data-slate-object="block" data-key="2194">
   <span data-slate-object="text" data-key="2195"><span data-slate-leaf="true" data-offset-key="2195:0" data-first-offset="true"><span data-slate-string="true">Consistency：一致性，这里的一致性和我们前面介绍的一致性含义略有不同，它指的是事务开始前、结束后，数据库的完整性都没有被破坏，所有键、数据类型、检查、触发器等等都依然有效。</span></span></span>
  </div>
  <div class="se-65d94ceb se-e83b6ab1" data-slate-type="list-line" data-slate-object="block" data-key="2196">
   <span data-slate-object="text" data-key="2197"><span data-slate-leaf="true" data-offset-key="2197:0" data-first-offset="true"><span data-slate-string="true">Isolation：隔离性，指的是多个并发事务同一时间对于数据进行读写的能力，同时执行，互不影响。事务隔离分为四大级别，不同的数据库默认实现在不同的级别，我在扩展阅读中放置了一些学习材料，感兴趣的话可以进一步学习。</span></span></span>
  </div>
  <div class="se-0cada005 se-27005c01" data-slate-type="list-line" data-slate-object="block" data-key="2198">
   <span data-slate-object="text" data-key="2199"><span data-slate-leaf="true" data-offset-key="2199:0" data-first-offset="true"><span data-slate-string="true">Durability：持久性，一旦事务成功提交，那么改变是永久性的。</span></span></span>
  </div>
 </div>
 <div class="se-a41e323b " data-slate-type="paragraph" data-slate-object="block" data-key="2200">
  <span data-slate-object="text" data-key="2201"><span data-slate-leaf="true" data-offset-key="2201:0" data-first-offset="true"><span data-slate-string="true">接着说说 BASE。</span></span></span>
 </div>
 <div class="se-645c784f " data-slate-type="paragraph" data-slate-object="block" data-key="2202">
  <span data-slate-object="text" data-key="2203"><span data-slate-leaf="true" data-offset-key="2203:0" data-first-offset="true"><span data-slate-string="true">前面已经谈到了 NoSQL，CAP、最终一致性，再加上 BASE，被称作 NoSQL 的三大基石。而 BASE，是基于 CAP 衍生出来，对于其牺牲一致性和保证可用性的这一分支，落实到具体实践中的经验总结，在大规模互联网分布式系统的设计中具有指导意义。</span></span></span>
 </div>
 <div class="se-963520ab" data-slate-type="list" data-slate-object="block" data-key="2204">
  <div class="se-e5e455d8 se-0402bf3e" data-slate-type="list-line" data-slate-object="block" data-key="2205">
   <span data-slate-object="text" data-key="2206"><span data-slate-leaf="true" data-offset-key="2206:0" data-first-offset="true"><span data-slate-string="true">BA：基本可用，即 Basically Available。这就是说，为了保障核心特性的“基本可用”，无论是次要特性的功能上，还是性能上，都可以牺牲。严格说来，这都是在“可用性”方面做的妥协。例如电商网站在双十一等访问压力较大的期间，可以关闭某一些次要特性，将购物支付等核心特性保证起来。如果你还记得 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2207" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2208"><span data-slate-leaf="true" data-offset-key="2208:0" data-first-offset="true"><span data-slate-string="true">[第 17 讲]</span></span></span></a><span data-slate-object="text" data-key="2209"><span data-slate-leaf="true" data-offset-key="2209:0" data-first-offset="true"><span data-slate-string="true"> 中的“优雅降级”，那么你应该知道，这里说的就是优雅降级中一个常见的应用场景。</span></span></span>
  </div>
  <div class="se-3d994dca se-d053043f" data-slate-type="list-line" data-slate-object="block" data-key="2210">
   <span data-slate-object="text" data-key="2211"><span data-slate-leaf="true" data-offset-key="2211:0" data-first-offset="true"><span data-slate-string="true">S：软状态，即 Soft State。说的是允许系统中的数据存在中间状态，这也一样，为了可用性，而牺牲了一致性。</span></span></span>
  </div>
  <div class="se-3c09f5dc se-2401c1b5" data-slate-type="list-line" data-slate-object="block" data-key="2212">
   <span data-slate-object="text" data-key="2213"><span data-slate-leaf="true" data-offset-key="2213:0" data-first-offset="true"><span data-slate-string="true">E：最终一致性，即 Eventually Consistent。S 和 E 两点其实说的是一个事情，一致性的牺牲是可行且有限度的，某个数据变更后的时间窗口内出现了不一致的情况，但是之后数据会恢复到一致的状态。举例来说，上文提到过的 CDN 系统便是如此，再比如社交媒体发布后的互动，像点赞、评论等功能，这些数据可以延迟一会儿显示，但是超过了一定的时间窗口还不同步到就会是问题。</span></span></span>
  </div>
 </div>
 <h2 class="se-8f9a40ac" data-slate-type="heading" data-slate-object="block" data-key="2214"><span data-slate-object="text" data-key="2215"><span data-slate-leaf="true" data-offset-key="2215:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-d02f5f8f" data-slate-type="list" data-slate-object="block" data-key="2216">
  <div class="se-79729d5f se-e77e8c16" data-slate-type="list-line" data-slate-object="block" data-key="2217">
   <a data-slate-type="link" data-slate-object="inline" data-key="2218" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2219"><span data-slate-leaf="true" data-offset-key="2219:0" data-first-offset="true"><span data-slate-string="true">Towards Robust Distributed Systems</span></span></span></a><span data-slate-object="text" data-key="2220"><span data-slate-leaf="true" data-offset-key="2220:0" data-first-offset="true"><span data-slate-string="true">，这是一个胶片，来自 Eric Brewer 最早谈及 CAP 理论的一个分享；而 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2221" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2222"><span data-slate-leaf="true" data-offset-key="2222:0" data-first-offset="true"><span data-slate-string="true">Brewer’s CAP Theorem</span></span></span></a><span data-slate-object="text" data-key="2223"><span data-slate-leaf="true" data-offset-key="2223:0" data-first-offset="true"><span data-slate-string="true">，这一篇是对 CAP 理论证明的论文，想看中文的话可以看看这篇</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2224" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2225"><span data-slate-leaf="true" data-offset-key="2225:0" data-first-offset="true"><span data-slate-string="true">中文译文</span></span></span></a><span data-slate-object="text" data-key="2226"><span data-slate-leaf="true" data-offset-key="2226:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-306dd2b7 se-b3b30d3f" data-slate-type="list-line" data-slate-object="block" data-key="2227">
   <span data-slate-object="text" data-key="2228"><span data-slate-leaf="true" data-offset-key="2228:0" data-first-offset="true"><span data-slate-string="true">文中提到了 NoSQL 的概念，CAP 的三角形一图中也有一些实现的例子，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2229" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2230"><span data-slate-leaf="true" data-offset-key="2230:0" data-first-offset="true"><span data-slate-string="true">NoSQL Databases</span></span></span></a><span data-slate-object="text" data-key="2231"><span data-slate-leaf="true" data-offset-key="2231:0" data-first-offset="true"><span data-slate-string="true"> 这个网站列出了比较全面的 NoSQL 数据库列表，可供查询。</span></span></span>
  </div>
  <div class="se-8cbc431a se-4c4b2103" data-slate-type="list-line" data-slate-object="block" data-key="2232">
   <span data-slate-object="text" data-key="2233"><span data-slate-leaf="true" data-offset-key="2233:0" data-first-offset="true"><span data-slate-string="true">文中提到了某些存储服务能够通过配置在 CAP 的三角形上切换。比如 DynamoDB，它是一个 NoSQL 的键 / 值文档数据库，就可以配置为 CP，也可以配置为 AP，官方的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2234" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2235"><span data-slate-leaf="true" data-offset-key="2235:0" data-first-offset="true"><span data-slate-string="true">读取一致性</span></span></span></a><span data-slate-object="text" data-key="2236"><span data-slate-leaf="true" data-offset-key="2236:0" data-first-offset="true"><span data-slate-string="true">这篇文章做了简要说明；再比如 S3，它是一个云上的对象存储服务，它的一致性根据对象创建和对象修改而有所不同，你可以看一下</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2237" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2238"><span data-slate-leaf="true" data-offset-key="2238:0" data-first-offset="true"><span data-slate-string="true">官方的这个说明</span></span></span></a><span data-slate-object="text" data-key="2239"><span data-slate-leaf="true" data-offset-key="2239:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-7df1841c se-802e4653" data-slate-type="list-line" data-slate-object="block" data-key="2240">
   <span data-slate-object="text" data-key="2241"><span data-slate-leaf="true" data-offset-key="2241:0" data-first-offset="true"><span data-slate-string="true">如果对 BASE 感兴趣，你可以看看这篇最原始的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2242" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2243"><span data-slate-leaf="true" data-offset-key="2243:0" data-first-offset="true"><span data-slate-string="true">Base: An Acid Alternative</span></span></span></a><span data-slate-object="text" data-key="2244"><span data-slate-leaf="true" data-offset-key="2244:0" data-first-offset="true"><span data-slate-string="true">，想看中文译文的话可以看看</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2245" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2246"><span data-slate-leaf="true" data-offset-key="2246:0" data-first-offset="true"><span data-slate-string="true">这篇</span></span></span></a><span data-slate-object="text" data-key="2247"><span data-slate-leaf="true" data-offset-key="2247:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-66d76c24 se-17239546" data-slate-type="list-line" data-slate-object="block" data-key="2248">
   <span data-slate-object="text" data-key="2249"><span data-slate-leaf="true" data-offset-key="2249:0" data-first-offset="true"><span data-slate-string="true">对于文中提到的事务隔离，感兴趣可以进一步参见</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2250" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2251"><span data-slate-leaf="true" data-offset-key="2251:0" data-first-offset="true"><span data-slate-string="true">维基百科</span></span></span></a><span data-slate-object="text" data-key="2252"><span data-slate-leaf="true" data-offset-key="2252:0" data-first-offset="true"><span data-slate-string="true">，还有一篇美团技术团队写的</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="2253" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="2254"><span data-slate-leaf="true" data-offset-key="2254:0" data-first-offset="true"><span data-slate-string="true">Innodb 中的事务隔离级别和锁的关系</span></span></span></a><span data-slate-object="text" data-key="2255"><span data-slate-leaf="true" data-offset-key="2255:0" data-first-offset="true"><span data-slate-string="true">，也是很好的针对事务隔离的学习材料。</span></span></span>
  </div>
 </div>
 <div class="se-e269788d" data-slate-type="image" data-slate-object="block" data-key="2256">
  <img class="se-8066cd69" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |23          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:47:18.346 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=23 
 {executed in 0 msec}
2020-11-19 17:47:18.347 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                     |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|-----|----|----|
|23  |1605755636 |1605755636 |1                |zh-hans  |0       |1                             |1      |0      |24丨尺有所短，寸有所长：CAP和数据存储技术选择 |book |1   |23  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|-----|----|----|

2020-11-19 17:47:18.348 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=23 
 {executed in 0 msec}
2020-11-19 17:47:18.348 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                     |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|----|----|
|[unread] |1605755636 |1605755636 |1                |zh-hans  |0       |1                             |1      |0      |24丨尺有所短，寸有所长：CAP和数据存储技术选择 |1   |23  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------------|----|----|

2020-11-19 17:47:18.352 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779238, created=1605779238, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='24丨尺有所短，寸有所长：CAP和数据存储技术选择', 
type='book', uid=1, vid=23 where nid=23 
 {executed in 1 msec}
2020-11-19 17:47:18.352 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779238, created=1605779238, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='24丨尺有所短，寸有所长：CAP和数据存储技术选择', 
uid=1, vid=23 where nid=23 
 {executed in 0 msec}
2020-11-19 17:47:18.359 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.360 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|23        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/56b7abb74b991bfc01d8daa6a201cedf?bkt=en-06f5c65000af0ed6cf391d9987ff1c7d49b268d0e2d7238ddc4f49b993c4dbbe6acc327878ad5eb2&fid=3757516097-778750-342183480050886&time=1605755635&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-FbD2e9d7wLhRMb1x49fmMJVs2l0%3D&to=92&size=16098707&sta_dx=16098707&sta_cs=3426&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572854462&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16098707&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-db2acf3e28c7865ebeddfaff4daed586f37be3fcb28d2f00c3aa86809321853841170dd8a08d2c70&sl=76480590&expires=8h&rt=pr&r=781993201&mlogid=7502136082562330854&vbdid=2247232042&fin=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a&bflag=92,34-92&rtype=1&dp-logid=7502136082562330854&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=8525e99dbc6685b12cf09d202f93a41add58274f97593415&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a |23          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:47:18.363 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/56b7abb74b991bfc01d8daa6a201cedf?bkt=en-06f5c65000af0ed6cf391d9987ff1c7d49b268d0e2d7238ddc4f49b993c4dbbe6acc327878ad5eb2&fid=3757516097-778750-253597464493161&time=1605779236&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-MsgG0K%2BLxEnB15ZcpAMEacikfGw%3D&to=92&size=16098707&sta_dx=16098707&sta_cs=3430&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572854462&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16098707&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-db2acf3e28c7865ebeddfaff4daed586f37be3fcb28d2f00c3aa86809321853841170dd8a08d2c70&sl=76480590&expires=8h&rt=pr&r=294133594&mlogid=7508471484223272649&vbdid=2247232042&fin=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a&bflag=92,34-92&rtype=1&dp-logid=7508471484223272649&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=12146e4ffd7df3c9db0a9a5c663301d70cd71c237f811d32&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a', 
revision_id=23 where entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.367 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.368 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/56b7abb74b991bfc01d8daa6a201cedf?bkt=en-06f5c65000af0ed6cf391d9987ff1c7d49b268d0e2d7238ddc4f49b993c4dbbe6acc327878ad5eb2&fid=3757516097-778750-342183480050886&time=1605755635&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-FbD2e9d7wLhRMb1x49fmMJVs2l0%3D&to=92&size=16098707&sta_dx=16098707&sta_cs=3426&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572854462&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16098707&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-db2acf3e28c7865ebeddfaff4daed586f37be3fcb28d2f00c3aa86809321853841170dd8a08d2c70&sl=76480590&expires=8h&rt=pr&r=781993201&mlogid=7502136082562330854&vbdid=2247232042&fin=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a&bflag=92,34-92&rtype=1&dp-logid=7502136082562330854&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=8525e99dbc6685b12cf09d202f93a41add58274f97593415&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a |23          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:47:18.371 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/56b7abb74b991bfc01d8daa6a201cedf?bkt=en-06f5c65000af0ed6cf391d9987ff1c7d49b268d0e2d7238ddc4f49b993c4dbbe6acc327878ad5eb2&fid=3757516097-778750-253597464493161&time=1605779236&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-MsgG0K%2BLxEnB15ZcpAMEacikfGw%3D&to=92&size=16098707&sta_dx=16098707&sta_cs=3430&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572854462&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16098707&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-db2acf3e28c7865ebeddfaff4daed586f37be3fcb28d2f00c3aa86809321853841170dd8a08d2c70&sl=76480590&expires=8h&rt=pr&r=294133594&mlogid=7508471484223272649&vbdid=2247232042&fin=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a&bflag=92,34-92&rtype=1&dp-logid=7508471484223272649&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=12146e4ffd7df3c9db0a9a5c663301d70cd71c237f811d32&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=24%E4%B8%A8%E5%B0%BA%E6%9C%89%E6%89%80%E7%9F%AD%EF%BC%8C%E5%AF%B8%E6%9C%89%E6%89%80%E9%95%BF%EF%BC%9ACAP%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9.m4a', 
revision_id=23 where entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.375 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.376 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |delta |field_comment_format |langcode |revision_id |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|23        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>tt</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-04
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我在某银行的省级分行工作。大体上，账务核心是全国集中的，标准银行业务从粗力度上看直接与核心发生交互，而对于分省的特色业务，是通过分行接入核心进行账务交易，分行系统与三方商户进行交互和资金清算。分行会记录金融交易的状态，商户也会记录状态。
    <br>从记录金融交易状态这一点来看，总行核心、分行交易系统、商户IT系统算是构成了一个分布式的存储吧。
    <br>
    <br>其实这不是第一次听到CAP这个理论，但今天在听到老师的问题时，突然觉得日常交易配置中的种种风格都可以用CAP或者BASE理论来解释。(ACID在上述某个节点如分行系统内部运行，这里不讨论了)。
    <br>
    <br>比如，发生账务交易时，是先在总行账务核心进行还是先去商户进行业务处理等。
    <br>
    <br>分区容忍性对应到我的业务场景，就是交易未明，这时分行会进行冲正（先冲正核心或者先冲正商户系统）或者先查询再冲正，如果此时网络恢复，则强一致性得到了满足。但如果经过一定次数的重试后仍然未明，就只能依赖于第二天的对账来进行了，此时业务柜员会进行手工处理。
    <br>
    <br>所以，从这个角度上来说，上面三个节点系统保障的是最终一致性，适用于BASE。而银行核心的内部节点间适用于CAP的CP。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 说得很好 :) 感谢。<br><br>即便如银行，在一些出现网络分区的场景下依然优先保证可用性，而可以牺牲一致性。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |23          |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:47:18.380 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.381 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |delta |field_comment_format |langcode |revision_id |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <a>tt</a> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-11-04
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我在某银行的省级分行工作。大体上，账务核心是全国集中的，标准银行业务从粗力度上看直接与核心发生交互，而对于分省的特色业务，是通过分行接入核心进行账务交易，分行系统与三方商户进行交互和资金清算。分行会记录金融交易的状态，商户也会记录状态。
    <br>从记录金融交易状态这一点来看，总行核心、分行交易系统、商户IT系统算是构成了一个分布式的存储吧。
    <br>
    <br>其实这不是第一次听到CAP这个理论，但今天在听到老师的问题时，突然觉得日常交易配置中的种种风格都可以用CAP或者BASE理论来解释。(ACID在上述某个节点如分行系统内部运行，这里不讨论了)。
    <br>
    <br>比如，发生账务交易时，是先在总行账务核心进行还是先去商户进行业务处理等。
    <br>
    <br>分区容忍性对应到我的业务场景，就是交易未明，这时分行会进行冲正（先冲正核心或者先冲正商户系统）或者先查询再冲正，如果此时网络恢复，则强一致性得到了满足。但如果经过一定次数的重试后仍然未明，就只能依赖于第二天的对账来进行了，此时业务柜员会进行手工处理。
    <br>
    <br>所以，从这个角度上来说，上面三个节点系统保障的是最终一致性，适用于BASE。而银行核心的内部节点间适用于CAP的CP。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 说得很好 :) 感谢。<br><br>即便如银行，在一些出现网络分区的场景下依然优先保证可用性，而可以牺牲一致性。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |23          |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:47:18.384 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.385 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|23        |book   |0     |zh-hans  |23          |https://static001.geekbang.org/resource/image/d1/26/d1c13a9e40f253baa7113195782cc726.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:47:18.389 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.389 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |23          |https://static001.geekbang.org/resource/image/d1/26/d1c13a9e40f253baa7113195782cc726.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:47:18.393 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=23 
 {executed in 1 msec}
2020-11-19 17:47:18.393 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |23          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:47:18.397 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=23 
 {executed in 0 msec}
2020-11-19 17:47:18.398 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |23          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:47:18.401 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='911224506662888' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:47:18.401 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:48:14.836 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='911224506662888' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:48:14.836 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:48:14.837 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('911224506662888', 0, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:48:14.837 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('911224506662888', 
0, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:48:14.837 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|39            |
|--------------|

2020-11-19 17:48:14.850 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='911224506662888' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:48:14.851 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:48:15.295 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='911224506662888' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:48:15.296 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:48:15.298 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('911224506662888', 1, 'media') 
 {executed in 1 msec}
2020-11-19 17:48:15.298 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('911224506662888', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:48:15.299 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|40            |
|--------------|

2020-11-19 17:48:15.313 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='911224506662888' 
 {executed in 0 msec}
2020-11-19 17:48:15.313 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|24        |book   |0     |911224506662888  |zh-hans  |24          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:48:15.314 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=24 
 {executed in 0 msec}
2020-11-19 17:48:15.315 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|24  |zh-hans  |book |223d5216-f654-4ebe-9ead-3dddb8188af5 |24  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:48:15.319 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=24 
 {executed in 1 msec}
2020-11-19 17:48:15.319 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |911224506662888  |zh-hans  |24          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:48:15.323 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=24 
 {executed in 0 msec}
2020-11-19 17:48:15.323 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|24  |1   |3     |0            |1  |19 |24 |0  |0  |19  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:48:15.328 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=24 
 {executed in 1 msec}
2020-11-19 17:48:15.340 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|24        |<div data-slate-editor="true" data-key="1237" autocorrect="off" spellcheck="false" data-gramm="false" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;">
 <div class="se-6e3a0b9a " data-slate-type="paragraph" data-slate-object="block" data-key="1238">
  <span data-slate-object="text" data-key="1239"><span data-slate-leaf="true" data-offset-key="1239:0" data-first-offset="true"><span data-slate-string="true">你好，我是四火。</span></span></span>
 </div>
 <div class="se-d0683b7f " data-slate-type="paragraph" data-slate-object="block" data-key="1240">
  <span data-slate-object="text" data-key="1241"><span data-slate-leaf="true" data-offset-key="1241:0" data-first-offset="true"><span data-slate-string="true">我想你很可能已经使用过许多存储层的技术了，例如缓存、文件、关系数据库，甚至一些云上 key-value 的存储服务，但就如同我之前提到的那样，某项具体技术总是相对好学，可对于全栈知识系统地学习，也包括持久层的学习，是一定要立足于技术的基础、原理和本质的。今天，我们要讲的就是其中之一 —— 一致性（Consistency）。</span></span></span>
 </div>
 <div class="se-e74ddb98 " data-slate-type="paragraph" data-slate-object="block" data-key="1242">
  <span data-slate-object="text" data-key="1243"><span data-slate-leaf="true" data-offset-key="1243:0" data-first-offset="true"><span data-slate-string="true">数据的可用性和一致性是很多工程师几乎每天都会挂在嘴边的概念，在存储系统的技术选型上面，一致性将会是我们一个重要的衡量因素，而在持久层架构设计上面，它也将是最重要的思考维度。</span></span></span>
 </div>
 <div class="se-d7b6a63a " data-slate-type="paragraph" data-slate-object="block" data-key="1244">
  <span data-slate-object="text" data-key="1245"><span data-slate-leaf="true" data-offset-key="1245:0" data-first-offset="true"><span data-slate-string="true">数据的一致性不但是数据持久化的一个核心内容，也是学习的一个难点，希望我们一起努力，从原理上去彻底理解它，并学习一些常见的应用模式，做到“知其然，知其所以然”，我们一起把这个难啃的骨头给啃下来。</span></span></span>
 </div>
 <h2 class="se-772520ac" data-slate-type="heading" data-slate-object="block" data-key="1246"><span data-slate-object="text" data-key="1247"><span data-slate-leaf="true" data-offset-key="1247:0" data-first-offset="true"><span data-slate-string="true">概念和背景</span></span></span></h2>
 <div class="se-0b63aa5a " data-slate-type="paragraph" data-slate-object="block" data-key="1248">
  <span data-slate-object="text" data-key="1249"><span data-slate-leaf="true" data-offset-key="1249:0" data-first-offset="true"><span data-slate-string="true">数据持久化，本质上就是把内存中的数据给转换并写入指定的存储系统中，这个过程是保证数据不丢失的基本方式，而这个存储系统可以具备很多种形式，可以是网络、硬盘文件，也可以是数据库，还可以是前面两讲提到的某种形式的缓存。</span></span></span>
 </div>
 <div class="se-4237e450 " data-slate-type="paragraph" data-slate-object="block" data-key="1250">
  <span data-slate-object="text" data-key="1251"><span data-slate-leaf="true" data-offset-key="1251:0" data-first-offset="true"><span data-slate-string="true">你也许听说过对于一致性的不同解释，而我们在谈论数据持久化的时候讲到的一致性，我认为简单来说，指的就是在存储系统中，客户端对数据的读写行为都是可以预期、符合一定规则的。这里有两个值得注意的方面：</span></span></span>
 </div>
 <div class="se-008ca755" data-slate-type="list" data-slate-object="block" data-key="1252">
  <div class="se-c8760f42 se-b2a29774" data-slate-type="list-line" data-slate-object="block" data-key="1253">
   <span data-slate-object="text" data-key="1254"><span data-slate-leaf="true" data-offset-key="1254:0" data-first-offset="true"><span class="se-9bb15cbf" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">可以预期和符合规则，而不是说读到的数据是“一致的”“准确的”或是“最新的”</span></span></span></span><span data-slate-object="text" data-key="1255"><span data-slate-leaf="true" data-offset-key="1255:0" data-first-offset="true"><span data-slate-string="true">，是因为存在不同的一致性模型，数据对一致性遵从的程度和规则都不同，下文我会讲到。</span></span></span>
  </div>
  <div class="se-1125b4fd se-0f65f661" data-slate-type="list-line" data-slate-object="block" data-key="1256">
   <span data-slate-object="text" data-key="1257"><span data-slate-leaf="true" data-offset-key="1257:0" data-first-offset="true"><span data-slate-string="true">一致性判断的视角要从客户端来看，也就是说，</span></span></span><span data-slate-object="text" data-key="1258"><span data-slate-leaf="true" data-offset-key="1258:0" data-first-offset="true"><span class="se-c1b22d2e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">存储系统实际存储的数据可以在某些时候不遵从我们所要求的一致性，而只需要保证存储系统的客户端能读取到一致的数据就可以了。</span></span></span></span><span data-slate-object="text" data-key="1259"><span data-slate-leaf="true" data-offset-key="1259:0" data-first-offset="true"><span data-slate-string="true">举例来说，某一个数据更新的过程中，对于存储系统来说，新数据其实已经写入，但由于事务还未提交，这时客户端读到的还是老数据。</span></span></span>
  </div>
 </div>
 <div class="se-2dacc5cb " data-slate-type="paragraph" data-slate-object="block" data-key="1260">
  <span data-slate-object="text" data-key="1261"><span data-slate-leaf="true" data-offset-key="1261:0" data-first-offset="true"><span data-slate-string="true">我想这个概念并没有什么特殊之处，但是，这里面隐含了一个事情，就是说，为什么要有数据备份呢？</span></span></span>
 </div>
 <div class="se-5ccce30b " data-slate-type="paragraph" data-slate-object="block" data-key="1262">
  <span data-slate-object="text" data-key="1263"><span data-slate-leaf="true" data-offset-key="1263:0" data-first-offset="true"><span data-slate-string="true">为了可用性（Availability）。</span></span></span>
 </div>
 <div class="se-3a78c1a0 " data-slate-type="paragraph" data-slate-object="block" data-key="1264">
  <span data-slate-object="text" data-key="1265"><span data-slate-leaf="true" data-offset-key="1265:0" data-first-offset="true"><span class="se-b493fb7e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">服务为了高可用，就要部署多个节点；数据为了高可用，就要存放多个备份。</span></span></span></span><span data-slate-object="text" data-key="1266"><span data-slate-leaf="true" data-offset-key="1266:0" data-first-offset="true"><span data-slate-string="true">这里的数据，既包括数据本身，又包括数据的读写服务，这是因为：</span></span></span>
 </div>
 <div class="se-0d7e98d1" data-slate-type="list" data-slate-object="block" data-key="1267">
  <div class="se-efeae001 se-b7bdc555" data-slate-type="list-line" data-slate-object="block" data-key="1268">
   <span data-slate-object="text" data-key="1269"><span data-slate-leaf="true" data-offset-key="1269:0" data-first-offset="true"><span data-slate-string="true">要让数据不丢失，冗余几乎是唯一的办法，因为再好的存储介质也架不住设备老化和各种原因的破坏；</span></span></span>
  </div>
  <div class="se-c89f5590 se-ce1c8aeb" data-slate-type="list-line" data-slate-object="block" data-key="1270">
   <span data-slate-object="text" data-key="1271"><span data-slate-leaf="true" data-offset-key="1271:0" data-first-offset="true"><span data-slate-string="true">同理，为了数据访问服务能保持可用，包括保证足够的性能，必须要提供多个节点的读写操作服务，于是，我们不得不创建多个数据副本。</span></span></span>
  </div>
 </div>
 <div class="se-e0051987 " data-slate-type="paragraph" data-slate-object="block" data-key="1272">
  <span data-slate-object="text" data-key="1273"><span data-slate-leaf="true" data-offset-key="1273:0" data-first-offset="true"><span data-slate-string="true">那么一环扣一环，如果只有一份数据，是不存在一致性问题的，因为数据自己也只有一份，没法存在不一致，但有了数据副本，一致性就成为了课题。</span></span></span>
 </div>
 <h2 class="se-1227a2af" data-slate-type="heading" data-slate-object="block" data-key="1274"><span data-slate-object="text" data-key="1275"><span data-slate-leaf="true" data-offset-key="1275:0" data-first-offset="true"><span data-slate-string="true">一致性模型</span></span></span></h2>
 <div class="se-25833989 " data-slate-type="paragraph" data-slate-object="block" data-key="1276">
  <span data-slate-object="text" data-key="1277"><span data-slate-leaf="true" data-offset-key="1277:0" data-first-offset="true"><span data-slate-string="true">你很可能已经听说过这三种一致性模型，下面我们来分别了解一下。</span></span></span>
 </div>
 <div class="se-17a7f1a6 " data-slate-type="paragraph" data-slate-object="block" data-key="1278">
  <span data-slate-object="text" data-key="1279"><span data-slate-leaf="true" data-offset-key="1279:0" data-first-offset="true"><span class="se-1fa8a7f0" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">强一致性（Strong Consistency）：</span></span></span></span><span data-slate-object="text" data-key="1280"><span data-slate-leaf="true" data-offset-key="1280:0" data-first-offset="true"><span data-slate-string="true">强一致性要求任意时间下，读操作总是能取得最近一次写操作写入的数据。</span></span></span>
 </div>
 <div class="se-60a5e3d4 " data-slate-type="paragraph" data-slate-object="block" data-key="1281">
  <span data-slate-object="text" data-key="1282"><span data-slate-leaf="true" data-offset-key="1282:0" data-first-offset="true"><span data-slate-string="true">注意，这里依然是从存储系统客户端的角度来描述的，</span></span></span><span data-slate-object="text" data-key="1283"><span data-slate-leaf="true" data-offset-key="1283:0" data-first-offset="true"><span class="se-4f1b77e9" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">即便如强一致性的限制，也只要求在读取的时候能读到“最新”的数据就可以了，至于这个在上次写操作之后、这次读操作之前，对存储系统内部的数据是否是“最新”的并无要求。</span></span></span></span><span data-slate-object="text" data-key="1284"><span data-slate-leaf="true" data-offset-key="1284:0" data-first-offset="true"><span data-slate-string="true">我们经常使用的传统关系型数据库，比如 Oracle、MySQL，它们都是符合强一致性的。</span></span></span>
 </div>
 <div class="se-a4fe5bc1 " data-slate-type="paragraph" data-slate-object="block" data-key="1285">
  <span data-slate-object="text" data-key="1286"><span data-slate-leaf="true" data-offset-key="1286:0" data-first-offset="true"><span class="se-dbe999f3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">弱一致性（Weak Consistency）：</span></span></span></span><span data-slate-object="text" data-key="1287"><span data-slate-leaf="true" data-offset-key="1287:0" data-first-offset="true"><span class="se-959c01e7" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">弱一致性和强一致性相反，读操作</span></span></span></span><span data-slate-object="text" data-key="1288"><span data-slate-leaf="true" data-offset-key="1288:0" data-first-offset="true"><span class="se-d4a2b323" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">并不能保证</span></span></span></span><span data-slate-object="text" data-key="1289"><span data-slate-leaf="true" data-offset-key="1289:0" data-first-offset="true"><span data-slate-string="true">可以取得最新一次写操作写入的数据，也就是说，客户端可能读到最新的数据，也可能读不到最新的数据。</span></span></span>
 </div>
 <div class="se-531d52cb " data-slate-type="paragraph" data-slate-object="block" data-key="1290">
  <span data-slate-object="text" data-key="1291"><span data-slate-leaf="true" data-offset-key="1291:0" data-first-offset="true"><span data-slate-string="true">这个“并不能保证”就有点“搞笑”了——都不确定能不能读到最新值，那它有什么用？其实它的应用也挺广泛的，最常见的例子就是缓存，比如一个静态资源被浏览器缓存起来，那么这之后只要是从缓存内取得的数据，使用者其实根本不知道这个数据是不是最新的，因为即便它实际有了更新，服务端也不会通知你。</span></span></span>
 </div>
 <div class="se-93cc4b13 " data-slate-type="paragraph" data-slate-object="block" data-key="1292">
  <span data-slate-object="text" data-key="1293"><span data-slate-leaf="true" data-offset-key="1293:0" data-first-offset="true"><span class="se-03eeaee8" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">最终一致性（Eventual Consistency）：</span></span></span></span><span data-slate-object="text" data-key="1294"><span data-slate-leaf="true" data-offset-key="1294:0" data-first-offset="true"><span data-slate-string="true">最终一致性介于强一致性和弱一致性之间，写操作之后立即进行读操作，可能无法读到更新后的值，但是如果经过了一个指定的时间窗口，就能保证可以读到那个更新后的值。</span></span></span>
 </div>
 <div class="se-d92ab5c5 " data-slate-type="paragraph" data-slate-object="block" data-key="1295">
  <span data-slate-object="text" data-key="1296"><span data-slate-leaf="true" data-offset-key="1296:0" data-first-offset="true"><span data-slate-string="true">最终一致性可能是我们日常生活中最常见的一致性模型了。比如搜索引擎，搜索引擎的爬虫会定期爬取数据，并更新搜索数据，因此如果你的网站只是刚刚更新，可能还无法搜到这个更新内容，但只要是过了一定的时间窗口，它就会出现在搜索结果中了。</span></span></span>
 </div>
 <h2 class="se-b7a48732" data-slate-type="heading" data-slate-object="block" data-key="1297"><span data-slate-object="text" data-key="1298"><span data-slate-leaf="true" data-offset-key="1298:0" data-first-offset="true"><span data-slate-string="true">数据高可用的架构技术</span></span></span></h2>
 <div class="se-e1222b64 " data-slate-type="paragraph" data-slate-object="block" data-key="1299">
  <span data-slate-object="text" data-key="1300"><span data-slate-leaf="true" data-offset-key="1300:0" data-first-offset="true"><span data-slate-string="true">接下来，我们探讨互联网应用中最常见的几种架构技术，它们都是用以解决数据可用性的问题，就如同我们在上文中所提到的那样，既包括数据本身的可用性，又包括数据读写服务的可用性。</span></span></span>
 </div>
 <h3 class="se-119601fe" data-slate-type="heading" data-slate-object="block" data-key="1301"><span data-slate-object="text" data-key="1302"><span data-slate-leaf="true" data-offset-key="1302:0" data-first-offset="true"><span data-slate-string="true">1. 简单备份</span></span></span></h3>
 <div class="se-a2a11c4e " data-slate-type="paragraph" data-slate-object="block" data-key="1303">
  <span data-slate-object="text" data-key="1304"><span data-slate-leaf="true" data-offset-key="1304:0" data-first-offset="true"><span data-slate-string="true">简单备份（Backup）指的就是定期或按需对存储系统中的数据全量或增量进行复制，并保存为副本，从而降低数据丢失风险的一种方式。</span></span></span>
 </div>
 <div class="se-c957c305" data-slate-type="image" data-slate-object="block" data-key="1305">
  <img class="se-61b1b487" src="https://static001.geekbang.org/resource/image/53/4f/53c3e61aca5906962a78446cbdb5fa4f.png">
 </div>
 <div class="se-b51603d8 " data-slate-type="paragraph" data-slate-object="block" data-key="1306">
  <span data-slate-object="text" data-key="1307"><span data-slate-leaf="true" data-offset-key="1307:0" data-first-offset="true"><span data-slate-string="true">这是一种实现上最简单的技术，在个人电脑上极其常见，但即便在工业界，依然有大量的应用场景。比方说 Amazon RDS（将关系数据库搬到云上）的 Snapshot 技术，可以定期将所有数据导出为一份副本。在 CPU 和 I/O 等资源不成为瓶颈的情况下，因为是异步进行的，简单备份往往对存储系统读写操作的影响很小。</span></span></span>
 </div>
 <div class="se-71eb63e8 " data-slate-type="paragraph" data-slate-object="block" data-key="1308">
  <span data-slate-object="text" data-key="1309"><span data-slate-leaf="true" data-offset-key="1309:0" data-first-offset="true"><span data-slate-string="true">但是，这种方式存在存储系统的单点故障问题，一旦存储系统挂掉了，服务也就中断了，因此基本没法谈可用性。</span></span></span>
 </div>
 <div class="se-252ff97d " data-slate-type="paragraph" data-slate-object="block" data-key="1310">
  <span data-slate-object="text" data-key="1311"><span data-slate-leaf="true" data-offset-key="1311:0" data-first-offset="true"><span data-slate-string="true">你可能会说，可用性的话，可以给访问存储的 Web 服务器做双机备份啊。没错，但那解决的是 Web 服务器可用性的问题，并不是我们这里最关心的数据可用性的问题，数据存储依然是单点的。同时，如果什么时候存储系统挂掉了，那么只能恢复到最近一次的备份点，因此可能丢失大量的数据。</span></span></span>
 </div>
 <h3 class="se-a6a67ff9" data-slate-type="heading" data-slate-object="block" data-key="1312"><span data-slate-object="text" data-key="1313"><span data-slate-leaf="true" data-offset-key="1313:0" data-first-offset="true"><span data-slate-string="true">2. Multi-Master</span></span></span></h3>
 <div class="se-be7810c3 " data-slate-type="paragraph" data-slate-object="block" data-key="1314">
  <span data-slate-object="text" data-key="1315"><span data-slate-leaf="true" data-offset-key="1315:0" data-first-offset="true"><span data-slate-string="true">Multi-Master 架构是指存在多个 Master（主）节点，各自都提供完整的读写服务，数据备份之间的互相拷贝为了不影响读写请求的性能，通常是异步进行的。</span></span></span>
 </div>
 <div class="se-a1183064" data-slate-type="image" data-slate-object="block" data-key="1316">
  <img class="se-fa157b70" src="https://static001.geekbang.org/resource/image/b9/cc/b9153efbb171d6381a08cfa577bc02cc.jpg">
 </div>
 <div class="se-643be13e " data-slate-type="paragraph" data-slate-object="block" data-key="1317">
  <span data-slate-object="text" data-key="1318"><span data-slate-leaf="true" data-offset-key="1318:0" data-first-offset="true"><span data-slate-string="true">从图中，你可以看到，如果某一主节点对应的存储服务挂掉了，那么还有另一个主节点可以提供对应服务，因此，这种方式是可以提供高可用服务的。图中只放了两个主节点，但是其实是可以放置多个的。</span></span></span>
 </div>
 <div class="se-2f2af078 " data-slate-type="paragraph" data-slate-object="block" data-key="1319">
  <span data-slate-object="text" data-key="1320"><span data-slate-leaf="true" data-offset-key="1320:0" data-first-offset="true"><span data-slate-string="true">关于一致性，通常情况下节点之间的数据互拷贝是异步进行的，因此是最终一致性。需要说明的是，这个数据互拷贝理论上也是可以做到同步进行的，即将数据拷贝到所有其它的主节点以后再将响应返回给用户，而且那种情况下就可以做到强一致性，不过实际却很少有这样做的，这是为什么呢？</span></span></span>
 </div>
 <div class="se-fbfeac27 " data-slate-type="paragraph" data-slate-object="block" data-key="1321">
  <span data-slate-object="text" data-key="1322"><span data-slate-leaf="true" data-offset-key="1322:0" data-first-offset="true"><span data-slate-string="true">第一个原因，显而易见，同步的数据拷贝会导致整体请求响应的时延增加。</span></span></span>
 </div>
 <div class="se-2534079e " data-slate-type="paragraph" data-slate-object="block" data-key="1323">
  <span data-slate-object="text" data-key="1324"><span data-slate-leaf="true" data-offset-key="1324:0" data-first-offset="true"><span data-slate-string="true">第二个，也是更重要的原因，如果有节点异常，这个拷贝操作就可能会超时或失败，这种情况下，你觉得存储系统应该怎样对待这个错误？显然，存储系统会陷入两难的境地。</span></span></span>
 </div>
 <div class="se-ec15f918" data-slate-type="list" data-slate-object="block" data-key="1325">
  <div class="se-aceabca4 se-8e299a4c" data-slate-type="list-line" data-slate-object="block" data-key="1326">
   <span data-slate-object="text" data-key="1327"><span data-slate-leaf="true" data-offset-key="1327:0" data-first-offset="true"><span data-slate-string="true">如果系统容许错误发生，不返回错误给用户，那么强一致性就无法保证，既然无法保证，那么这个拷贝过程就完全可以设计成异步的，因为既然无论如何也无法保证强一致性，这个同步除了增加时延以外，并未带来任何明显的好处。</span></span></span>
  </div>
  <div class="se-d2c750e0 se-22b2bc95" data-slate-type="list-line" data-slate-object="block" data-key="1328">
   <span data-slate-object="text" data-key="1329"><span data-slate-leaf="true" data-offset-key="1329:0" data-first-offset="true"><span data-slate-string="true">如果系统不容许错误发生，即返回错误给用户，一致性就被严格保证了，但是这样的话，整个存储系统就不再是高可用了，因为任何一个主节点的不可用，就会导致其它任意主节点向其拷贝数据的失败，进而导致整个系统都变得不可用。我们使用多个主节点的目的就是要提高可用性，而现在这样的设计和高可用性的目的就自相矛盾了。</span></span></span>
  </div>
 </div>
 <div class="se-7656f08d " data-slate-type="paragraph" data-slate-object="block" data-key="1330">
  <span data-slate-object="text" data-key="1331"><span data-slate-leaf="true" data-offset-key="1331:0" data-first-offset="true"><span data-slate-string="true">其实，对待这个节点间的数据拷贝错误，还有第三种方式，它结合了上述二者的优点。我先卖个关子，我们在下面 Master-Slave 的部分会谈到。</span></span></span>
 </div>
 <div class="se-39175672 " data-slate-type="paragraph" data-slate-object="block" data-key="1332">
  <span data-slate-object="text" data-key="1333"><span data-slate-leaf="true" data-offset-key="1333:0" data-first-offset="true"><span data-slate-string="true">再来说说 Multi-Master 的缺陷。</span></span></span><span data-slate-object="text" data-key="1334"><span data-slate-leaf="true" data-offset-key="1334:0" data-first-offset="true"><span class="se-c8c593d9" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">它最大的缺陷是关于事务处理的，本地事务（即单个存储节点）可以提交成功，但是全局事务（所有存储节点）却可能失败。</span></span></span></span><span data-slate-object="text" data-key="1335"><span data-slate-leaf="true" data-offset-key="1335:0" data-first-offset="true"><span data-slate-string="true">它包含这样两种典型的产生问题的场景：</span></span></span>
 </div>
 <div class="se-5ce9d582" data-slate-type="list" data-slate-object="block" data-key="1336">
  <div class="se-4650c8dc se-bbec9ea1" data-slate-type="list-line" data-slate-object="block" data-key="1337">
   <span data-slate-object="text" data-key="1338"><span data-slate-leaf="true" data-offset-key="1338:0" data-first-offset="true"><span data-slate-string="true">由于是最终一致性，那么数据丢失也是可能发生的，即在写操作成功而节点间数据拷贝还没完成的时刻，如果主节点挂掉了，那么数据丢失也就发生了，只不过丢失的数据可能相对较少，但是全局事务的完整性就无从谈起了。</span></span></span>
  </div>
  <div class="se-253ae670 se-b4e67ffa" data-slate-type="list-line" data-slate-object="block" data-key="1339">
   <span data-slate-object="text" data-key="1340"><span data-slate-leaf="true" data-offset-key="1340:0" data-first-offset="true"><span data-slate-string="true">如果没有节点异常，主节点 A 的事务提交成功，主节点 B 的事务也提交成功，它们是做到了对本地数据库中事务操作的原子性。可是当进行节点间数据互拷贝时，一旦这两个提交的事务发生冲突（例如修改同一条记录），它们就傻眼了，到底应该以 A 还是以 B 的事务为准？这种冲突的解决会比较复杂，而且由于发生在异步的拷贝环节，这时候用户的请求都已经返回响应了，就没法告知用户事务冲突了。</span></span></span>
  </div>
 </div>
 <div class="se-f1486780 " data-slate-type="paragraph" data-slate-object="block" data-key="1341">
  <span data-slate-object="text" data-key="1342"><span data-slate-leaf="true" data-offset-key="1342:0" data-first-offset="true"><span data-slate-string="true">因此，当我们要实现全局事务的时候，Multi-Master 往往不是一个好的选择。</span></span></span>
 </div>
 <h3 class="se-9e439169" data-slate-type="heading" data-slate-object="block" data-key="1343"><span data-slate-object="text" data-key="1344"><span data-slate-leaf="true" data-offset-key="1344:0" data-first-offset="true"><span data-slate-string="true">3. Master-Slave</span></span></span></h3>
 <div class="se-96b99cb1 " data-slate-type="paragraph" data-slate-object="block" data-key="1345">
  <span data-slate-object="text" data-key="1346"><span data-slate-leaf="true" data-offset-key="1346:0" data-first-offset="true"><span data-slate-string="true">Master-Slave 架构是指存在一个可读可写（或者只写）的 Master 节点，而存在多个只读的 Slave 节点，每当有通过 Master 的更新出现，数据会以异步的方式单向拷贝到所有的 Slave 节点上去。</span></span></span>
 </div>
 <div class="se-55e94565" data-slate-type="image" data-slate-object="block" data-key="1347">
  <img class="se-af37bae5" src="https://static001.geekbang.org/resource/image/d2/46/d2ee6e41dd28830a49d736f6e5168a46.jpg">
 </div>
 <div class="se-53d8b9d7 " data-slate-type="paragraph" data-slate-object="block" data-key="1348">
  <span data-slate-object="text" data-key="1349"><span data-slate-leaf="true" data-offset-key="1349:0" data-first-offset="true"><span data-slate-string="true">这种方式和 Multi-Master 比起来，将可写的节点数减少为了一个，而允许有多个只读的节点（图中只画了一个，但实际可以有多个），这种方式比较适用互联网较常见的业务，即读远大于写的场景，而且读的可扩展性（Scalability）较强（即增加一个 Slave 节点的代价较小），而且不存在 Multi-Master 的事务冲突问题。</span></span></span>
 </div>
 <div class="se-aa10c240 " data-slate-type="paragraph" data-slate-object="block" data-key="1350">
  <span data-slate-object="text" data-key="1351"><span data-slate-leaf="true" data-offset-key="1351:0" data-first-offset="true"><span data-slate-string="true">当然了，</span></span></span><span data-slate-object="text" data-key="1352"><span data-slate-leaf="true" data-offset-key="1352:0" data-first-offset="true"><span class="se-a136429c" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Master-Slave 的缺点也很明显</span></span></span></span><span data-slate-object="text" data-key="1353"><span data-slate-leaf="true" data-offset-key="1353:0" data-first-offset="true"><span data-slate-string="true">。既然</span></span></span><span data-slate-object="text" data-key="1354"><span data-slate-leaf="true" data-offset-key="1354:0" data-first-offset="true"><span class="se-bfcea6d3" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">只有一个可写的节点</span></span></span></span><span data-slate-object="text" data-key="1355"><span data-slate-leaf="true" data-offset-key="1355:0" data-first-offset="true"><span data-slate-string="true">，那么写的可扩展性就很差了；而且和 Multi-Master 一样，数据从 Master 到 Slave 的拷贝是异步进行的，因此数据存在丢失的可能。</span></span></span>
 </div>
 <div class="se-f49fe67d " data-slate-type="paragraph" data-slate-object="block" data-key="1356">
  <span data-slate-object="text" data-key="1357"><span data-slate-leaf="true" data-offset-key="1357:0" data-first-offset="true"><span data-slate-string="true">和 Multi-Master 一样，我们当然也可以让数据拷贝变成同步进行的，但是这又存在着上文讨论过的同样的缺陷。但是，有一种介于全同步和全异步之间的缓解这个问题的方法，即“最小副本数量”，比如可能存在 5 个 Slave 节点，但是从 Master 到 Slave 的数据拷贝一旦在 2 个节点成功了，就不用等另外 3 个返回，直接返回用户操作成功。即便那 3 个中存在失败，系统也可以标记失败节点，并按照既定策略自动处理掉，而不影响用户感知。</span></span></span>
 </div>
 <div class="se-e0991e39 " data-slate-type="paragraph" data-slate-object="block" data-key="1358">
  <span data-slate-object="text" data-key="1359"><span data-slate-leaf="true" data-offset-key="1359:0" data-first-offset="true"><span data-slate-string="true">因此，</span></span></span><span data-slate-object="text" data-key="1360"><span data-slate-leaf="true" data-offset-key="1360:0" data-first-offset="true"><span class="se-34e656a0" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">我们可以说这种数据拷贝的方法是“部分同步”“部分异步”的，既降低了数据丢失的可能，又避免了因为某个 Slave 问题而导致 Master“死等”的情况发生。</span></span></span></span>
 </div>
 <div class="se-f5b04869 " data-slate-type="paragraph" data-slate-object="block" data-key="1361">
  <span data-slate-object="text" data-key="1362"><span data-slate-leaf="true" data-offset-key="1362:0" data-first-offset="true"><span data-slate-string="true">最后，值得注意的是，写现在变成单点的了，为了避免单点故障引起的服务中断，一种方式是在 Master 挂掉的时候，Slave 可以挺身而出，变为 Master 顶上去提供写的服务。但是这件事情说说容易，实际要让它自动发生却有大量的工作要做，比如，谁顶上去，以及顶上去了之后，原来以为挂掉的 Master 又活过来了怎么办，等等。</span></span></span>
 </div>
 <h3 class="se-a724e84a" data-slate-type="heading" data-slate-object="block" data-key="1363"><span data-slate-object="text" data-key="1364"><span data-slate-leaf="true" data-offset-key="1364:0" data-first-offset="true"><span data-slate-string="true">4. 其它</span></span></span></h3>
 <div class="se-92365620 " data-slate-type="paragraph" data-slate-object="block" data-key="1365">
  <span data-slate-object="text" data-key="1366"><span data-slate-leaf="true" data-offset-key="1366:0" data-first-offset="true"><span data-slate-string="true">还有其它更为复杂的方法，一种是 2PC 或 3PC，即两阶段提交或三阶段提交，甚至采用高容错的分布式的共识算法 Paxos。这些方法能够保证强一致性，但是在实现上都要复杂许多，我在今天的扩展阅读中会介绍它们。</span></span></span>
 </div>
 <div class="se-3495ee20 " data-slate-type="paragraph" data-slate-object="block" data-key="1367">
  <span data-slate-object="text" data-key="1368"><span data-slate-leaf="true" data-offset-key="1368:0" data-first-offset="true"><span data-slate-string="true">下面这张比较的表格来自 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1369" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1370"><span data-slate-leaf="true" data-offset-key="1370:0" data-first-offset="true"><span data-slate-string="true">Transactions Across Datacenters</span></span></span></a><span data-slate-object="text" data-key="1371"><span data-slate-leaf="true" data-offset-key="1371:0" data-first-offset="true"><span data-slate-string="true"> 这个著名的演讲，这张图在互联网上流传很广。</span></span></span>
 </div>
 <div class="se-243783b6" data-slate-type="image" data-slate-object="block" data-key="1372">
  <img class="se-f2caf4f8" src="https://static001.geekbang.org/resource/image/31/c2/31ba31142c4854ae042ad29e627ee7c2.jpg">
 </div>
 <div class="se-829eef9b " data-slate-type="paragraph" data-slate-object="block" data-key="1373">
  <span data-slate-object="text" data-key="1374"><span data-slate-leaf="true" data-offset-key="1374:0" data-first-offset="true"><span data-slate-string="true">简单说明一下，从上到下每行的含义依次为：一致性、事务支持、延迟、吞吐量、数据丢失和故障转移（指的是节点出现故障以后，其它节点可以自动顶替上来的能力）。</span></span></span>
 </div>
 <div class="se-d05504e3 " data-slate-type="paragraph" data-slate-object="block" data-key="1375">
  <span data-slate-object="text" data-key="1376"><span data-slate-leaf="true" data-offset-key="1376:0" data-first-offset="true"><span data-slate-string="true">从中我们可以看到，没有一列能够做到全绿色，这正如我们所知道的那样，软件工程上的问题都“没有银弹”。特别是，Backups、M/S 和 MM 得益于异步的副本拷贝，能够做到低延迟，这就无法做到强一致性；而 2PC 和 Paxos 通过同步操作可以做到强一致性，却带来了高延迟。</span></span></span>
 </div>
 <h2 class="se-51267e48" data-slate-type="heading" data-slate-object="block" data-key="1377"><span data-slate-object="text" data-key="1378"><span data-slate-leaf="true" data-offset-key="1378:0" data-first-offset="true"><span data-slate-string="true">总结思考</span></span></span></h2>
 <div class="se-7a9b18c1 " data-slate-type="paragraph" data-slate-object="block" data-key="1379">
  <span data-slate-object="text" data-key="1380"><span data-slate-leaf="true" data-offset-key="1380:0" data-first-offset="true"><span data-slate-string="true">今天我们学习和理解了数据持久化中一致性的相关概念和实现技术，希望通过今天的学习，你能做到“知其然，知其所以然”。</span></span></span>
 </div>
 <div class="se-77ba4c3e " data-slate-type="paragraph" data-slate-object="block" data-key="1381">
  <span data-slate-object="text" data-key="1382"><span data-slate-leaf="true" data-offset-key="1382:0" data-first-offset="true"><span data-slate-string="true">现在，我来提一个问题，检验一下你的学习成果。请将下列存储系统按照“强一致性”“弱一致性”和“最终一致性”进行归类：</span></span></span>
 </div>
 <div class="se-6b401cd8" data-slate-type="list" data-slate-object="block" data-key="1383">
  <div class="se-4e9eca18 se-9590fe21" data-slate-type="list-line" data-slate-object="block" data-key="1384">
   <span data-slate-object="text" data-key="1385"><span data-slate-leaf="true" data-offset-key="1385:0" data-first-offset="true"><span data-slate-string="true">关系数据库</span></span></span>
  </div>
  <div class="se-e6609b83 se-ecb71f35" data-slate-type="list-line" data-slate-object="block" data-key="1386">
   <span data-slate-object="text" data-key="1387"><span data-slate-leaf="true" data-offset-key="1387:0" data-first-offset="true"><span data-slate-string="true">本地文件</span></span></span>
  </div>
  <div class="se-05719620 se-9fafac54" data-slate-type="list-line" data-slate-object="block" data-key="1388">
   <span data-slate-object="text" data-key="1389"><span data-slate-leaf="true" data-offset-key="1389:0" data-first-offset="true"><span data-slate-string="true">浏览器缓存</span></span></span>
  </div>
  <div class="se-79eb9cd8 se-0735b773" data-slate-type="list-line" data-slate-object="block" data-key="1390">
   <span data-slate-object="text" data-key="1391"><span data-slate-leaf="true" data-offset-key="1391:0" data-first-offset="true"><span data-slate-string="true">网盘数据</span></span></span>
  </div>
  <div class="se-cebe8fa1 se-c01f7131" data-slate-type="list-line" data-slate-object="block" data-key="1392">
   <span data-slate-object="text" data-key="1393"><span data-slate-leaf="true" data-offset-key="1393:0" data-first-offset="true"><span data-slate-string="true">CDN 节点上的静态资源</span></span></span>
  </div>
  <div class="se-c475542c se-0a8e8282" data-slate-type="list-line" data-slate-object="block" data-key="1394">
   <span data-slate-object="text" data-key="1395"><span data-slate-leaf="true" data-offset-key="1395:0" data-first-offset="true"><span data-slate-string="true">搜索引擎爬虫爬到的数据</span></span></span>
  </div>
 </div>
 <div class="se-0934fa4a " data-slate-type="paragraph" data-slate-object="block" data-key="1396">
  <span data-slate-object="text" data-key="1397"><span data-slate-leaf="true" data-offset-key="1397:0" data-first-offset="true"><span data-slate-string="true">好，今天的正文内容就到这里。如果你对一致性哈希原理了解不够透彻的话，我强烈推荐你继续学习今天的选修课堂。</span></span></span>
 </div>
 <h2 class="se-6f7bca50" data-slate-type="heading" data-slate-object="block" data-key="1398"><span data-slate-object="text" data-key="1399"><span data-slate-leaf="true" data-offset-key="1399:0" data-first-offset="true"><span data-slate-string="true">选修课堂：一致性哈希</span></span></span></h2>
 <div class="se-b71f65d4 " data-slate-type="paragraph" data-slate-object="block" data-key="1400">
  <span data-slate-object="text" data-key="1401"><span data-slate-leaf="true" data-offset-key="1401:0" data-first-offset="true"><span data-slate-string="true">在今天的选修课堂中，我们来学习一种特殊的哈希算法——一致性哈希（Consistent Hashing）。</span></span></span>
 </div>
 <div class="se-ea554d4b " data-slate-type="paragraph" data-slate-object="block" data-key="1402">
  <span data-slate-object="text" data-key="1403"><span data-slate-leaf="true" data-offset-key="1403:0" data-first-offset="true"><span data-slate-string="true">首先，你可以在脑海里回忆一下，什么是哈希算法。哈希算法，又被称为散列算法，就是通过某种确定的键值函数，将源数据映射成为一个简短的新数据串，这个串叫做哈希值。</span></span></span><span data-slate-object="text" data-key="1404"><span data-slate-leaf="true" data-offset-key="1404:0" data-first-offset="true"><span class="se-15a396da" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果两个源数据的 hash 值不同，那么它们一定不相同；如果两个源数据的 hash 值相同，那么这两个源数据可能相同，也可能不相同。</span></span></span></span>
 </div>
 <div class="se-36e76263 " data-slate-type="paragraph" data-slate-object="block" data-key="1405">
  <span data-slate-object="text" data-key="1406"><span data-slate-leaf="true" data-offset-key="1406:0" data-first-offset="true"><span data-slate-string="true">我们在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1407" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1408"><span data-slate-leaf="true" data-offset-key="1408:0" data-first-offset="true"><span data-slate-string="true">[第 02 讲]</span></span></span></a><span data-slate-object="text" data-key="1409"><span data-slate-leaf="true" data-offset-key="1409:0" data-first-offset="true"><span data-slate-string="true"> 中谈到的数字签名，就是通过一个哈希算法，得到证书的哈希值，也就是它的“指纹”，是经过加密以后得到的。哈希是很常用的算法和技术，在后面的全栈内容中我们还会遇到。</span></span></span>
 </div>
 <div class="se-56ab5678 " data-slate-type="paragraph" data-slate-object="block" data-key="1410">
  <span data-slate-object="text" data-key="1411"><span data-slate-leaf="true" data-offset-key="1411:0" data-first-offset="true"><span data-slate-string="true">我们有时候会使用一个特殊的哈希算法，来将每项数据都映射到某一个“位置”，从而将大量的数据分散存储到不同的位置中。哈希算法在数据量大，且单个节点（单台机器）无法处理的时候尤为有用。比如说，我们要将从 0 到 9999 这 10000 个连续自然数分散到 5 个数据存储的节点上，那我就可以设计一个基于取余数的哈希算法，做到均匀分布：</span></span></span>
 </div>
 <div class="se-4178fa03 se-34e422ee" data-slate-type="pre" data-slate-object="block" data-key="1412">
  <div class="se-4a6bde3b se-d3b747f0">
   <span></span>
  </div>
  <div class="se-f12e84f3">
   <div class="se-43133065 se-a982e19b" data-code-line-number="1"></div>
  </div>
  <div class="se-1faa2e56 ps">
   <div class="se-7a1105a5 se-fe18eba5" data-slate-type="code-line" data-slate-object="block" data-key="1413">
    <span data-slate-object="text" data-key="1414"><span data-slate-leaf="true" data-offset-key="1414:0" data-first-offset="true"><span data-slate-string="true">f(x) = x % 5</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-50a49f32 " data-slate-type="paragraph" data-slate-object="block" data-key="1415">
  <span data-slate-object="text" data-key="1416"><span data-slate-leaf="true" data-offset-key="1416:0" data-first-offset="true"><span data-slate-string="true">我们可以看到，这个函数的结果，也就是哈希值，只有 0、1、2、3、4 这 5 个，对应这 5 个节点，那么我可以根据其结果把这个 x 放到相应的节点上去。这样，每个节点就只需要存储 2000 个数。</span></span></span>
 </div>
 <div class="se-951a5fda " data-slate-type="paragraph" data-slate-object="block" data-key="1417">
  <span data-slate-object="text" data-key="1418"><span data-slate-leaf="true" data-offset-key="1418:0" data-first-offset="true"><span data-slate-string="true">好，这看起来是个挺好的解决办法，但是现在问题来了，由于业务的扩张，我们现在需要处理从 0 到 11999 这 12000 个数了，也就是说，多了 2000 个数。可是，节点承载的数据量已经基本到达了极限，没法再加入那么多数据了。</span></span></span>
 </div>
 <div class="se-394dfb90 " data-slate-type="paragraph" data-slate-object="block" data-key="1419">
  <span data-slate-object="text" data-key="1420"><span data-slate-leaf="true" data-offset-key="1420:0" data-first-offset="true"><span data-slate-string="true">没问题，我们加机器吧，现在有 6 个节点了，我们就得修改这个算法：</span></span></span>
 </div>
 <div class="se-215a545c se-fdc82bcb" data-slate-type="pre" data-slate-object="block" data-key="1421">
  <div class="se-b283ed93 se-ca044d93">
   <span></span>
  </div>
  <div class="se-a6fddf0a">
   <div class="se-31c68534 se-1efdcbfc" data-code-line-number="1"></div>
  </div>
  <div class="se-6aaebcff ps">
   <div class="se-7a1105a5 se-fe18eba5" data-slate-type="code-line" data-slate-object="block" data-key="1422">
    <span data-slate-object="text" data-key="1423"><span data-slate-leaf="true" data-offset-key="1423:0" data-first-offset="true"><span data-slate-string="true">f(x) = x % 6</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-ac2b823e " data-slate-type="paragraph" data-slate-object="block" data-key="1424">
  <span data-slate-object="text" data-key="1425"><span data-slate-leaf="true" data-offset-key="1425:0" data-first-offset="true"><span data-slate-string="true">嗯，这样数据还是能均匀分布。</span></span></span>
 </div>
 <div class="se-36a13c67 " data-slate-type="paragraph" data-slate-object="block" data-key="1426">
  <span data-slate-object="text" data-key="1427"><span data-slate-leaf="true" data-offset-key="1427:0" data-first-offset="true"><span data-slate-string="true">原理上没错，可是这又带来了一个问题，就是这些已经在节点上的数据，必须要调整位置了，毕竟算法变了嘛，因此这些数所在的节点可能要改变，这个过程叫做 </span></span></span><span data-slate-object="text" data-key="1428"><span data-slate-leaf="true" data-offset-key="1428:0" data-first-offset="true"><span class="se-1eddec9d" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Rehashing</span></span></span></span><span data-slate-object="text" data-key="1429"><span data-slate-leaf="true" data-offset-key="1429:0" data-first-offset="true"><span data-slate-string="true">。这一调整，就傻眼了，只有同为 5 和 6 的倍数的数（即只有为 30 倍数的数），不用调整位置，其它全部都要调整。也就是说，就因为加了这一台机器，29/30 = 96.7% 的数据全部都要调整位置！</span></span></span>
 </div>
 <div class="se-f5f4d34c " data-slate-type="paragraph" data-slate-object="block" data-key="1430">
  <span data-slate-object="text" data-key="1431"><span data-slate-leaf="true" data-offset-key="1431:0" data-first-offset="true"><span data-slate-string="true">这个代价显然是接受不了的，那有没有办法可以优化它呢？</span></span></span>
 </div>
 <div class="se-a9b63c36 " data-slate-type="paragraph" data-slate-object="block" data-key="1432">
  <span data-slate-object="text" data-key="1433"><span data-slate-leaf="true" data-offset-key="1433:0" data-first-offset="true"><span data-slate-string="true">当然！</span></span></span><span data-slate-object="text" data-key="1434"><span data-slate-leaf="true" data-offset-key="1434:0" data-first-offset="true"><span class="se-a16a7b7e" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">一致性哈希，就是一种尽可能减少 Rehashing 过程中进行数据迁移的算法。</span></span></span></span><span data-slate-object="text" data-key="1435"><span data-slate-leaf="true" data-offset-key="1435:0" data-first-offset="true"><span data-slate-string="true">且看下面这张图：</span></span></span>
 </div>
 <div class="se-18afc8cd" data-slate-type="image" data-slate-object="block" data-key="1436">
  <img class="se-84e7f2a0" src="https://static001.geekbang.org/resource/image/dd/39/dd1f0fd322a16176c72395b79422cf39.jpg">
 </div>
 <div class="se-2a24f3ce " data-slate-type="paragraph" data-slate-object="block" data-key="1437">
  <span data-slate-object="text" data-key="1438"><span data-slate-leaf="true" data-offset-key="1438:0" data-first-offset="true"><span data-slate-string="true">请你</span></span></span><span data-slate-object="text" data-key="1439"><span data-slate-leaf="true" data-offset-key="1439:0" data-first-offset="true"><span class="se-5327c6f1" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">把上面的圆盘想象成一个时钟</span></span></span></span><span data-slate-object="text" data-key="1440"><span data-slate-leaf="true" data-offset-key="1440:0" data-first-offset="true"><span data-slate-string="true">，总共有 12 格（0 点到 12 点），假如说我们通过上面类似的哈希算法，把数据映射到时钟的每个格子上。因为是时钟，我们这次取 12 的余数：</span></span></span>
 </div>
 <div class="se-d6c9514b se-a8f81f75" data-slate-type="pre" data-slate-object="block" data-key="1441">
  <div class="se-416502f4 se-6805988c">
   <span></span>
  </div>
  <div class="se-ddf483cc">
   <div class="se-51fa73c7 se-64247e85" data-code-line-number="1"></div>
  </div>
  <div class="se-191633f5 ps">
   <div class="se-7a1105a5 se-fe18eba5" data-slate-type="code-line" data-slate-object="block" data-key="1442">
    <span data-slate-object="text" data-key="1443"><span data-slate-leaf="true" data-offset-key="1443:0" data-first-offset="true"><span data-slate-string="true">f(x) = x % 12</span></span></span>
   </div>
   <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
    <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
   </div>
   <div class="ps__rail-y" style="top: 0px; right: 0px;">
    <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div>
   </div>
  </div>
 </div>
 <div class="se-13e65dbf " data-slate-type="paragraph" data-slate-object="block" data-key="1444">
  <span data-slate-object="text" data-key="1445"><span data-slate-leaf="true" data-offset-key="1445:0" data-first-offset="true"><span data-slate-string="true">同时，系统中总共有三台服务器，那么每台服务器就可以负责管理其中的“4 个小时”的数据。比如哈希值是 1~4 的数据（范围 B）存储在右下角的节点，5~8 的数据（范围 C）存储在左下角的节点，而 9~12 的数据（范围 A）存储到正上方的节点。</span></span></span>
 </div>
 <div class="se-7f8d2b85 " data-slate-type="paragraph" data-slate-object="block" data-key="1446">
  <span data-slate-object="text" data-key="1447"><span data-slate-leaf="true" data-offset-key="1447:0" data-first-offset="true"><span data-slate-string="true">用这种方式来打散数据看起来似乎没有什么特别的对不对，别急，当我们添加新硬件，有一个新节点加入的时候，情况就不同了，请看下图：</span></span></span>
 </div>
 <div class="se-1ed47c44" data-slate-type="image" data-slate-object="block" data-key="1448">
  <img class="se-329926d5" src="https://static001.geekbang.org/resource/image/55/50/550fd7dc68feb27eb729d9b915d3da50.jpg">
 </div>
 <div class="se-5e8c4e6a " data-slate-type="paragraph" data-slate-object="block" data-key="1449">
  <span data-slate-object="text" data-key="1450"><span data-slate-leaf="true" data-offset-key="1450:0" data-first-offset="true"><span data-slate-string="true">在这种情况下，正下方有一台机器被加入，原本 5~8 点的数据被分成两部分，7~8 点的数据（C2）依然存储在左下角的原节点，而 5~6 点的数据（C1）则需要迁移到新的，也就是正下方的节点上。</span></span></span>
 </div>
 <div class="se-e028be15 " data-slate-type="paragraph" data-slate-object="block" data-key="1451">
  <span data-slate-object="text" data-key="1452"><span data-slate-leaf="true" data-offset-key="1452:0" data-first-offset="true"><span data-slate-string="true">你看，这种情况下，添加一个节点，只需要移动其中的一部分数据，也就是 2/12 = 1/6 的数据就行，是不是对整个系统影响就小了很多？</span></span></span>
 </div>
 <div class="se-0562dbac " data-slate-type="paragraph" data-slate-object="block" data-key="1453">
  <span data-slate-object="text" data-key="1454"><span data-slate-leaf="true" data-offset-key="1454:0" data-first-offset="true"><span data-slate-string="true">等等！你可能会说，这样添加了一台服务器，如果原始数据哈希计算后的分布是均匀的，</span></span></span><span data-slate-object="text" data-key="1455"><span data-slate-leaf="true" data-offset-key="1455:0" data-first-offset="true"><span class="se-885045bf" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">经过 了添加机器的操作，节点上承载数据分布却是不均匀的</span></span></span></span><span data-slate-object="text" data-key="1456"><span data-slate-leaf="true" data-offset-key="1456:0" data-first-offset="true"><span data-slate-string="true">——正上方、右下角的服务器分别承载了总共 1/3 的数据，而左下角、正下方的服务器却各自只需要承载 1/6 的数据。</span></span></span>
 </div>
 <div class="se-a5e9e9c4 " data-slate-type="paragraph" data-slate-object="block" data-key="1457">
  <span data-slate-object="text" data-key="1458"><span data-slate-leaf="true" data-offset-key="1458:0" data-first-offset="true"><span data-slate-string="true">那么，这个问题，怎么解决？如果你能想到这个问题，那非常好。</span></span></span>
 </div>
 <div class="se-9930e26b " data-slate-type="paragraph" data-slate-object="block" data-key="1459">
  <span data-slate-object="text" data-key="1460"><span data-slate-leaf="true" data-offset-key="1460:0" data-first-offset="true"><span data-slate-string="true">解决方法就是引入“</span></span></span><span data-slate-object="text" data-key="1461"><span data-slate-leaf="true" data-offset-key="1461:0" data-first-offset="true"><span class="se-73f891eb" data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">虚拟节点</span></span></span></span><span data-slate-object="text" data-key="1462"><span data-slate-leaf="true" data-offset-key="1462:0" data-first-offset="true"><span data-slate-string="true">”，我们根据时钟的 12 个数字，把它均匀分成 12 个区域，分别由 12 个虚拟节点负责，并且顺时针按照 Ax-Bx-Cx 这样命名。这样，在添加机器以前，每台机器需要负责 4 块数据（例如某台机器 A 需要承载 A1、A2、A3 和 A4 的数据），并且它们均匀地散布在圆环上：</span></span></span>
 </div>
 <div class="se-0e56c1af" data-slate-type="image" data-slate-object="block" data-key="1463">
  <img class="se-227aa300" src="https://static001.geekbang.org/resource/image/75/b0/75a9aa4ba97bae18fbff18698601ceb0.jpg">
 </div>
 <div class="se-48d4fc10 " data-slate-type="paragraph" data-slate-object="block" data-key="1464">
  <span data-slate-object="text" data-key="1465"><span data-slate-leaf="true" data-offset-key="1465:0" data-first-offset="true"><span data-slate-string="true">好，现在添加新机器，我们只需要把 A1、B2、C3 这三个虚拟节点的数据，搬迁到新机器 D 上：</span></span></span>
 </div>
 <div class="se-6b174060" data-slate-type="image" data-slate-object="block" data-key="1466">
  <img class="se-859b7210" src="https://static001.geekbang.org/resource/image/a0/6c/a0d26ef488f14ed18e6056960ab7d46c.jpg">
 </div>
 <div class="se-f0124a47 " data-slate-type="paragraph" data-slate-object="block" data-key="1467">
  <span data-slate-object="text" data-key="1468"><span data-slate-leaf="true" data-offset-key="1468:0" data-first-offset="true"><span data-slate-string="true">你看，同样搬迁了最少量的数据，且元盘上的数据还是均匀分布的，只是从均匀分布在 3 台机器，变成了均匀分布到 4 台机器上。当然，作为示意，我这里是把圆环分成了 12 份，实际可以分成更多的 2^n 份。</span></span></span>
 </div>
 <h2 class="se-83c4436e" data-slate-type="heading" data-slate-object="block" data-key="1469"><span data-slate-object="text" data-key="1470"><span data-slate-leaf="true" data-offset-key="1470:0" data-first-offset="true"><span data-slate-string="true">扩展阅读</span></span></span></h2>
 <div class="se-db7abec6" data-slate-type="list" data-slate-object="block" data-key="1471">
  <div class="se-8bc339cd se-cecc77d6" data-slate-type="list-line" data-slate-object="block" data-key="1472">
   <span data-slate-object="text" data-key="1473"><span data-slate-leaf="true" data-offset-key="1473:0" data-first-offset="true"><span data-slate-string="true">关于 2PC 和 3PC，如果你感兴趣的话，可以阅读维基百科的词条，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1474" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1475"><span data-slate-leaf="true" data-offset-key="1475:0" data-first-offset="true"><span data-slate-string="true">2PC</span></span></span></a><span data-slate-object="text" data-key="1476"><span data-slate-leaf="true" data-offset-key="1476:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1477" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1478"><span data-slate-leaf="true" data-offset-key="1478:0" data-first-offset="true"><span data-slate-string="true">3PC</span></span></span></a><span data-slate-object="text" data-key="1479"><span data-slate-leaf="true" data-offset-key="1479:0" data-first-offset="true"><span data-slate-string="true">，或者是直接阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1480" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1481"><span data-slate-leaf="true" data-offset-key="1481:0" data-first-offset="true"><span data-slate-string="true">The Two-Phase Commit Protocol</span></span></span></a><span data-slate-object="text" data-key="1482"><span data-slate-leaf="true" data-offset-key="1482:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1483" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1484"><span data-slate-leaf="true" data-offset-key="1484:0" data-first-offset="true"><span data-slate-string="true">Three-Phase Commit Protocol</span></span></span></a><span data-slate-object="text" data-key="1485"><span data-slate-leaf="true" data-offset-key="1485:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span>
  </div>
  <div class="se-ba7bb619 se-bb69bd82" data-slate-type="list-line" data-slate-object="block" data-key="1486">
   <span data-slate-object="text" data-key="1487"><span data-slate-leaf="true" data-offset-key="1487:0" data-first-offset="true"><span data-slate-string="true">关于 Paxos，算法本身比较难，如果你很感兴趣，我找了一些中文材料，我觉得 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1488" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1489"><span data-slate-leaf="true" data-offset-key="1489:0" data-first-offset="true"><span data-slate-string="true">Paxos 算法详解</span></span></span></a><span data-slate-object="text" data-key="1490"><span data-slate-leaf="true" data-offset-key="1490:0" data-first-offset="true"><span data-slate-string="true">这篇是相对讲得比较清楚的。</span></span></span>
  </div>
  <div class="se-d1df168e se-2b33f761" data-slate-type="list-line" data-slate-object="block" data-key="1491">
   <span data-slate-object="text" data-key="1492"><span data-slate-leaf="true" data-offset-key="1492:0" data-first-offset="true"><span data-slate-string="true">文中那个表格最早是来自于 Google I/O 2009 的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1493" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1494"><span data-slate-leaf="true" data-offset-key="1494:0" data-first-offset="true"><span data-slate-string="true">Transactions Across Datacenters</span></span></span></a><span data-slate-object="text" data-key="1495"><span data-slate-leaf="true" data-offset-key="1495:0" data-first-offset="true"><span data-slate-string="true"> 这个分享，后来有人</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1496" class="se-654b04e9 se-f2d6d068"><span data-slate-object="text" data-key="1497"><span data-slate-leaf="true" data-offset-key="1497:0" data-first-offset="true"><span data-slate-string="true">上传到了 Bilibili 上</span></span></span></a><span data-slate-object="text" data-key="1498"><span data-slate-leaf="true" data-offset-key="1498:0" data-first-offset="true"><span data-slate-string="true">，我推荐你听一下这个分享。</span></span></span>
  </div>
 </div>
 <div class="se-7a360a05" data-slate-type="image" data-slate-object="block" data-key="1499">
  <img class="se-d9ee1813" src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg">
 </div>
</div> |             |book   |0     |full_html   |zh-hans  |24          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:48:15.346 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=24 
 {executed in 2 msec}
