2020-11-19 17:51:14.358 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779474, created=1605779474, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='19丨打开潘多拉盒子：JavaScript异步编程', 
uid=1, vid=29 where nid=29 
 {executed in 0 msec}
2020-11-19 17:51:14.366 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.367 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|29        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/53bfca0d3baee50b0ba712863e3c693a?bkt=en-d3a65691252603d31d1a169bc22165b52914eb5f43adf46e8a79937ef59b643e25b980353f86e167&fid=3757516097-778750-337304310443835&time=1605755870&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-wg1WUgPeVr2KZYA6eNIAlF95abg%3D&to=92&size=17230281&sta_dx=17230281&sta_cs=3481&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572250751&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=17230281&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-cce54a4b6e00d83cf075f8b73f2fe9f10ad7c2b31bb929dd8912da7a896e54044f61f7e4df052d1e&sl=76480590&expires=8h&rt=pr&r=373099427&mlogid=7502199375178637011&vbdid=2247232042&fin=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a&bflag=92,34-92&rtype=1&dp-logid=7502199375178637011&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=26fa64dbec28822466a6f1e24c58fb5b8b23d8dbb98cc945305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a |29          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:51:14.371 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/53bfca0d3baee50b0ba712863e3c693a?bkt=en-d3a65691252603d31d1a169bc22165b52914eb5f43adf46e8a79937ef59b643e25b980353f86e167&fid=3757516097-778750-1049987594684857&time=1605779472&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2FP8cpJSPXOH%2BA11UN%2FPhaC6G5eo%3D&to=92&size=17230281&sta_dx=17230281&sta_cs=3486&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572250751&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=17230281&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-cce54a4b6e00d83cf075f8b73f2fe9f10ad7c2b31bb929dd8912da7a896e54044f61f7e4df052d1e&sl=76480590&expires=8h&rt=pr&r=136364147&mlogid=7508534808684554847&vbdid=2247232042&fin=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a&bflag=92,34-92&rtype=1&dp-logid=7508534808684554847&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=16c8192e22ea32f52e7376ae9fe5efdd22d5f7de78dbdd6c&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a', 
revision_id=29 where entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.375 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.376 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/53bfca0d3baee50b0ba712863e3c693a?bkt=en-d3a65691252603d31d1a169bc22165b52914eb5f43adf46e8a79937ef59b643e25b980353f86e167&fid=3757516097-778750-337304310443835&time=1605755870&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-wg1WUgPeVr2KZYA6eNIAlF95abg%3D&to=92&size=17230281&sta_dx=17230281&sta_cs=3481&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572250751&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=17230281&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-cce54a4b6e00d83cf075f8b73f2fe9f10ad7c2b31bb929dd8912da7a896e54044f61f7e4df052d1e&sl=76480590&expires=8h&rt=pr&r=373099427&mlogid=7502199375178637011&vbdid=2247232042&fin=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a&bflag=92,34-92&rtype=1&dp-logid=7502199375178637011&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=26fa64dbec28822466a6f1e24c58fb5b8b23d8dbb98cc945305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a |29          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:51:14.380 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/53bfca0d3baee50b0ba712863e3c693a?bkt=en-d3a65691252603d31d1a169bc22165b52914eb5f43adf46e8a79937ef59b643e25b980353f86e167&fid=3757516097-778750-1049987594684857&time=1605779472&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2FP8cpJSPXOH%2BA11UN%2FPhaC6G5eo%3D&to=92&size=17230281&sta_dx=17230281&sta_cs=3486&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1572250751&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=17230281&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-cce54a4b6e00d83cf075f8b73f2fe9f10ad7c2b31bb929dd8912da7a896e54044f61f7e4df052d1e&sl=76480590&expires=8h&rt=pr&r=136364147&mlogid=7508534808684554847&vbdid=2247232042&fin=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a&bflag=92,34-92&rtype=1&dp-logid=7508534808684554847&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=16c8192e22ea32f52e7376ae9fe5efdd22d5f7de78dbdd6c&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=19%E4%B8%A8%E6%89%93%E5%BC%80%E6%BD%98%E5%A4%9A%E6%8B%89%E7%9B%92%E5%AD%90%EF%BC%9AJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.m4a', 
revision_id=29 where entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.384 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=29 
 {executed in 1 msec}
2020-11-19 17:51:14.385 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |delta |field_comment_format |langcode |revision_id |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|29        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/d8/6f/22e5ec55.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>零维</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-28
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，如何使用 promise 和 generator 模拟出 await 的返回值呢？
    <br>如果用 async/awiat:
    <br>&nbsp;const res = await ajax(); 
    <br>变成 yield 是:
    <br>&nbsp;&nbsp;const res = yield ajaxWrap();
    <br>
    <br>res 是怎么用 ajaxWrap 里面出来的呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-25
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    这个promise“异步”变“同步”，就是让异步代码看起来像同步一样，刚看第一遍没看明白，还有就是箭头函数，箭头多了，我就不能第一时间看明白，看来还是用得少。
   </div> <!----> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 用得少是一个方面，本来 JavaScript 如果书写的时候不注意结构和组织的话，确实容易写出难懂的代码</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-23
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，JavaScript和Python确实太像了，尤其是异步函数、生成器以及协程的部分。
    <br>
    <br>那么，对于小规模的团队，JavaScript+Python或者JavaScript+node.js的组合是不是比JavaScript+java在开发速度上更有优势呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 这个问题不太好回答，我也没有足够的统计数据。据我个人的经历，Python 开发效率确实是要比 Java 高出不少</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |29          |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:51:14.390 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=29 
 {executed in 1 msec}
2020-11-19 17:51:14.391 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |delta |field_comment_format |langcode |revision_id |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/d8/6f/22e5ec55.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>零维</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-28
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，如何使用 promise 和 generator 模拟出 await 的返回值呢？
    <br>如果用 async/awiat:
    <br>&nbsp;const res = await ajax(); 
    <br>变成 yield 是:
    <br>&nbsp;&nbsp;const res = yield ajaxWrap();
    <br>
    <br>res 是怎么用 ajaxWrap 里面出来的呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-25
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    这个promise“异步”变“同步”，就是让异步代码看起来像同步一样，刚看第一遍没看明白，还有就是箭头函数，箭头多了，我就不能第一时间看明白，看来还是用得少。
   </div> <!----> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 用得少是一个方面，本来 JavaScript 如果书写的时候不注意结构和组织的话，确实容易写出难懂的代码</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-23
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，JavaScript和Python确实太像了，尤其是异步函数、生成器以及协程的部分。
    <br>
    <br>那么，对于小规模的团队，JavaScript+Python或者JavaScript+node.js的组合是不是比JavaScript+java在开发速度上更有优势呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 这个问题不太好回答，我也没有足够的统计数据。据我个人的经历，Python 开发效率确实是要比 Java 高出不少</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |29          |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:51:14.396 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.397 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|29        |book   |0     |zh-hans  |29          |https://static001.geekbang.org/resource/image/c7/b3/c7d0336787d0611f36eaee775a22d7b3.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:51:14.401 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.402 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |29          |https://static001.geekbang.org/resource/image/c7/b3/c7d0336787d0611f36eaee775a22d7b3.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:51:14.406 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=29 
 {executed in 0 msec}
2020-11-19 17:51:14.407 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |29          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:51:14.412 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=29 
 {executed in 1 msec}
2020-11-19 17:51:14.412 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |29          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:51:14.417 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='708978153660401' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:51:14.417 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:51:50.966 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='708978153660401' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:51:50.967 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:51:50.971 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('708978153660401', 1, 'net_content') 
 {executed in 1 msec}
2020-11-19 17:51:50.972 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('708978153660401', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:51:50.974 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|49            |
|--------------|

2020-11-19 17:51:51.000 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='708978153660401' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:51:51.000 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:51:51.420 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='708978153660401' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:51:51.421 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:51:51.422 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('708978153660401', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:51:51.423 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('708978153660401', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:51:51.423 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|50            |
|--------------|

2020-11-19 17:51:51.439 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='708978153660401' 
 {executed in 0 msec}
2020-11-19 17:51:51.440 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|30        |book   |0     |708978153660401  |zh-hans  |30          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:51:51.441 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=30 
 {executed in 1 msec}
2020-11-19 17:51:51.441 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|30  |zh-hans  |book |db13164a-56ee-4e5c-93fa-9919f6fe989c |30  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:51:51.447 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.447 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |708978153660401  |zh-hans  |30          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:51:51.452 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=30 
 {executed in 0 msec}
2020-11-19 17:51:51.452 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|30  |1   |3     |0            |1  |27 |30 |0  |0  |27  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:51:51.458 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=30 
 {executed in 1 msec}
2020-11-19 17:51:51.470 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|30        |<p>你好，我是四火。</p>
<p>随着大数据和数据分析趋势的流行，数据可视化变得越来越重要，而许多全栈的学习材料并没有跟上节奏，去介绍这方面的技术。这一讲中，我们将介绍数据可视化的基本概念和原理，以及几个常用的 JavaScript 用来实现数据可视化的库。</p>
<p>数据可视化，即 Data Visualization，是指使用具备视觉表现力的图形和表格等工具，向用户传达数据信息的方式。在我工作过的每个大型团队中，数据可视化技术都有着其不可替代的用武之地。</p>
<p>在大数据分析团队，数据库可视化技术被用来分析数据变化，验证机器学习算法的效果；在高可用服务团队，数据可视化技术被用来了解和监视服务的运行状况，了解系统的压力和负载；在分布式平台团队，数据可视化技术用来俯瞰一个个异步任务的执行情况，以获知任务执行的健康状况……事实上，只要有工程的地方，数据可视化就扮演着举足轻重的角色。</p>
<h2>Web 绘图标准</h2>
<p>在前端绘图，是数据可视化里面很常见的一个需求，我们常见的有位图和矢量图这样两种。</p>
<p>通常我们谈论的图片，绝大多数都是位图。位图又叫栅格图像，<strong>无论位图采用何种压缩算法，它本质就是点阵</strong>，它对于图像本身更具备普适性，无论图像的形状如何，都可以很容易分解为一个二维的点阵，更大的图，或者更高的分辨率，只是需要更密集的点阵而已。</p><!-- [[[read_end]]] -->
<p>你可能已经听说过矢量图。<strong>矢量图是使用点、线段或者多边形等基于数学方程的几何形状来表示的图像</strong>。将一个复杂图像使用矢量的方式来表达，显然要比位图困难得多，但是矢量图可以无损放大，因为它的本质是一组基于数学方程的几何形状的集合，因此无论放大多少倍，形状都不会发生失真或扭曲。并且图像越大，就越能比相应的位图节约空间，因为矢量图的大小和实际图像大小无关。倘若再采用独立的压缩算法进行压缩，矢量图可以基于文本压缩，从而获得很大的压缩比。</p>
<p>在早些年的项目中，在后端使用 Python 等语言预生成绘制图像的场景还比较多，但是如今已经少见一些了，大多数的图形生成都被搬到了前端。而这种情况也成为了前后端分离，以及数据和展示分离的典型场景，后端同步或异步生成不同维度的数据，浏览器则通过统一的 API 根据用户需求获取相应的数据；前端根据这些取得的数据在浏览器中现场绘制图像。关于服务端和客户端聚合的知识，如有遗忘，请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>。</p>
<p>总的来看，前端绘图，和后端比起来，有这样几个显著的优势。</p>
<ul> 
 <li><strong>前端生成的图形图像具有天然的交互性。</strong>前端生成的图像不仅仅意味着一张“图”，还意味着它能够和 HTML 这样的呈现结构紧密地结合起来，而图像上的组成部分都可以响应用户的行为。</li> 
 <li><strong>图像的生成可能需要显著的资源消耗，放到前端可以减轻服务器压力。</strong>这里的消耗既包括 CPU、内存等物理资源消耗，还有用户的等待时间消耗，在前端可以更好地给用户提供渲染过程的反馈。</li> 
 <li><strong>图形图像的设计和规划本就属于呈现层，系统架构上把它放到前端更容易实现前后端分离，组织结构上能让擅长视觉处理的前端工程师和 UX 设计师更自然地工作。</strong>有了数据，就可以对前端的图像生成逻辑进行设计和测试，工程师和设计师只需要专注于前端的通用技能就可以较为独立地完成工作。</li> 
</ul>
<p>我们较常听到的 Web 绘图标准包括 VML、SVG 和 Canvas，其中 VML 是微软最初参与制定的标准，一直以来只有 IE 等少数浏览器支持，从 2012 年的 IE 10 开始它逐渐被废弃了；但是剩余两个，SVG 和 Canvas 有一定互补性，且如今都非常流行，下面我来介绍一下。</p>
<h3>1. SVG</h3>
<p>SVG 即 Scalable Vector Graphics，可缩放矢量图形。它是基于可扩展标记语言（XML），用于描述二维矢量图形的一种图形格式。在它之前，微软曾经向 W3C 交过 VML 的提议，但被拒绝了。之后才有了 SVG，由 W3C 制定，是一个开放标准，当时在 W3C 自己看来，SVG 的竞争对手应该主要是 Flash。</p>
<p>SVG 格式和前面提到的 VML 一样，支持脚本，容易被搜索引擎索引。SVG 可以嵌入外部对象，比如文字、PNG、JPG，也可以嵌入外部的 SVG。它在移动设备上存在两个子版本，分别叫做 SVG Basic 和 SVG Tiny。SVG 很快获得了各种浏览器的支持，一开始 IE 还坚守着自家的 VML 不放，但后来也慢慢被迫转移到了 SVG 的阵营，从 IE 9 才开始对 SVG 部分支持。</p>
<p>SVG 支持三种格式的图形：矢量图形、栅格图像和文本。所以你看，<strong>SVG 并不只是一个矢量图的简单表示规范，而是尝试把矢量图、位图和文字统一起来的标准</strong>。我们来亲自写一个 SVG 的小例子，在你的工作文件夹中建立 example.svg，并用文本编辑器打开，录入如下文字：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;?xml version="1.0" encoding="UTF-8"?&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="300" height="300"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;rect x="60" y="60" width="200" height="200" fill="red" stroke="black" stroke-width="2px" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/svg&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我来对上述 XML 做个简单的解释：第一行了指明 XML 的版本和编码；第二行是一个 svg 的根节点，指明了协议和版本号，图像画布的大小（500 x 500），其中只包含一个矩形（rect），这个矩形的起始位置是（x, y），宽和高都为 200，填充红色，并使用 2px 宽的黑色线条来描边。</p>
<p>接着使用 Chrome 来打开这个文件，你将看到这样的效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/3f/86/3f4e7698378c4cf109730d7c5ee2f086.png" alt=""></p>
<p>接着我们另建立一个 HTML 文件：svg.html，加上 html 标签，并拷贝 XML 中的 svg 标签到这个 HTML 文件中：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="300" height="300"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;rect x="60" y="60" width="200" height="200" fill="red" stroke="black" stroke-width="2px" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/svg&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>用 Chrome 打开看看效果——嗯，再次展示了这个红色方块。反复点击 Chrome 的 View 菜单下的 Zoom In 选项，将图像放到最大，观察矩形的边角，没有任何模糊和失真，这证明了它确实是矢量图。</p>
<p><img src="https://static001.geekbang.org/resource/image/d9/5c/d9b9e454a6379295c47133231096bd5c.png" alt=""></p>
<p>最后打开 Chrome 的开发者工具，在控制台键入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("svg&gt;rect").setAttribute("fill", "green");
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你会看到这个矢量图从红色变成了绿色。这充分说明，svg 就是普普通通的 HTML 标签，它可以响应 JavaScript 的控制。自此，图像对于天天和 HTML 打交道的程序员来说，再也不是一个“二进制黑盒”了。</p>
<h3>2. Canvas</h3>
<p>Canvas 标签是 HTML 5 的标签之一，标签可以定义一片区域，允许 JavaScript 动态渲染图像。开始由苹果推出，自家的 Safari 率先支持，IE 从 IE 9 开始支持。</p>
<p>Canvas 和 SVG 有相当程度的互补之处，我们来实现一个 Canvas 的例子，体会下这一点。请在任何工作文件夹中，建立 canvas.html，并写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;canvas width="300" height="300"&gt;&lt;/canvas&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;script type="text/javascript"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var canvas = document.getElementsByTagName('canvas')[0];
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var ctx = canvas.getContext('2d');
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.rect(60,60,200,200);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.fillStyle = 'RED';
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.fill();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.strokeStyle = 'BLACK';
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.stroke();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/script&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>代码很容易理解，获取到 canvas 节点以后，获取一个 2D 上下文，接着设置好矩形的位置和大小，分别进行填充和描线的操作。接着使用 Chrome 打开，你会发现效果和 SVG 的例子一样，展示了这个具备黑色边框的红色方块。</p>
<p><img src="https://static001.geekbang.org/resource/image/ea/c9/ea7cd35069fdf2216eb490cfa8ef72c9.png" alt=""></p>
<p>看起来和 SVG 差不多对不对？我们也来执行相同的操作，反复点击 Chrome 的 View 菜单下的 Zoom In 选项，将图像放到最大：</p>
<p><img src="https://static001.geekbang.org/resource/image/5b/f6/5bda99bcbf2f4eddbddd5361440185f6.png" alt=""></p>
<p>你看，矩形的边角不再清晰，这说明这种方式绘制的不是矢量图，而是位图。再使用 Chrome 的开发者工具，点击左上角的 DOM 选择箭头，选中这个矩形，我们发现，和 SVG 不同的是，这个 canvas 节点内部并没有任何 DOM 结构。</p>
<p><img src="https://static001.geekbang.org/resource/image/55/c8/5584741d7f3bbab26690d46a0ce2e8c8.jpg" alt=""></p>
<p>虽然这是一个小小的例子，但足以看出 Canvas 和 SVG 之间的明显差异和互补性了。</p>
<p>总的来说，从图片描述过程上来说，SVG 是 HTML 标签原生支持的，因此就可以使用这种<strong>声明式的语言</strong>来描述图片，它更加直观、形象、具体，每一个图形组成的 DOM 都可以很方便地绑定和用户交互的事件。<strong>这种在渲染技术上通过提供一套完整的图像绘制模型来实现的方式叫做 <a href="https://en.wikipedia.org/wiki/Retained_mode">Retained Mode</a>。</strong></p>
<p>Canvas 则是藉由 JavaScript 的<strong>命令式的语言</strong>对既定 API 的调用，来完成图像的绘制，canvas 标签的内部，并没有任何 DOM 结构，这让它无法使用传统的 DOM 对象绑定的方式来和图像内部的元素进行互动，但它更直接、可编程性强，在浏览器内存中不需要为了图形维护一棵巨大的 DOM 树，这也让它在遇到大量的密集对象时，拥有更高的渲染性能。<strong>这种在渲染技术上通过直接调用图形对象的绘制命令接口来实现的方式叫做 <a href="https://en.wikipedia.org/wiki/Immediate_mode_(computer_graphics)">Immediate Mode</a>。</strong></p>
<p>讲到这里，不知道你是否联想到了我们之前反复提到过的，声明式编程和命令式编程在全栈技术中的应用，如果你忘记了，可以回看 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中的介绍。所以，我想再次说，技术都是相通的。</p>
<p><img src="https://static001.geekbang.org/resource/image/41/76/41df55e850904a275a28708e94d4fa76.jpg" alt="">（上图来自 <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/samples/gg193983(v=vs.85)">SVG vs canvas: how to choose</a>，比较了 SVG 和 Canvas 其中的一些优劣）</p>
<p>我们从这些例子中可以看出来，无论选用哪一种技术，HTML 5 的出现，都给了浏览器底气。以往由于其自身能力的限制，浏览器的很多领土都被播放器控件、Flash 等蚕食了，HTML 5 正助其将领土重新夺回来（你可能已经听说了，Chrome 已经开始用提示条警告：从 2020 年 12 月起 Chrome 将不再支持 Flash）。</p>
<p>使用这种方式，以往浏览器内的这些插件和扩展的“黑盒”全部通过原生的 HTML 标签完成替换支持，少了一个软件“层”，多了一分透明，视频、音频等媒体由浏览器底层直接支持，性能会更加出色，交互性更好。</p>
<h2>数据可视化的 JavaScript 库</h2>
<p>数据可视化的 JavaScript 库有很多，我想它们可以简单分为两类：绝大多数都比较专精，完成某一类的图表绘制工作，比如 <a href="http://www.flotcharts.org/">Flot</a>；但是也有一些相对通用而强大，比如 <a href="https://d3js.org/">D3.js</a>。</p>
<h3>1. Flot</h3>
<p>Flot 是一个非常简单的图表绘制的 jQuery 插件，这样类似的库有很多，它们绝大多数包含这样两个特点：</p>
<ul> 
 <li>在使用上都包含 DOM 选择、选项设置、数据绑定、行为绑定等几个常见步骤，简单、直接，没有特定的领域语言，也没有复杂的模式套用；</li> 
 <li>它们往往针对性解决特定的、狭窄领域的问题，比如就是用来绘制二维坐标图，或者就是用来生成二维表格。</li> 
</ul>
<p>我们拿 Flot 举例，来感受一下这两个特点，比如下面这个例子，绘制一条正弦曲线，代码非常得简洁。</p>
<p>首先在 HTML 页面中建立一个 div：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;div id="plot"&gt;&lt;/div&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>接着在 JavaScript 中，写入如下代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let data = $.map([...Array(1000).keys()],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        (x, i) =&gt; [[i, Math.sin(x/100)]]);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $.plot("#plot", [{ data }], {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        xaxis: { ticks: [
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        0,
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 100 * Math.PI, "Pi" ],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 200 * Math.PI, "2Pi" ],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 300 * Math.PI, "3Pi" ]
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ]}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       });
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>按照前面说的常见步骤，我来简单解释一下。</p>
<ul> 
 <li>DOM 选择：“#plot”是 jQuery 的选择器，取得了 id 为 plot 的 DOM；</li> 
 <li>数据绑定：从 0 到 1000 的数中，给每一个数除以 100，再取它的正弦，将结果和数的序号捆绑起来放到入参 data 中；</li> 
 <li>行为绑定：这里没有显示绑定行为，有一些默认的响应行为由库实现；</li> 
 <li>选项设置：后面跟着的参数，其中包含 xaxis 用于设置 x 轴的坐标显示。</li> 
</ul>
<p>通过这样简单的代码，就可以得到如下效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/bc/7b/bc4af845f71bd7f97c5ae97fd5abf57b.png" alt=""></p>
<p>如果你考察生成的对象，你会发现它是使用 Canvas 来绘制的。</p>
<h3>2. D3.js</h3>
<p>第二类可视化 JavaScript 库相对较为通用。D3.js 是一个基于数据的操作文档的 JavaScript 库，可以让你绑定任何数据到 DOM，支持 DIV 这类常规 DOM 进行的图案生成，也支持 SVG 这种图案的生成。D3 帮助你屏蔽了浏览器差异，并且<strong>通过基于容器和数据匹配状态变更的解耦设计，这种方式对于绘制某些动态变化的、画布元素根据数据按照一定规则变动的图像，代码会非常得清晰简洁。</strong></p>
<p>这种方法就是 “Enter and Exit” 机制，下面我们来着重理解一下它。</p>
<p>这种机制建立在容器节点和数据映射的关系上，即“一个萝卜一个坑”，数据项就是萝卜，容器节点就是坑。在数据变动的过程中，通过每个节点位置和每个数据项的匹配，发生如下三种行为之一：</p>
<ul> 
 <li>如果数据项能够找到它所属的节点，发生 update 事件；</li> 
 <li>如果数据项更多，节点数量不够，对于无法找到节点的数据项，发生 enter 事件；</li> 
 <li>如果数据项减少，即原有的数据项离开了节点，发生 exit 事件。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/b7/1c/b7855ee66e852299334da11e6d9b6e1c.png" alt="">（来自 <a href="http://vis.stanford.edu/files/2011-D3-InfoVis.pdf">D3: Data-Driven Documents</a>）</p>
<p>下面，我们还是让代码说话，用一个简单的小例子，来展示这个过程。HTML 中有这样一个 DOM，作为画布，准备用 D3.js 在上面作画：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;svg&gt;&lt;/svg&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>定义一个作画方法 render，任何时候我们希望针对改变的数据，重新更新画布，只需要调用下面定义的 render 方法：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let render = (data) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 选择节点
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var circles = d3
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .select('svg')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .selectAll('circle');
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 默认行为，对应于 update
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('r', 20)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cx', (d, i) =&gt; { return i * 50 + 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cy', (d, i) =&gt; { return 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('fill', 'BLUE')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 新 data 加入，对应于 enter
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .enter()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .append('circle')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('r', 20)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cx', (d, i) =&gt; { return i * 50 + 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cy', (d, i) =&gt; { return 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity', 0)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('fill', 'RED')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .transition()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .duration(1000)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity', 1)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 旧 data 离开，对应于 exit
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .exit()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .transition()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .duration(1000)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity',0)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .remove();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       };
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，render 方法包含了这样几步：</p>
<ul> 
 <li>首先，选择节点，即“萝卜坑”，在最开始的时候，一个坑也没有，即 svg 节点内没有任何 circle 节点；</li> 
 <li>第二步，定义了默认的 update 行为，在数据项，即萝卜保持占据萝卜坑的时候，进行的操作，在这里就是绘制蓝色的坑；</li> 
 <li>第三步，定义 enter 行为，即对于新来的萝卜，无法找到相应萝卜坑的时候，进行的操作，例子中就是建立新的红色的坑；</li> 
 <li>第四步，定义 exit 行为，当有萝卜要离开萝卜坑的时候，需要进行的操作，例子中就是删掉原有的坑。</li> 
</ul>
<p>其中链式调用中的 transition() 定义了在执行某些过程时，以过渡动画的方式来进行，例子中无论是“挖坑”还是“填坑”，都通过透明度渐变的方法来实现过渡。</p>
<p>最后，我们在第 0 秒的时候种下了 3 个萝卜，由于之前没有萝卜坑，于是发生了三次 enter 行为；第 2 秒的时候我们将萝卜减少到了 2 个，于是发生了一次 exit 行为；在第 4 秒的时候我们将萝卜数量变为 4 个，于是发生两次 enter 行为：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       render([1, 2, 3]);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(() =&gt; { render([1, 2]); }, 2000);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(() =&gt; { render([1, 2, 3, 4]); }, 4000);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>效果如下：</p>
<p><img src="https://static001.geekbang.org/resource/image/52/72/525f4372f828ff85078c68d4dc28d372.gif" alt=""></p>
<p>不知道你是否还记得我们在 <a href="https://time.geekbang.org/column/article/151127">[第 16 讲]</a> 中介绍过的 Redux，D3.js 的这种机制和 Redux 的状态管理有着相似和相通之处。<strong>状态都在统一的地方维护，而状态的改变，都通过事件的发生和响应机制来进行，且都将事件的响应逻辑（回调）交给用户来完成。</strong>其实，这是一种很常见的“套路”，我们在后面的学习中，还将见到它的实现。</p>
<h2>总结思考</h2>
<p>今天，我们学习了 Web 绘图标准的基础知识，比较了 SVG 和 Canvas 这两种具备互补性的技术实现；同时，我们也学习了 Flot 和 D3.js 这两个差异很大，但都具备代表性的可视化 JavaScript 库。</p>
<p>希望你除了这两项同类技术之间孰优孰劣的比较以外，还掌握了不同类型技术之间联系比较的方法。随着学习的进行，对不同类型技术慢慢具备“深入”和“浅出”两个方向的理解，逐渐将充满关联的知识体系网状结构建立起来。</p>
<p>最后，我来提两个问题，供你思考一下吧：</p>
<ul> 
 <li>思考一下你经历过的比较大的项目，你是否在项目中使用过数据可视化技术，如果给你一个机会，你觉得该怎样使用呢？</li> 
 <li>相信你用过 Google 地图或 Baidu 地图吧，那么，你觉得地图应用应该是用 SVG 还是 Canvas 来实现呢，为什么？</li> 
</ul>
<h2>扩展阅读</h2>
<ul> 
 <li>对于 SVG 和 Canvas 技术上的详细类比，我推荐你阅读 <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/samples/gg193983(v=vs.85)">SVG vs canvas: how to choose</a> 这篇文章。</li> 
 <li>学习数据可视化的技术有一个学习的小窍门，就是在掌握最基本的原理之后，可以直接跳到例子中去学习。作为可视化的库，对于其视觉上反馈迅速的特点，我们可以利用起来。比如文中提到的这两个库，Flot 提供了一些<a href="http://www.flotcharts.org/flot/examples/">实用的例子</a>，而 <a href="https://github.com/d3/d3/wiki/Gallery">D3.js 的例子</a>则是非常震撼。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |30          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:51:51.474 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=30 
 {executed in 1 msec}
2020-11-19 17:51:51.482 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>随着大数据和数据分析趋势的流行，数据可视化变得越来越重要，而许多全栈的学习材料并没有跟上节奏，去介绍这方面的技术。这一讲中，我们将介绍数据可视化的基本概念和原理，以及几个常用的 JavaScript 用来实现数据可视化的库。</p>
<p>数据可视化，即 Data Visualization，是指使用具备视觉表现力的图形和表格等工具，向用户传达数据信息的方式。在我工作过的每个大型团队中，数据可视化技术都有着其不可替代的用武之地。</p>
<p>在大数据分析团队，数据库可视化技术被用来分析数据变化，验证机器学习算法的效果；在高可用服务团队，数据可视化技术被用来了解和监视服务的运行状况，了解系统的压力和负载；在分布式平台团队，数据可视化技术用来俯瞰一个个异步任务的执行情况，以获知任务执行的健康状况……事实上，只要有工程的地方，数据可视化就扮演着举足轻重的角色。</p>
<h2>Web 绘图标准</h2>
<p>在前端绘图，是数据可视化里面很常见的一个需求，我们常见的有位图和矢量图这样两种。</p>
<p>通常我们谈论的图片，绝大多数都是位图。位图又叫栅格图像，<strong>无论位图采用何种压缩算法，它本质就是点阵</strong>，它对于图像本身更具备普适性，无论图像的形状如何，都可以很容易分解为一个二维的点阵，更大的图，或者更高的分辨率，只是需要更密集的点阵而已。</p><!-- [[[read_end]]] -->
<p>你可能已经听说过矢量图。<strong>矢量图是使用点、线段或者多边形等基于数学方程的几何形状来表示的图像</strong>。将一个复杂图像使用矢量的方式来表达，显然要比位图困难得多，但是矢量图可以无损放大，因为它的本质是一组基于数学方程的几何形状的集合，因此无论放大多少倍，形状都不会发生失真或扭曲。并且图像越大，就越能比相应的位图节约空间，因为矢量图的大小和实际图像大小无关。倘若再采用独立的压缩算法进行压缩，矢量图可以基于文本压缩，从而获得很大的压缩比。</p>
<p>在早些年的项目中，在后端使用 Python 等语言预生成绘制图像的场景还比较多，但是如今已经少见一些了，大多数的图形生成都被搬到了前端。而这种情况也成为了前后端分离，以及数据和展示分离的典型场景，后端同步或异步生成不同维度的数据，浏览器则通过统一的 API 根据用户需求获取相应的数据；前端根据这些取得的数据在浏览器中现场绘制图像。关于服务端和客户端聚合的知识，如有遗忘，请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>。</p>
<p>总的来看，前端绘图，和后端比起来，有这样几个显著的优势。</p>
<ul> 
 <li><strong>前端生成的图形图像具有天然的交互性。</strong>前端生成的图像不仅仅意味着一张“图”，还意味着它能够和 HTML 这样的呈现结构紧密地结合起来，而图像上的组成部分都可以响应用户的行为。</li> 
 <li><strong>图像的生成可能需要显著的资源消耗，放到前端可以减轻服务器压力。</strong>这里的消耗既包括 CPU、内存等物理资源消耗，还有用户的等待时间消耗，在前端可以更好地给用户提供渲染过程的反馈。</li> 
 <li><strong>图形图像的设计和规划本就属于呈现层，系统架构上把它放到前端更容易实现前后端分离，组织结构上能让擅长视觉处理的前端工程师和 UX 设计师更自然地工作。</strong>有了数据，就可以对前端的图像生成逻辑进行设计和测试，工程师和设计师只需要专注于前端的通用技能就可以较为独立地完成工作。</li> 
</ul>
<p>我们较常听到的 Web 绘图标准包括 VML、SVG 和 Canvas，其中 VML 是微软最初参与制定的标准，一直以来只有 IE 等少数浏览器支持，从 2012 年的 IE 10 开始它逐渐被废弃了；但是剩余两个，SVG 和 Canvas 有一定互补性，且如今都非常流行，下面我来介绍一下。</p>
<h3>1. SVG</h3>
<p>SVG 即 Scalable Vector Graphics，可缩放矢量图形。它是基于可扩展标记语言（XML），用于描述二维矢量图形的一种图形格式。在它之前，微软曾经向 W3C 交过 VML 的提议，但被拒绝了。之后才有了 SVG，由 W3C 制定，是一个开放标准，当时在 W3C 自己看来，SVG 的竞争对手应该主要是 Flash。</p>
<p>SVG 格式和前面提到的 VML 一样，支持脚本，容易被搜索引擎索引。SVG 可以嵌入外部对象，比如文字、PNG、JPG，也可以嵌入外部的 SVG。它在移动设备上存在两个子版本，分别叫做 SVG Basic 和 SVG Tiny。SVG 很快获得了各种浏览器的支持，一开始 IE 还坚守着自家的 VML 不放，但后来也慢慢被迫转移到了 SVG 的阵营，从 IE 9 才开始对 SVG 部分支持。</p>
<p>SVG 支持三种格式的图形：矢量图形、栅格图像和文本。所以你看，<strong>SVG 并不只是一个矢量图的简单表示规范，而是尝试把矢量图、位图和文字统一起来的标准</strong>。我们来亲自写一个 SVG 的小例子，在你的工作文件夹中建立 example.svg，并用文本编辑器打开，录入如下文字：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;?xml version="1.0" encoding="UTF-8"?&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="300" height="300"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;rect x="60" y="60" width="200" height="200" fill="red" stroke="black" stroke-width="2px" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/svg&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我来对上述 XML 做个简单的解释：第一行了指明 XML 的版本和编码；第二行是一个 svg 的根节点，指明了协议和版本号，图像画布的大小（500 x 500），其中只包含一个矩形（rect），这个矩形的起始位置是（x, y），宽和高都为 200，填充红色，并使用 2px 宽的黑色线条来描边。</p>
<p>接着使用 Chrome 来打开这个文件，你将看到这样的效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/3f/86/3f4e7698378c4cf109730d7c5ee2f086.png" alt=""></p>
<p>接着我们另建立一个 HTML 文件：svg.html，加上 html 标签，并拷贝 XML 中的 svg 标签到这个 HTML 文件中：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="300" height="300"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;rect x="60" y="60" width="200" height="200" fill="red" stroke="black" stroke-width="2px" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/svg&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>用 Chrome 打开看看效果——嗯，再次展示了这个红色方块。反复点击 Chrome 的 View 菜单下的 Zoom In 选项，将图像放到最大，观察矩形的边角，没有任何模糊和失真，这证明了它确实是矢量图。</p>
<p><img src="https://static001.geekbang.org/resource/image/d9/5c/d9b9e454a6379295c47133231096bd5c.png" alt=""></p>
<p>最后打开 Chrome 的开发者工具，在控制台键入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("svg&gt;rect").setAttribute("fill", "green");
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你会看到这个矢量图从红色变成了绿色。这充分说明，svg 就是普普通通的 HTML 标签，它可以响应 JavaScript 的控制。自此，图像对于天天和 HTML 打交道的程序员来说，再也不是一个“二进制黑盒”了。</p>
<h3>2. Canvas</h3>
<p>Canvas 标签是 HTML 5 的标签之一，标签可以定义一片区域，允许 JavaScript 动态渲染图像。开始由苹果推出，自家的 Safari 率先支持，IE 从 IE 9 开始支持。</p>
<p>Canvas 和 SVG 有相当程度的互补之处，我们来实现一个 Canvas 的例子，体会下这一点。请在任何工作文件夹中，建立 canvas.html，并写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;canvas width="300" height="300"&gt;&lt;/canvas&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;script type="text/javascript"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var canvas = document.getElementsByTagName('canvas')[0];
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var ctx = canvas.getContext('2d');
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.rect(60,60,200,200);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.fillStyle = 'RED';
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.fill();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.strokeStyle = 'BLACK';
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ctx.stroke();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/script&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>代码很容易理解，获取到 canvas 节点以后，获取一个 2D 上下文，接着设置好矩形的位置和大小，分别进行填充和描线的操作。接着使用 Chrome 打开，你会发现效果和 SVG 的例子一样，展示了这个具备黑色边框的红色方块。</p>
<p><img src="https://static001.geekbang.org/resource/image/ea/c9/ea7cd35069fdf2216eb490cfa8ef72c9.png" alt=""></p>
<p>看起来和 SVG 差不多对不对？我们也来执行相同的操作，反复点击 Chrome 的 View 菜单下的 Zoom In 选项，将图像放到最大：</p>
<p><img src="https://static001.geekbang.org/resource/image/5b/f6/5bda99bcbf2f4eddbddd5361440185f6.png" alt=""></p>
<p>你看，矩形的边角不再清晰，这说明这种方式绘制的不是矢量图，而是位图。再使用 Chrome 的开发者工具，点击左上角的 DOM 选择箭头，选中这个矩形，我们发现，和 SVG 不同的是，这个 canvas 节点内部并没有任何 DOM 结构。</p>
<p><img src="https://static001.geekbang.org/resource/image/55/c8/5584741d7f3bbab26690d46a0ce2e8c8.jpg" alt=""></p>
<p>虽然这是一个小小的例子，但足以看出 Canvas 和 SVG 之间的明显差异和互补性了。</p>
<p>总的来说，从图片描述过程上来说，SVG 是 HTML 标签原生支持的，因此就可以使用这种<strong>声明式的语言</strong>来描述图片，它更加直观、形象、具体，每一个图形组成的 DOM 都可以很方便地绑定和用户交互的事件。<strong>这种在渲染技术上通过提供一套完整的图像绘制模型来实现的方式叫做 <a href="https://en.wikipedia.org/wiki/Retained_mode">Retained Mode</a>。</strong></p>
<p>Canvas 则是藉由 JavaScript 的<strong>命令式的语言</strong>对既定 API 的调用，来完成图像的绘制，canvas 标签的内部，并没有任何 DOM 结构，这让它无法使用传统的 DOM 对象绑定的方式来和图像内部的元素进行互动，但它更直接、可编程性强，在浏览器内存中不需要为了图形维护一棵巨大的 DOM 树，这也让它在遇到大量的密集对象时，拥有更高的渲染性能。<strong>这种在渲染技术上通过直接调用图形对象的绘制命令接口来实现的方式叫做 <a href="https://en.wikipedia.org/wiki/Immediate_mode_(computer_graphics)">Immediate Mode</a>。</strong></p>
<p>讲到这里，不知道你是否联想到了我们之前反复提到过的，声明式编程和命令式编程在全栈技术中的应用，如果你忘记了，可以回看 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中的介绍。所以，我想再次说，技术都是相通的。</p>
<p><img src="https://static001.geekbang.org/resource/image/41/76/41df55e850904a275a28708e94d4fa76.jpg" alt="">（上图来自 <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/samples/gg193983(v=vs.85)">SVG vs canvas: how to choose</a>，比较了 SVG 和 Canvas 其中的一些优劣）</p>
<p>我们从这些例子中可以看出来，无论选用哪一种技术，HTML 5 的出现，都给了浏览器底气。以往由于其自身能力的限制，浏览器的很多领土都被播放器控件、Flash 等蚕食了，HTML 5 正助其将领土重新夺回来（你可能已经听说了，Chrome 已经开始用提示条警告：从 2020 年 12 月起 Chrome 将不再支持 Flash）。</p>
<p>使用这种方式，以往浏览器内的这些插件和扩展的“黑盒”全部通过原生的 HTML 标签完成替换支持，少了一个软件“层”，多了一分透明，视频、音频等媒体由浏览器底层直接支持，性能会更加出色，交互性更好。</p>
<h2>数据可视化的 JavaScript 库</h2>
<p>数据可视化的 JavaScript 库有很多，我想它们可以简单分为两类：绝大多数都比较专精，完成某一类的图表绘制工作，比如 <a href="http://www.flotcharts.org/">Flot</a>；但是也有一些相对通用而强大，比如 <a href="https://d3js.org/">D3.js</a>。</p>
<h3>1. Flot</h3>
<p>Flot 是一个非常简单的图表绘制的 jQuery 插件，这样类似的库有很多，它们绝大多数包含这样两个特点：</p>
<ul> 
 <li>在使用上都包含 DOM 选择、选项设置、数据绑定、行为绑定等几个常见步骤，简单、直接，没有特定的领域语言，也没有复杂的模式套用；</li> 
 <li>它们往往针对性解决特定的、狭窄领域的问题，比如就是用来绘制二维坐标图，或者就是用来生成二维表格。</li> 
</ul>
<p>我们拿 Flot 举例，来感受一下这两个特点，比如下面这个例子，绘制一条正弦曲线，代码非常得简洁。</p>
<p>首先在 HTML 页面中建立一个 div：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;div id="plot"&gt;&lt;/div&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>接着在 JavaScript 中，写入如下代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let data = $.map([...Array(1000).keys()],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        (x, i) =&gt; [[i, Math.sin(x/100)]]);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $.plot("#plot", [{ data }], {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        xaxis: { ticks: [
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        0,
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 100 * Math.PI, "Pi" ],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 200 * Math.PI, "2Pi" ],
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        [ 300 * Math.PI, "3Pi" ]
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        ]}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       });
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>按照前面说的常见步骤，我来简单解释一下。</p>
<ul> 
 <li>DOM 选择：“#plot”是 jQuery 的选择器，取得了 id 为 plot 的 DOM；</li> 
 <li>数据绑定：从 0 到 1000 的数中，给每一个数除以 100，再取它的正弦，将结果和数的序号捆绑起来放到入参 data 中；</li> 
 <li>行为绑定：这里没有显示绑定行为，有一些默认的响应行为由库实现；</li> 
 <li>选项设置：后面跟着的参数，其中包含 xaxis 用于设置 x 轴的坐标显示。</li> 
</ul>
<p>通过这样简单的代码，就可以得到如下效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/bc/7b/bc4af845f71bd7f97c5ae97fd5abf57b.png" alt=""></p>
<p>如果你考察生成的对象，你会发现它是使用 Canvas 来绘制的。</p>
<h3>2. D3.js</h3>
<p>第二类可视化 JavaScript 库相对较为通用。D3.js 是一个基于数据的操作文档的 JavaScript 库，可以让你绑定任何数据到 DOM，支持 DIV 这类常规 DOM 进行的图案生成，也支持 SVG 这种图案的生成。D3 帮助你屏蔽了浏览器差异，并且<strong>通过基于容器和数据匹配状态变更的解耦设计，这种方式对于绘制某些动态变化的、画布元素根据数据按照一定规则变动的图像，代码会非常得清晰简洁。</strong></p>
<p>这种方法就是 “Enter and Exit” 机制，下面我们来着重理解一下它。</p>
<p>这种机制建立在容器节点和数据映射的关系上，即“一个萝卜一个坑”，数据项就是萝卜，容器节点就是坑。在数据变动的过程中，通过每个节点位置和每个数据项的匹配，发生如下三种行为之一：</p>
<ul> 
 <li>如果数据项能够找到它所属的节点，发生 update 事件；</li> 
 <li>如果数据项更多，节点数量不够，对于无法找到节点的数据项，发生 enter 事件；</li> 
 <li>如果数据项减少，即原有的数据项离开了节点，发生 exit 事件。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/b7/1c/b7855ee66e852299334da11e6d9b6e1c.png" alt="">（来自 <a href="http://vis.stanford.edu/files/2011-D3-InfoVis.pdf">D3: Data-Driven Documents</a>）</p>
<p>下面，我们还是让代码说话，用一个简单的小例子，来展示这个过程。HTML 中有这样一个 DOM，作为画布，准备用 D3.js 在上面作画：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;svg&gt;&lt;/svg&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>定义一个作画方法 render，任何时候我们希望针对改变的数据，重新更新画布，只需要调用下面定义的 render 方法：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let render = (data) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 选择节点
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var circles = d3
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .select('svg')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .selectAll('circle');
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 默认行为，对应于 update
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('r', 20)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cx', (d, i) =&gt; { return i * 50 + 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cy', (d, i) =&gt; { return 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('fill', 'BLUE')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 新 data 加入，对应于 enter
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .enter()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .append('circle')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('r', 20)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cx', (d, i) =&gt; { return i * 50 + 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .attr('cy', (d, i) =&gt; { return 20; })
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity', 0)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('fill', 'RED')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .transition()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .duration(1000)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity', 1)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        // 旧 data 离开，对应于 exit
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        circles.data(data)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .exit()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .transition()
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .duration(1000)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .style('opacity',0)
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .remove();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       };
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，render 方法包含了这样几步：</p>
<ul> 
 <li>首先，选择节点，即“萝卜坑”，在最开始的时候，一个坑也没有，即 svg 节点内没有任何 circle 节点；</li> 
 <li>第二步，定义了默认的 update 行为，在数据项，即萝卜保持占据萝卜坑的时候，进行的操作，在这里就是绘制蓝色的坑；</li> 
 <li>第三步，定义 enter 行为，即对于新来的萝卜，无法找到相应萝卜坑的时候，进行的操作，例子中就是建立新的红色的坑；</li> 
 <li>第四步，定义 exit 行为，当有萝卜要离开萝卜坑的时候，需要进行的操作，例子中就是删掉原有的坑。</li> 
</ul>
<p>其中链式调用中的 transition() 定义了在执行某些过程时，以过渡动画的方式来进行，例子中无论是“挖坑”还是“填坑”，都通过透明度渐变的方法来实现过渡。</p>
<p>最后，我们在第 0 秒的时候种下了 3 个萝卜，由于之前没有萝卜坑，于是发生了三次 enter 行为；第 2 秒的时候我们将萝卜减少到了 2 个，于是发生了一次 exit 行为；在第 4 秒的时候我们将萝卜数量变为 4 个，于是发生两次 enter 行为：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       render([1, 2, 3]);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(() =&gt; { render([1, 2]); }, 2000);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(() =&gt; { render([1, 2, 3, 4]); }, 4000);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>效果如下：</p>
<p><img src="https://static001.geekbang.org/resource/image/52/72/525f4372f828ff85078c68d4dc28d372.gif" alt=""></p>
<p>不知道你是否还记得我们在 <a href="https://time.geekbang.org/column/article/151127">[第 16 讲]</a> 中介绍过的 Redux，D3.js 的这种机制和 Redux 的状态管理有着相似和相通之处。<strong>状态都在统一的地方维护，而状态的改变，都通过事件的发生和响应机制来进行，且都将事件的响应逻辑（回调）交给用户来完成。</strong>其实，这是一种很常见的“套路”，我们在后面的学习中，还将见到它的实现。</p>
<h2>总结思考</h2>
<p>今天，我们学习了 Web 绘图标准的基础知识，比较了 SVG 和 Canvas 这两种具备互补性的技术实现；同时，我们也学习了 Flot 和 D3.js 这两个差异很大，但都具备代表性的可视化 JavaScript 库。</p>
<p>希望你除了这两项同类技术之间孰优孰劣的比较以外，还掌握了不同类型技术之间联系比较的方法。随着学习的进行，对不同类型技术慢慢具备“深入”和“浅出”两个方向的理解，逐渐将充满关联的知识体系网状结构建立起来。</p>
<p>最后，我来提两个问题，供你思考一下吧：</p>
<ul> 
 <li>思考一下你经历过的比较大的项目，你是否在项目中使用过数据可视化技术，如果给你一个机会，你觉得该怎样使用呢？</li> 
 <li>相信你用过 Google 地图或 Baidu 地图吧，那么，你觉得地图应用应该是用 SVG 还是 Canvas 来实现呢，为什么？</li> 
</ul>
<h2>扩展阅读</h2>
<ul> 
 <li>对于 SVG 和 Canvas 技术上的详细类比，我推荐你阅读 <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/samples/gg193983(v=vs.85)">SVG vs canvas: how to choose</a> 这篇文章。</li> 
 <li>学习数据可视化的技术有一个学习的小窍门，就是在掌握最基本的原理之后，可以直接跳到例子中去学习。作为可视化的库，对于其视觉上反馈迅速的特点，我们可以利用起来。比如文中提到的这两个库，Flot 提供了一些<a href="http://www.flotcharts.org/flot/examples/">实用的例子</a>，而 <a href="https://github.com/d3/d3/wiki/Gallery">D3.js 的例子</a>则是非常震撼。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |30          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:51:51.491 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=30 
 {executed in 0 msec}
2020-11-19 17:51:51.492 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|
|30  |1605755909 |1605755909 |1                |zh-hans  |0       |1                             |1      |0      |18丨千言万语不及一幅画：谈谈数据可视化 |book |1   |30  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|

2020-11-19 17:51:51.493 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=30 
 {executed in 0 msec}
2020-11-19 17:51:51.493 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|
|[unread] |1605755909 |1605755909 |1                |zh-hans  |0       |1                             |1      |0      |18丨千言万语不及一幅画：谈谈数据可视化 |1   |30  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|

2020-11-19 17:51:51.498 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779511, created=1605779511, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='18丨千言万语不及一幅画：谈谈数据可视化', 
type='book', uid=1, vid=30 where nid=30 
 {executed in 1 msec}
2020-11-19 17:51:51.498 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779511, created=1605779511, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='18丨千言万语不及一幅画：谈谈数据可视化', 
uid=1, vid=30 where nid=30 
 {executed in 0 msec}
2020-11-19 17:51:51.506 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=30 
 {executed in 1 msec}
2020-11-19 17:51:51.507 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |revision_id |
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|30        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/7a563ddabb56a5096d152b34439dd1de?bkt=en-06f5c65000af0ed6db40bb7b24bd01451f23b5830fd9de47526444b2163930fb161c9f81f4ea72b1&fid=3757516097-778750-74090905837149&time=1605755908&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-WeF5kAEpwKKED2qwaBZxmoo%2FU7k%3D&to=92&size=16220465&sta_dx=16220465&sta_cs=3504&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655940&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16220465&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9fa97d1671ee21cadea6d823144517c4c5ce313cb8b9347eecc0b256568a58c252523bcb1e3562c6&sl=76480590&expires=8h&rt=pr&r=523464624&mlogid=7502209316865924288&vbdid=2247232042&fin=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a&bflag=92,34-92&rtype=1&dp-logid=7502209316865924288&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=9d46d1303ead72daa4e6ac8fc977fa30404bf108248dd6f6&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a |30          |
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:51:51.511 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/7a563ddabb56a5096d152b34439dd1de?bkt=en-06f5c65000af0ed6db40bb7b24bd01451f23b5830fd9de47526444b2163930fb161c9f81f4ea72b1&fid=3757516097-778750-447892812952296&time=1605779509&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-pFHJrBQ3rBYYuUAqvCPkKrNV34o%3D&to=92&size=16220465&sta_dx=16220465&sta_cs=3509&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655940&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16220465&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9fa97d1671ee21cadea6d823144517c4c5ce313cb8b9347eecc0b256568a58c252523bcb1e3562c6&sl=76480590&expires=8h&rt=pr&r=585260624&mlogid=7508544801613750179&vbdid=2247232042&fin=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a&bflag=92,34-92&rtype=1&dp-logid=7508544801613750179&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=92f9da3c8a3331aef8ad8cac1a175ced73314bfa43512ec8&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a', 
revision_id=30 where entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.514 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.515 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |revision_id |
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/7a563ddabb56a5096d152b34439dd1de?bkt=en-06f5c65000af0ed6db40bb7b24bd01451f23b5830fd9de47526444b2163930fb161c9f81f4ea72b1&fid=3757516097-778750-74090905837149&time=1605755908&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-WeF5kAEpwKKED2qwaBZxmoo%2FU7k%3D&to=92&size=16220465&sta_dx=16220465&sta_cs=3504&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655940&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16220465&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9fa97d1671ee21cadea6d823144517c4c5ce313cb8b9347eecc0b256568a58c252523bcb1e3562c6&sl=76480590&expires=8h&rt=pr&r=523464624&mlogid=7502209316865924288&vbdid=2247232042&fin=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a&bflag=92,34-92&rtype=1&dp-logid=7502209316865924288&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=9d46d1303ead72daa4e6ac8fc977fa30404bf108248dd6f6&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a |30          |
|----------|-------|------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:51:51.519 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/7a563ddabb56a5096d152b34439dd1de?bkt=en-06f5c65000af0ed6db40bb7b24bd01451f23b5830fd9de47526444b2163930fb161c9f81f4ea72b1&fid=3757516097-778750-447892812952296&time=1605779509&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-pFHJrBQ3rBYYuUAqvCPkKrNV34o%3D&to=92&size=16220465&sta_dx=16220465&sta_cs=3509&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655940&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16220465&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9fa97d1671ee21cadea6d823144517c4c5ce313cb8b9347eecc0b256568a58c252523bcb1e3562c6&sl=76480590&expires=8h&rt=pr&r=585260624&mlogid=7508544801613750179&vbdid=2247232042&fin=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a&bflag=92,34-92&rtype=1&dp-logid=7508544801613750179&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=92f9da3c8a3331aef8ad8cac1a175ced73314bfa43512ec8&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=18%E4%B8%A8%E5%8D%83%E8%A8%80%E4%B8%87%E8%AF%AD%E4%B8%8D%E5%8F%8A%E4%B8%80%E5%B9%85%E7%94%BB%EF%BC%9A%E8%B0%88%E8%B0%88%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96.m4a', 
revision_id=30 where entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.522 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.523 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|30        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/1d/d6/76fe5259.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>Dream.</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    #1思考一下你经历过的比较大的项目，你是否在项目中使用过数据可视化技术，如果给你一个机会，你觉得该怎样使用呢？
    <br>
    <br>数据可视化，关键是将用户关注，并且值得分析的数据展示给用户。比如业务系统的业务量，运维系统的监控状态等等。
    <br>
    <br>相信你用过 Google 地图或 Baidu 地图吧，那么，你觉得地图应用应该是用 SVG 还是 Canvas 来实现呢，为什么？
    <br>
    <br>地图最好还是采用svg来实现，svg可以很好的支撑地图缩放功能，保证缩放时地图保持原样。如果换成Canvas，放大了会模糊，缩太小了会因为点阵过于密集而造成图像扭曲
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |30          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:51:51.528 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=30 
 {executed in 1 msec}
2020-11-19 17:51:51.528 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/1d/d6/76fe5259.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>Dream.</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    #1思考一下你经历过的比较大的项目，你是否在项目中使用过数据可视化技术，如果给你一个机会，你觉得该怎样使用呢？
    <br>
    <br>数据可视化，关键是将用户关注，并且值得分析的数据展示给用户。比如业务系统的业务量，运维系统的监控状态等等。
    <br>
    <br>相信你用过 Google 地图或 Baidu 地图吧，那么，你觉得地图应用应该是用 SVG 还是 Canvas 来实现呢，为什么？
    <br>
    <br>地图最好还是采用svg来实现，svg可以很好的支撑地图缩放功能，保证缩放时地图保持原样。如果换成Canvas，放大了会模糊，缩太小了会因为点阵过于密集而造成图像扭曲
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |30          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:51:51.533 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.533 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|30        |book   |0     |zh-hans  |30          |https://static001.geekbang.org/resource/image/02/b9/022272ea310623ba7708994e570072b9.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:51:51.538 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.538 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |30          |https://static001.geekbang.org/resource/image/02/b9/022272ea310623ba7708994e570072b9.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:51:51.543 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=30 
 {executed in 1 msec}
2020-11-19 17:51:51.543 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |30          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:51:51.548 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=30 
 {executed in 0 msec}
2020-11-19 17:51:51.548 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |30          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:51:51.553 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='507724466199032' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:51:51.553 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:52:41.093 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='507724466199032' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:52:41.094 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:52:41.097 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('507724466199032', 1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:52:41.098 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('507724466199032', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:52:41.099 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|51            |
|--------------|

2020-11-19 17:52:41.129 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='507724466199032' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:52:41.129 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:52:41.915 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='507724466199032' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:52:41.916 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:52:41.917 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('507724466199032', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:52:41.918 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('507724466199032', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:52:41.918 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|52            |
|--------------|

2020-11-19 17:52:41.935 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='507724466199032' 
 {executed in 1 msec}
2020-11-19 17:52:41.935 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|31        |book   |0     |507724466199032  |zh-hans  |31          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:52:41.935 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.935 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|31  |zh-hans  |book |bf153783-dd22-4495-9459-55223cc8b171 |31  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:52:41.941 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:41.941 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |507724466199032  |zh-hans  |31          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:52:41.946 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.946 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|31  |1   |3     |0            |1  |27 |31 |0  |0  |27  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:52:41.951 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:41.957 INFO  jdbc.resultsettable Line:610 - 
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|31        |<p>你好，我是四火。</p>
<p>前几讲我们一直在 JavaScript 的代码中游走，这一讲我们来换换脑子，聊一聊界面设计，讲一讲交互和布局。这部分对于基于 Web 的全栈工程师来说，不只是技术栈特殊的一部分，还是一个能够给个人发展格局带来更多可能的部分。</p>
<h2>1. 单页面应用</h2>
<p>SPA，Single-Page Application，即单页应用，是一种互联网应用在用户交互方面的模型。</p>
<p>用户打开一个页面，大部分操作都在单个页面里面完成。和传统的 MPA（Multiple-Page Application）相比，用户体验上，SPA 省去了页面跳转的突兀感受和等待时间，用户体验更加桌面化，操作迅速、切换无缝；软件架构上，SPA 可以更彻底地落实前后端分离，后端彻底变成了一个只暴露 API 的服务，将不同终端的视图层的工作，特别是页面聚合搬到前端来完成（如有遗忘请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>）。</p>
<p>对于许多大型应用，SPA 和 MPA 往往是在一定程度上结合起来使用的，比如新浪微博的网页版，用户可以浏览时间线，并作出一些转发评论、媒体播放等等操作，但是也可以跳到单独的单条微博的页面去。</p>
<p>但 SPA 也有着先天的缺陷。比如说，网页的 SEO（Search Engine Optimization）就是一个例子，单页应用上的操作，引起页面的状态改变，很难被搜索引擎敏锐地捕获到，并使之成为“可搜索到的”，因此 SPA 页面的 SEO 需要做额外的工作，关于这部分我会在第五章中介绍一些相关知识。</p><!-- [[[read_end]]] -->
<p>再比如，浏览器上网页操纵的功能，像前进、后退的功能，也需要一些特别的技巧才能支持，毕竟，和互联网整体翻天覆地的改变相比，浏览器的核心设计一直以来都变化缓慢，而地址栏、页面控制功能等等可都不是为着 SPA 考虑的。最后，SPA 通常会伴随着大大增加的在线应用复杂程度。</p>
<h2>2. 渐进式增强</h2>
<p><strong>渐进式增强，即 Progressive Enhancement，强调的是可访问性，即允许不同能力的设备都能够访问网页的基本内容，使用网页的基本功能；但是，当用户使用更加先进的设备时，它能够给用户带来更强大的功能和更好的体验。</strong></p>
<p>举一个小例子，对于非常极端和基础的设备，网页可以只加载 HTML；更高级一点的设备，则可以加载 CSS；而对于多数高级设备，则还需加载 JavaScript。这三种设备都可以使用网站的核心功能，但是只有最后一类设备可以使用全部功能。当然，实际的增强效果递进未必会那么极端，对于每一个递进，可以只是部分样式，部分标签，部分脚本等等。</p>
<p>渐进式增强的理念不仅仅可以对不同设备的访问带来普适性，对低端设备的访问更为友好，它还有一些其它优势。比如说，立足于网页基础的 HTML，可以让网页对于搜索引擎更加友好，因为 CSS 样式和 JavaScript 行为不一定能被搜索引擎解释执行并收录。</p>
<p>在这个过程中，HTML 的语义化变得越来越重要。语义化，指的就是让 HTML 页面体现出内容的结构性，即让 HTML 具备自解释能力，而不是一堆冷冰冰的缺乏语义的标签。你看下面的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;article&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;h1&gt;Article Title&lt;/h1&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;p&gt;This is the content. Please read &lt;em&gt;carefully&lt;/em&gt;.&lt;/p&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/article&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>其中的 article 标签，就是具备语义的，表示着其中的内容是一篇文章，我们当然可以使用没有语义的 div 标签来代替，但 article 标签可以让阅读代码的人，浏览器，以及搜索引擎理解这部分的内容。h1 标签表示标题，p 标签表示段落，而其中的 em 标签表示的是需要强调（如果想使用无语义的标签，可以使用斜体标签 i 来代替），这些用在这里都是具备恰当语义的。</p>
<p><strong>和渐进式增强一起谈论的，还有一个相反过程的设计理念，叫做优雅降级，Graceful Degradation，本质上它们说的是一个事儿。</strong></p>
<p>优雅降级指的是，当高级特性和增强内容无法在用户的设备上展现的时候，依然能够给用户提供一个具备基本功能的，可以工作的应用版本。值得注意的是，优雅降级并非一定发生在用户设备的能力不匹配时，还有可能发生在服务器端资源出现瓶颈的时候，比如某些访问量特别大或者系统出现问题的时刻，资源紧张，服务端可以关闭某一些次要功能，降低一些用户体验，用几种核心资源来保证基础功能的正常运行。</p>
<p>关于渐进增强和优雅降级，我来举一个 Amazon 网站设计的例子，希望它能帮助你进一步理解。如果你使用先进的 Web 浏览器访问 <a href="https://www.amazon.com/">amazon.com</a>，你会看到完整的功能：</p>
<p><img src="https://static001.geekbang.org/resource/image/e0/6d/e0e9042739354cd257c0a4c5562c1b6d.png" alt=""></p>
<p>点击左上角三横线的菜单图标，你将能看到利用 JavaScript 做出的弹出层的效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/8a/ab/8a0207fda0c53029c7e42fea22163bab.jpg" alt=""></p>
<p>现在，我们点击 Chrome 地址栏的锁图标，点击 Site Settings，在设置中关闭对网站的 JavaScript 支持，刷新页面，显示还差不多。但是如果点击左上角的菜单图标，你就会发现，由于没有了 JavaScript，无法使用弹出层效果，它变成了一个链接，跳转到了商品分类：</p>
<p><img src="https://static001.geekbang.org/resource/image/22/47/22487f4e20e1879283feac0fc757ef47.jpg" alt=""></p>
<p>你看，虽然没有了 JavaScript，遵循这种设计理念，在损失一部分用户体验的情况下 ，你可以继续使用网站，并且可以继续购物，其中的核心功能并没有丢失。</p>
<p>此外，还有一种可以拿来类比的设计理念，叫做<strong>回归增强</strong>，Regressive Enhancement。它要求为系统的特性设定基线，并应用到较老的设备和浏览器中。于是在设计网页特性时，我们可以按照高级设备的能力来进行，但是在实际开发的实施过程中，对于较低级的设备，提供一些其它的替代方法，让它们也模拟支持这些新特性。</p>
<p>比方说，HTML 5 的一些特性在偏老的 IE 浏览器中不支持，那么就可以使用 JavaScript 等替代方案实现出相似的效果。我们提到过的类库 jQuery 就遵循着回归增强的设计理念，在一定程度上屏蔽了不同浏览器的差异性。</p>
<p>举个实际例子，input 标签如果在偏老的浏览器中不支持 placeholder 属性，我们可以利用灰度字体的样式在 input 标签中显示实际内容来模拟这个功能。当用户将输入焦点移到 input 标签中，再将其从 input 中清空，以便用户能输入实际内容。</p>
<p><img src="https://static001.geekbang.org/resource/image/2a/b9/2a2fcffed3b03c5873f069a6c3c6d8b9.jpg" alt=""></p>
<p>无论是渐进式增强、优雅降级，还是回归增强，都是为了在一定程度上照顾更多的不同能力的设备和浏览器，给用户带来“尽量好”的体验。但是我们在应用这样的设计理念时，需要把握这个度，毕竟，它不是无代价的，而是会增加前端设计开发的复杂性。</p>
<h2>3. 响应式布局</h2>
<p>响应式网页设计，即 RWD，Responsive Web Design，也有称之为<strong>自适应性网页设计</strong>，Adaptive Web Design，是一种网页设计方法，<strong>目的是使得同一份网页，在不同的设备上有合适的展现。</strong>几乎页面上所有的元素都可以遵循响应式布局，在不同的设备上产生不同的呈现，包括字体和图像等，但是我们讨论得最多的，却是布局。</p>
<p>我记得我刚参加工作的那几年，我们对于同一个页面在不同设备上的展示，考虑的最多的问题还是终端适配，并且这种适配还是基于协议的。例如，服务端是返回 Web 页面，<a href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%BA%BF%E5%BA%94%E7%94%A8%E5%8D%8F%E8%AE%AE">WAP</a> 1.0 页面（WML 语言描述），还是 WAP 2.0 页面（XHTML 语言描述）？那时候我们还很难去谈论用户体验有多么“合适”，对于这些低端的移动设备，我们充其量只能关心功能的实现是否能保证。</p>
<p>这部分，我们改变一下学习策略，来动动手，实现下简单的响应式布局页面。假如说我们需要实现一个具有 header、footer 的页面，并且他们需要填满宽度。而中间的主页面部分采用三列布局，左边列定宽，右边列也定宽，中间列宽度自由设置，但是要保证这三列排列起来也填满浏览器的宽度。</p>
<p>在往下阅读之前，你能否先想想，这该如何实现？</p>
<p>现在，我们在任意的工作文件夹下建立一个 responsive layout.html 文件，填写如下内容：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;head&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;link href="style.css" type="text/css" rel="stylesheet"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/head&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;header&gt;header&lt;/header&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;aside class="left"&gt;aside&lt;/aside&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;aside class="right"&gt;aside&lt;/aside&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;main class="middle"&gt;main&lt;/main&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;footer&gt;footer&lt;/footer&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这个文件结构是很简单的，但是具备了我们所需要的要素，包括 header、中间三列以及 footer。这个页面将引入 style.css，因此，我们在同一目录下，建立 style.css：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       * {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        height: 100px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 10px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       header, footer {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: YELLOW;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       main {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: BLUE;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       aside {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: GREEN;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .left {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: left;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 20px 230px 20px 230px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: right;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我来简单解读一下这个 CSS 文件。为了演示效果，所有的 DOM 对象都具备 100px 的高度，左边栏向左侧浮动排列，右边栏向右侧浮动排列，中间一列使用 margin 的方式给左右边栏留足位置。在排列这三列时，DOM 的顺序是左边栏 - 右边栏 - 中间栏，原因是，左右边栏是浮动样式，需要给他们排好以后，中间栏位无浮动，自动填满所有剩余空间。</p>
<p>看看效果吧，你可以拖动浏览器的边界，调整窗口的宽度，来模拟不同宽度的浏览器窗口下的效果。在较宽的浏览器下，它是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/2f/da/2f070ea33f80d6baf856b1c5e8238ada.jpg" alt=""></p>
<p>而在较窄的浏览器下，它是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/69/5c/6985655142435ed1b24352d0d1ea885c.jpg" alt=""></p>
<p>注意这里的图片有缩放，但是每个矩形的高度实际上都是 100px。也就是说，中间蓝色的区域可以根据实际的宽度需要进行自适应的横向缩放，但是布局始终保持填满浏览器的宽度，也就是说，绿色的部分，始终是固定不变的。</p>
<p>但是，这样的显示有一个问题，在屏幕宽度较小时，比如手机屏幕，中间的蓝色区域会被挤得看不见。因此，我们希望在浏览器宽度小到一定程度的时候，显示成多行格式，而不进行左中右栏位的划分了，即从上到下包含 5 行：header、left aside、main、right aside 和 footer。</p>
<p>那么，这又该怎么实现？</p>
<p>其实也不难，我们需要先在 HTML 的头部增加：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这个 meta 标签指定了视口（View Port）的宽度为设备宽度，避免了任何手机端自动缩放的可能，同时也关闭了用户手动缩放的功能，这样网页会更像一个原生 app。</p>
<p>接着，需要把现有的 css 中 .left, .right, .middle 三个样式放到屏幕宽度大于 640px 的条件下启用，而在宽度小于 640px 的条件下，我们将启用另外三组样式，这三组是将现有的三列以行的方式来展示：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       @media screen and (min-width: 640px) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .left {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: left;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 20px 230px 20px 230px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: right;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       @media screen and (max-width: 640px) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: auto;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .left, .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: auto;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: none;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>完工，我们一起看看效果。调整浏览器的右侧边界，逐渐缩小宽度，直到其低于 640px，你将看到如下效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/84/82/847dfb9c0c534d521bc0351303761382.jpg" alt=""></p>
<h2>总结思考</h2>
<p>今天我们学习了一些网页交互设计的理念，知道了怎样通过渐进式增强来照顾到尽可能多的设备和浏览器，也通过例子实际动手了解了怎样实现网页的响应式布局，希望你有所收获。</p>
<p>现在，我来提两个问题吧：</p>
<ul> 
 <li>在你的实际工作中，是否有考虑过不同能力的设备和浏览器的兼容适配问题，你又是怎样解决这样的问题呢？</li> 
 <li>给你这样几个 HTML 标签，你能否说出哪些是有语义的，哪些是无语义的呢？div、section、span、nav、summary、b。</li> 
</ul>
<p>好，今天就到这里，感谢你的阅读和思考，期待你的打卡！</p>
<h2>扩展阅读</h2>
<ul> 
 <li>【基础】对于 CSS 不熟悉的程序员朋友，可以通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started">MDN 上的 CSS 教程</a>进行系统地学习。</li> 
 <li>文中提到了 SPA 环境下，对于浏览器的前进、后退功能，需要一些特别的技巧才能实现，其中一个技巧就是使用内嵌 iFrame，这个机制的原理在 <a href="http://www.webdeveasy.com/back-button-behavior-on-a-page-with-an-iframe/">Back Button Behavior on a Page With an iframe</a> 这篇文章中有介绍（虽然这个机制本身当时给作者带来的是一个问题而不是一个解决方法），文中还附带了一个可尝试的<a href="http://www.webdeveasy.com/code/back-button-behavior-on-a-page-with-an-iframe/problem/page2.html">小例子</a>，另外的一个技巧我们将在第五章学到。</li> 
 <li>文中介绍了渐进增强和优雅降级的概念，在 <a href="https://www.mavenecommerce.com/2017/10/31/progressive-enhancement-vs-graceful-degradation/">Progressive Enhancement vs Graceful Degradation</a> 这篇文章中，我们可以看到对它的进一步形象的阐释；而 <a href="https://www.zhangxinxu.com/wordpress/2010/04/css-%E6%B8%90%E8%BF%9B%E5%A2%9E%E5%BC%BA%E5%9C%A8web%E5%88%B6%E4%BD%9C%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B/">CSS “渐进增强”在 web 制作中常见应用举例</a>一文则举了几个 CSS 具体应用渐进增强的例子。</li> 
 <li>对于 HTML 语义的介绍，<a href="http://justineo.github.io/slideshows/semantic-html/#/">Semantic HTML</a> 是一个非常好的用于介绍基础知识的胶片。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |31          |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:52:41.961 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:41.967 INFO  jdbc.resultsettable Line:610 - 
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>前几讲我们一直在 JavaScript 的代码中游走，这一讲我们来换换脑子，聊一聊界面设计，讲一讲交互和布局。这部分对于基于 Web 的全栈工程师来说，不只是技术栈特殊的一部分，还是一个能够给个人发展格局带来更多可能的部分。</p>
<h2>1. 单页面应用</h2>
<p>SPA，Single-Page Application，即单页应用，是一种互联网应用在用户交互方面的模型。</p>
<p>用户打开一个页面，大部分操作都在单个页面里面完成。和传统的 MPA（Multiple-Page Application）相比，用户体验上，SPA 省去了页面跳转的突兀感受和等待时间，用户体验更加桌面化，操作迅速、切换无缝；软件架构上，SPA 可以更彻底地落实前后端分离，后端彻底变成了一个只暴露 API 的服务，将不同终端的视图层的工作，特别是页面聚合搬到前端来完成（如有遗忘请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>）。</p>
<p>对于许多大型应用，SPA 和 MPA 往往是在一定程度上结合起来使用的，比如新浪微博的网页版，用户可以浏览时间线，并作出一些转发评论、媒体播放等等操作，但是也可以跳到单独的单条微博的页面去。</p>
<p>但 SPA 也有着先天的缺陷。比如说，网页的 SEO（Search Engine Optimization）就是一个例子，单页应用上的操作，引起页面的状态改变，很难被搜索引擎敏锐地捕获到，并使之成为“可搜索到的”，因此 SPA 页面的 SEO 需要做额外的工作，关于这部分我会在第五章中介绍一些相关知识。</p><!-- [[[read_end]]] -->
<p>再比如，浏览器上网页操纵的功能，像前进、后退的功能，也需要一些特别的技巧才能支持，毕竟，和互联网整体翻天覆地的改变相比，浏览器的核心设计一直以来都变化缓慢，而地址栏、页面控制功能等等可都不是为着 SPA 考虑的。最后，SPA 通常会伴随着大大增加的在线应用复杂程度。</p>
<h2>2. 渐进式增强</h2>
<p><strong>渐进式增强，即 Progressive Enhancement，强调的是可访问性，即允许不同能力的设备都能够访问网页的基本内容，使用网页的基本功能；但是，当用户使用更加先进的设备时，它能够给用户带来更强大的功能和更好的体验。</strong></p>
<p>举一个小例子，对于非常极端和基础的设备，网页可以只加载 HTML；更高级一点的设备，则可以加载 CSS；而对于多数高级设备，则还需加载 JavaScript。这三种设备都可以使用网站的核心功能，但是只有最后一类设备可以使用全部功能。当然，实际的增强效果递进未必会那么极端，对于每一个递进，可以只是部分样式，部分标签，部分脚本等等。</p>
<p>渐进式增强的理念不仅仅可以对不同设备的访问带来普适性，对低端设备的访问更为友好，它还有一些其它优势。比如说，立足于网页基础的 HTML，可以让网页对于搜索引擎更加友好，因为 CSS 样式和 JavaScript 行为不一定能被搜索引擎解释执行并收录。</p>
<p>在这个过程中，HTML 的语义化变得越来越重要。语义化，指的就是让 HTML 页面体现出内容的结构性，即让 HTML 具备自解释能力，而不是一堆冷冰冰的缺乏语义的标签。你看下面的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;article&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;h1&gt;Article Title&lt;/h1&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;p&gt;This is the content. Please read &lt;em&gt;carefully&lt;/em&gt;.&lt;/p&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/article&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>其中的 article 标签，就是具备语义的，表示着其中的内容是一篇文章，我们当然可以使用没有语义的 div 标签来代替，但 article 标签可以让阅读代码的人，浏览器，以及搜索引擎理解这部分的内容。h1 标签表示标题，p 标签表示段落，而其中的 em 标签表示的是需要强调（如果想使用无语义的标签，可以使用斜体标签 i 来代替），这些用在这里都是具备恰当语义的。</p>
<p><strong>和渐进式增强一起谈论的，还有一个相反过程的设计理念，叫做优雅降级，Graceful Degradation，本质上它们说的是一个事儿。</strong></p>
<p>优雅降级指的是，当高级特性和增强内容无法在用户的设备上展现的时候，依然能够给用户提供一个具备基本功能的，可以工作的应用版本。值得注意的是，优雅降级并非一定发生在用户设备的能力不匹配时，还有可能发生在服务器端资源出现瓶颈的时候，比如某些访问量特别大或者系统出现问题的时刻，资源紧张，服务端可以关闭某一些次要功能，降低一些用户体验，用几种核心资源来保证基础功能的正常运行。</p>
<p>关于渐进增强和优雅降级，我来举一个 Amazon 网站设计的例子，希望它能帮助你进一步理解。如果你使用先进的 Web 浏览器访问 <a href="https://www.amazon.com/">amazon.com</a>，你会看到完整的功能：</p>
<p><img src="https://static001.geekbang.org/resource/image/e0/6d/e0e9042739354cd257c0a4c5562c1b6d.png" alt=""></p>
<p>点击左上角三横线的菜单图标，你将能看到利用 JavaScript 做出的弹出层的效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/8a/ab/8a0207fda0c53029c7e42fea22163bab.jpg" alt=""></p>
<p>现在，我们点击 Chrome 地址栏的锁图标，点击 Site Settings，在设置中关闭对网站的 JavaScript 支持，刷新页面，显示还差不多。但是如果点击左上角的菜单图标，你就会发现，由于没有了 JavaScript，无法使用弹出层效果，它变成了一个链接，跳转到了商品分类：</p>
<p><img src="https://static001.geekbang.org/resource/image/22/47/22487f4e20e1879283feac0fc757ef47.jpg" alt=""></p>
<p>你看，虽然没有了 JavaScript，遵循这种设计理念，在损失一部分用户体验的情况下 ，你可以继续使用网站，并且可以继续购物，其中的核心功能并没有丢失。</p>
<p>此外，还有一种可以拿来类比的设计理念，叫做<strong>回归增强</strong>，Regressive Enhancement。它要求为系统的特性设定基线，并应用到较老的设备和浏览器中。于是在设计网页特性时，我们可以按照高级设备的能力来进行，但是在实际开发的实施过程中，对于较低级的设备，提供一些其它的替代方法，让它们也模拟支持这些新特性。</p>
<p>比方说，HTML 5 的一些特性在偏老的 IE 浏览器中不支持，那么就可以使用 JavaScript 等替代方案实现出相似的效果。我们提到过的类库 jQuery 就遵循着回归增强的设计理念，在一定程度上屏蔽了不同浏览器的差异性。</p>
<p>举个实际例子，input 标签如果在偏老的浏览器中不支持 placeholder 属性，我们可以利用灰度字体的样式在 input 标签中显示实际内容来模拟这个功能。当用户将输入焦点移到 input 标签中，再将其从 input 中清空，以便用户能输入实际内容。</p>
<p><img src="https://static001.geekbang.org/resource/image/2a/b9/2a2fcffed3b03c5873f069a6c3c6d8b9.jpg" alt=""></p>
<p>无论是渐进式增强、优雅降级，还是回归增强，都是为了在一定程度上照顾更多的不同能力的设备和浏览器，给用户带来“尽量好”的体验。但是我们在应用这样的设计理念时，需要把握这个度，毕竟，它不是无代价的，而是会增加前端设计开发的复杂性。</p>
<h2>3. 响应式布局</h2>
<p>响应式网页设计，即 RWD，Responsive Web Design，也有称之为<strong>自适应性网页设计</strong>，Adaptive Web Design，是一种网页设计方法，<strong>目的是使得同一份网页，在不同的设备上有合适的展现。</strong>几乎页面上所有的元素都可以遵循响应式布局，在不同的设备上产生不同的呈现，包括字体和图像等，但是我们讨论得最多的，却是布局。</p>
<p>我记得我刚参加工作的那几年，我们对于同一个页面在不同设备上的展示，考虑的最多的问题还是终端适配，并且这种适配还是基于协议的。例如，服务端是返回 Web 页面，<a href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%BA%BF%E5%BA%94%E7%94%A8%E5%8D%8F%E8%AE%AE">WAP</a> 1.0 页面（WML 语言描述），还是 WAP 2.0 页面（XHTML 语言描述）？那时候我们还很难去谈论用户体验有多么“合适”，对于这些低端的移动设备，我们充其量只能关心功能的实现是否能保证。</p>
<p>这部分，我们改变一下学习策略，来动动手，实现下简单的响应式布局页面。假如说我们需要实现一个具有 header、footer 的页面，并且他们需要填满宽度。而中间的主页面部分采用三列布局，左边列定宽，右边列也定宽，中间列宽度自由设置，但是要保证这三列排列起来也填满浏览器的宽度。</p>
<p>在往下阅读之前，你能否先想想，这该如何实现？</p>
<p>现在，我们在任意的工作文件夹下建立一个 responsive layout.html 文件，填写如下内容：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;!DOCTYPE html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;html&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;head&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;link href="style.css" type="text/css" rel="stylesheet"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/head&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;header&gt;header&lt;/header&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;aside class="left"&gt;aside&lt;/aside&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;aside class="right"&gt;aside&lt;/aside&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;main class="middle"&gt;main&lt;/main&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;footer&gt;footer&lt;/footer&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/body&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/html&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这个文件结构是很简单的，但是具备了我们所需要的要素，包括 header、中间三列以及 footer。这个页面将引入 style.css，因此，我们在同一目录下，建立 style.css：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       * {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        height: 100px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 10px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       header, footer {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: YELLOW;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       main {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: BLUE;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       aside {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        background-color: GREEN;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .left {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: left;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 20px 230px 20px 230px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: right;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我来简单解读一下这个 CSS 文件。为了演示效果，所有的 DOM 对象都具备 100px 的高度，左边栏向左侧浮动排列，右边栏向右侧浮动排列，中间一列使用 margin 的方式给左右边栏留足位置。在排列这三列时，DOM 的顺序是左边栏 - 右边栏 - 中间栏，原因是，左右边栏是浮动样式，需要给他们排好以后，中间栏位无浮动，自动填满所有剩余空间。</p>
<p>看看效果吧，你可以拖动浏览器的边界，调整窗口的宽度，来模拟不同宽度的浏览器窗口下的效果。在较宽的浏览器下，它是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/2f/da/2f070ea33f80d6baf856b1c5e8238ada.jpg" alt=""></p>
<p>而在较窄的浏览器下，它是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/69/5c/6985655142435ed1b24352d0d1ea885c.jpg" alt=""></p>
<p>注意这里的图片有缩放，但是每个矩形的高度实际上都是 100px。也就是说，中间蓝色的区域可以根据实际的宽度需要进行自适应的横向缩放，但是布局始终保持填满浏览器的宽度，也就是说，绿色的部分，始终是固定不变的。</p>
<p>但是，这样的显示有一个问题，在屏幕宽度较小时，比如手机屏幕，中间的蓝色区域会被挤得看不见。因此，我们希望在浏览器宽度小到一定程度的时候，显示成多行格式，而不进行左中右栏位的划分了，即从上到下包含 5 行：header、left aside、main、right aside 和 footer。</p>
<p>那么，这又该怎么实现？</p>
<p>其实也不难，我们需要先在 HTML 的头部增加：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这个 meta 标签指定了视口（View Port）的宽度为设备宽度，避免了任何手机端自动缩放的可能，同时也关闭了用户手动缩放的功能，这样网页会更像一个原生 app。</p>
<p>接着，需要把现有的 css 中 .left, .right, .middle 三个样式放到屏幕宽度大于 640px 的条件下启用，而在宽度小于 640px 的条件下，我们将启用另外三组样式，这三组是将现有的三列以行的方式来展示：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       @media screen and (min-width: 640px) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .left {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: left;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: 20px 230px 20px 230px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: 200px;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: right;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       @media screen and (max-width: 640px) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .middle {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        margin: auto;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        .left, .right {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        width: auto;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        float: none;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>完工，我们一起看看效果。调整浏览器的右侧边界，逐渐缩小宽度，直到其低于 640px，你将看到如下效果：</p>
<p><img src="https://static001.geekbang.org/resource/image/84/82/847dfb9c0c534d521bc0351303761382.jpg" alt=""></p>
<h2>总结思考</h2>
<p>今天我们学习了一些网页交互设计的理念，知道了怎样通过渐进式增强来照顾到尽可能多的设备和浏览器，也通过例子实际动手了解了怎样实现网页的响应式布局，希望你有所收获。</p>
<p>现在，我来提两个问题吧：</p>
<ul> 
 <li>在你的实际工作中，是否有考虑过不同能力的设备和浏览器的兼容适配问题，你又是怎样解决这样的问题呢？</li> 
 <li>给你这样几个 HTML 标签，你能否说出哪些是有语义的，哪些是无语义的呢？div、section、span、nav、summary、b。</li> 
</ul>
<p>好，今天就到这里，感谢你的阅读和思考，期待你的打卡！</p>
<h2>扩展阅读</h2>
<ul> 
 <li>【基础】对于 CSS 不熟悉的程序员朋友，可以通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started">MDN 上的 CSS 教程</a>进行系统地学习。</li> 
 <li>文中提到了 SPA 环境下，对于浏览器的前进、后退功能，需要一些特别的技巧才能实现，其中一个技巧就是使用内嵌 iFrame，这个机制的原理在 <a href="http://www.webdeveasy.com/back-button-behavior-on-a-page-with-an-iframe/">Back Button Behavior on a Page With an iframe</a> 这篇文章中有介绍（虽然这个机制本身当时给作者带来的是一个问题而不是一个解决方法），文中还附带了一个可尝试的<a href="http://www.webdeveasy.com/code/back-button-behavior-on-a-page-with-an-iframe/problem/page2.html">小例子</a>，另外的一个技巧我们将在第五章学到。</li> 
 <li>文中介绍了渐进增强和优雅降级的概念，在 <a href="https://www.mavenecommerce.com/2017/10/31/progressive-enhancement-vs-graceful-degradation/">Progressive Enhancement vs Graceful Degradation</a> 这篇文章中，我们可以看到对它的进一步形象的阐释；而 <a href="https://www.zhangxinxu.com/wordpress/2010/04/css-%E6%B8%90%E8%BF%9B%E5%A2%9E%E5%BC%BA%E5%9C%A8web%E5%88%B6%E4%BD%9C%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B/">CSS “渐进增强”在 web 制作中常见应用举例</a>一文则举了几个 CSS 具体应用渐进增强的例子。</li> 
 <li>对于 HTML 语义的介绍，<a href="http://justineo.github.io/slideshows/semantic-html/#/">Semantic HTML</a> 是一个非常好的用于介绍基础知识的胶片。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |31          |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:52:41.977 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.977 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title               |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|-----|----|----|
|31  |1605755959 |1605755959 |1                |zh-hans  |0       |1                             |1      |0      |17丨不一样的体验：交互设计和页面布局 |book |1   |31  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|-----|----|----|

2020-11-19 17:52:41.978 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.979 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title               |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|----|----|
|[unread] |1605755959 |1605755959 |1                |zh-hans  |0       |1                             |1      |0      |17丨不一样的体验：交互设计和页面布局 |1   |31  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|--------------------|----|----|

2020-11-19 17:52:41.983 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779561, created=1605779561, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='17丨不一样的体验：交互设计和页面布局', 
type='book', uid=1, vid=31 where nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.983 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779561, created=1605779561, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='17丨不一样的体验：交互设计和页面布局', 
uid=1, vid=31 where nid=31 
 {executed in 0 msec}
2020-11-19 17:52:41.991 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:41.992 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|31        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/18117fc83d6d8d73056f3ea8b7b87ccc?bkt=en-07c9b0a504a370600a7287672d603ef69afb731282c20e287a58db1a9676332cb31bc9906e07c2c0&fid=3757516097-778750-265111303410177&time=1605755958&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-GfO9sLluS54B1p3%2FAtEEGK4wVas%3D&to=92&size=12071843&sta_dx=12071843&sta_cs=3517&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655925&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12071843&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bca7bb006dd36cb1157846ed65ad986c1ca870a309cf699e21f7089716017e1c18a4d0d6e12a1f4f&sl=76480590&expires=8h&rt=pr&r=974454576&mlogid=7502222776008744968&vbdid=2247232042&fin=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a&bflag=92,34-92&rtype=1&dp-logid=7502222776008744968&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=548236dbf16cf8fadb217f827e29be01a48bf4aeb17f8604&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a |31          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:52:41.997 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/18117fc83d6d8d73056f3ea8b7b87ccc?bkt=en-07c9b0a504a370600a7287672d603ef69afb731282c20e287a58db1a9676332cb31bc9906e07c2c0&fid=3757516097-778750-29014770340781&time=1605779559&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-XqkCqhei00Rcqe9EvZj0AwxFLGU%3D&to=92&size=12071843&sta_dx=12071843&sta_cs=3522&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655925&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12071843&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bca7bb006dd36cb1157846ed65ad986c1ca870a309cf699e21f7089716017e1c18a4d0d6e12a1f4f&sl=76480590&expires=8h&rt=pr&r=558313768&mlogid=7508558321761762701&vbdid=2247232042&fin=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a&bflag=92,34-92&rtype=1&dp-logid=7508558321761762701&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=86348c5ac45f19b1c265433ec447eb4381ba94992be00948&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a', 
revision_id=31 where entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:42.001 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:42.001 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/18117fc83d6d8d73056f3ea8b7b87ccc?bkt=en-07c9b0a504a370600a7287672d603ef69afb731282c20e287a58db1a9676332cb31bc9906e07c2c0&fid=3757516097-778750-265111303410177&time=1605755958&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-GfO9sLluS54B1p3%2FAtEEGK4wVas%3D&to=92&size=12071843&sta_dx=12071843&sta_cs=3517&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655925&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12071843&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bca7bb006dd36cb1157846ed65ad986c1ca870a309cf699e21f7089716017e1c18a4d0d6e12a1f4f&sl=76480590&expires=8h&rt=pr&r=974454576&mlogid=7502222776008744968&vbdid=2247232042&fin=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a&bflag=92,34-92&rtype=1&dp-logid=7502222776008744968&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=548236dbf16cf8fadb217f827e29be01a48bf4aeb17f8604&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a |31          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:52:42.006 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/18117fc83d6d8d73056f3ea8b7b87ccc?bkt=en-07c9b0a504a370600a7287672d603ef69afb731282c20e287a58db1a9676332cb31bc9906e07c2c0&fid=3757516097-778750-29014770340781&time=1605779559&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-XqkCqhei00Rcqe9EvZj0AwxFLGU%3D&to=92&size=12071843&sta_dx=12071843&sta_cs=3522&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655925&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12071843&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bca7bb006dd36cb1157846ed65ad986c1ca870a309cf699e21f7089716017e1c18a4d0d6e12a1f4f&sl=76480590&expires=8h&rt=pr&r=558313768&mlogid=7508558321761762701&vbdid=2247232042&fin=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a&bflag=92,34-92&rtype=1&dp-logid=7508558321761762701&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=86348c5ac45f19b1c265433ec447eb4381ba94992be00948&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=17%E4%B8%A8%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E4%BD%93%E9%AA%8C%EF%BC%9A%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80.m4a', 
revision_id=31 where entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:42.010 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=31 
 {executed in 1 msec}
2020-11-19 17:52:42.011 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |delta |field_comment_format |langcode |revision_id |
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|31        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/61/61/677e8f92.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>xianhai</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-20
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    bootstrap是不是响应式布局的银弹？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>hedeqiang</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-19
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    这篇收获很大
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-18
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    这个适配的问题，我看很多种方案都是先拿到宽度，然后定个数比如是100得到单位长度，然后不管多大分辨率，都可以标准化，老师有没有更好的适配方案，还有现在回头用原生的JS写页面好难受，不知道什么原因赋值不成功，不起作用很难受。
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-18
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     我记得样式和加载不同：有时会听到开发PM抱怨用户用小众型的浏览器，甚至许多都是根本不曾听闻的，导致效果不一致缺东西。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其实这块最大的坑在于有时不知缺啥且做了个性化导致：个性化其实有时导致的兼容性问题。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |31          |
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:52:42.016 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:42.017 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |delta |field_comment_format |langcode |revision_id |
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/61/61/677e8f92.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>xianhai</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-20
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    bootstrap是不是响应式布局的银弹？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>hedeqiang</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-19
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    这篇收获很大
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-18
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    这个适配的问题，我看很多种方案都是先拿到宽度，然后定个数比如是100得到单位长度，然后不管多大分辨率，都可以标准化，老师有没有更好的适配方案，还有现在回头用原生的JS写页面好难受，不知道什么原因赋值不成功，不起作用很难受。
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-18
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     我记得样式和加载不同：有时会听到开发PM抱怨用户用小众型的浏览器，甚至许多都是根本不曾听闻的，导致效果不一致缺东西。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其实这块最大的坑在于有时不知缺啥且做了个性化导致：个性化其实有时导致的兼容性问题。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |31          |
|----------|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:52:42.022 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:42.022 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|31        |book   |0     |zh-hans  |31          |https://static001.geekbang.org/resource/image/35/d2/35bf5835a04ac1888866948314f0cad2.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:52:42.027 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:42.028 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |31          |https://static001.geekbang.org/resource/image/35/d2/35bf5835a04ac1888866948314f0cad2.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:52:42.032 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:42.033 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |31          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:52:42.037 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=31 
 {executed in 0 msec}
2020-11-19 17:52:42.038 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |31          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:52:42.042 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='59024556127114' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:52:42.043 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:11.942 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='59024556127114' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:53:11.942 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:11.943 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('59024556127114', 1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:53:11.943 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('59024556127114', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:53:11.944 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|53            |
|--------------|

2020-11-19 17:53:11.954 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='59024556127114' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:53:11.954 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:12.375 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='59024556127114' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:53:12.376 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:12.377 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('59024556127114', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:53:12.378 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('59024556127114', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:53:12.379 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|54            |
|--------------|

2020-11-19 17:53:12.394 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='59024556127114' 
 {executed in 0 msec}
2020-11-19 17:53:12.395 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|32        |book   |0     |59024556127114   |zh-hans  |32          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:53:12.395 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.396 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|32  |zh-hans  |book |f1365da4-a51d-40c4-87e3-e0d2b0cf925f |32  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:53:12.402 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.402 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |59024556127114   |zh-hans  |32          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:53:12.408 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.409 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|32  |1   |3     |0            |1  |27 |32 |0  |0  |27  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:53:12.415 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=32 
 {executed in 1 msec}
2020-11-19 17:53:12.421 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|32        |<p>你好，我是四火。</p>
<p>我在上一章讲到了 MVC 的原理，今天我来讲讲前端的 MVC 框架。这部分发展很快，它们比后端 MVC 框架出现得更晚，但是社区普遍更活跃。</p>
<p>我们在学习的过程中，需要继续保持深度和广度的均衡，既要对自己熟悉的那一款框架做深入了解，知道它的核心特性，明白其基本实现原理，对于其优劣有自己的想法；也要多了解了解这个技术的百花园，看看别的框架是什么，想想有什么优势和缺点，拓宽视野，为自己能够做出合理的技术选型而打下扎实的基础。</p>
<h2>前端 MVC 的变革</h2>
<p>让我们来回想一下，在 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中，介绍过的 MVC 架构。实际上，我们可以把前端的部分大致归纳到视图层内，可它本身，却还可以按照 MVC 的基本思想继续划分。这个划分，有些遵循着 MVC 两个常见形式之一，有些则遵循着 MVC 的某种变体，比如 MVVM。</p>
<p>我们都知道前端技术的基础是 HTML、CSS 和 JavaScript，可随着技术的发展，它们在前端技术分层中的位置是不断变化的。</p>
<p>在前端技术发展的早期，Ajax 技术尚未被发明或引进，页面是一次性从服务端生成的，即便有视图层的解耦，页面聚合也是在服务端生成的（如果忘记了服务端的页面聚合，请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>）。也就是说，整个页面一旦生成，就可以认为是静态的了。</p><!-- [[[read_end]]] -->
<p>在这种情况下，如果单独把前端代码的组织也按照 MVC 架构来划分，你觉得 HTML 到底算模型层还是视图层？</p>
<ul> 
 <li>有人说 ，是模型层，因为它承载了具备业务含义的文本和图像等资源，是数据模型的载体，它们是前端的血和肉；</li> 
 <li>有人说，是视图层，因为它决定了用户最后看到的样子，至于 CSS，它可以决定展示的“部分”效果，但却不是必须的（即便没有 CSS，页面一样可以展示）。</li> 
</ul>
<p>其实，这两种说法都部分正确。毕竟，如果采用服务端聚合，等浏览器收到了响应报文，从前端的角度来看，模型和呈现实际已经融合在一起了，很难分得清楚。</p>
<p>等到 Ajax 技术成熟，客户端聚合发展起来了，情况忽然就不一样了。代表视图的 HTML 模板和代表数据的 JSON 报文，分别依次抵达浏览器，JavaScript 再把数据和模板聚合起来展示，这时候这个过程的 MVC 分层就很清晰了。</p>
<p>曾经 jQuery 是最流行的 JavaScript 库，但是如今随着前端业务的复杂性剧增，一个单纯的库已经不能很好地解决问题，而框架开始扮演更重要的地位，比如大家常常耳闻的前端新三驾马车 Vue.js, Anuglar 和 React。</p>
<h2>Angular</h2>
<p>对于现代 MVC 框架的介绍，我将用两个框架来举例。前端框架那么多，希望你的学习不仅仅是知识的堆砌，而是可以领会一些有代表性的玩法，能有自己的解读。第一个是 Angular，我们来看看它的几个特性。</p>
<h3>1. 双向绑定</h3>
<p>曾经，写前端代码的时候，数据绑定都是用类似于 <a href="https://jquery.com/">jQuery</a> 绑定的方式来完成的，但是，<strong>有时候视图页面的数值变更和前端模型的数据变更，这两个变更所需的数据绑定是双向的，这就会引发非常啰嗦的状态同步：</strong></p>
<ul> 
 <li><strong>数据对象发生变更以后，要及时更新 DOM 树；</strong></li> 
 <li><strong>用户操作改变 DOM 树以后，要回头更新数据对象。</strong></li> 
</ul>
<p>比方说，在 JavaScript 中有这样一个数据对象，一本书：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       book = {name: "Steve Jobs Biography"}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在 HTML 中有这样的 DOM 元素：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;input id="book-input" type="text" ... /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;label id="book-label" ...&gt;&lt;/label&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们需要把数据绑定到这样的 DOM 对象上去，这样，在数据对象变更的时候，下面这两个 DOM 对象也会得到变更，从而保证一致性：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-input").val(book.name);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-label").text(book.name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>相应地，我们还需要些绑定语句来响应用户对 book-input 这个输入框的变更，同步到 book-label 和 JavaScript 的 book 对象上去：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-input").keydown(function(){
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var data = $(this).val();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $("book-label").text(data);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        book.name = data;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       });
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你可以想象，当这样的关联变更很多的时候，类似的样板代码该有多少，复杂度和恶心程度该有多高。</p>
<p>于是 Angular 跳出来说，让我们来使用双向绑定解决这个问题吧。无论我们“主动”改变模型层的业务对象（book 对象），还是视图层的这个业务对象的展示（input 标签），都可以自动完成模型层和视图层的同步。</p>
<p>实现方法呢，其实只有两步而已。首先模型层需要告知 DOM 受到哪个控制器控制，比如这里的 BookController，然后使用模板的方式来完成从模型到视图的绑定：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;div ng-app ng-controller="BookController"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;input type="text" value="{{book.name}}" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;label&gt;{{book.name}}&lt;/label&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/div&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>接着在 JavaScript 代码中定义控制器 BookController，将业务对象 book 绑定到 $scope 以暴露出去：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function BookController($scope) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $scope.book = {name : "Steve Jobs Biography"};
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这样 label、input 和 $scope.book 这三者就同步了，这三者任一改变，另两者会自动同步，保持一致。<strong>这大大简化了复杂绑定行为的代码，尽可能地将绑定的命令式代码移除出去，而使用声明式代码来完成绑定的关联关系的定义。</strong></p>
<h3>2. 依赖注入</h3>
<p>你可能还记得我们在 <a href="https://time.geekbang.org/column/article/143882">[第 11 讲]</a> 中介绍过依赖注入，在前端，借助 Angular 我们也可以做到，比如下面的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function BookController($scope, $http) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $http.get('/books').success(function(data) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $scope.books = data;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        });
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，无论是 <code>$scope</code> 还是 <code>$http</code> 模块，写业务代码的程序员都不需要关心，只需要直接使用即可，它们被 Angular 管理起来并在此注入。这个方法，是不是很像我们介绍过的 Spring 对对象的管理和注入？</p>
<h3>3. 过滤器</h3>
<p>注意，这是 Angular 的过滤器，并不是我们之前讲到的 Servlet Filter。</p>
<p>过滤器是个很有趣的特性，让人想起了管道编程。你大概也发现 Angular 真是一个到处“抄袭”，哦不，是“借鉴”各种概念和范型的东西，比如依赖注入抄 Spring，标签定义抄 Flex，过滤器抄 Linux 的管道。从一定角度来说，还是那句话，技术都是相通的。比如：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       {{ book.name | uppercase | replace:' ':'_' }}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这就是把书名全转成大写，再把空格用下划线替换。我觉得这”管道“用得就很酷了。<strong>它的一大意义是，业务对象到视图对象的转换，被这样简单而清晰的方式精巧地解决了。</strong></p>
<h2>React + Redux</h2>
<p>这两个放到一起说，是因为 <a href="https://reactjs.org/">React</a> 其实只是一个用户界面的库，它的组件化做得特别出色，但本身的贡献主要还是在视图层；而 <a href="https://redux.js.org/">Redux</a> 是一个 JavaScript 状态容器，提供可预测的状态管理能力。有了 Redux，才能谈整个 MVC 框架。</p>
<h3>1. JSX</h3>
<p>没有 JSX 的话 React 也能工作，但是如果没有 JSX，React 会变得索然无味许多，JSX 是 React 带来的最有变革意义的部分。比如这样一个简单的 JSX 文件：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       class BookInfo extends React.Component {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        render() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return (
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;div&gt;{this.props.name}&lt;/div&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        );
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       ReactDOM.render(
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;BookInfo name="Steve Jobs Biography" /&gt;,
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        document.getElementById('book-info')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       );
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>前半部分定义了一个输出图书信息的组件 BookInfo，内容很容易理解；后半部分则是将这个组件渲染到指定的 DOM 节点上。&lt;div&gt;{this.props.name}&lt;/div&gt; 这个东西，如果你初次见到，可能会感到新奇：</p>
<ul> 
 <li>看起来像是 HTML，可是居然放在 JavaScript 代码里返回了；</li> 
 <li>也没有使用双引号，因此看起来也不像是单纯的字符串。</li> 
</ul>
<p>没错，它二者都不是，而是 JavaScript 的一种语法扩展。</p>
<p>我们总在说解耦，于是我们把用于呈现的模板放到 HTML 里，把和模板有关的交互逻辑和数据准备放到 JavaScript 里（这被称为“标记和逻辑的分离”）。</p>
<p>可是越来越多的程序员发现，<strong>这样的解耦未必总能带来“简化”，原因就在呈现模板本身，还有为了最终呈现而写的渲染逻辑，二者有着紧密的联系，脱离开模板本身的渲染逻辑，没有存在的价值，也难以被阅读和理解。</strong></p>
<p>既然这样，那为什么还要把它们分开呢？</p>
<p>原来，它们分开的原因并不仅仅是为了分层解耦本身，还因为当时承载技术发展的限制。还记得我们谈到过的声明式和命令式代码的区别吗？两种不同的编程范式，由于技术等种种限制，就仿佛井水不犯河水，二者采用的技术是分别发展的。</p>
<p>如今，大胆的 JSX 反其道而行，把呈现和渲染逻辑放在了一起，并且，它还没有丢掉二者自身的优点。比如说，整体看 JSX 内跑的是 JavaScript 代码，但是嵌入在 JSX 中的 HTML 标签依然可以以它原生的结构存放，支持 JSX 的开发工具也可以实时编译并告知 HTML 标签内的错误。换言之，JSX 中的“HTML 标签”它依然是具有结构属性的 HTML，而不是普通字符串！</p>
<p>并且，这两者放到一起以后，带来了除了内聚性增强以外的其它好处。比如说，测试更加方便，所有的呈现代码都可以作为 JavaScript 的一部分进行测试了，这大大简化了原本需要针对 HTML 而进行单独的打桩、替换、变化捕获而变得复杂的测试过程。</p>
<h3>2. Redux 对状态的管理</h3>
<p>复杂前端程序的一大难题是对于状态的管理，本质上这种状态的不可预知性是由前端天然的事件驱动模型造成的（如有遗忘，请回看 <a href="https://time.geekbang.org/column/article/145875">[第 14 讲]</a>），它试图用一种统一的模式和机制来简化状态管理的复杂性，达到复杂系统状态变化“可预测”的目的。</p>
<p>下面我通过一个最简单的例子，结合图示，来把这个大致过程讲清楚。</p>
<p><img src="https://static001.geekbang.org/resource/image/01/f8/0156ed94391b73d3e2fb79c5956802f8.png" alt=""></p>
<p>首先，最核心的部分，是图中右侧是 Store，它是唯一一个存储状态的数据来源，要获知整个系统的状态，只要把握住 Store 的状态就可以了。假设一开始存放了两本书。</p>
<p>在图中的最下方，由 View 来展现数据，这部分我们已经很熟悉了，根据 Store 的状态，视图会展示相应的内容。一旦 Store 的状态有了更新，View 上会体现出来，这个数据绑定后的同步由框架完成。一开始，展示的是书的数量 2。</p>
<p>这时，用户在 View 上点击了一个添加书本的按钮，一个如下添加书本的 Action 对象生成，发送（dispatch）给 Reducer：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       { type: 'ADD_BOOK', amount: 1 }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>Reducer 根据 Action 和 Store 中老的状态，来生成新的状态。它接收两个参数，一个是当前 Store 中的状态 state，再一个就是上面的这个 action，返回新的 state：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       (state = 0, action) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        switch (action.type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        case 'ADD_BOOK':
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return state + action.amount;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        default: 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return state;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       };
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>于是，Store 中的 state 由 2 变成了 3，相应地，View 展示的图书数量也得到了更新。</p>
<p>那为什么 Redux 能将复杂的状态简化？我觉得有这么几个原因：</p>
<ul> 
 <li>整个流程中<strong>数据是单向流动的，状态被隔离，严格地管理起来了</strong>，只有 Store 有状态，这就避免了散落的状态混乱而互相影响。</li> 
 <li>无论多么复杂的 View 上的操作或者事件，都会统一转换成若干个 Redux 系统能够识别的 Action。换句话说，<strong>不同的操作，只不过引起 Action 的 type 不同，或者上面承载的业务数据不同。</strong></li> 
 <li>Reducer 是无状态的，它是一个纯函数，但它的职责是根据 Action 和 Store 中老的状态来生成新的状态。这样，<strong>Store 中状态的改变也只有一个来源，就是 Reducer 的操作。</strong></li> 
</ul>
<h2>总结思考</h2>
<p>今天我们学习了从前端的角度怎样理解 MVC 架构，特别学习了 Angular 和 React + Redux 两个实际框架的具有代表性的特性。</p>
<p>下面，留两个思考题给你：</p>
<p><strong>问题一：</strong>你在项目中是否使用过前端 MVC 框架，你觉得它带来了什么好处和坏处？</p>
<p><strong>问题二：</strong>案例判断。</p>
<p>我们曾经学过要解耦，把行为从 HTML 中分离出去，比如这样的代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;img onclick="setImage()"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们说它“不好”，因为点击行为和视图展现耦合在一起了，因此我们使用 jQuery 等工具在 JavaScript 中完成绑定，才最终把它移除出去，完成了“解耦”。</p>
<p>可是，作为现代的 JavaScript 框架，Angular 却又让类似的代码回来了：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;img ng-click="setImage()"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>对此，你怎么看，你觉得它会让代码结构和层次变得更好，还是更糟？</p>
<p>好，今天就到这里，欢迎你打卡，把你的总结或者思考题的答案，分享到留言区，我们一起讨论。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>和其它技术相比，<a href="https://angular.cn/">Angular 的中文站</a>做得非常出色，关于 Angular 的中文教程到上面去找就好了。</li> 
 <li>对于 React 的学习，<a href="https://zh-hans.reactjs.org/docs/getting-started.html">官方的中文翻译文档</a>是非常适合的起点；对于 Redux 的学习，请参考 <a href="https://cn.redux.js.org/">Redux 中文文档</a>。</li> 
 <li>【基础】文中提到了 jQuery，我相信很多前端程序员对它很熟悉了，它在前端开发中的地位无可替代，它是如此之好用和通用，以至于让一些程序员患上了“jQuery 依赖症”，离开了它就不会写 JavaScript 来操纵 DOM 了。我们当然不鼓励任何形式的“依赖症”，但我们确实需要学好 jQuery，廖雪峰的网站上有一个<a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023022609723552">简短的入门</a>。</li> 
 <li><a href="https://github.com/GoogleChrome/devtools-docs/blob/master/docs/commandline-api.md">Chrome 开发者工具的命令行 API</a>，熟知其中的一些常用命令，可以非常方便地在 Chrome 中定位前端问题，其中选择器的语法和 jQuery 非常相似。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |32          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:53:12.424 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.430 INFO  jdbc.resultsettable Line:610 - 
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>我在上一章讲到了 MVC 的原理，今天我来讲讲前端的 MVC 框架。这部分发展很快，它们比后端 MVC 框架出现得更晚，但是社区普遍更活跃。</p>
<p>我们在学习的过程中，需要继续保持深度和广度的均衡，既要对自己熟悉的那一款框架做深入了解，知道它的核心特性，明白其基本实现原理，对于其优劣有自己的想法；也要多了解了解这个技术的百花园，看看别的框架是什么，想想有什么优势和缺点，拓宽视野，为自己能够做出合理的技术选型而打下扎实的基础。</p>
<h2>前端 MVC 的变革</h2>
<p>让我们来回想一下，在 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中，介绍过的 MVC 架构。实际上，我们可以把前端的部分大致归纳到视图层内，可它本身，却还可以按照 MVC 的基本思想继续划分。这个划分，有些遵循着 MVC 两个常见形式之一，有些则遵循着 MVC 的某种变体，比如 MVVM。</p>
<p>我们都知道前端技术的基础是 HTML、CSS 和 JavaScript，可随着技术的发展，它们在前端技术分层中的位置是不断变化的。</p>
<p>在前端技术发展的早期，Ajax 技术尚未被发明或引进，页面是一次性从服务端生成的，即便有视图层的解耦，页面聚合也是在服务端生成的（如果忘记了服务端的页面聚合，请回看 <a href="https://time.geekbang.org/column/article/141817">[第 09 讲]</a>）。也就是说，整个页面一旦生成，就可以认为是静态的了。</p><!-- [[[read_end]]] -->
<p>在这种情况下，如果单独把前端代码的组织也按照 MVC 架构来划分，你觉得 HTML 到底算模型层还是视图层？</p>
<ul> 
 <li>有人说 ，是模型层，因为它承载了具备业务含义的文本和图像等资源，是数据模型的载体，它们是前端的血和肉；</li> 
 <li>有人说，是视图层，因为它决定了用户最后看到的样子，至于 CSS，它可以决定展示的“部分”效果，但却不是必须的（即便没有 CSS，页面一样可以展示）。</li> 
</ul>
<p>其实，这两种说法都部分正确。毕竟，如果采用服务端聚合，等浏览器收到了响应报文，从前端的角度来看，模型和呈现实际已经融合在一起了，很难分得清楚。</p>
<p>等到 Ajax 技术成熟，客户端聚合发展起来了，情况忽然就不一样了。代表视图的 HTML 模板和代表数据的 JSON 报文，分别依次抵达浏览器，JavaScript 再把数据和模板聚合起来展示，这时候这个过程的 MVC 分层就很清晰了。</p>
<p>曾经 jQuery 是最流行的 JavaScript 库，但是如今随着前端业务的复杂性剧增，一个单纯的库已经不能很好地解决问题，而框架开始扮演更重要的地位，比如大家常常耳闻的前端新三驾马车 Vue.js, Anuglar 和 React。</p>
<h2>Angular</h2>
<p>对于现代 MVC 框架的介绍，我将用两个框架来举例。前端框架那么多，希望你的学习不仅仅是知识的堆砌，而是可以领会一些有代表性的玩法，能有自己的解读。第一个是 Angular，我们来看看它的几个特性。</p>
<h3>1. 双向绑定</h3>
<p>曾经，写前端代码的时候，数据绑定都是用类似于 <a href="https://jquery.com/">jQuery</a> 绑定的方式来完成的，但是，<strong>有时候视图页面的数值变更和前端模型的数据变更，这两个变更所需的数据绑定是双向的，这就会引发非常啰嗦的状态同步：</strong></p>
<ul> 
 <li><strong>数据对象发生变更以后，要及时更新 DOM 树；</strong></li> 
 <li><strong>用户操作改变 DOM 树以后，要回头更新数据对象。</strong></li> 
</ul>
<p>比方说，在 JavaScript 中有这样一个数据对象，一本书：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       book = {name: "Steve Jobs Biography"}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在 HTML 中有这样的 DOM 元素：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;input id="book-input" type="text" ... /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;label id="book-label" ...&gt;&lt;/label&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们需要把数据绑定到这样的 DOM 对象上去，这样，在数据对象变更的时候，下面这两个 DOM 对象也会得到变更，从而保证一致性：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-input").val(book.name);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-label").text(book.name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>相应地，我们还需要些绑定语句来响应用户对 book-input 这个输入框的变更，同步到 book-label 和 JavaScript 的 book 对象上去：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       $("#book-input").keydown(function(){
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        var data = $(this).val();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $("book-label").text(data);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        book.name = data;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       });
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你可以想象，当这样的关联变更很多的时候，类似的样板代码该有多少，复杂度和恶心程度该有多高。</p>
<p>于是 Angular 跳出来说，让我们来使用双向绑定解决这个问题吧。无论我们“主动”改变模型层的业务对象（book 对象），还是视图层的这个业务对象的展示（input 标签），都可以自动完成模型层和视图层的同步。</p>
<p>实现方法呢，其实只有两步而已。首先模型层需要告知 DOM 受到哪个控制器控制，比如这里的 BookController，然后使用模板的方式来完成从模型到视图的绑定：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;div ng-app ng-controller="BookController"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;input type="text" value="{{book.name}}" /&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;label&gt;{{book.name}}&lt;/label&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/div&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>接着在 JavaScript 代码中定义控制器 BookController，将业务对象 book 绑定到 $scope 以暴露出去：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function BookController($scope) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $scope.book = {name : "Steve Jobs Biography"};
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这样 label、input 和 $scope.book 这三者就同步了，这三者任一改变，另两者会自动同步，保持一致。<strong>这大大简化了复杂绑定行为的代码，尽可能地将绑定的命令式代码移除出去，而使用声明式代码来完成绑定的关联关系的定义。</strong></p>
<h3>2. 依赖注入</h3>
<p>你可能还记得我们在 <a href="https://time.geekbang.org/column/article/143882">[第 11 讲]</a> 中介绍过依赖注入，在前端，借助 Angular 我们也可以做到，比如下面的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function BookController($scope, $http) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $http.get('/books').success(function(data) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        $scope.books = data;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        });
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，无论是 <code>$scope</code> 还是 <code>$http</code> 模块，写业务代码的程序员都不需要关心，只需要直接使用即可，它们被 Angular 管理起来并在此注入。这个方法，是不是很像我们介绍过的 Spring 对对象的管理和注入？</p>
<h3>3. 过滤器</h3>
<p>注意，这是 Angular 的过滤器，并不是我们之前讲到的 Servlet Filter。</p>
<p>过滤器是个很有趣的特性，让人想起了管道编程。你大概也发现 Angular 真是一个到处“抄袭”，哦不，是“借鉴”各种概念和范型的东西，比如依赖注入抄 Spring，标签定义抄 Flex，过滤器抄 Linux 的管道。从一定角度来说，还是那句话，技术都是相通的。比如：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       {{ book.name | uppercase | replace:' ':'_' }}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这就是把书名全转成大写，再把空格用下划线替换。我觉得这”管道“用得就很酷了。<strong>它的一大意义是，业务对象到视图对象的转换，被这样简单而清晰的方式精巧地解决了。</strong></p>
<h2>React + Redux</h2>
<p>这两个放到一起说，是因为 <a href="https://reactjs.org/">React</a> 其实只是一个用户界面的库，它的组件化做得特别出色，但本身的贡献主要还是在视图层；而 <a href="https://redux.js.org/">Redux</a> 是一个 JavaScript 状态容器，提供可预测的状态管理能力。有了 Redux，才能谈整个 MVC 框架。</p>
<h3>1. JSX</h3>
<p>没有 JSX 的话 React 也能工作，但是如果没有 JSX，React 会变得索然无味许多，JSX 是 React 带来的最有变革意义的部分。比如这样一个简单的 JSX 文件：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       class BookInfo extends React.Component {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        render() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return (
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;div&gt;{this.props.name}&lt;/div&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        );
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       ReactDOM.render(
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;BookInfo name="Steve Jobs Biography" /&gt;,
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        document.getElementById('book-info')
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       );
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>前半部分定义了一个输出图书信息的组件 BookInfo，内容很容易理解；后半部分则是将这个组件渲染到指定的 DOM 节点上。&lt;div&gt;{this.props.name}&lt;/div&gt; 这个东西，如果你初次见到，可能会感到新奇：</p>
<ul> 
 <li>看起来像是 HTML，可是居然放在 JavaScript 代码里返回了；</li> 
 <li>也没有使用双引号，因此看起来也不像是单纯的字符串。</li> 
</ul>
<p>没错，它二者都不是，而是 JavaScript 的一种语法扩展。</p>
<p>我们总在说解耦，于是我们把用于呈现的模板放到 HTML 里，把和模板有关的交互逻辑和数据准备放到 JavaScript 里（这被称为“标记和逻辑的分离”）。</p>
<p>可是越来越多的程序员发现，<strong>这样的解耦未必总能带来“简化”，原因就在呈现模板本身，还有为了最终呈现而写的渲染逻辑，二者有着紧密的联系，脱离开模板本身的渲染逻辑，没有存在的价值，也难以被阅读和理解。</strong></p>
<p>既然这样，那为什么还要把它们分开呢？</p>
<p>原来，它们分开的原因并不仅仅是为了分层解耦本身，还因为当时承载技术发展的限制。还记得我们谈到过的声明式和命令式代码的区别吗？两种不同的编程范式，由于技术等种种限制，就仿佛井水不犯河水，二者采用的技术是分别发展的。</p>
<p>如今，大胆的 JSX 反其道而行，把呈现和渲染逻辑放在了一起，并且，它还没有丢掉二者自身的优点。比如说，整体看 JSX 内跑的是 JavaScript 代码，但是嵌入在 JSX 中的 HTML 标签依然可以以它原生的结构存放，支持 JSX 的开发工具也可以实时编译并告知 HTML 标签内的错误。换言之，JSX 中的“HTML 标签”它依然是具有结构属性的 HTML，而不是普通字符串！</p>
<p>并且，这两者放到一起以后，带来了除了内聚性增强以外的其它好处。比如说，测试更加方便，所有的呈现代码都可以作为 JavaScript 的一部分进行测试了，这大大简化了原本需要针对 HTML 而进行单独的打桩、替换、变化捕获而变得复杂的测试过程。</p>
<h3>2. Redux 对状态的管理</h3>
<p>复杂前端程序的一大难题是对于状态的管理，本质上这种状态的不可预知性是由前端天然的事件驱动模型造成的（如有遗忘，请回看 <a href="https://time.geekbang.org/column/article/145875">[第 14 讲]</a>），它试图用一种统一的模式和机制来简化状态管理的复杂性，达到复杂系统状态变化“可预测”的目的。</p>
<p>下面我通过一个最简单的例子，结合图示，来把这个大致过程讲清楚。</p>
<p><img src="https://static001.geekbang.org/resource/image/01/f8/0156ed94391b73d3e2fb79c5956802f8.png" alt=""></p>
<p>首先，最核心的部分，是图中右侧是 Store，它是唯一一个存储状态的数据来源，要获知整个系统的状态，只要把握住 Store 的状态就可以了。假设一开始存放了两本书。</p>
<p>在图中的最下方，由 View 来展现数据，这部分我们已经很熟悉了，根据 Store 的状态，视图会展示相应的内容。一旦 Store 的状态有了更新，View 上会体现出来，这个数据绑定后的同步由框架完成。一开始，展示的是书的数量 2。</p>
<p>这时，用户在 View 上点击了一个添加书本的按钮，一个如下添加书本的 Action 对象生成，发送（dispatch）给 Reducer：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       { type: 'ADD_BOOK', amount: 1 }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>Reducer 根据 Action 和 Store 中老的状态，来生成新的状态。它接收两个参数，一个是当前 Store 中的状态 state，再一个就是上面的这个 action，返回新的 state：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       (state = 0, action) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        switch (action.type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        case 'ADD_BOOK':
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return state + action.amount;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        default: 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return state;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       };
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>于是，Store 中的 state 由 2 变成了 3，相应地，View 展示的图书数量也得到了更新。</p>
<p>那为什么 Redux 能将复杂的状态简化？我觉得有这么几个原因：</p>
<ul> 
 <li>整个流程中<strong>数据是单向流动的，状态被隔离，严格地管理起来了</strong>，只有 Store 有状态，这就避免了散落的状态混乱而互相影响。</li> 
 <li>无论多么复杂的 View 上的操作或者事件，都会统一转换成若干个 Redux 系统能够识别的 Action。换句话说，<strong>不同的操作，只不过引起 Action 的 type 不同，或者上面承载的业务数据不同。</strong></li> 
 <li>Reducer 是无状态的，它是一个纯函数，但它的职责是根据 Action 和 Store 中老的状态来生成新的状态。这样，<strong>Store 中状态的改变也只有一个来源，就是 Reducer 的操作。</strong></li> 
</ul>
<h2>总结思考</h2>
<p>今天我们学习了从前端的角度怎样理解 MVC 架构，特别学习了 Angular 和 React + Redux 两个实际框架的具有代表性的特性。</p>
<p>下面，留两个思考题给你：</p>
<p><strong>问题一：</strong>你在项目中是否使用过前端 MVC 框架，你觉得它带来了什么好处和坏处？</p>
<p><strong>问题二：</strong>案例判断。</p>
<p>我们曾经学过要解耦，把行为从 HTML 中分离出去，比如这样的代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;img onclick="setImage()"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们说它“不好”，因为点击行为和视图展现耦合在一起了，因此我们使用 jQuery 等工具在 JavaScript 中完成绑定，才最终把它移除出去，完成了“解耦”。</p>
<p>可是，作为现代的 JavaScript 框架，Angular 却又让类似的代码回来了：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;img ng-click="setImage()"&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>对此，你怎么看，你觉得它会让代码结构和层次变得更好，还是更糟？</p>
<p>好，今天就到这里，欢迎你打卡，把你的总结或者思考题的答案，分享到留言区，我们一起讨论。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>和其它技术相比，<a href="https://angular.cn/">Angular 的中文站</a>做得非常出色，关于 Angular 的中文教程到上面去找就好了。</li> 
 <li>对于 React 的学习，<a href="https://zh-hans.reactjs.org/docs/getting-started.html">官方的中文翻译文档</a>是非常适合的起点；对于 Redux 的学习，请参考 <a href="https://cn.redux.js.org/">Redux 中文文档</a>。</li> 
 <li>【基础】文中提到了 jQuery，我相信很多前端程序员对它很熟悉了，它在前端开发中的地位无可替代，它是如此之好用和通用，以至于让一些程序员患上了“jQuery 依赖症”，离开了它就不会写 JavaScript 来操纵 DOM 了。我们当然不鼓励任何形式的“依赖症”，但我们确实需要学好 jQuery，廖雪峰的网站上有一个<a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023022609723552">简短的入门</a>。</li> 
 <li><a href="https://github.com/GoogleChrome/devtools-docs/blob/master/docs/commandline-api.md">Chrome 开发者工具的命令行 API</a>，熟知其中的一些常用命令，可以非常方便地在 Chrome 中定位前端问题，其中选择器的语法和 jQuery 非常相似。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |32          |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:53:12.445 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.445 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|
|32  |1605755989 |1605755989 |1                |zh-hans  |0       |1                             |1      |0      |16丨百花齐放，百家争鸣：前端MVC框架 |book |1   |32  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|-----|----|----|

2020-11-19 17:53:12.446 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.447 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|
|[unread] |1605755989 |1605755989 |1                |zh-hans  |0       |1                             |1      |0      |16丨百花齐放，百家争鸣：前端MVC框架 |1   |32  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------------|----|----|

2020-11-19 17:53:12.451 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779592, created=1605779592, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='16丨百花齐放，百家争鸣：前端MVC框架', 
type='book', uid=1, vid=32 where nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.451 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779592, created=1605779592, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='16丨百花齐放，百家争鸣：前端MVC框架', 
uid=1, vid=32 where nid=32 
 {executed in 0 msec}
2020-11-19 17:53:12.458 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.459 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|32        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/167f01c074a5e43a3ffa0bc7e30abaac?bkt=en-1df98aeb722e81f5fd9728eea3da5c53a6033cdbcc8b08a33f91c00739a5522f176c20e710c35c1a&fid=3757516097-778750-354593317304736&time=1605755988&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-aR6R0jxuVMf6Jk4LNlxJsgOOmOc%3D&to=92&size=13083973&sta_dx=13083973&sta_cs=3508&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655930&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=13083973&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-3b065a773e80f5a54c9031abf07dc9714c7e208afebeb081897be497934d051b2f64dde8bb036c4c&sl=76480590&expires=8h&rt=pr&r=368778615&mlogid=7502230955979520612&vbdid=2247232042&fin=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a&bflag=92,34-92&rtype=1&dp-logid=7502230955979520612&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=16c8192e22ea32f59b634a4fe130acd85e6a8d33f251557b&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a |32          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:53:12.463 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/167f01c074a5e43a3ffa0bc7e30abaac?bkt=en-1df98aeb722e81f5fd9728eea3da5c53a6033cdbcc8b08a33f91c00739a5522f176c20e710c35c1a&fid=3757516097-778750-1105085400283298&time=1605779590&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-wjN2GuU%2B8gcziBjmafkof6fyDXY%3D&to=92&size=13083973&sta_dx=13083973&sta_cs=3513&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655930&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=13083973&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-3b065a773e80f5a54c9031abf07dc9714c7e208afebeb081897be497934d051b2f64dde8bb036c4c&sl=76480590&expires=8h&rt=pr&r=254373616&mlogid=7508566525570832124&vbdid=2247232042&fin=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a&bflag=92,34-92&rtype=1&dp-logid=7508566525570832124&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=cdac69781712398022e9121697d0c65ec3e7f8efba161e89305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a', 
revision_id=32 where entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.466 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.467 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/167f01c074a5e43a3ffa0bc7e30abaac?bkt=en-1df98aeb722e81f5fd9728eea3da5c53a6033cdbcc8b08a33f91c00739a5522f176c20e710c35c1a&fid=3757516097-778750-354593317304736&time=1605755988&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-aR6R0jxuVMf6Jk4LNlxJsgOOmOc%3D&to=92&size=13083973&sta_dx=13083973&sta_cs=3508&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655930&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=13083973&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-3b065a773e80f5a54c9031abf07dc9714c7e208afebeb081897be497934d051b2f64dde8bb036c4c&sl=76480590&expires=8h&rt=pr&r=368778615&mlogid=7502230955979520612&vbdid=2247232042&fin=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a&bflag=92,34-92&rtype=1&dp-logid=7502230955979520612&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=16c8192e22ea32f59b634a4fe130acd85e6a8d33f251557b&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a |32          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:53:12.471 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/167f01c074a5e43a3ffa0bc7e30abaac?bkt=en-1df98aeb722e81f5fd9728eea3da5c53a6033cdbcc8b08a33f91c00739a5522f176c20e710c35c1a&fid=3757516097-778750-1105085400283298&time=1605779590&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-wjN2GuU%2B8gcziBjmafkof6fyDXY%3D&to=92&size=13083973&sta_dx=13083973&sta_cs=3513&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571655930&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=13083973&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-3b065a773e80f5a54c9031abf07dc9714c7e208afebeb081897be497934d051b2f64dde8bb036c4c&sl=76480590&expires=8h&rt=pr&r=254373616&mlogid=7508566525570832124&vbdid=2247232042&fin=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a&bflag=92,34-92&rtype=1&dp-logid=7508566525570832124&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=cdac69781712398022e9121697d0c65ec3e7f8efba161e89305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=16%E4%B8%A8%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE%EF%BC%8C%E7%99%BE%E5%AE%B6%E4%BA%89%E9%B8%A3%EF%BC%9A%E5%89%8D%E7%AB%AFMVC%E6%A1%86%E6%9E%B6.m4a', 
revision_id=32 where entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.474 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.476 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|32        |book   |<li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>pyhhou</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-17
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    1. 使用过 React，前端的 MVC 框架的出现带动了整个前端的发展，现在前端可以和后端分离开来设计与实现，对比之前，前端页面的聚合需要后端，这些框架的出现，在大的层面上看也算是进行了一次前后端的解耦吧；不好的地方就是前端的技术变得非常的多，而且杂，并且很多前端技术的生命周期都很短，这增加了普通工程师的学习难度的同时，前端在技术层面上也没有一个大的 “统一”
    <br>
    <br>2. 这让我回想起了我们之前讲过的一个话题，就是 “MVC 框架的控制逻辑的配置是写在单一的文件中，还是利用注解的方式写在控制逻辑处？”，放在这里也是可以类比的，把行为从 HTML 里面分离出去，单独管理，可以使得行为和 HTML 显示分开，达到解耦，同样，以 Angular 这种方式，让行为跟着具体的 HTML 显示模块走，让行为和 HTML 显示对照起来，这也是解耦，只不过前者是代码横向分层解耦，后者是代码纵向分层解耦，不能完全说哪一个好，还是得具体场景，具体分析。
    <br>
    <br>这里有一个小问题，就是上面提到说 “Reducer 是无状态的，它是一个纯函数”，我们上一篇文章中提到纯函数是安全的，也是幂等的，但是这里 Reducer 是会改变 store 的，而且对一个 Reducer 一次调用和多次调用会导致 store 里面的状态变得不一样，或者说我这里是不是误解了什么，还请老师指教
    <br>
    <br>PS: 过滤器标题下面那句话有 typo，Angular 写成了 React
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 第2点讲得非常好，👍。<br>关于你的问题，Reducer返回的是新状态，而不是改变原有状态（新状态会放到这个store里面），这点请注意，你可以参见 https://redux.js.org/basics/reducers#handling-actions。<br>typo 我已经知会编辑修改，感谢！</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">2</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/18/28/d9/78dfd983.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>sky</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    我是直接从使用vue开始前端之路的。总体上来说感觉还是利大于弊的。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/18/28/d9/78dfd983.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>sky</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    三驾马车没有讲vue，老师对这个框架没有什么想说的吗？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>没带就是没写</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    jquery现在已经不流行了，除非是维护老项目。开发比较大的新项目用不到，但是它的理念是很有启发性的，write less,do more.
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我觉得是更好，看到这个我就知道这个被绑定了，找后面的代码处理逻辑也好找。
    <br>JQuery确实是解耦了，你定义好属性，后面各种选择器对应起来，但是感觉不好管理。根据ID我不小心又加了两个逻辑和之前的逻辑有冲突，可能达不到你之前预想。类选择器更是坑爹，可能我只是要个样式而已，结果你还顺便帮忙做了点别的。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    打卡吧：程序的东西学起来太苦了，现在的框架完全不是早年的那些了、、、慢慢实践慢慢补、、、
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/5a/55/411f95a8.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>我叫徐小晋</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    一直以来没有用框架。都是用jquery。。。老师如果要选择一个框架。那个入门会好一点？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |32          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:53:12.482 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=32 
 {executed in 1 msec}
2020-11-19 17:53:12.484 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |delta |field_comment_format |langcode |revision_id |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>pyhhou</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-17
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    1. 使用过 React，前端的 MVC 框架的出现带动了整个前端的发展，现在前端可以和后端分离开来设计与实现，对比之前，前端页面的聚合需要后端，这些框架的出现，在大的层面上看也算是进行了一次前后端的解耦吧；不好的地方就是前端的技术变得非常的多，而且杂，并且很多前端技术的生命周期都很短，这增加了普通工程师的学习难度的同时，前端在技术层面上也没有一个大的 “统一”
    <br>
    <br>2. 这让我回想起了我们之前讲过的一个话题，就是 “MVC 框架的控制逻辑的配置是写在单一的文件中，还是利用注解的方式写在控制逻辑处？”，放在这里也是可以类比的，把行为从 HTML 里面分离出去，单独管理，可以使得行为和 HTML 显示分开，达到解耦，同样，以 Angular 这种方式，让行为跟着具体的 HTML 显示模块走，让行为和 HTML 显示对照起来，这也是解耦，只不过前者是代码横向分层解耦，后者是代码纵向分层解耦，不能完全说哪一个好，还是得具体场景，具体分析。
    <br>
    <br>这里有一个小问题，就是上面提到说 “Reducer 是无状态的，它是一个纯函数”，我们上一篇文章中提到纯函数是安全的，也是幂等的，但是这里 Reducer 是会改变 store 的，而且对一个 Reducer 一次调用和多次调用会导致 store 里面的状态变得不一样，或者说我这里是不是误解了什么，还请老师指教
    <br>
    <br>PS: 过滤器标题下面那句话有 typo，Angular 写成了 React
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 第2点讲得非常好，👍。<br>关于你的问题，Reducer返回的是新状态，而不是改变原有状态（新状态会放到这个store里面），这点请注意，你可以参见 https://redux.js.org/basics/reducers#handling-actions。<br>typo 我已经知会编辑修改，感谢！</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">2</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/18/28/d9/78dfd983.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>sky</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    我是直接从使用vue开始前端之路的。总体上来说感觉还是利大于弊的。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/18/28/d9/78dfd983.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>sky</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-21
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    三驾马车没有讲vue，老师对这个框架没有什么想说的吗？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>没带就是没写</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    jquery现在已经不流行了，除非是维护老项目。开发比较大的新项目用不到，但是它的理念是很有启发性的，write less,do more.
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>靠人品去赢</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我觉得是更好，看到这个我就知道这个被绑定了，找后面的代码处理逻辑也好找。
    <br>JQuery确实是解耦了，你定义好属性，后面各种选择器对应起来，但是感觉不好管理。根据ID我不小心又加了两个逻辑和之前的逻辑有冲突，可能达不到你之前预想。类选择器更是坑爹，可能我只是要个样式而已，结果你还顺便帮忙做了点别的。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    打卡吧：程序的东西学起来太苦了，现在的框架完全不是早年的那些了、、、慢慢实践慢慢补、、、
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/5a/55/411f95a8.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>我叫徐小晋</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-16
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    一直以来没有用框架。都是用jquery。。。老师如果要选择一个框架。那个入门会好一点？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |32          |
|----------|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:53:12.489 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=32 
 {executed in 1 msec}
2020-11-19 17:53:12.489 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|32        |book   |0     |zh-hans  |32          |https://static001.geekbang.org/resource/image/f5/2c/f5808b3f10516b9342e9de07de48fd2c.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:53:12.494 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.495 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |32          |https://static001.geekbang.org/resource/image/f5/2c/f5808b3f10516b9342e9de07de48fd2c.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:53:12.499 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.500 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |32          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:53:12.504 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=32 
 {executed in 0 msec}
2020-11-19 17:53:12.505 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |32          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:53:12.510 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='320295675806015' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:53:12.510 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:42.826 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='320295675806015' 
and bookchecke0_.name='net_content' 
 {executed in 2 msec}
2020-11-19 17:53:42.827 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:42.830 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('320295675806015', 1, 'net_content') 
 {executed in 1 msec}
2020-11-19 17:53:42.831 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('320295675806015', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:53:42.832 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|55            |
|--------------|

2020-11-19 17:53:42.856 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='320295675806015' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:53:42.857 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:43.254 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='320295675806015' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:53:43.255 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:53:43.256 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('320295675806015', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:53:43.257 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('320295675806015', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:53:43.257 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|56            |
|--------------|

2020-11-19 17:53:43.277 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='320295675806015' 
 {executed in 1 msec}
2020-11-19 17:53:43.277 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|33        |book   |0     |320295675806015  |zh-hans  |33          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:53:43.278 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=33 
 {executed in 0 msec}
2020-11-19 17:53:43.279 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|33  |zh-hans  |book |b2ec3831-fd87-4c55-a8d1-79887c60d7ed |33  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:53:43.286 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.287 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |320295675806015  |zh-hans  |33          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:53:43.294 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=33 
 {executed in 1 msec}
2020-11-19 17:53:43.294 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|33  |1   |3     |0            |1  |27 |33 |0  |0  |27  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:53:43.301 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.310 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|33        |<p>你好，我是四火。</p>
<p>JavaScript 的设计和编程能力可以说是前端工程师的修养之一，而 JavaScript 面向对象就是其中的一个重要组成部分。</p>
<p>我相信对于后端开发来说，面向对象的编程能力是一个程序员必须要熟练掌握的基本技能；而对于前端开发，很多项目，甚至在很多知名互联网公司的项目中，很遗憾，这部分都是缺失的，于是我们看到大量的一个一个散落的方法，以及一堆一堆难以理解的全局变量，这对系统的扩展和维护简直是噩梦。</p>
<p>“好的软件质量是设计出来的”，这个设计既包括宏观的架构和组件设计，也包括微观的代码层面的设计。在这一讲中，我们将学习 JavaScript 面向对象的基本知识和技巧，提升代码层面的面向对象设计和编码能力。</p>
<p>首先，我们将通过面向对象的三大特征，结合实例，介绍 JavaScript 面向对象的知识：封装、继承以及多态。</p>
<h2>1. 封装</h2>
<p>在面向对象编程中，封装（Encapsulation）说的是一种通过接口抽象将具体实现包装并隐藏起来的方法。具体来说，封装的机制包括两大部分：</p>
<ul> 
 <li><strong>限制对对象内部组件直接访问的机制；</strong></li> 
 <li><strong>将数据和方法绑定起来，对外提供方法，从而改变对象状态的机制。</strong></li> 
</ul>
<p>在 Java 中，在类中通过 private 或 public 这样的修饰符，能够实现对对象属性或方法不同级别的访问权限控制。但是，在 JavaScript 中并没有这样的关键字，但是，通过一点小的技巧，就能让 JavaScript 代码支持封装。</p><!-- [[[read_end]]] -->
<p>直到 ES6（<a href="http://es6-features.org">ECMAScript 6</a>）以前，类（class）这个概念在 JavaScript 中其实不存在，但是 JavaScript 对函数（function）有着比一般静态语言强大得多的支持，我们经常利用它来模拟类的概念。现在，请你打开 Chrome 的开发者工具，在控制台上贴上如下代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book("Life").name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你将看到控制台输出了 “Life”。从代码中可以看到，name 作为了 Book 这个类的构造函数传入，并赋值给了自己的 name 属性（它和入参 name 重名，但却不是同一个东西）。这样，在使用“Life”作为入参来实例化 Book 对象的时候，就能访问对象的 name 属性并输出了。</p>
<p>但是，这样的 name 属性，其实相当于公有属性，因为外部可以访问到，那么，我们能够实现私有属性吗？当然，请看这段代码 ：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.getName = () =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        };
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.setName = (newName) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        name = newName;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        };
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let book = new Book("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       book.setName("Time");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(book.getName()); // Time
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(book.name); // 无法访问私有属性 name 的值
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>上面的代码中，有两处变化，一个是使用了 () =&gt; {} 这样的语法代替了 function 关键字，使得其定义看起来更加简洁，但是表达的含义依然是函数定义，没有区别；第二个是增加了 getName() 和 setName() 这样的存取方法，并且利用闭包的特性，将 name 封装在 Book 类的对象中，你无法通过任何其它方法访问到私有属性 name 的值。</p>
<p>这里介绍闭包（Closure），我想你应该听说过这个概念。<strong>闭包简单说，就是引用了自由变量的函数。这里的关键是“自由变量”，其实这个自由变量，扮演的作用是为这个函数调用提供了一个“上下文”</strong>，而上下文的不同，将对入参相同的函数调用造成不同的影响，它包括：</p>
<ul> 
 <li>函数的行为不同，即函数调用改变其上下文中的其它变量，如例子中的 setName()；</li> 
 <li>函数的返回值不同，如例子中的 getName()。</li> 
</ul>
<p><strong>和闭包相对的，是一种称为“纯函数”（Pure Function）的东西，即函数不允许引用任何自由变量。</strong>因此，和上面两条“影响”对应，纯函数的调用必须满足如下特性：</p>
<ul> 
 <li>函数的调用不允许改变其所属的上下文；</li> 
 <li>相同入参的函数调用一定能得到相同的返回值。</li> 
</ul>
<p>读到这里，你是否想到了 <a href="https://time.geekbang.org/column/article/136795">[第 04 讲]</a> 中我们将 HTTP 的请求从两个维度进行划分，即是否幂等，是否安全；在 <a href="https://time.geekbang.org/column/article/141679">[第 08 讲]</a> 中我们对 CQRS 依然从这样两个维度进行划分，并作了分析。今天，我们还做相同的划分。</p>
<ul> 
 <li>闭包的调用是不安全的，因为它可能改变对象的内部属性（闭包的上下文）；同时它也不是幂等的，因为一次调用和多次调用可能产生不同的结果。</li> 
 <li>纯函数的调用是安全的，也是幂等的。</li> 
</ul>
<p>于是，我们又一次发现，技术是相通，是可以联想和类比的。<strong>本质上，它们围绕的都是一个方法（函数）是否引用和改变外部状态的问题。</strong>闭包本身是一个很简单的机制，但是，它可以带来丰富的语言高级功能特性，比如<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0">高阶函数</a>。</p>
<h2>2. 继承</h2>
<p>在面向对象编程中，继承（Inheritance）指的是一个对象或者类能够自动保持另一个对象或者类的实现的一种机制。我们经常讲的子类具备父类的所有特性，只是继承中的一种，叫做类继承；其实还有另一种，对象继承，这种继承只需要对象，不需要类。</p>
<p>在 ES6 以前，没有继承（extends）关键字，JavaScript 最常见的继承方式叫做<strong>原型链继承</strong>。原型（prototype）是 JavaScript 函数的一个内置属性，指向另外的一个对象，而那个对象的所有属性和方法，都会被这个函数的所有实例自动继承。</p>
<p>因此，当我们对那个原型指向的对象做出任何改变，这个函数的所有实例也将发生相同的改变。这样原型的设计在常见的静态语言中并不常见。当然，它在实现的效果上和静态语言中的“类属性 / 类方法”有一点儿相似。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Child.prototype = new Base();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c.name); // "Life"
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // true
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // true
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>请看上面的例子，通过将子类 Child 的原型 prototype 设置为父类的对象，就完成了 Child 继承 Base 的关联，之后我们再判断 Child 的对象 c，就发现它也是 Base 的对象。请注意这样两个要点：</p>
<ul> 
 <li>设置 prototype 的语句一定要放到 Base 和 Child 两个构造器之外；</li> 
 <li>并且要放在实例化任何子类之前。</li> 
</ul>
<p>上面这两条原则非常重要，缺一不可。如果违背第一个要点，即把 prototype 的设置放到子类的里面，变成这样：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Child.prototype = new Base();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这是完全错误的，每次 Child 在构建的过程中，原型被破坏并重建一次，这可不只是一个资源浪费、状态丢失的问题。由于原型是实例辨识运算 instanceof 的依据，因此它还会影响 JavaScript 引擎对 instanceof 的判断：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // false
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，c 现在不但不是 Base 的实例，甚至也不是 Child 的了。</p>
<p>还有些程序员违反了上面说的第二个要点，即搞错了顺序：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Child.prototype = new Base();
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>后面的判断也出现了错误：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // false
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>因为 Child 的原型在 c 生成之后发生了破坏并重建，因此无论 Base 还是 Child，都已经和 c 没有关联了。</p>
<p>你再仔细想想的话，你还会发现原型链继承有一个解决不了的问题，即父类的构造方法如果包含参数，就无法被完美地继承下来。比如上例中的 name 构造参数，传入后赋值给对象的操作不得不在子类中重做了一遍。于是，我们引出另一种常见的 JavaScript 实现继承的方式——<strong>构造继承</strong>。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base1(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base2(type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.type = type;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name, type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Base1.call(this, name); // 让 this 去调用 Base1，并传入参数 name
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Base2.call(this, type);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life", "book");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c.name); // "Life"
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base1); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // true
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这种方法就能够保留父类对于构造器参数的处理逻辑，并且，我们居然还不知不觉地实现了<strong>多重继承</strong>！但是，缺点也很明显，使用 instanceof 方法判断的时候，发现子类对象 c 并非父类实例，并且，当父类的 prototype 还有额外属性和方法的时候，它们也无法通过构造继承被自动搬到子类里来。</p>
<h2>3. 多态</h2>
<p>在面向对象编程中，多态（Polymorphism）指的是同样的接口，有着不同的实现。在 JavaScript 中没有用来表示接口的关键字，但是通过在不同实现类中定义同名的方法，我们可以轻易做到多态的效果，即同名方法在不同的类中有不同的实现。而由于没有类型和参数的强约束，它的灵活性远大于 Java 等静态语言。</p>
<h2>理解对象创建</h2>
<p>在对面向对象的三大特征有了一定的理解之后，我们再来看看实际的对象创建。你可能会说，对象创建不是一件很简单的事儿吗，有什么可讲的？</p>
<p>别急，JavaScript 和一般的静态语言在对象创建上有着明显的不同，JavaScript 奇怪的行为特别多，还是让我们来看看吧。</p>
<p>在 Java 等多数静态语言中，是使用 new 关键字加基于类名的方法调用来创建对象，但是如果不使用 new 关键字，只使用基于类名的方法调用，则什么都不是，编译器直接报错。但是 JavaScript 不同，我们对于类的概念完全是通过强大的函数特性来实现的，先看下面这个容易混淆函数调用和对象创建的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book("Life").name); // 输出 Life
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(Book("Life").name); // 也输出 Life
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，在 Book() 中，我们最终返回了 this，这就让它变得模糊，这个 Book() 到底是类的定义，还是普通函数（方法）定义？</p>
<ul> 
 <li>代码中使用 this 关键字来给对象自己赋值，看起来 Book 应该是类，那么 Book() 其实就是类的构造器，而这个赋值是完成对象创建的一部分；</li> 
 <li>可是它居然又有返回（return 语句），那么从这个角度看，Book 应该是普通函数定义，函数调用显式返回了一个对象。</li> 
</ul>
<p>于是，我们从上述最下面的两行代码中看到，无论使用 new 来创建对象，还是不使用 new，把它当成普通方法调用，都能够获得对象 name 属性的值“Life”，因此看起来用不用 new 似乎没有区别嘛？</p>
<p>其实不然，没有区别只是一个假象。JavaScript 是一个特别善于创造错觉的编程语言，有许多古怪无比“坑”等着你去踩，而这只是其中一个。我们要来进一步理解它，就必须去理解代码中的 this，众所周知 this 可以看做是对象对于它自己的引用，那么我们在执行上述两步操作时，this 分别是什么呢？</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log(this);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       new Book("Life"); // 打印 Book {}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Book("Life"); // 打印 Window { ... }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       window.Book("Life") // 打印 Window { ... }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在这段代码中，我在 Book() 内部把 this 打印出来了。原来，在使用 new 的时候，this 是创建的对象自己；而在不使用 new 的时候，this 是浏览器的内置对象 window，并且，这个效果和使用 window 调用 Book() 是一样的。也就是说，<strong>当我们定义了一个“没有归属”的全局函数的时候，这个函数的默认宿主就是 window</strong>。</p>
<p>实际上，上述例子在使用 new 这个关键字的时候，JavaScript 引擎就帮我们做了这样几件事情。</p>
<p>第一件，创建一个 Book 的对象，我们把它叫做 x 吧。<br> 第二件，绑定原型：x.<strong>proto</strong> = Book.prototype。<br> 第三件，指定对象自己：this = x，并调用构造方法，相当于执行了 x.Book()。<br> 第四件，对于构造器中的 return 语句，根据 typeof x === ‘object’ 的结果来决定它实际的返回：</p>
<ul> 
 <li>如果 return 语句返回基本数据类型（如 string、boolean 等），这种情况 typeof x 就不是“object”，那么 new 的时候构造器的返回会被强制指定为 x；</li> 
 <li>如果 return 语句返回其它类型，即对象类型，这种情况 typeof x 就是“object”，那么 new 的时候会遵循构造器的实际 return 语句来返回。</li> 
</ul>
<p>前面三件其实很好理解，我们的试验代码也验证了；但是第四件，简直令人崩溃对不对？这是什么鬼设计，<strong>难道创建对象的时候，还要根据这个 return 值的类型来决定 new 的行为？</strong></p>
<p>很遗憾，说对了……我们来执行下面的代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book1(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return 1;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book1("Life")); // 打印 Book1 {name: "Life"}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book2(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return [];
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book2("Life")); // 打印 []
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，Book1 的构造器返回一个基本数据类型的数值 1，new 返回的就是 Book1 的实例对象本身；而 Book2 的构造器返回一个非基本数值类型 []（数组），new 返回的就是这个数组了。</p>
<p>正是因为这样那样的问题，ES5 开始提供了严格模式（Strict Mode），可以让代码对一些可能造成不良后果的不严谨、有歧义的用法报错。</p>
<p>在实际项目中，我们应当开启严格模式，或是使用 <a href="https://www.typescriptlang.org/">TypeScript</a> 这样的 JavaScript 超集等等替代方案。写 JavaScript 代码的时候，心中要非常明确自己使用 function 的目的，是创建一个类，是创建某个对象的方法，还是创建一个普通的函数，并且在命名的时候，根据项目的约定给予清晰明确的名字，看到名字就立即可以知道它是什么，而不需要联系上下文去推导，甚至猜测。</p>
<p>正确的代码是写给机器看的，但是优秀的代码是写给别的程序员看的。</p>
<h2>总结思考</h2>
<p>今天我们学习了 JavaScript 面向对象的实现方式和相关的重要特性，希望你能够掌握介绍到的知识点，通过思考和吸收，最终可以在项目中写出易于维护的高质量代码。现在，我想提两个问题，请你挑战一下：</p>
<ul> 
 <li>在你经历的项目中，是否使用过面向对象来进行 JavaScript 编码，项目的代码质量是怎样的？</li> 
 <li>和静态语言不同的是，JavaScript 有好多种不同的方式来实现继承效果，除了文中介绍的原型链继承和构造继承以外，你是否还知道其它的 JavaScript 继承实现方式？</li> 
</ul>
<p>好，今天的内容就到这里。欢迎你在留言区和我讨论，也欢迎你把文章分享出去，和朋友一起阅读。</p>
<h2>选修课堂：当函数成为一等公民</h2>
<p>众所周知，有一种经典的学习一门新语言的方法是类比法，比如从 C 迁入 JavaScript 的程序员，就会不由自主地比较这两门语言的语法映射，从而快速掌握新语言的写法。</p>
<p>但是，<strong>仅仅通过语法映射的学习而训练出来的程序员，只是能写出符合 JavaScript 语法的 C 语言而已，本质上写的代码依然是 C</strong>。因此，在类比以外，我们还要思考和使用 JavaScript 不一样的核心特性，比如接下去要介绍的函数“一等公民”地位。</p>
<p>首先，我们需要理解，何为“函数成为一等公民”。这指的是，<strong>函数可以不依附于任何类或对象等实体而独立存在，它可以单独作为参数、变量或返回值在程序中传递。</strong></p>
<p>回想 Java 语言，如果 Book 这个类，有一个方法 getName()，这个方法必须依附于 Book 而存在，一般情况下必须使用 Book 或它的对象才能调用。这就是说，Java 中的函数或方法，无法成为一等公民。可 JavaScript 完全不同了，你可能还记得上文中出现了这样的调用：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Base1.call(this, name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>Base1 实际是一个函数，而函数的宿主对象 this 被当作参数传进去了，后面的 name 则是调用参数，这种以函数为核心的方法调用，在许多传统的静态语言中是很难见到的。我们来看一个更完整的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function getName() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this.name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let book = new Book("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(getName.call(book, getName)); // "Life"
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，同样使用 function 关键字，getName 是函数（方法），Book 是书这个类，实例化得到 book 以后，通过 call 关键字调用，把 book 作为 getName() 的宿主，即其中的 this 传入，得到了我们期望的值“Life”。</p>
<p>上面就是对于函数成为一等公民的一个简单诠释：以往我们只能先指定宿主对象，再来调用函数；现在可以反过来，先指定函数，再来选择宿主对象，完成调用。请注意，函数的调用必须要有宿主对象，如果你使用 null 或者 undefined 这样不存在的对象，window 会取而代之，被指定为默认的宿主对象。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>对于系统地学习 ES 6，推荐阅读阮一峰的翻译作品 <a href="http://es6.ruanyifeng.com/">ECMAScript 6 入门</a>。</li> 
 <li>文中介绍了严格模式（Strict Mode），感兴趣的话可以看看 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode">MDN 的介绍</a>。</li> 
 <li>文章多次提到了静态语言和动态语言，我曾经写过一篇文章<a href="https://www.raychase.net/2310">编程范型：工具的选择</a>，对它们做了介绍，供你参考。</li> 
 <li>对于文中提到的 instanceof 运算符，如果你想了解它是怎样实现的，它和对象原型有何关系，请参阅 <a href="https://www.ibm.com/developerworks/cn/web/1306_jiangjj_jsinstanceof/index.html">JavaScript instanceof 运算符深入剖析</a>。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |33          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:53:43.314 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.322 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>JavaScript 的设计和编程能力可以说是前端工程师的修养之一，而 JavaScript 面向对象就是其中的一个重要组成部分。</p>
<p>我相信对于后端开发来说，面向对象的编程能力是一个程序员必须要熟练掌握的基本技能；而对于前端开发，很多项目，甚至在很多知名互联网公司的项目中，很遗憾，这部分都是缺失的，于是我们看到大量的一个一个散落的方法，以及一堆一堆难以理解的全局变量，这对系统的扩展和维护简直是噩梦。</p>
<p>“好的软件质量是设计出来的”，这个设计既包括宏观的架构和组件设计，也包括微观的代码层面的设计。在这一讲中，我们将学习 JavaScript 面向对象的基本知识和技巧，提升代码层面的面向对象设计和编码能力。</p>
<p>首先，我们将通过面向对象的三大特征，结合实例，介绍 JavaScript 面向对象的知识：封装、继承以及多态。</p>
<h2>1. 封装</h2>
<p>在面向对象编程中，封装（Encapsulation）说的是一种通过接口抽象将具体实现包装并隐藏起来的方法。具体来说，封装的机制包括两大部分：</p>
<ul> 
 <li><strong>限制对对象内部组件直接访问的机制；</strong></li> 
 <li><strong>将数据和方法绑定起来，对外提供方法，从而改变对象状态的机制。</strong></li> 
</ul>
<p>在 Java 中，在类中通过 private 或 public 这样的修饰符，能够实现对对象属性或方法不同级别的访问权限控制。但是，在 JavaScript 中并没有这样的关键字，但是，通过一点小的技巧，就能让 JavaScript 代码支持封装。</p><!-- [[[read_end]]] -->
<p>直到 ES6（<a href="http://es6-features.org">ECMAScript 6</a>）以前，类（class）这个概念在 JavaScript 中其实不存在，但是 JavaScript 对函数（function）有着比一般静态语言强大得多的支持，我们经常利用它来模拟类的概念。现在，请你打开 Chrome 的开发者工具，在控制台上贴上如下代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book("Life").name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你将看到控制台输出了 “Life”。从代码中可以看到，name 作为了 Book 这个类的构造函数传入，并赋值给了自己的 name 属性（它和入参 name 重名，但却不是同一个东西）。这样，在使用“Life”作为入参来实例化 Book 对象的时候，就能访问对象的 name 属性并输出了。</p>
<p>但是，这样的 name 属性，其实相当于公有属性，因为外部可以访问到，那么，我们能够实现私有属性吗？当然，请看这段代码 ：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.getName = () =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        };
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.setName = (newName) =&gt; {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        name = newName;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        };
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let book = new Book("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       book.setName("Time");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(book.getName()); // Time
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(book.name); // 无法访问私有属性 name 的值
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>上面的代码中，有两处变化，一个是使用了 () =&gt; {} 这样的语法代替了 function 关键字，使得其定义看起来更加简洁，但是表达的含义依然是函数定义，没有区别；第二个是增加了 getName() 和 setName() 这样的存取方法，并且利用闭包的特性，将 name 封装在 Book 类的对象中，你无法通过任何其它方法访问到私有属性 name 的值。</p>
<p>这里介绍闭包（Closure），我想你应该听说过这个概念。<strong>闭包简单说，就是引用了自由变量的函数。这里的关键是“自由变量”，其实这个自由变量，扮演的作用是为这个函数调用提供了一个“上下文”</strong>，而上下文的不同，将对入参相同的函数调用造成不同的影响，它包括：</p>
<ul> 
 <li>函数的行为不同，即函数调用改变其上下文中的其它变量，如例子中的 setName()；</li> 
 <li>函数的返回值不同，如例子中的 getName()。</li> 
</ul>
<p><strong>和闭包相对的，是一种称为“纯函数”（Pure Function）的东西，即函数不允许引用任何自由变量。</strong>因此，和上面两条“影响”对应，纯函数的调用必须满足如下特性：</p>
<ul> 
 <li>函数的调用不允许改变其所属的上下文；</li> 
 <li>相同入参的函数调用一定能得到相同的返回值。</li> 
</ul>
<p>读到这里，你是否想到了 <a href="https://time.geekbang.org/column/article/136795">[第 04 讲]</a> 中我们将 HTTP 的请求从两个维度进行划分，即是否幂等，是否安全；在 <a href="https://time.geekbang.org/column/article/141679">[第 08 讲]</a> 中我们对 CQRS 依然从这样两个维度进行划分，并作了分析。今天，我们还做相同的划分。</p>
<ul> 
 <li>闭包的调用是不安全的，因为它可能改变对象的内部属性（闭包的上下文）；同时它也不是幂等的，因为一次调用和多次调用可能产生不同的结果。</li> 
 <li>纯函数的调用是安全的，也是幂等的。</li> 
</ul>
<p>于是，我们又一次发现，技术是相通，是可以联想和类比的。<strong>本质上，它们围绕的都是一个方法（函数）是否引用和改变外部状态的问题。</strong>闭包本身是一个很简单的机制，但是，它可以带来丰富的语言高级功能特性，比如<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0">高阶函数</a>。</p>
<h2>2. 继承</h2>
<p>在面向对象编程中，继承（Inheritance）指的是一个对象或者类能够自动保持另一个对象或者类的实现的一种机制。我们经常讲的子类具备父类的所有特性，只是继承中的一种，叫做类继承；其实还有另一种，对象继承，这种继承只需要对象，不需要类。</p>
<p>在 ES6 以前，没有继承（extends）关键字，JavaScript 最常见的继承方式叫做<strong>原型链继承</strong>。原型（prototype）是 JavaScript 函数的一个内置属性，指向另外的一个对象，而那个对象的所有属性和方法，都会被这个函数的所有实例自动继承。</p>
<p>因此，当我们对那个原型指向的对象做出任何改变，这个函数的所有实例也将发生相同的改变。这样原型的设计在常见的静态语言中并不常见。当然，它在实现的效果上和静态语言中的“类属性 / 类方法”有一点儿相似。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Child.prototype = new Base();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c.name); // "Life"
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // true
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // true
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>请看上面的例子，通过将子类 Child 的原型 prototype 设置为父类的对象，就完成了 Child 继承 Base 的关联，之后我们再判断 Child 的对象 c，就发现它也是 Base 的对象。请注意这样两个要点：</p>
<ul> 
 <li>设置 prototype 的语句一定要放到 Base 和 Child 两个构造器之外；</li> 
 <li>并且要放在实例化任何子类之前。</li> 
</ul>
<p>上面这两条原则非常重要，缺一不可。如果违背第一个要点，即把 prototype 的设置放到子类的里面，变成这样：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Child.prototype = new Base();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这是完全错误的，每次 Child 在构建的过程中，原型被破坏并重建一次，这可不只是一个资源浪费、状态丢失的问题。由于原型是实例辨识运算 instanceof 的依据，因此它还会影响 JavaScript 引擎对 instanceof 的判断：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // false
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，c 现在不但不是 Base 的实例，甚至也不是 Child 的了。</p>
<p>还有些程序员违反了上面说的第二个要点，即搞错了顺序：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Child.prototype = new Base();
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>后面的判断也出现了错误：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // false
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>因为 Child 的原型在 c 生成之后发生了破坏并重建，因此无论 Base 还是 Child，都已经和 c 没有关联了。</p>
<p>你再仔细想想的话，你还会发现原型链继承有一个解决不了的问题，即父类的构造方法如果包含参数，就无法被完美地继承下来。比如上例中的 name 构造参数，传入后赋值给对象的操作不得不在子类中重做了一遍。于是，我们引出另一种常见的 JavaScript 实现继承的方式——<strong>构造继承</strong>。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base1(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Base2(type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.type = type;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Child(name, type) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Base1.call(this, name); // 让 this 去调用 Base1，并传入参数 name
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        Base2.call(this, type);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       var c = new Child("Life", "book");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c.name); // "Life"
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Base1); // false
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(c instanceof Child); // true
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，这种方法就能够保留父类对于构造器参数的处理逻辑，并且，我们居然还不知不觉地实现了<strong>多重继承</strong>！但是，缺点也很明显，使用 instanceof 方法判断的时候，发现子类对象 c 并非父类实例，并且，当父类的 prototype 还有额外属性和方法的时候，它们也无法通过构造继承被自动搬到子类里来。</p>
<h2>3. 多态</h2>
<p>在面向对象编程中，多态（Polymorphism）指的是同样的接口，有着不同的实现。在 JavaScript 中没有用来表示接口的关键字，但是通过在不同实现类中定义同名的方法，我们可以轻易做到多态的效果，即同名方法在不同的类中有不同的实现。而由于没有类型和参数的强约束，它的灵活性远大于 Java 等静态语言。</p>
<h2>理解对象创建</h2>
<p>在对面向对象的三大特征有了一定的理解之后，我们再来看看实际的对象创建。你可能会说，对象创建不是一件很简单的事儿吗，有什么可讲的？</p>
<p>别急，JavaScript 和一般的静态语言在对象创建上有着明显的不同，JavaScript 奇怪的行为特别多，还是让我们来看看吧。</p>
<p>在 Java 等多数静态语言中，是使用 new 关键字加基于类名的方法调用来创建对象，但是如果不使用 new 关键字，只使用基于类名的方法调用，则什么都不是，编译器直接报错。但是 JavaScript 不同，我们对于类的概念完全是通过强大的函数特性来实现的，先看下面这个容易混淆函数调用和对象创建的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book("Life").name); // 输出 Life
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(Book("Life").name); // 也输出 Life
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，在 Book() 中，我们最终返回了 this，这就让它变得模糊，这个 Book() 到底是类的定义，还是普通函数（方法）定义？</p>
<ul> 
 <li>代码中使用 this 关键字来给对象自己赋值，看起来 Book 应该是类，那么 Book() 其实就是类的构造器，而这个赋值是完成对象创建的一部分；</li> 
 <li>可是它居然又有返回（return 语句），那么从这个角度看，Book 应该是普通函数定义，函数调用显式返回了一个对象。</li> 
</ul>
<p>于是，我们从上述最下面的两行代码中看到，无论使用 new 来创建对象，还是不使用 new，把它当成普通方法调用，都能够获得对象 name 属性的值“Life”，因此看起来用不用 new 似乎没有区别嘛？</p>
<p>其实不然，没有区别只是一个假象。JavaScript 是一个特别善于创造错觉的编程语言，有许多古怪无比“坑”等着你去踩，而这只是其中一个。我们要来进一步理解它，就必须去理解代码中的 this，众所周知 this 可以看做是对象对于它自己的引用，那么我们在执行上述两步操作时，this 分别是什么呢？</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log(this);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       new Book("Life"); // 打印 Book {}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Book("Life"); // 打印 Window { ... }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       window.Book("Life") // 打印 Window { ... }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在这段代码中，我在 Book() 内部把 this 打印出来了。原来，在使用 new 的时候，this 是创建的对象自己；而在不使用 new 的时候，this 是浏览器的内置对象 window，并且，这个效果和使用 window 调用 Book() 是一样的。也就是说，<strong>当我们定义了一个“没有归属”的全局函数的时候，这个函数的默认宿主就是 window</strong>。</p>
<p>实际上，上述例子在使用 new 这个关键字的时候，JavaScript 引擎就帮我们做了这样几件事情。</p>
<p>第一件，创建一个 Book 的对象，我们把它叫做 x 吧。<br> 第二件，绑定原型：x.<strong>proto</strong> = Book.prototype。<br> 第三件，指定对象自己：this = x，并调用构造方法，相当于执行了 x.Book()。<br> 第四件，对于构造器中的 return 语句，根据 typeof x === ‘object’ 的结果来决定它实际的返回：</p>
<ul> 
 <li>如果 return 语句返回基本数据类型（如 string、boolean 等），这种情况 typeof x 就不是“object”，那么 new 的时候构造器的返回会被强制指定为 x；</li> 
 <li>如果 return 语句返回其它类型，即对象类型，这种情况 typeof x 就是“object”，那么 new 的时候会遵循构造器的实际 return 语句来返回。</li> 
</ul>
<p>前面三件其实很好理解，我们的试验代码也验证了；但是第四件，简直令人崩溃对不对？这是什么鬼设计，<strong>难道创建对象的时候，还要根据这个 return 值的类型来决定 new 的行为？</strong></p>
<p>很遗憾，说对了……我们来执行下面的代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book1(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return 1;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book1("Life")); // 打印 Book1 {name: "Life"}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book2(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return [];
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(new Book2("Life")); // 打印 []
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，Book1 的构造器返回一个基本数据类型的数值 1，new 返回的就是 Book1 的实例对象本身；而 Book2 的构造器返回一个非基本数值类型 []（数组），new 返回的就是这个数组了。</p>
<p>正是因为这样那样的问题，ES5 开始提供了严格模式（Strict Mode），可以让代码对一些可能造成不良后果的不严谨、有歧义的用法报错。</p>
<p>在实际项目中，我们应当开启严格模式，或是使用 <a href="https://www.typescriptlang.org/">TypeScript</a> 这样的 JavaScript 超集等等替代方案。写 JavaScript 代码的时候，心中要非常明确自己使用 function 的目的，是创建一个类，是创建某个对象的方法，还是创建一个普通的函数，并且在命名的时候，根据项目的约定给予清晰明确的名字，看到名字就立即可以知道它是什么，而不需要联系上下文去推导，甚至猜测。</p>
<p>正确的代码是写给机器看的，但是优秀的代码是写给别的程序员看的。</p>
<h2>总结思考</h2>
<p>今天我们学习了 JavaScript 面向对象的实现方式和相关的重要特性，希望你能够掌握介绍到的知识点，通过思考和吸收，最终可以在项目中写出易于维护的高质量代码。现在，我想提两个问题，请你挑战一下：</p>
<ul> 
 <li>在你经历的项目中，是否使用过面向对象来进行 JavaScript 编码，项目的代码质量是怎样的？</li> 
 <li>和静态语言不同的是，JavaScript 有好多种不同的方式来实现继承效果，除了文中介绍的原型链继承和构造继承以外，你是否还知道其它的 JavaScript 继承实现方式？</li> 
</ul>
<p>好，今天的内容就到这里。欢迎你在留言区和我讨论，也欢迎你把文章分享出去，和朋友一起阅读。</p>
<h2>选修课堂：当函数成为一等公民</h2>
<p>众所周知，有一种经典的学习一门新语言的方法是类比法，比如从 C 迁入 JavaScript 的程序员，就会不由自主地比较这两门语言的语法映射，从而快速掌握新语言的写法。</p>
<p>但是，<strong>仅仅通过语法映射的学习而训练出来的程序员，只是能写出符合 JavaScript 语法的 C 语言而已，本质上写的代码依然是 C</strong>。因此，在类比以外，我们还要思考和使用 JavaScript 不一样的核心特性，比如接下去要介绍的函数“一等公民”地位。</p>
<p>首先，我们需要理解，何为“函数成为一等公民”。这指的是，<strong>函数可以不依附于任何类或对象等实体而独立存在，它可以单独作为参数、变量或返回值在程序中传递。</strong></p>
<p>回想 Java 语言，如果 Book 这个类，有一个方法 getName()，这个方法必须依附于 Book 而存在，一般情况下必须使用 Book 或它的对象才能调用。这就是说，Java 中的函数或方法，无法成为一等公民。可 JavaScript 完全不同了，你可能还记得上文中出现了这样的调用：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Base1.call(this, name);
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>Base1 实际是一个函数，而函数的宿主对象 this 被当作参数传进去了，后面的 name 则是调用参数，这种以函数为核心的方法调用，在许多传统的静态语言中是很难见到的。我们来看一个更完整的例子：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function getName() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        return this.name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       function Book(name) {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        this.name = name;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       let book = new Book("Life");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log(getName.call(book, getName)); // "Life"
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，同样使用 function 关键字，getName 是函数（方法），Book 是书这个类，实例化得到 book 以后，通过 call 关键字调用，把 book 作为 getName() 的宿主，即其中的 this 传入，得到了我们期望的值“Life”。</p>
<p>上面就是对于函数成为一等公民的一个简单诠释：以往我们只能先指定宿主对象，再来调用函数；现在可以反过来，先指定函数，再来选择宿主对象，完成调用。请注意，函数的调用必须要有宿主对象，如果你使用 null 或者 undefined 这样不存在的对象，window 会取而代之，被指定为默认的宿主对象。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>对于系统地学习 ES 6，推荐阅读阮一峰的翻译作品 <a href="http://es6.ruanyifeng.com/">ECMAScript 6 入门</a>。</li> 
 <li>文中介绍了严格模式（Strict Mode），感兴趣的话可以看看 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode">MDN 的介绍</a>。</li> 
 <li>文章多次提到了静态语言和动态语言，我曾经写过一篇文章<a href="https://www.raychase.net/2310">编程范型：工具的选择</a>，对它们做了介绍，供你参考。</li> 
 <li>对于文中提到的 instanceof 运算符，如果你想了解它是怎样实现的，它和对象原型有何关系，请参阅 <a href="https://www.ibm.com/developerworks/cn/web/1306_jiangjj_jsinstanceof/index.html">JavaScript instanceof 运算符深入剖析</a>。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |33          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:53:43.333 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=33 
 {executed in 0 msec}
2020-11-19 17:53:43.334 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                       |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|-----|----|----|
|33  |1605756020 |1605756020 |1                |zh-hans  |0       |1                             |1      |0      |15丨重剑无锋，大巧不工：JavaScript面向对象 |book |1   |33  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|-----|----|----|

2020-11-19 17:53:43.335 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=33 
 {executed in 1 msec}
2020-11-19 17:53:43.335 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                       |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|----|----|
|[unread] |1605756020 |1605756020 |1                |zh-hans  |0       |1                             |1      |0      |15丨重剑无锋，大巧不工：JavaScript面向对象 |1   |33  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|----------------------------|----|----|

2020-11-19 17:53:43.340 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779623, created=1605779623, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='15丨重剑无锋，大巧不工：JavaScript面向对象', 
type='book', uid=1, vid=33 where nid=33 
 {executed in 1 msec}
2020-11-19 17:53:43.340 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779623, created=1605779623, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='15丨重剑无锋，大巧不工：JavaScript面向对象', 
uid=1, vid=33 where nid=33 
 {executed in 0 msec}
2020-11-19 17:53:43.348 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.349 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|33        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/80868a164655d3b00ec4cd7c29c02141?bkt=en-2e2b5030dd6ff0378e24780db089b5465bd1b9cba0c33fa65e4872337401c67643136368f52b65fa&fid=3757516097-778750-626663225562656&time=1605756019&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-WaCQ9hpP%2FRLqEcl186hTy8va2%2Fg%3D&to=92&size=16088760&sta_dx=16088760&sta_cs=3672&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030261&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16088760&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-acabb6aef81065b8dac364c289e91dcecfd9ccb6e97f23aa44356524b7fcbfc82b5610f4c8aa6834&sl=76480590&expires=8h&rt=pr&r=816509086&mlogid=7502239272403649565&vbdid=2247232042&fin=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a&bflag=92,34-92&rtype=1&dp-logid=7502239272403649565&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=c4d909716469fa07336d4468a91324519c45df85c496a599&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a |33          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:53:43.354 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/80868a164655d3b00ec4cd7c29c02141?bkt=en-2e2b5030dd6ff0378e24780db089b5465bd1b9cba0c33fa65e4872337401c67643136368f52b65fa&fid=3757516097-778750-228534822965867&time=1605779621&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2FNzwgAPYsQwVVFDB7rd5dDWo%2BSY%3D&to=92&size=16088760&sta_dx=16088760&sta_cs=3677&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030261&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16088760&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-acabb6aef81065b8dac364c289e91dcecfd9ccb6e97f23aa44356524b7fcbfc82b5610f4c8aa6834&sl=76480590&expires=8h&rt=pr&r=105473813&mlogid=7508574821618765436&vbdid=2247232042&fin=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a&bflag=92,34-92&rtype=1&dp-logid=7508574821618765436&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=37cfb58296b21ea9e8b7efd7765b36cd49f65b2fc7a07146&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a', 
revision_id=33 where entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.358 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.358 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |revision_id |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/80868a164655d3b00ec4cd7c29c02141?bkt=en-2e2b5030dd6ff0378e24780db089b5465bd1b9cba0c33fa65e4872337401c67643136368f52b65fa&fid=3757516097-778750-626663225562656&time=1605756019&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-WaCQ9hpP%2FRLqEcl186hTy8va2%2Fg%3D&to=92&size=16088760&sta_dx=16088760&sta_cs=3672&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030261&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16088760&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-acabb6aef81065b8dac364c289e91dcecfd9ccb6e97f23aa44356524b7fcbfc82b5610f4c8aa6834&sl=76480590&expires=8h&rt=pr&r=816509086&mlogid=7502239272403649565&vbdid=2247232042&fin=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a&bflag=92,34-92&rtype=1&dp-logid=7502239272403649565&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=c4d909716469fa07336d4468a91324519c45df85c496a599&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a |33          |
|----------|-------|------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:53:43.363 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/80868a164655d3b00ec4cd7c29c02141?bkt=en-2e2b5030dd6ff0378e24780db089b5465bd1b9cba0c33fa65e4872337401c67643136368f52b65fa&fid=3757516097-778750-228534822965867&time=1605779621&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-%2FNzwgAPYsQwVVFDB7rd5dDWo%2BSY%3D&to=92&size=16088760&sta_dx=16088760&sta_cs=3677&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030261&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=16088760&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-acabb6aef81065b8dac364c289e91dcecfd9ccb6e97f23aa44356524b7fcbfc82b5610f4c8aa6834&sl=76480590&expires=8h&rt=pr&r=105473813&mlogid=7508574821618765436&vbdid=2247232042&fin=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a&bflag=92,34-92&rtype=1&dp-logid=7508574821618765436&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=37cfb58296b21ea9e8b7efd7765b36cd49f65b2fc7a07146&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=15%E4%B8%A8%E9%87%8D%E5%89%91%E6%97%A0%E9%94%8B%EF%BC%8C%E5%A4%A7%E5%B7%A7%E4%B8%8D%E5%B7%A5%EF%BC%9AJavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.m4a', 
revision_id=33 where entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.366 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.366 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|33        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>许童童</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-14
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师你好，问个问题，对象继承是什么，有相关的资料可以看一下吗？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/e7/a0/9a962a74.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>joker</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-14
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    面试有问原型链的，老师您能给讲一下不
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |33          |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:53:43.372 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.372 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>许童童</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-14
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师你好，问个问题，对象继承是什么，有相关的资料可以看一下吗？
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/e7/a0/9a962a74.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>joker</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-14
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    面试有问原型链的，老师您能给讲一下不
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |33          |
|----------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:53:43.377 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.378 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|33        |book   |0     |zh-hans  |33          |https://static001.geekbang.org/resource/image/b9/b5/b9d1220d1c3331869dbeb88d1c49e7b5.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:53:43.382 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.383 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |33          |https://static001.geekbang.org/resource/image/b9/b5/b9d1220d1c3331869dbeb88d1c49e7b5.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:53:43.388 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=33 
 {executed in 1 msec}
2020-11-19 17:53:43.388 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |33          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:53:43.393 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=33 
 {executed in 0 msec}
2020-11-19 17:53:43.393 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |33          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:53:43.398 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='505968262876985' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:53:43.398 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:26.916 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='505968262876985' 
and bookchecke0_.name='net_content' 
 {executed in 0 msec}
2020-11-19 17:54:26.918 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:26.920 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('505968262876985', 1, 'net_content') 
 {executed in 1 msec}
2020-11-19 17:54:26.921 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('505968262876985', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:54:26.922 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|57            |
|--------------|

2020-11-19 17:54:26.950 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='505968262876985' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:54:26.951 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:27.656 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='505968262876985' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:54:27.657 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:27.659 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('505968262876985', 1, 'media') 
 {executed in 0 msec}
2020-11-19 17:54:27.659 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('505968262876985', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:54:27.660 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|58            |
|--------------|

2020-11-19 17:54:27.682 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='505968262876985' 
 {executed in 0 msec}
2020-11-19 17:54:27.683 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|34        |book   |0     |505968262876985  |zh-hans  |34          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:27.683 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=34 
 {executed in 0 msec}
2020-11-19 17:54:27.683 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|34  |zh-hans  |book |e216dd9f-ef55-4af8-acb2-b255e4f2673f |34  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:54:27.688 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.689 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |505968262876985  |zh-hans  |34          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:27.693 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=34 
 {executed in 0 msec}
2020-11-19 17:54:27.694 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|34  |1   |3     |0            |1  |27 |34 |0  |0  |27  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:54:27.699 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=34 
 {executed in 1 msec}
2020-11-19 17:54:27.702 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|34        |<p>你好，我是四火。</p>
<p>前两章我们分别介绍了网络协议和 Web 接口的知识，以及网站等应用的 MVC 架构和其衍生发展而来的各种设计模式。以上希望你已经充分消化吸收了，今天我们将迈入第三大基于 Web 的全栈技能领域——前端。</p>
<h2>为什么要学习前端技术？</h2>
<p>“前端”简简单单两个字，背后却有着纷繁的故事和复杂的情感。这也促使我产生了想多聊一聊这个话题的想法，一般的技术在“为什么要学”的方面我往往简言述之，但对于前端技术我想为此破例。</p>
<p>前端一直以来是一个颇具争议的领域，有人极其喜爱，有人避而远之，和多数“天下太平”的技术相比，这确实有些令人费解，但我认为这其中的原因至少包括这样两点。</p>
<p>第一，某些技术人员或管理者单项技术进步，但思想却依然陈旧迂腐，停留在“前端就是改改页面”这样老旧的思维程度，认为前端没有技术含量且无法创造显著价值。</p>
<p>第二，相对于软件领域的通用技术，前端极低的入门门槛，导致号称“懂前端”的工程师技术水准严重参差不齐，这反向影响了整个技术群体的形象。</p>
<p>如果你志在学习全栈工程，前端就自然是你无法避开，且还需努力驾驭的领域。但即便你的长期目标不在此，也应该学习前端技术，因为它能给你带来的好处是多方面，且是别的技术所不可替代的。具体包括这样几个方面。</p><!-- [[[read_end]]] -->
<p><strong>首先，它可以帮助你开阔眼界，为你的思维模式带来新的选项，整个全栈技术都有这样的特点，但是前端技术在这方面尤其明显。</strong>前端技术的结构和软件其它领域有着显著的不同，技术发展极其迅速，技术之水深不见底，开源社区百花齐放。我们也将在本章中体会到前端领域所需要的不同的思维模式。</p>
<p><strong>其次，它可以帮助你形成快速原型、即时验证和独立展示演示的优势，在迅捷的反馈中设计和编程。</strong>在我参与过的 Hackthon（黑客马拉松）数天的短期竞赛中，产品经理、程序员和数据科学家被认为是最合理的一组搭配，懂前端技术的程序员总是对互联网的用户交互、数据采集等方面特别有经验，在展示环节还可以快速地做出非常优秀的效果来。</p>
<p><strong>再次，它可以帮助你建立产品思维。</strong>有人认为它能用来解决用户的核心问题，但实际上往往不是，解决核心问题主要还是靠后端的代码，但是前端的代码却是和用户最贴近和交互的部分，一个优秀的前端工程师总是具备非常强烈的产品属性。</p>
<p>我记得以前在一个团队中负责一个 portal，有别的团队的同事私下里抱怨，说我们做的东西被 portal 一展示，用户都说好用 ，结果都默认是做 portal 的团队做的了。其实这是一个很现实的问题，无论产品的功和过，即便它的组件分层再深，用户的眼光往往只到很浅的层次就断了。有句话叫，“没有声音，再好的戏也出不来”，如果说，产品的功能性能是它的硬实力，是这出戏的画面，那么前端带来的用户体验在很多情况下就是这出戏的声音。</p>
<p><strong>最后，前端技术是全栈工程的必备技能。</strong>它可以让你拍着胸脯对用户说，“这个可以做”，“这个不能做”，而不是说，“我去和前端确认一下这个交互能不能实现”。产品做出来，也不至于成为一个号称装着高性能引擎，却裹着破布毯子的“豪车”。</p>
<p>遗憾的是，现实中有不少迈入职场没有几年，却已经给自己打上“前端工程师”“后端工程师”等标签的程序员朋友。我觉得他们可能是受到了某些万恶的职业生涯规划鸡汤的影响，这些标签会让他们在面对新技术和新机遇的时候，觉得身处“不属于自己的领域”而选择封闭自己。</p>
<p>因此我的建议是：<strong>职业生涯不宜过早做过细的规划，除了技术深度，也需要在技术广度上积累，等到一定程度以后再来选择自己的发展分支路线。</strong>而且，某些特定技术领域，在程序员给自己打标签的时候，压根还没有发展成熟，等到发展起来，时机真正到来的时候，只有那些原本“不偏食”的优秀的程序员才能够脱颖而出。</p>
<h2>思维模式的转变</h2>
<p>如果你具备后端开发的经验，刚刚开始从后端转向前端，你可能会发现，有很多想当然的理解，不再适用，有很多想当然的解决方法，也不再有效。</p>
<h3>1. 应用事件驱动编程</h3>
<p>来看这样一段 JavaScript 代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log("1");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(function timeout() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log("2");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }, 0);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(function timeout() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log("3");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }, 5000);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log("4");
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>代码中有四处打印，setTimeout 接受两个参数，第一个参数表示调用逻辑，第二个参数表示等待多少毫秒后再来执行该调用逻辑。</p>
<p>你觉得打印结果应该是什么？</p>
<p>是 1 -&gt; 2 -&gt; 4 -&gt; 3 吗？先别急着回答，我们好久没动手了，让我们来动动手看看结果吧。</p>
<p>在 Chrome 中，任意一个页面打开浏览器的开发者工具，在 Console 标签下，把上面的代码复制粘贴进去，于是我们看到这样的输出：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       1
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       4
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       undefined
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       2
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       3
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这是为什么，上面的 undefined 又是什么？</p>
<p>为了回答上面的问题，我们需要了解 JavaScript 执行机制中的 Event Loop（事件循环）来理解上面的代码。</p>
<p>在写后端代码的时候，你可能已经习惯了使用进程（process）或者线程（thread）来对付需要并行处理的逻辑，Java 如此，Python 也如此。进程或线程可以说是“真并行”，虽然微观地看，它们可能会顺序占用 CPU 时间片，但宏观地看，代码在二者中执行互不阻塞，是并行执行的。</p>
<p>而在 JavaScript 中，在浏览器中，你看到眼花缭乱的效果和变化，却是“假并行”，是一个彻头彻尾的“骗局”。为什么这么说？</p>
<p>因为浏览器中 JavaScript 代码的执行通常是单线程的（对于 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">Web Worker</a> 这样的“例外”我们暂不讨论）——一个线程，一个调用栈，一次只做一件事。</p>
<p>具体说来，在整个 JavaScript 的世界里，引起代码运行的行为是通过事件驱动的，并且<strong>全部是通过这唯一的一个勤奋的工作线程来执行的。那么当有事件产生的时候，这个工作线程不一定空闲，这就需要一个机制来让新产生的事件排队“等一等”</strong>，等当前的工作完成之后，再来处理它。这个机制就是 Event Loop，这个等一等的事件，就被放在一个被称为事件（回调）队列的数据结构中。</p>
<p>于是上面的代码，实际在运行的时候，从事件队列的角度看，是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/75/ff/757fe02c8910fe1d02be6d159ccf3cff.png" alt=""></p>
<p>工作线程不断地从整个事件队列的右侧取得新的事件来处理执行，而新的事件只会从左侧放入：</p>
<p>主代码最先被执行，从上往下顺序执行，因此顺序是：</p>
<ul> 
 <li>先打印 1；</li> 
 <li>在遇到第一个 setTimeout 的时候，告知浏览器，请在 0 秒之后往事件队列内放入执行打印 2 的事件；</li> 
 <li>在遇到第二个 setTimeout 的时候，告知浏览器，请在 5 秒之后往事件队列内放入执行打印 3 的事件；</li> 
 <li>再打印 4；</li> 
 <li>主代码执行完毕，Chrome 的控制台打印这段代码的返回值，但因为它没有返回值，于是就打印 undefined。</li> 
</ul>
<p>浏览器老老实实地按照要求放入了打印 2 的事件，虽然是第 0 秒就放入，但是因为放入的时候主代码还在执行，因此只能等待，它等到主代码执行完毕后才得到执行，打印了 2。</p>
<p>5 秒钟后，浏览器按照要求往队列里放入了打印 3 的事件，于是 3 被打印出来。</p>
<p>你看，通过这种方式，JavaScript 可以让不同的任务在一个线程中完成，而整个任务编排的机制，<strong>从代码的角度看，所有的逻辑都是通过七七八八的“异步回调”来完成的；而从程序员思维方式的角度看，以往基于线程的编程，变成了事件驱动的编程</strong>。</p>
<p><img src="https://static001.geekbang.org/resource/image/8f/b9/8f475ade881eeaa7e49a442e80af2db9.jpg" alt=""></p>
<p>上图来自 <a href="http://berb.github.io/diploma-thesis/original/043_threadsevents.html">The Case of Threads vs. Events</a>，很好地对比了两者的不同之处，其中：</p>
<p>对于逻辑的触发，基于线程编程需要不断地由监视线程去查询被监视线程的某一个状态，如果状态满足某个条件，则触发相应的逻辑；而事件驱动则通过事件处理器，在事件发生时执行挂载的回调逻辑。不知你是否联想起了 <a href="https://time.geekbang.org/column/article/136587">[第 03 讲]</a> 中我介绍的 push 和 pull，在这里，前者正类似于 pull 的形式，而后者则类似于 push 的形式。</p>
<p>基于线程的方式可以阻塞线程，等待时间或某个条件满足后再继续执行；而事件驱动则相反，发送一条消息后无阻塞等待回调的发生。阻塞线程的方式对资源的消耗往往更加显著，因为无论是否执行线程都被占用，但从人直观理解的角度来说，代码更直白，更符合人对顺序执行的理解；而事件驱动的方式则相反，资源消耗上更优，但是代码的执行顺序，以及由此产生的系统状态判断变得难以预知。</p>
<p>请注意的是，在 JavaScript 中我们通常无法使用基于线程的编程，但是在很多情况下，例如 Java 和 Python 这些传统的后端编程语言中，我们可以混合使用基于线程和事件驱动的编程，它们是互不矛盾的。</p>
<p>最后，为什么 JavaScript 要被设计成单线程的，多线程难道就不行吗？最重要的原因，就是为了让整个模型简单。如果引入多线程，这里有很多问题需要解决，例如事件处理的依赖关系（多线程的事件处理就不再是简单队列的挨个处理了），例如资源的共享和修改（无锁编程不再有效，必须要考虑同步等加锁机制了），整个系统会变得极其复杂，不只是对于浏览器的开发者而言，对前端的开发者也一样。</p>
<p>另外，需要说明的是，浏览器的 JavaScript 执行是单线程的，但不代表浏览器是单线程的。浏览器通常还包含其它线程，比如说：</p>
<ul> 
 <li>界面（GUI）渲染线程，这个线程的执行和上述的 JavaScript 工作线程是互斥的，即二者不可同时执行；</li> 
 <li>事件触发线程，这个也很好理解，我们介绍过有一个神秘人物帮着往队列中放入事件（例子中的回调打印 2 和回调打印 3），这个神秘人物就是事件触发线程。</li> 
</ul>
<h3>2. 学写声明式代码</h3>
<p>习惯于设计和书写大量的声明式代码，也是一个很重要的思维转变。</p>
<p>我们在 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中讲过什么是声明式代码，为什么我们在写视图层的时候会大量使用声明式代码。HTML、CSS 和 JavaScript，前端的三驾马车，两架是用声明式代码写的，我们应当记得自己做的是前端开发，而不是一个单纯的 JavaScript 写手。</p>
<p><strong>声明式代码和命令式代码一样，都需要设计，且都需要测试。</strong>我见过不少工程师能够写出优秀的命令式代码，甚至已经习惯了，但是在写声明式代码的时候，却缺乏条理。</p>
<p>举例来说，设计页面的时候，要先设计布局，抓住整棵 DOM 树中核心的部分，自上而下地去划分区域，哪些是静态的区域，哪些是动态生成的，并合理设计可重用组件。再比如说，使用声明式代码处理模板中呈现数据的格式转换，使得呈现部分的代码更纯粹、自然，具体请参看 [第 16 讲] 中的过滤器。</p>
<h3>3. 培养交互思维</h3>
<p>前端工程师必须具备敏感的交互思维。通常来说，前端的代码，兼具着“甲方”和“乙方”的角色：</p>
<ul> 
 <li>对用户和前端的交互来说，客户是甲方，享受服务；前端就是乙方，提供服务。</li> 
 <li>对和服务端的交互来说，前端就是甲方，从服务端获得数据和服务；服务端就是乙方，提供数据和服务。</li> 
</ul>
<p>而无论是和用户，还是和服务端的交互，都是学习前端技术中需要领会的部分。<strong>和用户的交互要求开发前端的程序员具备产品思维，而和服务端的交互则要求开发前端的程序员具备工程思维。</strong></p>
<p>一头是用户，另一头是后端工程师，前端的开发人员，在整个庞大的研发体系中，既像粘合剂，又像润滑剂，要从产品和工程两个视角去思考问题，作出判断；不但要交付实实在在的功能，要引导好的工程架构，还要给用户带来优秀的产品体验。</p>
<h2>总结思考</h2>
<p>今天我们首先强调了对于基于 Web 的全栈学习来说，学习前端技术的重要性，接着我们介绍了前端思维的几个转变，特别是事件驱动编程。希望你已经了解了 JavaScript 的单线程运行机制，并能够慢慢习惯不断在代码中与异步和回调打交道。</p>
<p>下面留两个思考问题：</p>
<ul> 
 <li>你在技术团队中主要扮演什么角色，你对前端技术的认识是怎样的？</li> 
 <li>为什么 JavaScript 中，没有像 Java 或 Python 一样的 sleep 方法？毕竟，我就是想让当前执行过程稍等一下，再继续后面的逻辑，有 sleep 的话多方便啊。</li> 
</ul>
<p>最后，我想说的是，以前有句话叫做，“狗拿耗子，多管闲事”，但是我们在学习前端技术的时候，却要反过来，我们不但要多管闲事，还要“越管越多”，要多去想想类似的后端技术是怎样实现的。那在学习后端技术的时候，道理也是一样的，也要联想。</p>
<p>无论是早些年的 <a href="http://www.gwtproject.org/">GWT</a>，后端 Java 程序员写出了优秀的基于 Ajax 的跨浏览器应用；还是这些年的 <a href="https://nodejs.org/en/">Node.js</a>，利用强大的 V8 引擎把数不清的 JavaScript 异步回调也写到后端去……技术是没有边界的，前端和后端的技术当然也包括在内。</p>
<p>好，今天的内容就到这里，欢迎你和我讨论，也欢迎你邀请你的朋友一起阅读、学习。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>你可能听过这样一句话，“任何能用 JavaScript 写的应用，最终都会用 JavaScript 来实现。”这句话最初来自 <a href="https://blog.codinghorror.com/the-principle-of-least-power/">The Principle of Least Power</a> 这篇文章，写于 2007 年。</li> 
 <li>有位工程师做了一个<a href="http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIjEiKTsKCnNldFRpbWVvdXQoZnVuY3Rpb24gdGltZW91dCgpIHsKICAgIGNvbnNvbGUubG9nKCIyIik7Cn0sIDApOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIjMiKTsKfSwgNTAwMCk7Cgpjb25zb2xlLmxvZygiNCIpOw%3D%3D!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D">名为 Loupe 的网站</a>，用动画来形象地展示事件循环的过程，本文的例子也可以在它上面运行。</li> 
 <li>为什么浏览器中 JavaScript 代码的执行设计成单线程的，还有一个文中没有提到的原因，就是多线程的 GUI 特别容易死锁。这篇文章 <a href="https://community.oracle.com/blogs/kgh/2004/10/19/multithreaded-toolkits-failed-dream">Multithreaded toolkits: A failed dream?</a> 描述了其中的缘由，大致是说 GUI 的行为大多都是从更高层的抽象一层一层往下调用到更低层的抽象、具体工具类实现，再到操作系统；而事件则是反过来，从下往上冒泡。结果就是两个方向相反的行为在碰头，给资源加锁的时候一个正序，一个逆序，极其容易出现互相等待而饿死的情况，而这种情况下要彻底解决这一问题的难度无异于“逆转潮汐”。</li> 
 <li><a href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/">浏览器的工作原理：新式网络浏览器幕后揭秘</a>，这可能是在互联网上流传最广泛地介绍浏览器工作原理的中文文章，非常推荐。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |34          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:27.705 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=34 
 {executed in 1 msec}
2020-11-19 17:54:27.708 INFO  jdbc.resultsettable Line:610 - 
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>前两章我们分别介绍了网络协议和 Web 接口的知识，以及网站等应用的 MVC 架构和其衍生发展而来的各种设计模式。以上希望你已经充分消化吸收了，今天我们将迈入第三大基于 Web 的全栈技能领域——前端。</p>
<h2>为什么要学习前端技术？</h2>
<p>“前端”简简单单两个字，背后却有着纷繁的故事和复杂的情感。这也促使我产生了想多聊一聊这个话题的想法，一般的技术在“为什么要学”的方面我往往简言述之，但对于前端技术我想为此破例。</p>
<p>前端一直以来是一个颇具争议的领域，有人极其喜爱，有人避而远之，和多数“天下太平”的技术相比，这确实有些令人费解，但我认为这其中的原因至少包括这样两点。</p>
<p>第一，某些技术人员或管理者单项技术进步，但思想却依然陈旧迂腐，停留在“前端就是改改页面”这样老旧的思维程度，认为前端没有技术含量且无法创造显著价值。</p>
<p>第二，相对于软件领域的通用技术，前端极低的入门门槛，导致号称“懂前端”的工程师技术水准严重参差不齐，这反向影响了整个技术群体的形象。</p>
<p>如果你志在学习全栈工程，前端就自然是你无法避开，且还需努力驾驭的领域。但即便你的长期目标不在此，也应该学习前端技术，因为它能给你带来的好处是多方面，且是别的技术所不可替代的。具体包括这样几个方面。</p><!-- [[[read_end]]] -->
<p><strong>首先，它可以帮助你开阔眼界，为你的思维模式带来新的选项，整个全栈技术都有这样的特点，但是前端技术在这方面尤其明显。</strong>前端技术的结构和软件其它领域有着显著的不同，技术发展极其迅速，技术之水深不见底，开源社区百花齐放。我们也将在本章中体会到前端领域所需要的不同的思维模式。</p>
<p><strong>其次，它可以帮助你形成快速原型、即时验证和独立展示演示的优势，在迅捷的反馈中设计和编程。</strong>在我参与过的 Hackthon（黑客马拉松）数天的短期竞赛中，产品经理、程序员和数据科学家被认为是最合理的一组搭配，懂前端技术的程序员总是对互联网的用户交互、数据采集等方面特别有经验，在展示环节还可以快速地做出非常优秀的效果来。</p>
<p><strong>再次，它可以帮助你建立产品思维。</strong>有人认为它能用来解决用户的核心问题，但实际上往往不是，解决核心问题主要还是靠后端的代码，但是前端的代码却是和用户最贴近和交互的部分，一个优秀的前端工程师总是具备非常强烈的产品属性。</p>
<p>我记得以前在一个团队中负责一个 portal，有别的团队的同事私下里抱怨，说我们做的东西被 portal 一展示，用户都说好用 ，结果都默认是做 portal 的团队做的了。其实这是一个很现实的问题，无论产品的功和过，即便它的组件分层再深，用户的眼光往往只到很浅的层次就断了。有句话叫，“没有声音，再好的戏也出不来”，如果说，产品的功能性能是它的硬实力，是这出戏的画面，那么前端带来的用户体验在很多情况下就是这出戏的声音。</p>
<p><strong>最后，前端技术是全栈工程的必备技能。</strong>它可以让你拍着胸脯对用户说，“这个可以做”，“这个不能做”，而不是说，“我去和前端确认一下这个交互能不能实现”。产品做出来，也不至于成为一个号称装着高性能引擎，却裹着破布毯子的“豪车”。</p>
<p>遗憾的是，现实中有不少迈入职场没有几年，却已经给自己打上“前端工程师”“后端工程师”等标签的程序员朋友。我觉得他们可能是受到了某些万恶的职业生涯规划鸡汤的影响，这些标签会让他们在面对新技术和新机遇的时候，觉得身处“不属于自己的领域”而选择封闭自己。</p>
<p>因此我的建议是：<strong>职业生涯不宜过早做过细的规划，除了技术深度，也需要在技术广度上积累，等到一定程度以后再来选择自己的发展分支路线。</strong>而且，某些特定技术领域，在程序员给自己打标签的时候，压根还没有发展成熟，等到发展起来，时机真正到来的时候，只有那些原本“不偏食”的优秀的程序员才能够脱颖而出。</p>
<h2>思维模式的转变</h2>
<p>如果你具备后端开发的经验，刚刚开始从后端转向前端，你可能会发现，有很多想当然的理解，不再适用，有很多想当然的解决方法，也不再有效。</p>
<h3>1. 应用事件驱动编程</h3>
<p>来看这样一段 JavaScript 代码：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log("1");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(function timeout() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log("2");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }, 0);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       setTimeout(function timeout() {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        console.log("3");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }, 5000);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       console.log("4");
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>代码中有四处打印，setTimeout 接受两个参数，第一个参数表示调用逻辑，第二个参数表示等待多少毫秒后再来执行该调用逻辑。</p>
<p>你觉得打印结果应该是什么？</p>
<p>是 1 -&gt; 2 -&gt; 4 -&gt; 3 吗？先别急着回答，我们好久没动手了，让我们来动动手看看结果吧。</p>
<p>在 Chrome 中，任意一个页面打开浏览器的开发者工具，在 Console 标签下，把上面的代码复制粘贴进去，于是我们看到这样的输出：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       1
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       4
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       undefined
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       2
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       3
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这是为什么，上面的 undefined 又是什么？</p>
<p>为了回答上面的问题，我们需要了解 JavaScript 执行机制中的 Event Loop（事件循环）来理解上面的代码。</p>
<p>在写后端代码的时候，你可能已经习惯了使用进程（process）或者线程（thread）来对付需要并行处理的逻辑，Java 如此，Python 也如此。进程或线程可以说是“真并行”，虽然微观地看，它们可能会顺序占用 CPU 时间片，但宏观地看，代码在二者中执行互不阻塞，是并行执行的。</p>
<p>而在 JavaScript 中，在浏览器中，你看到眼花缭乱的效果和变化，却是“假并行”，是一个彻头彻尾的“骗局”。为什么这么说？</p>
<p>因为浏览器中 JavaScript 代码的执行通常是单线程的（对于 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">Web Worker</a> 这样的“例外”我们暂不讨论）——一个线程，一个调用栈，一次只做一件事。</p>
<p>具体说来，在整个 JavaScript 的世界里，引起代码运行的行为是通过事件驱动的，并且<strong>全部是通过这唯一的一个勤奋的工作线程来执行的。那么当有事件产生的时候，这个工作线程不一定空闲，这就需要一个机制来让新产生的事件排队“等一等”</strong>，等当前的工作完成之后，再来处理它。这个机制就是 Event Loop，这个等一等的事件，就被放在一个被称为事件（回调）队列的数据结构中。</p>
<p>于是上面的代码，实际在运行的时候，从事件队列的角度看，是这样的：</p>
<p><img src="https://static001.geekbang.org/resource/image/75/ff/757fe02c8910fe1d02be6d159ccf3cff.png" alt=""></p>
<p>工作线程不断地从整个事件队列的右侧取得新的事件来处理执行，而新的事件只会从左侧放入：</p>
<p>主代码最先被执行，从上往下顺序执行，因此顺序是：</p>
<ul> 
 <li>先打印 1；</li> 
 <li>在遇到第一个 setTimeout 的时候，告知浏览器，请在 0 秒之后往事件队列内放入执行打印 2 的事件；</li> 
 <li>在遇到第二个 setTimeout 的时候，告知浏览器，请在 5 秒之后往事件队列内放入执行打印 3 的事件；</li> 
 <li>再打印 4；</li> 
 <li>主代码执行完毕，Chrome 的控制台打印这段代码的返回值，但因为它没有返回值，于是就打印 undefined。</li> 
</ul>
<p>浏览器老老实实地按照要求放入了打印 2 的事件，虽然是第 0 秒就放入，但是因为放入的时候主代码还在执行，因此只能等待，它等到主代码执行完毕后才得到执行，打印了 2。</p>
<p>5 秒钟后，浏览器按照要求往队列里放入了打印 3 的事件，于是 3 被打印出来。</p>
<p>你看，通过这种方式，JavaScript 可以让不同的任务在一个线程中完成，而整个任务编排的机制，<strong>从代码的角度看，所有的逻辑都是通过七七八八的“异步回调”来完成的；而从程序员思维方式的角度看，以往基于线程的编程，变成了事件驱动的编程</strong>。</p>
<p><img src="https://static001.geekbang.org/resource/image/8f/b9/8f475ade881eeaa7e49a442e80af2db9.jpg" alt=""></p>
<p>上图来自 <a href="http://berb.github.io/diploma-thesis/original/043_threadsevents.html">The Case of Threads vs. Events</a>，很好地对比了两者的不同之处，其中：</p>
<p>对于逻辑的触发，基于线程编程需要不断地由监视线程去查询被监视线程的某一个状态，如果状态满足某个条件，则触发相应的逻辑；而事件驱动则通过事件处理器，在事件发生时执行挂载的回调逻辑。不知你是否联想起了 <a href="https://time.geekbang.org/column/article/136587">[第 03 讲]</a> 中我介绍的 push 和 pull，在这里，前者正类似于 pull 的形式，而后者则类似于 push 的形式。</p>
<p>基于线程的方式可以阻塞线程，等待时间或某个条件满足后再继续执行；而事件驱动则相反，发送一条消息后无阻塞等待回调的发生。阻塞线程的方式对资源的消耗往往更加显著，因为无论是否执行线程都被占用，但从人直观理解的角度来说，代码更直白，更符合人对顺序执行的理解；而事件驱动的方式则相反，资源消耗上更优，但是代码的执行顺序，以及由此产生的系统状态判断变得难以预知。</p>
<p>请注意的是，在 JavaScript 中我们通常无法使用基于线程的编程，但是在很多情况下，例如 Java 和 Python 这些传统的后端编程语言中，我们可以混合使用基于线程和事件驱动的编程，它们是互不矛盾的。</p>
<p>最后，为什么 JavaScript 要被设计成单线程的，多线程难道就不行吗？最重要的原因，就是为了让整个模型简单。如果引入多线程，这里有很多问题需要解决，例如事件处理的依赖关系（多线程的事件处理就不再是简单队列的挨个处理了），例如资源的共享和修改（无锁编程不再有效，必须要考虑同步等加锁机制了），整个系统会变得极其复杂，不只是对于浏览器的开发者而言，对前端的开发者也一样。</p>
<p>另外，需要说明的是，浏览器的 JavaScript 执行是单线程的，但不代表浏览器是单线程的。浏览器通常还包含其它线程，比如说：</p>
<ul> 
 <li>界面（GUI）渲染线程，这个线程的执行和上述的 JavaScript 工作线程是互斥的，即二者不可同时执行；</li> 
 <li>事件触发线程，这个也很好理解，我们介绍过有一个神秘人物帮着往队列中放入事件（例子中的回调打印 2 和回调打印 3），这个神秘人物就是事件触发线程。</li> 
</ul>
<h3>2. 学写声明式代码</h3>
<p>习惯于设计和书写大量的声明式代码，也是一个很重要的思维转变。</p>
<p>我们在 <a href="https://time.geekbang.org/column/article/140196">[第 07 讲]</a> 中讲过什么是声明式代码，为什么我们在写视图层的时候会大量使用声明式代码。HTML、CSS 和 JavaScript，前端的三驾马车，两架是用声明式代码写的，我们应当记得自己做的是前端开发，而不是一个单纯的 JavaScript 写手。</p>
<p><strong>声明式代码和命令式代码一样，都需要设计，且都需要测试。</strong>我见过不少工程师能够写出优秀的命令式代码，甚至已经习惯了，但是在写声明式代码的时候，却缺乏条理。</p>
<p>举例来说，设计页面的时候，要先设计布局，抓住整棵 DOM 树中核心的部分，自上而下地去划分区域，哪些是静态的区域，哪些是动态生成的，并合理设计可重用组件。再比如说，使用声明式代码处理模板中呈现数据的格式转换，使得呈现部分的代码更纯粹、自然，具体请参看 [第 16 讲] 中的过滤器。</p>
<h3>3. 培养交互思维</h3>
<p>前端工程师必须具备敏感的交互思维。通常来说，前端的代码，兼具着“甲方”和“乙方”的角色：</p>
<ul> 
 <li>对用户和前端的交互来说，客户是甲方，享受服务；前端就是乙方，提供服务。</li> 
 <li>对和服务端的交互来说，前端就是甲方，从服务端获得数据和服务；服务端就是乙方，提供数据和服务。</li> 
</ul>
<p>而无论是和用户，还是和服务端的交互，都是学习前端技术中需要领会的部分。<strong>和用户的交互要求开发前端的程序员具备产品思维，而和服务端的交互则要求开发前端的程序员具备工程思维。</strong></p>
<p>一头是用户，另一头是后端工程师，前端的开发人员，在整个庞大的研发体系中，既像粘合剂，又像润滑剂，要从产品和工程两个视角去思考问题，作出判断；不但要交付实实在在的功能，要引导好的工程架构，还要给用户带来优秀的产品体验。</p>
<h2>总结思考</h2>
<p>今天我们首先强调了对于基于 Web 的全栈学习来说，学习前端技术的重要性，接着我们介绍了前端思维的几个转变，特别是事件驱动编程。希望你已经了解了 JavaScript 的单线程运行机制，并能够慢慢习惯不断在代码中与异步和回调打交道。</p>
<p>下面留两个思考问题：</p>
<ul> 
 <li>你在技术团队中主要扮演什么角色，你对前端技术的认识是怎样的？</li> 
 <li>为什么 JavaScript 中，没有像 Java 或 Python 一样的 sleep 方法？毕竟，我就是想让当前执行过程稍等一下，再继续后面的逻辑，有 sleep 的话多方便啊。</li> 
</ul>
<p>最后，我想说的是，以前有句话叫做，“狗拿耗子，多管闲事”，但是我们在学习前端技术的时候，却要反过来，我们不但要多管闲事，还要“越管越多”，要多去想想类似的后端技术是怎样实现的。那在学习后端技术的时候，道理也是一样的，也要联想。</p>
<p>无论是早些年的 <a href="http://www.gwtproject.org/">GWT</a>，后端 Java 程序员写出了优秀的基于 Ajax 的跨浏览器应用；还是这些年的 <a href="https://nodejs.org/en/">Node.js</a>，利用强大的 V8 引擎把数不清的 JavaScript 异步回调也写到后端去……技术是没有边界的，前端和后端的技术当然也包括在内。</p>
<p>好，今天的内容就到这里，欢迎你和我讨论，也欢迎你邀请你的朋友一起阅读、学习。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>你可能听过这样一句话，“任何能用 JavaScript 写的应用，最终都会用 JavaScript 来实现。”这句话最初来自 <a href="https://blog.codinghorror.com/the-principle-of-least-power/">The Principle of Least Power</a> 这篇文章，写于 2007 年。</li> 
 <li>有位工程师做了一个<a href="http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIjEiKTsKCnNldFRpbWVvdXQoZnVuY3Rpb24gdGltZW91dCgpIHsKICAgIGNvbnNvbGUubG9nKCIyIik7Cn0sIDApOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIjMiKTsKfSwgNTAwMCk7Cgpjb25zb2xlLmxvZygiNCIpOw%3D%3D!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D">名为 Loupe 的网站</a>，用动画来形象地展示事件循环的过程，本文的例子也可以在它上面运行。</li> 
 <li>为什么浏览器中 JavaScript 代码的执行设计成单线程的，还有一个文中没有提到的原因，就是多线程的 GUI 特别容易死锁。这篇文章 <a href="https://community.oracle.com/blogs/kgh/2004/10/19/multithreaded-toolkits-failed-dream">Multithreaded toolkits: A failed dream?</a> 描述了其中的缘由，大致是说 GUI 的行为大多都是从更高层的抽象一层一层往下调用到更低层的抽象、具体工具类实现，再到操作系统；而事件则是反过来，从下往上冒泡。结果就是两个方向相反的行为在碰头，给资源加锁的时候一个正序，一个逆序，极其容易出现互相等待而饿死的情况，而这种情况下要彻底解决这一问题的难度无异于“逆转潮汐”。</li> 
 <li><a href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/">浏览器的工作原理：新式网络浏览器幕后揭秘</a>，这可能是在互联网上流传最广泛地介绍浏览器工作原理的中文文章，非常推荐。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |34          |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:27.717 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=34 
 {executed in 0 msec}
2020-11-19 17:54:27.718 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title          |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|-----|----|----|
|34  |1605756064 |1605756064 |1                |zh-hans  |0       |1                             |1      |0      |14丨别有洞天：从后端到前端 |book |1   |34  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|-----|----|----|

2020-11-19 17:54:27.719 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=34 
 {executed in 0 msec}
2020-11-19 17:54:27.719 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title          |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|----|----|
|[unread] |1605756064 |1605756064 |1                |zh-hans  |0       |1                             |1      |0      |14丨别有洞天：从后端到前端 |1   |34  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|---------------|----|----|

2020-11-19 17:54:27.724 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779667, created=1605779667, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='14丨别有洞天：从后端到前端', type='book', 
uid=1, vid=34 where nid=34 
 {executed in 1 msec}
2020-11-19 17:54:27.724 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779667, created=1605779667, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='14丨别有洞天：从后端到前端', 
uid=1, vid=34 where nid=34 
 {executed in 0 msec}
2020-11-19 17:54:27.732 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.733 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|34        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/be2d7a25bbca12eb11992891901b17f5?bkt=en-d3a65691252603d3a0bd9a2d9b6bb3b22779d834633fff1a6e88447a1b9f91dec9b9d1231b6a8de7&fid=3757516097-778750-716887119671835&time=1605756063&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-1IYBBCAG%2Bb9AzPAvUjogttCk4Jk%3D&to=92&size=14645473&sta_dx=14645473&sta_cs=2007&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030255&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14645473&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9421d65cb42737833d6aae194a6a33fce436e93c91e64628ca9079d2c6b9b311970ec293184e82df&sl=76480590&expires=8h&rt=pr&r=408416782&mlogid=7502251028512664463&vbdid=2247232042&fin=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a&bflag=92,34-92&rtype=1&dp-logid=7502251028512664463&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=92f9da3c8a3331aef8ad8cac1a175cede47622267f3dbc35&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a |34          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:54:27.738 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/be2d7a25bbca12eb11992891901b17f5?bkt=en-d3a65691252603d3a0bd9a2d9b6bb3b22779d834633fff1a6e88447a1b9f91dec9b9d1231b6a8de7&fid=3757516097-778750-180709743927988&time=1605779665&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-UiAQl2QaeNbqIFZRRqeSeXWU1pc%3D&to=92&size=14645473&sta_dx=14645473&sta_cs=2012&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030255&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14645473&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9421d65cb42737833d6aae194a6a33fce436e93c91e64628ca9079d2c6b9b311970ec293184e82df&sl=76480590&expires=8h&rt=pr&r=840535318&mlogid=7508586675188770066&vbdid=2247232042&fin=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a&bflag=92,34-92&rtype=1&dp-logid=7508586675188770066&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=39965399e74cce84a7ec2432bf54ac69fd854d795974ed3e&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a', 
revision_id=34 where entity_id=34 
 {executed in 1 msec}
2020-11-19 17:54:27.742 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=34 
 {executed in 1 msec}
2020-11-19 17:54:27.742 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/be2d7a25bbca12eb11992891901b17f5?bkt=en-d3a65691252603d3a0bd9a2d9b6bb3b22779d834633fff1a6e88447a1b9f91dec9b9d1231b6a8de7&fid=3757516097-778750-716887119671835&time=1605756063&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-1IYBBCAG%2Bb9AzPAvUjogttCk4Jk%3D&to=92&size=14645473&sta_dx=14645473&sta_cs=2007&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030255&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14645473&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9421d65cb42737833d6aae194a6a33fce436e93c91e64628ca9079d2c6b9b311970ec293184e82df&sl=76480590&expires=8h&rt=pr&r=408416782&mlogid=7502251028512664463&vbdid=2247232042&fin=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a&bflag=92,34-92&rtype=1&dp-logid=7502251028512664463&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=92f9da3c8a3331aef8ad8cac1a175cede47622267f3dbc35&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a |34          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:54:27.747 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/be2d7a25bbca12eb11992891901b17f5?bkt=en-d3a65691252603d3a0bd9a2d9b6bb3b22779d834633fff1a6e88447a1b9f91dec9b9d1231b6a8de7&fid=3757516097-778750-180709743927988&time=1605779665&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-UiAQl2QaeNbqIFZRRqeSeXWU1pc%3D&to=92&size=14645473&sta_dx=14645473&sta_cs=2012&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030255&mtime=1605778300&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=14645473&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9421d65cb42737833d6aae194a6a33fce436e93c91e64628ca9079d2c6b9b311970ec293184e82df&sl=76480590&expires=8h&rt=pr&r=840535318&mlogid=7508586675188770066&vbdid=2247232042&fin=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a&bflag=92,34-92&rtype=1&dp-logid=7508586675188770066&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=39965399e74cce84a7ec2432bf54ac69fd854d795974ed3e&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=14%E4%B8%A8%E5%88%AB%E6%9C%89%E6%B4%9E%E5%A4%A9%EF%BC%9A%E4%BB%8E%E5%90%8E%E7%AB%AF%E5%88%B0%E5%89%8D%E7%AB%AF.m4a', 
revision_id=34 where entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.750 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.752 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|34        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/94/56/8132292a.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>Carson</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    Javascript 是单线程+事件驱动，单线程就是主线程。Javscript 必须让主线程一直处于运行当中，才能实现事件驱动。它无法通过简单的 sleep 主线程来达到 sleep 后继续执行某件事目的。
    <br>
    <br>以上是我的理解，不确定是否有误。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">3</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>不记年</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    思考题的第二个， 我觉得应该是因为js是单线程的，如果设置sleep的话，就是阻塞唯一的线程，而又没有一个监视线程去pull。而且按照事件驱动编程的逻辑，如果想sleep当前正常执行的事件的话，应该也使用事件回调的方式，这样就只阻塞事件而不是线程。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>不记年</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我所理解的js 执行过程分为两部分，第一部分是做一些初始化的工作， 初始化工作包括初始化一些参数之类的，以及告知浏览器事件以及触发的逻辑。第二部分是事件循环，不断地往事件队列中抓取事件执行。在这整个过程中。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/e7/a0/9a962a74.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>joker</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    他是执行哪段代码出的underfined
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: console.log("4");</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我一直从事后端开发，但是经过了几个Web项目后，对前端的认识发生了转变，真的就像老师文中所说的那样。这个感触在直接面向用户时尤其明显，感觉连原有的部门开发流程都不适应了。
    <br>
    <br>至于为什么没有sleep，是不是因为sleep里指定的时间只对事件分发线程有效，而真正被JavaScript执行线程从事件对列中取出来执行时，时间已经非常不准确了。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 第二问不太正确，你可以联系文中介绍的 event loop 再想想。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>許敲敲</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    Web developer ,工作中就是开发公司的组件库，客户报defect 去fix 。想说前端水好深， WebGL ,tensorflow.js ,webassembly 这些技术都好强悍
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |34          |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:54:27.757 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.759 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |delta |field_comment_format |langcode |revision_id |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/94/56/8132292a.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>Carson</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    Javascript 是单线程+事件驱动，单线程就是主线程。Javscript 必须让主线程一直处于运行当中，才能实现事件驱动。它无法通过简单的 sleep 主线程来达到 sleep 后继续执行某件事目的。
    <br>
    <br>以上是我的理解，不确定是否有误。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">3</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>不记年</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    思考题的第二个， 我觉得应该是因为js是单线程的，如果设置sleep的话，就是阻塞唯一的线程，而又没有一个监视线程去pull。而且按照事件驱动编程的逻辑，如果想sleep当前正常执行的事件的话，应该也使用事件回调的方式，这样就只阻塞事件而不是线程。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>不记年</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我所理解的js 执行过程分为两部分，第一部分是做一些初始化的工作， 初始化工作包括初始化一些参数之类的，以及告知浏览器事件以及触发的逻辑。第二部分是事件循环，不断地往事件队列中抓取事件执行。在这整个过程中。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/e7/a0/9a962a74.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>joker</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    他是执行哪段代码出的underfined
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: console.log("4");</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    我一直从事后端开发，但是经过了几个Web项目后，对前端的认识发生了转变，真的就像老师文中所说的那样。这个感触在直接面向用户时尤其明显，感觉连原有的部门开发流程都不适应了。
    <br>
    <br>至于为什么没有sleep，是不是因为sleep里指定的时间只对事件分发线程有效，而真正被JavaScript执行线程从事件对列中取出来执行时，时间已经非常不准确了。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 第二问不太正确，你可以联系文中介绍的 event loop 再想想。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>許敲敲</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    Web developer ,工作中就是开发公司的组件库，客户报defect 去fix 。想说前端水好深， WebGL ,tensorflow.js ,webassembly 这些技术都好强悍
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |34          |
|----------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:54:27.764 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.764 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|34        |book   |0     |zh-hans  |34          |https://static001.geekbang.org/resource/image/65/7e/65a5531e257c7468659493612a6ea37e.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:54:27.769 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.769 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |34          |https://static001.geekbang.org/resource/image/65/7e/65a5531e257c7468659493612a6ea37e.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:54:27.774 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.775 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |34          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:27.779 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=34 
 {executed in 0 msec}
2020-11-19 17:54:27.780 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |34          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:27.785 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='315018048607464' 
 {executed in 0 msec}
2020-11-19 17:54:27.785 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|35        |book   |0     |315018048607464  |zh-hans  |35          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:27.786 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=35 
 {executed in 0 msec}
2020-11-19 17:54:27.786 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|35  |zh-hans  |book |5d9ea852-ef02-48b8-a3d0-c9e1bb044295 |35  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:54:27.791 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.791 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |315018048607464  |zh-hans  |35          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:27.796 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=35 
 {executed in 0 msec}
2020-11-19 17:54:27.796 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|35  |1   |2     |1            |1  |35 |0  |0  |0  |1   |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:54:27.801 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.802 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------|-------------|-------|------|------------|---------|------------|
|35        |           |             |book   |0     |full_html   |zh-hans  |35          |
|----------|-----------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:27.802 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.803 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------|-------------|-------|------|------------|---------|------------|
|[unread]  |           |             |book   |0     |full_html   |zh-hans  |35          |
|----------|-----------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:27.812 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=35 
 {executed in 1 msec}
2020-11-19 17:54:27.812 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                    |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|
|35  |1605756064 |1605756064 |1                |zh-hans  |0       |1                             |1      |0      |02丨第二章 欢迎来到 MVC 的世界 (7讲) |book |1   |35  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|

2020-11-19 17:54:27.813 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=35 
 {executed in 0 msec}
2020-11-19 17:54:27.814 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                    |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|
|[unread] |1605756064 |1605756064 |1                |zh-hans  |0       |1                             |1      |0      |02丨第二章 欢迎来到 MVC 的世界 (7讲) |1   |35  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|

2020-11-19 17:54:27.819 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779667, created=1605779667, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='02丨第二章 欢迎来到 MVC 的世界 
(7讲)', type='book', uid=1, vid=35 where nid=35 
 {executed in 1 msec}
2020-11-19 17:54:27.819 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779667, created=1605779667, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='02丨第二章 
欢迎来到 MVC 的世界 (7讲)', uid=1, vid=35 where nid=35 
 {executed in 0 msec}
2020-11-19 17:54:27.826 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=35 
 {executed in 1 msec}
2020-11-19 17:54:27.826 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value |revision_id |
|----------|-------|------|---------|------------------|------------|
|35        |book   |0     |zh-hans  |                  |35          |
|----------|-------|------|---------|------------------|------------|

2020-11-19 17:54:27.831 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.831 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value |revision_id |
|----------|-------|------|---------|------------------|------------|
|[unread]  |book   |0     |zh-hans  |                  |35          |
|----------|-------|------|---------|------------------|------------|

2020-11-19 17:54:27.836 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.837 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------|------|---------------------|---------|------------|
|35        |book   |                    |0     |full_html            |zh-hans  |35          |
|----------|-------|--------------------|------|---------------------|---------|------------|

2020-11-19 17:54:27.842 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.842 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|--------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value |delta |field_comment_format |langcode |revision_id |
|----------|-------|--------------------|------|---------------------|---------|------------|
|[unread]  |book   |                    |0     |full_html            |zh-hans  |35          |
|----------|-------|--------------------|------|---------------------|---------|------------|

2020-11-19 17:54:27.847 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.847 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value |
|----------|-------|------|---------|------------|------------------|
|35        |book   |0     |zh-hans  |35          |                  |
|----------|-------|------|---------|------------|------------------|

2020-11-19 17:54:27.852 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.853 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value |
|----------|-------|------|---------|------------|------------------|
|[unread]  |book   |0     |zh-hans  |35          |                  |
|----------|-------|------|---------|------------|------------------|

2020-11-19 17:54:27.858 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=35 
 {executed in 1 msec}
2020-11-19 17:54:27.858 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |35          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:27.863 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=35 
 {executed in 0 msec}
2020-11-19 17:54:27.863 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |35          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:29.067 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='46226448877551' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:54:29.068 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:58.948 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='46226448877551' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:54:58.949 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:58.952 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('46226448877551', 1, 'net_content') 
 {executed in 1 msec}
2020-11-19 17:54:58.953 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('46226448877551', 
1, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:54:58.954 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|59            |
|--------------|

2020-11-19 17:54:58.982 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='46226448877551' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:54:58.983 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:59.384 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='46226448877551' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:54:59.385 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:54:59.387 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('46226448877551', 1, 'media') 
 {executed in 1 msec}
2020-11-19 17:54:59.387 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('46226448877551', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:54:59.388 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|60            |
|--------------|

2020-11-19 17:54:59.408 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='46226448877551' 
 {executed in 1 msec}
2020-11-19 17:54:59.408 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|36        |book   |0     |46226448877551   |zh-hans  |36          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:59.409 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=36 
 {executed in 0 msec}
2020-11-19 17:54:59.409 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|36  |zh-hans  |book |c91e0986-aab7-4295-a5c2-248b32556dd8 |36  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:54:59.415 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.416 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |46226448877551   |zh-hans  |36          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:54:59.421 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=36 
 {executed in 0 msec}
2020-11-19 17:54:59.422 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|36  |1   |3     |0            |1  |35 |36 |0  |0  |35  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:54:59.427 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.429 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|36        |<p>你好，我是四火。</p>
<p>又到了一章的末尾，特别放送时间。专栏上线后的这几周，我在留言区回答了一些问题，有一些是技术上的问题，也有一些是非技术上的问题。尽管在 <a href="https://time.geekbang.org/column/article/134212">[开篇词]</a> 和 <a href="https://time.geekbang.org/column/article/134216">[学习路径]</a> 中我已经介绍了全栈工程师的角色、重要性和学习方法，但是依然见到不少困惑和疑问，<strong>其中一个问题反复出现，那就是面对那么多的软件技术，总有一种“学不过来”的感觉，为此感到焦虑和担忧</strong>。尤其是对于全栈工程师而言，这个话题更是被放大了。</p>
<p>颇为遗憾的是，这几年来，我见到了一些相当有经验的做着 Web 全栈开发的程序员，他们还依然走在一条埋头苦干，不断堆积知识，单纯靠量取胜的路上。可是，我认为，学习是需要选择的，并且，选择比努力更重要。</p>
<p>今天的特别放送，我就来聊一聊，我是怎么认识这个问题的，希望能给你带来一点参考意义。</p>
<h2>两个小故事</h2>
<p>第一个故事，微软的测试团队改革。陆奇是一个程序员从技术做起，进而翻身的典范。最初他入职雅虎的时候只是一个普通的工程师，十多年后 ，他以执行副总裁的身份，不但牵头打造了 Bing 搜索，还完成了几项意义深远的改革，其中一项，就是合并开发和测试这两个原本独立的部门，大幅裁剪专职测试人员，让工程师做更多的事。</p>
<p>这样一来，有一些擅长使用内部测试工具进行测试的工程师，就慢慢丢掉工作了，原因很简单，他们更多的只是熟练工，而缺乏技术上的竞争力。<strong>听起来，这似乎是微软内部组织架构变动和工具、技术栈封闭的锅</strong>。</p><!-- [[[read_end]]] -->
<p>其实，合并开发和测试团队，对于许多软件公司，特别是互联网公司来说，是一个基本不需要讨论的事情。除了一些面向互联网用户的、交互较为复杂的团队，还配有专职测试（即便是这样的测试，为了节省成本，也常常外包给合同工去做了），绝大多数团队，都已经变成了软件工程师一肩挑的局面了，而测试只是被合并的一部分专职角色，其实还有线上运维等等。对于大型互联网企业来说，一个事实就是，工程师的全面性越来越强，这是一个不可辩驳的趋势。</p>
<p>第二个故事，是我在几个月前，参与面试一位有着超过 15 年 Web 开发经验的工程师，这件事就发生在五轮面试之后的讨论会上（这里涉及到的面试流程我曾在 <a href="https://time.geekbang.org/column/article/139370">[第 06 讲]</a> 中介绍过）。</p>
<p>对于这样一个比较资深的工程师岗，五个面试官，在讨论会上产生了巨大的分歧。招聘经理，也就是负责吃饭聊天那一轮面试的人，反馈非常正面，说此人经验丰富，谈吐得当，leadship 层面也没有问题；Bartender（技术负责人）重点考察了项目经验和系统设计，反馈也颇为不错，经验丰富，而且能够从很多角度去分析和思考问题；可其余的三轮面试，面试官反映却大相径庭，主要问题出在白板代码部分，总的来说，代码生疏，书写也缺乏条理，其中有一轮都没有写完代码，写完的两轮也是 bug 满地，问题频出。最后，在争论之后达成一致，可以通过，但是只能勉强给一个比预期职位级别低一级的 offer。</p>
<p>作为一个技术岗位的工程师，编码能力是一个硬指标，因此这也是照章办事，不得已而为之的。只不过，我们私下里讨论，应聘者很可能是有足够的编码技巧的，只不过有一段时间没有写代码了，确实有些可惜。但是，猜想也只是猜想而已。</p>
<p>其实，故事有很多，但是这两个故事是我精心挑选的。二者分别对应的启发是，工程师在技术学习的时候，需要遵循的两个主要思路。</p>
<ul> 
 <li>第一，技术是分级的，具体说，是分短命和长寿的，也是分表面和本质的。我们要学习各种技术，但是我们要把足够的精力放到长寿的技术以及技术本质上。这就是第一个故事带来的启发。</li> 
 <li>第二，基础知识和能力的训练需要长期坚持，无论是在工作中，还是工作以外。这就是第二个故事带来的启发。</li> 
</ul>
<h2>技术的分级</h2>
<p>下面我展开来讲第一个思路，技术分级。</p>
<p>我们都听过“技术无贵贱”的说法，但这并不代表我们要“无区别”地学习技术。工程师，说白了最重要的就是“工程能力”，就是应用工程化的思想和技术，去解决实际的问题。我把工程能力粗略地分成这样四个级别，请注意，<strong>它们都必不可少</strong>，这个分级也不严密，但是我们能从中看到一个大致的趋势：</p>
<p><img src="https://static001.geekbang.org/resource/image/12/e4/12471848fea52f2c04ef7f676bab62e4.png" alt=""></p>
<ul> 
 <li>比如说，稳定性上，从左到右逐渐降低，越靠右往往寿命越短。</li> 
 <li>比如说，学习难度上，不一定，但是总体来说从左到右逐渐降低。</li> 
 <li>比如说，针对性上，往往从左到右逐渐增加，即越往右就越是针对具体的问题。</li> 
</ul>
<p>下面我来具体说说图中的这几种能力。</p>
<p>软能力，比如我们对程序员要求最多的沟通能力、学习能力和抽象能力。哪怕再过几十年，这部分基本也是不会变的。</p>
<p>模式和思想，比如分而治之的思想，模块化的思维，客户端 / 服务端模式。这部分也相当稳定，可能随着技术的革新，也会有一些以往不受重视的模式或思想被列为重点，举例来说，十年前，我们可能很少谈论分布式的思想。</p>
<p>语言和平台，比如 Java 语言，JVM 平台。这部分其实变化就非常大了，有的语言已经几十年了，有的则是几年热度之后就消退了。普遍来说，语言平台要比语言本身稳定一些。</p>
<p>框架和库，这部分差异也非常大，但是总体来说，基本就是最短命的。如果要花费大量的时间和心血去深究某一个框架和库，那么你会希望它要么相当有代表性和典型意义，要么有足够长远的未来。</p>
<p>对于这几种能力，还有几点我要强调说明一下。</p>
<p>首先，请不要误解我的意思。每一级的能力都是有各自价值的，<strong>我们在解决实际问题的时候，需要使用到每一级的技术</strong>。举例来说，要设计实现一个网站，全栈工程师需要发挥沟通能力、合作能力，需要利用在模式和思想方面的经验和认识，选择合适的语言和平台，最后再选择相应的框架和库来完成它。</p>
<p>其次，我们当然希望图中靠左侧的“长寿”的能力得到进步，但每一级能力的培养，都需要通过对具体技术、业务的学习积累来实现，也就是说，<strong>这些分级之间是不冲突的，反而是互相促进的</strong>。通过这两章的学习，特别是从具体技术到通用模式这样的方式，也许你已经体会到了这一点。</p>
<p>那么现在，有了上面的说明，你是否已经清楚，该做出怎样的侧重了呢？</p>
<p>显然，我们应该明确的一点是，把几乎全部的精力都投入到这个分级的右端，换言之，<strong>把大量的时间都花在记忆一个接一个的框架和库上面，妄图靠数量取胜，不可取</strong>。有时更可悲的是，就连生硬的记忆本身也不讨好——都不用等到技术淘汰了，它们还都是公司内部的框架和库，离开公司就一文不值了。</p>
<p>因为，这只是单纯地记忆，没有比较、分析、思考这些能让这个分级均衡发展的行为。而这，我认为正是系统的技术学习中最大的误区。</p>
<p>我举一个真实的例子来说明这个现象，有位程序员朋友学习前端技术，最开始使用 Backbone.js，后来陆续用过 AngularJS 以及 React，现在准备转向 Vue.js。看起来似乎很勤奋，但是他自己却说他依然只是停留在上头说用什么，自己就跟着学什么的程度，自己也没有什么想法，总之越学越麻木……他自己还说“不知道何时是个头”。</p>
<p>接着，我想展开讲一下其它几个具体技术学习中的典型误区，而这些误区，在我看来也都和是否努力无关，本质上也都属于不恰当的“选择”。</p>
<p><strong>1. 过于关注配置使用，忽略原理和场景分析。</strong></p>
<p>这一点我觉得是最容易在迈入职场没多久的程序员身上见到的问题，非常普遍。老板一个命令下来，心里慌得很，就想着怎么把问题搞定，而有一些问题是知识迷局一类的，比如，怎样配置整合 SSH（Struts、Spring 和 Hibernate）。</p>
<p>这类问题光靠想是没法得出结论的，于是通过各种搜索、查文档、试错等等方式，花了很长时间，好不容易搞定了问题，完成了需求，又紧锣密鼓地去接下一个任务去了。<strong>可是呢，对于刚才使用到的技术，付出了那么多，却只收获了这一个小小的迷局的解</strong>。这投入产出比低不说，人还是很健忘的，这些具体的配置和使用，只要不用，很快就会忘掉的，下次在遇到类似的问题，可能已经忘记了这些配置，于是又要重复这一行为。</p>
<p><strong>2. 过于关注编程语言的语法和语言技巧，忽略语言思考和书写时的思维模式。</strong></p>
<p>比如说，JavaScript 语言，里面有很多坑，但是有一些坑是语言本身的不良设计造成的，知道当然好，但也不要因此沾沾自喜。但是对于一个写惯了 C++、Java 等后端静态语言的程序员来说，JavaScript 异步编程、函数成为一等公民等等这些颠覆以往编程思维模式的特性，才是学习这门新语言一个收获颇丰的地方（我们会在下一章介绍）。换言之，我们要写 JavaScript，就要写真正的 JavaScript——而不是写 Java，再按字面翻译成 JavaScript。</p>
<p><strong>3. 过于关注具体实现逻辑，忽略了对于设计的思考和权衡。</strong></p>
<p>我看到很多程序员朋友都热衷于研究源码，看完一个库，再看下一个，有些人甚至以读过源码的数量为荣，张口闭口就是“你读过多少源码”。</p>
<p>阅读源码当然是一件好事，但是请不要认为研究源码的目的只是“知道怎么实现”。毕竟，每个人的时间精力都是有限的，读源码尤其耗时。既然要读，就要读得有所收获，而不是凭空指望“读书百遍，其义自见”。比如说，阅读的时候，要抓住主干，去思考里面的设计思路，也就是所谓的“代码骨干”，忽略那些次要的边边角角。</p>
<p><strong>4. 直接学习模式和思想，脱离了具体实践。</strong></p>
<p>我已经介绍了模式和思想学习的好处，但是对于那些抽象的理论和概念，在没有实践的基础上，是很难真正“消化吸收”的。最好的方法是动手做一做，如果时间有限，至少也要阅读和了解它们都被哪些具体技术采用怎样的方式实现了。</p>
<h2>基础知识和能力</h2>
<p>下面我来说说第二个思路，基础知识和能力。</p>
<p>即便在同一级的技术上，我们的学习也应该是有轻重缓急的。我们的项目中需要的技术，当然要学，但是我们心里需要清楚那些所谓的“基础”。生活不可能完美，工作也是，工作中学当然很好，但<strong>很遗憾的是，有很多“基础”光靠工作中学是很难有较大进步的</strong>。比方说，算法和数据结构。</p>
<p>我认为，数据结构、算法、网络等等这些，都是基础知识，如果工作中的强化不够，工作以外的学习和训练还是需要的。如果你的基础不够扎实，特别是“非科班”出身的话，它就更加重要了。比较好的一点是，这些相对于“设计能力”“问题解决能力”等等来说，还是要好学很多。</p>
<p><strong>除了基础知识，还有基础能力。最重要的，就是编程能力。</strong>值得庆幸的是，我相信大部分程序员都会在工作中有足够的编程时间，因此，只要专注、带着思考去写代码，认真对待代码评审，编程能力是会随着经验的增加而逐渐提升的。</p>
<p>最后，你正在学习的这个专栏，涉及了大量的全栈技术相关的知识，但是从内容设计上你应该可以看出，我希望能更多地介绍其中的“套路”，也就是上图中的模式和思想，有些是同类技术所共同有的（比如前几讲介绍过的 IoC），有些则是跨技术类型，但却依然共有的（比如幂等性和安全性）。</p>
<h2>总结思考</h2>
<p>今天的特别放送，我结合了自己的积累，介绍了我们该怎样做出选择，来应对这个“学不过来”的话题，特别是介绍了一些常见的学习误区，希望你能从我的答案中有所收获。</p>
<p>今天就不放特定的思考题了，因为我觉得，这一类主观性特别强的话题，很容易有不同的认识，不需要拿问题来引导思考方向了，不加限定地思考会更好。欢迎你在下面的留言区谈谈自己的看法，我们一起讨论。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>有一篇文章，<a href="https://sizovs.net/2018/12/17/stop-learning-frameworks/">Stop Learning Frameworks</a>，观点比较朴实，也比较偏激，在程序员群体内掀起了轩然大波，有朋友翻译了，译文在<a href="https://zhuanlan.zhihu.com/p/52814937">这里</a>。</li> 
 <li>关于传统关系数据库技术淘汰的事情，以前我写过一点小<a href="https://www.raychase.net/3689">体会</a>，可供参考。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |36          |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:59.431 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=36 
 {executed in 1 msec}
2020-11-19 17:54:59.433 INFO  jdbc.resultsettable Line:610 - 
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>又到了一章的末尾，特别放送时间。专栏上线后的这几周，我在留言区回答了一些问题，有一些是技术上的问题，也有一些是非技术上的问题。尽管在 <a href="https://time.geekbang.org/column/article/134212">[开篇词]</a> 和 <a href="https://time.geekbang.org/column/article/134216">[学习路径]</a> 中我已经介绍了全栈工程师的角色、重要性和学习方法，但是依然见到不少困惑和疑问，<strong>其中一个问题反复出现，那就是面对那么多的软件技术，总有一种“学不过来”的感觉，为此感到焦虑和担忧</strong>。尤其是对于全栈工程师而言，这个话题更是被放大了。</p>
<p>颇为遗憾的是，这几年来，我见到了一些相当有经验的做着 Web 全栈开发的程序员，他们还依然走在一条埋头苦干，不断堆积知识，单纯靠量取胜的路上。可是，我认为，学习是需要选择的，并且，选择比努力更重要。</p>
<p>今天的特别放送，我就来聊一聊，我是怎么认识这个问题的，希望能给你带来一点参考意义。</p>
<h2>两个小故事</h2>
<p>第一个故事，微软的测试团队改革。陆奇是一个程序员从技术做起，进而翻身的典范。最初他入职雅虎的时候只是一个普通的工程师，十多年后 ，他以执行副总裁的身份，不但牵头打造了 Bing 搜索，还完成了几项意义深远的改革，其中一项，就是合并开发和测试这两个原本独立的部门，大幅裁剪专职测试人员，让工程师做更多的事。</p>
<p>这样一来，有一些擅长使用内部测试工具进行测试的工程师，就慢慢丢掉工作了，原因很简单，他们更多的只是熟练工，而缺乏技术上的竞争力。<strong>听起来，这似乎是微软内部组织架构变动和工具、技术栈封闭的锅</strong>。</p><!-- [[[read_end]]] -->
<p>其实，合并开发和测试团队，对于许多软件公司，特别是互联网公司来说，是一个基本不需要讨论的事情。除了一些面向互联网用户的、交互较为复杂的团队，还配有专职测试（即便是这样的测试，为了节省成本，也常常外包给合同工去做了），绝大多数团队，都已经变成了软件工程师一肩挑的局面了，而测试只是被合并的一部分专职角色，其实还有线上运维等等。对于大型互联网企业来说，一个事实就是，工程师的全面性越来越强，这是一个不可辩驳的趋势。</p>
<p>第二个故事，是我在几个月前，参与面试一位有着超过 15 年 Web 开发经验的工程师，这件事就发生在五轮面试之后的讨论会上（这里涉及到的面试流程我曾在 <a href="https://time.geekbang.org/column/article/139370">[第 06 讲]</a> 中介绍过）。</p>
<p>对于这样一个比较资深的工程师岗，五个面试官，在讨论会上产生了巨大的分歧。招聘经理，也就是负责吃饭聊天那一轮面试的人，反馈非常正面，说此人经验丰富，谈吐得当，leadship 层面也没有问题；Bartender（技术负责人）重点考察了项目经验和系统设计，反馈也颇为不错，经验丰富，而且能够从很多角度去分析和思考问题；可其余的三轮面试，面试官反映却大相径庭，主要问题出在白板代码部分，总的来说，代码生疏，书写也缺乏条理，其中有一轮都没有写完代码，写完的两轮也是 bug 满地，问题频出。最后，在争论之后达成一致，可以通过，但是只能勉强给一个比预期职位级别低一级的 offer。</p>
<p>作为一个技术岗位的工程师，编码能力是一个硬指标，因此这也是照章办事，不得已而为之的。只不过，我们私下里讨论，应聘者很可能是有足够的编码技巧的，只不过有一段时间没有写代码了，确实有些可惜。但是，猜想也只是猜想而已。</p>
<p>其实，故事有很多，但是这两个故事是我精心挑选的。二者分别对应的启发是，工程师在技术学习的时候，需要遵循的两个主要思路。</p>
<ul> 
 <li>第一，技术是分级的，具体说，是分短命和长寿的，也是分表面和本质的。我们要学习各种技术，但是我们要把足够的精力放到长寿的技术以及技术本质上。这就是第一个故事带来的启发。</li> 
 <li>第二，基础知识和能力的训练需要长期坚持，无论是在工作中，还是工作以外。这就是第二个故事带来的启发。</li> 
</ul>
<h2>技术的分级</h2>
<p>下面我展开来讲第一个思路，技术分级。</p>
<p>我们都听过“技术无贵贱”的说法，但这并不代表我们要“无区别”地学习技术。工程师，说白了最重要的就是“工程能力”，就是应用工程化的思想和技术，去解决实际的问题。我把工程能力粗略地分成这样四个级别，请注意，<strong>它们都必不可少</strong>，这个分级也不严密，但是我们能从中看到一个大致的趋势：</p>
<p><img src="https://static001.geekbang.org/resource/image/12/e4/12471848fea52f2c04ef7f676bab62e4.png" alt=""></p>
<ul> 
 <li>比如说，稳定性上，从左到右逐渐降低，越靠右往往寿命越短。</li> 
 <li>比如说，学习难度上，不一定，但是总体来说从左到右逐渐降低。</li> 
 <li>比如说，针对性上，往往从左到右逐渐增加，即越往右就越是针对具体的问题。</li> 
</ul>
<p>下面我来具体说说图中的这几种能力。</p>
<p>软能力，比如我们对程序员要求最多的沟通能力、学习能力和抽象能力。哪怕再过几十年，这部分基本也是不会变的。</p>
<p>模式和思想，比如分而治之的思想，模块化的思维，客户端 / 服务端模式。这部分也相当稳定，可能随着技术的革新，也会有一些以往不受重视的模式或思想被列为重点，举例来说，十年前，我们可能很少谈论分布式的思想。</p>
<p>语言和平台，比如 Java 语言，JVM 平台。这部分其实变化就非常大了，有的语言已经几十年了，有的则是几年热度之后就消退了。普遍来说，语言平台要比语言本身稳定一些。</p>
<p>框架和库，这部分差异也非常大，但是总体来说，基本就是最短命的。如果要花费大量的时间和心血去深究某一个框架和库，那么你会希望它要么相当有代表性和典型意义，要么有足够长远的未来。</p>
<p>对于这几种能力，还有几点我要强调说明一下。</p>
<p>首先，请不要误解我的意思。每一级的能力都是有各自价值的，<strong>我们在解决实际问题的时候，需要使用到每一级的技术</strong>。举例来说，要设计实现一个网站，全栈工程师需要发挥沟通能力、合作能力，需要利用在模式和思想方面的经验和认识，选择合适的语言和平台，最后再选择相应的框架和库来完成它。</p>
<p>其次，我们当然希望图中靠左侧的“长寿”的能力得到进步，但每一级能力的培养，都需要通过对具体技术、业务的学习积累来实现，也就是说，<strong>这些分级之间是不冲突的，反而是互相促进的</strong>。通过这两章的学习，特别是从具体技术到通用模式这样的方式，也许你已经体会到了这一点。</p>
<p>那么现在，有了上面的说明，你是否已经清楚，该做出怎样的侧重了呢？</p>
<p>显然，我们应该明确的一点是，把几乎全部的精力都投入到这个分级的右端，换言之，<strong>把大量的时间都花在记忆一个接一个的框架和库上面，妄图靠数量取胜，不可取</strong>。有时更可悲的是，就连生硬的记忆本身也不讨好——都不用等到技术淘汰了，它们还都是公司内部的框架和库，离开公司就一文不值了。</p>
<p>因为，这只是单纯地记忆，没有比较、分析、思考这些能让这个分级均衡发展的行为。而这，我认为正是系统的技术学习中最大的误区。</p>
<p>我举一个真实的例子来说明这个现象，有位程序员朋友学习前端技术，最开始使用 Backbone.js，后来陆续用过 AngularJS 以及 React，现在准备转向 Vue.js。看起来似乎很勤奋，但是他自己却说他依然只是停留在上头说用什么，自己就跟着学什么的程度，自己也没有什么想法，总之越学越麻木……他自己还说“不知道何时是个头”。</p>
<p>接着，我想展开讲一下其它几个具体技术学习中的典型误区，而这些误区，在我看来也都和是否努力无关，本质上也都属于不恰当的“选择”。</p>
<p><strong>1. 过于关注配置使用，忽略原理和场景分析。</strong></p>
<p>这一点我觉得是最容易在迈入职场没多久的程序员身上见到的问题，非常普遍。老板一个命令下来，心里慌得很，就想着怎么把问题搞定，而有一些问题是知识迷局一类的，比如，怎样配置整合 SSH（Struts、Spring 和 Hibernate）。</p>
<p>这类问题光靠想是没法得出结论的，于是通过各种搜索、查文档、试错等等方式，花了很长时间，好不容易搞定了问题，完成了需求，又紧锣密鼓地去接下一个任务去了。<strong>可是呢，对于刚才使用到的技术，付出了那么多，却只收获了这一个小小的迷局的解</strong>。这投入产出比低不说，人还是很健忘的，这些具体的配置和使用，只要不用，很快就会忘掉的，下次在遇到类似的问题，可能已经忘记了这些配置，于是又要重复这一行为。</p>
<p><strong>2. 过于关注编程语言的语法和语言技巧，忽略语言思考和书写时的思维模式。</strong></p>
<p>比如说，JavaScript 语言，里面有很多坑，但是有一些坑是语言本身的不良设计造成的，知道当然好，但也不要因此沾沾自喜。但是对于一个写惯了 C++、Java 等后端静态语言的程序员来说，JavaScript 异步编程、函数成为一等公民等等这些颠覆以往编程思维模式的特性，才是学习这门新语言一个收获颇丰的地方（我们会在下一章介绍）。换言之，我们要写 JavaScript，就要写真正的 JavaScript——而不是写 Java，再按字面翻译成 JavaScript。</p>
<p><strong>3. 过于关注具体实现逻辑，忽略了对于设计的思考和权衡。</strong></p>
<p>我看到很多程序员朋友都热衷于研究源码，看完一个库，再看下一个，有些人甚至以读过源码的数量为荣，张口闭口就是“你读过多少源码”。</p>
<p>阅读源码当然是一件好事，但是请不要认为研究源码的目的只是“知道怎么实现”。毕竟，每个人的时间精力都是有限的，读源码尤其耗时。既然要读，就要读得有所收获，而不是凭空指望“读书百遍，其义自见”。比如说，阅读的时候，要抓住主干，去思考里面的设计思路，也就是所谓的“代码骨干”，忽略那些次要的边边角角。</p>
<p><strong>4. 直接学习模式和思想，脱离了具体实践。</strong></p>
<p>我已经介绍了模式和思想学习的好处，但是对于那些抽象的理论和概念，在没有实践的基础上，是很难真正“消化吸收”的。最好的方法是动手做一做，如果时间有限，至少也要阅读和了解它们都被哪些具体技术采用怎样的方式实现了。</p>
<h2>基础知识和能力</h2>
<p>下面我来说说第二个思路，基础知识和能力。</p>
<p>即便在同一级的技术上，我们的学习也应该是有轻重缓急的。我们的项目中需要的技术，当然要学，但是我们心里需要清楚那些所谓的“基础”。生活不可能完美，工作也是，工作中学当然很好，但<strong>很遗憾的是，有很多“基础”光靠工作中学是很难有较大进步的</strong>。比方说，算法和数据结构。</p>
<p>我认为，数据结构、算法、网络等等这些，都是基础知识，如果工作中的强化不够，工作以外的学习和训练还是需要的。如果你的基础不够扎实，特别是“非科班”出身的话，它就更加重要了。比较好的一点是，这些相对于“设计能力”“问题解决能力”等等来说，还是要好学很多。</p>
<p><strong>除了基础知识，还有基础能力。最重要的，就是编程能力。</strong>值得庆幸的是，我相信大部分程序员都会在工作中有足够的编程时间，因此，只要专注、带着思考去写代码，认真对待代码评审，编程能力是会随着经验的增加而逐渐提升的。</p>
<p>最后，你正在学习的这个专栏，涉及了大量的全栈技术相关的知识，但是从内容设计上你应该可以看出，我希望能更多地介绍其中的“套路”，也就是上图中的模式和思想，有些是同类技术所共同有的（比如前几讲介绍过的 IoC），有些则是跨技术类型，但却依然共有的（比如幂等性和安全性）。</p>
<h2>总结思考</h2>
<p>今天的特别放送，我结合了自己的积累，介绍了我们该怎样做出选择，来应对这个“学不过来”的话题，特别是介绍了一些常见的学习误区，希望你能从我的答案中有所收获。</p>
<p>今天就不放特定的思考题了，因为我觉得，这一类主观性特别强的话题，很容易有不同的认识，不需要拿问题来引导思考方向了，不加限定地思考会更好。欢迎你在下面的留言区谈谈自己的看法，我们一起讨论。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>有一篇文章，<a href="https://sizovs.net/2018/12/17/stop-learning-frameworks/">Stop Learning Frameworks</a>，观点比较朴实，也比较偏激，在程序员群体内掀起了轩然大波，有朋友翻译了，译文在<a href="https://zhuanlan.zhihu.com/p/52814937">这里</a>。</li> 
 <li>关于传统关系数据库技术淘汰的事情，以前我写过一点小<a href="https://www.raychase.net/3689">体会</a>，可供参考。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |36          |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:54:59.442 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=36 
 {executed in 0 msec}
2020-11-19 17:54:59.443 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title            |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|-----|----|----|
|36  |1605756096 |1605756096 |1                |zh-hans  |0       |1                             |1      |0      |13丨特别放送：选择比努力更重要 |book |1   |36  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|-----|----|----|

2020-11-19 17:54:59.443 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=36 
 {executed in 0 msec}
2020-11-19 17:54:59.444 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title            |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|----|----|
|[unread] |1605756096 |1605756096 |1                |zh-hans  |0       |1                             |1      |0      |13丨特别放送：选择比努力更重要 |1   |36  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-----------------|----|----|

2020-11-19 17:54:59.448 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779699, created=1605779699, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='13丨特别放送：选择比努力更重要', type='book', 
uid=1, vid=36 where nid=36 
 {executed in 1 msec}
2020-11-19 17:54:59.448 INFO  jdbc.sqltiming Line:373 - update node_field_revision set changed=1605779699, created=1605779699, default_langcode=1, 
langcode='zh-hans', promote=0, revision_translation_affected=1, status=1, sticky=0, title='13丨特别放送：选择比努力更重要', 
uid=1, vid=36 where nid=36 
 {executed in 0 msec}
2020-11-19 17:54:59.458 INFO  jdbc.sqltiming Line:373 - select bookfieldm0_.entity_id as entity_i1_8_, bookfieldm0_.bundle as bundle2_8_, bookfieldm0_.delta 
as delta3_8_, bookfieldm0_.langcode as langcode4_8_, bookfieldm0_.field_media_value as field_me5_8_, 
bookfieldm0_.revision_id as revision6_8_ from node__field_media bookfieldm0_ where bookfieldm0_.entity_id=36 
 {executed in 1 msec}
2020-11-19 17:54:59.458 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|36        |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/4b85142bb60ed11bd446c5b9d0bc2b2f?bkt=en-1df98aeb722e81f5d723fac28d678c38a476821f313633cd92be7f545e22de646041a3ffcecf8a30&fid=3757516097-778750-481308051979037&time=1605756095&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-Ck5E0lseKXJ4Ucyim%2F%2BlWFPNr9Y%3D&to=92&size=12819831&sta_dx=12819831&sta_cs=3660&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030250&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12819831&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-17fb63a5422d08b4f2957cff33ec142b0ce2ef7732cef3213da9841552bdb06281ed29c7dda9e912&sl=76480590&expires=8h&rt=pr&r=368037844&mlogid=7502259450982594553&vbdid=2247232042&fin=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a&bflag=92,34-92&rtype=1&dp-logid=7502259450982594553&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=cdac697817123980f6fe281c435d7243f250e16d9c7bcb82305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a |36          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:54:59.463 INFO  jdbc.sqltiming Line:373 - update node__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/4b85142bb60ed11bd446c5b9d0bc2b2f?bkt=en-1df98aeb722e81f5d723fac28d678c38a476821f313633cd92be7f545e22de646041a3ffcecf8a30&fid=3757516097-778750-1118786593230272&time=1605779697&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-8dI4RLxXM6d4BY8q1%2B7aAxJnrX0%3D&to=92&size=12819831&sta_dx=12819831&sta_cs=3665&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030250&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12819831&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-17fb63a5422d08b4f2957cff33ec142b0ce2ef7732cef3213da9841552bdb06281ed29c7dda9e912&sl=76480590&expires=8h&rt=pr&r=322477512&mlogid=7508595258660894174&vbdid=2247232042&fin=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a&bflag=92,34-92&rtype=1&dp-logid=7508595258660894174&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=51702cd94a4865eef256af003acafb859326f418425b8ec0&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a', 
revision_id=36 where entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.466 INFO  jdbc.sqltiming Line:373 - select nodefieldm0_.entity_id as entity_i1_17_0_, nodefieldm0_.bundle as bundle2_17_0_, nodefieldm0_.delta 
as delta3_17_0_, nodefieldm0_.langcode as langcode4_17_0_, nodefieldm0_.field_media_value as 
field_me5_17_0_, nodefieldm0_.revision_id as revision6_17_0_ from node_revision__field_media 
nodefieldm0_ where nodefieldm0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.467 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|entity_id |bundle |delta |langcode |field_media_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |revision_id |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[unread]  |book   |0     |zh-hans  |https://qdall01.baidupcs.com/file/4b85142bb60ed11bd446c5b9d0bc2b2f?bkt=en-1df98aeb722e81f5d723fac28d678c38a476821f313633cd92be7f545e22de646041a3ffcecf8a30&fid=3757516097-778750-481308051979037&time=1605756095&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-Ck5E0lseKXJ4Ucyim%2F%2BlWFPNr9Y%3D&to=92&size=12819831&sta_dx=12819831&sta_cs=3660&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030250&mtime=1605754778&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12819831&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-17fb63a5422d08b4f2957cff33ec142b0ce2ef7732cef3213da9841552bdb06281ed29c7dda9e912&sl=76480590&expires=8h&rt=pr&r=368037844&mlogid=7502259450982594553&vbdid=2247232042&fin=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a&bflag=92,34-92&rtype=1&dp-logid=7502259450982594553&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=cdac697817123980f6fe281c435d7243f250e16d9c7bcb82305a5e1275657320&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a |36          |
|----------|-------|------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|

2020-11-19 17:54:59.472 INFO  jdbc.sqltiming Line:373 - update node_revision__field_media set bundle='book', delta=0, langcode='zh-hans', field_media_value='https://qdall01.baidupcs.com/file/4b85142bb60ed11bd446c5b9d0bc2b2f?bkt=en-1df98aeb722e81f5d723fac28d678c38a476821f313633cd92be7f545e22de646041a3ffcecf8a30&fid=3757516097-778750-1118786593230272&time=1605779697&sign=FDTAXUGERLQlBHSKfWqir-DCb740ccc5511e5e8fedcff06b081203-8dI4RLxXM6d4BY8q1%2B7aAxJnrX0%3D&to=92&size=12819831&sta_dx=12819831&sta_cs=3665&sta_ft=m4a&sta_ct=7&sta_mt=0&fm2=MH%2CYangquan%2CAnywhere%2C%2Cshanghai%2Cct&ctime=1571030250&mtime=1605778299&resv0=-1&resv1=0&resv2=rlim&resv3=2&resv4=12819831&vuk=3757516097&iv=0&htype=&randtype=em&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-17fb63a5422d08b4f2957cff33ec142b0ce2ef7732cef3213da9841552bdb06281ed29c7dda9e912&sl=76480590&expires=8h&rt=pr&r=322477512&mlogid=7508595258660894174&vbdid=2247232042&fin=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a&bflag=92,34-92&rtype=1&dp-logid=7508595258660894174&dp-callid=0.1.1&hps=1&tsl=80&csl=80&fsl=-1&csign=yVzLQPCt4DblfMLqd2BCjd2RnqQ%3D&so=0&ut=6&uter=0&serv=0&uc=1458616558&ti=51702cd94a4865eef256af003acafb859326f418425b8ec0&hflag=30&adg=c_15d187590626c675056c89c8026cfc17&reqlabel=778750_l_1bf9445f27094ab64c9f1cb0bdf7ccfa_-1_dd2c452b8e51a0c74130d7cf32c48a2d&ibp=1&by=themis&filename=13%E4%B8%A8%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%9A%E9%80%89%E6%8B%A9%E6%AF%94%E5%8A%AA%E5%8A%9B%E6%9B%B4%E9%87%8D%E8%A6%81.m4a', 
revision_id=36 where entity_id=36 
 {executed in 1 msec}
2020-11-19 17:54:59.475 INFO  jdbc.sqltiming Line:373 - select bookfieldc0_.entity_id as entity_i1_5_, bookfieldc0_.bundle as bundle2_5_, bookfieldc0_.field_comment_value 
as field_co3_5_, bookfieldc0_.delta as delta4_5_, bookfieldc0_.field_comment_format as field_co5_5_, 
bookfieldc0_.langcode as langcode6_5_, bookfieldc0_.revision_id as revision7_5_ from node__field_comment 
bookfieldc0_ where bookfieldc0_.entity_id=36 
 {executed in 1 msec}
2020-11-19 17:54:59.477 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |delta |field_comment_format |langcode |revision_id |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|36        |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    说到心坎里去了，坚持正确得做事。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">3</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cc/ce/39c470ee.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>jxs1211</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    1、python这样的脚本语言，是否没有对应平台可以学习，如果是，那么应该如何学习这门语言，如果用做web开发，是否只能去找对应的库来学习就可以了，还有其它需要关注的吗
    <br>2、SQL是一门半衰期很长的语言，学习sql也要是很有价值的，可以归为是语言和平台吧，是这样的吗
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/a8/35/85033228.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>亚东</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师讲到沟通能力真的蛮重要的。我最近换了工作，同事的一些不专业的行为老是把我激怒。我感觉很难受，分分钟想离职。但是又感觉工作就是跟各种人合作，要是过不了这个坎也不行。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>許敲敲</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    数据结构 算法 网络 这种基础要学到什么程度呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/c0/0e/c380fb0b.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>赖新宇</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，我现在作为一个前端，怎么可以找到全栈的工作，好多公司都要求相关经验，这个事情把我搞得有点头疼
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 我觉得先“吃饱”，再“吃好”，找一份理想工作总不是那么容易的。如果你能拿到理想的前端的 offer，那就去做吧，在工作中再慢慢积累经验和寻找项目和团队的机会。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/df/63/cf317827.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>anginiit</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师那句 光靠工作中学习是远远不够的 说得太对了，几年工作下来，体会很深，编程能力提高很快，几年基本就到顶点，但数据结构算法网络 原理等深一些的东西还是模糊的很。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>没带就是没写</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    为啥说语言平台比语言稳定呢？如果java没有热度了，没人用了，那么jvm平台就没人用了啊，存亡齿寒的关系。老师的意思是说语言的版本，比如java7 8 9 10迭代的比jvm快吗？
   </div> <!----> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 这是个泛指，其中一个原因是，你说的这个依赖关系，其实是单向的，比如说，JVM 是支持许多编程语言的，可不只有 Java 一种啊：https://en.wikipedia.org/wiki/List_of_JVM_languages</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     其实任何都是一个过程吧：其实更多的是根据现状去补充吧；其实自己说不上自己的选择是对还是错，不过确实全栈和DevOps两门课的学习补了我的典型短板，现在又在适当的扩展去强化算法-和Nosql相关。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;明确自己的主线然后不断的添砖加瓦吧：就像刘超老师在教授linux的系统的同时自己还在学徐老师的计算机原理然后补充到自己的课程中，明白自己的核心主线/主体然后强化自己周边的技能吧。数据系统和运维需要强化的是不同的，越往上越要明白核心然后逐渐补强典型的弱点吧；PY在学、GO也在学，不过适用场景是完全不一样的，当然深度不一样，全栈其实还是有核心的-这是跟老师的课程到现在的一点感悟吧。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可能有时会去理解全栈是什么都会什么都懂，其实这个同样有重点和非重点的；根据自己的核心去扩-不要为了全栈而全栈，选择几个核心技能然后其它适当轻之，从而让自己能更好的整体把握和解决问题，这是跟老师的课到现在明白的方向。
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |36          |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:54:59.483 INFO  jdbc.sqltiming Line:373 - select nodefieldc0_.entity_id as entity_i1_14_0_, nodefieldc0_.bundle as bundle2_14_0_, nodefieldc0_.field_comment_value 
as field_co3_14_0_, nodefieldc0_.delta as delta4_14_0_, nodefieldc0_.field_comment_format as 
field_co5_14_0_, nodefieldc0_.langcode as langcode6_14_0_, nodefieldc0_.revision_id as revision7_14_0_ 
from node_revision__field_comment nodefieldc0_ where nodefieldc0_.entity_id=36 
 {executed in 1 msec}
2020-11-19 17:54:59.485 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|entity_id |bundle |field_comment_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |delta |field_comment_format |langcode |revision_id |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|
|[unread]  |book   |<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>tt</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    说到心坎里去了，坚持正确得做事。
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">3</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cc/ce/39c470ee.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>jxs1211</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    1、python这样的脚本语言，是否没有对应平台可以学习，如果是，那么应该如何学习这门语言，如果用做web开发，是否只能去找对应的库来学习就可以了，还有其它需要关注的吗
    <br>2、SQL是一门半衰期很长的语言，学习sql也要是很有价值的，可以归为是语言和平台吧，是这样的吗
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span>1</span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/a8/35/85033228.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>亚东</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师讲到沟通能力真的蛮重要的。我最近换了工作，同事的一些不专业的行为老是把我激怒。我感觉很难受，分分钟想离职。但是又感觉工作就是跟各种人合作，要是过不了这个坎也不行。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>許敲敲</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-09
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    数据结构 算法 网络 这种基础要学到什么程度呢？
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class="">1</span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/c0/0e/c380fb0b.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>赖新宇</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-12
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
    老师，我现在作为一个前端，怎么可以找到全栈的工作，好多公司都要求相关经验，这个事情把我搞得有点头疼
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 我觉得先“吃饱”，再“吃好”，找一份理想工作总不是那么容易的。如果你能拿到理想的前端的 offer，那就去做吧，在工作中再慢慢积累经验和寻找项目和团队的机会。</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/df/63/cf317827.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>anginiit</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    老师那句 光靠工作中学习是远远不够的 说得太对了，几年工作下来，体会很深，编程能力提高很快，几年基本就到顶点，但数据结构算法网络 原理等深一些的东西还是模糊的很。
   </div> <!----> <!----> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>没带就是没写</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0 _3D2NkqD6_0">
    为啥说语言平台比语言稳定呢？如果java没有热度了，没人用了，那么jvm平台就没人用了啊，存亡齿寒的关系。老师的意思是说语言的版本，比如java7 8 9 10迭代的比jvm快吗？
   </div> <!----> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 这是个泛指，其中一个原因是，你说的这个依赖关系，其实是单向的，比如说，JVM 是支持许多编程语言的，可不只有 Java 一种啊：https://en.wikipedia.org/wiki/List_of_JVM_languages</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li>
<li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" class="_2273kGdT_0"> 
 <div class="_2CG0SquK_0">
  <div class="_304R4gla_0">
   <div>
    <div class="_18Dng5rT_0">
     <span>leslie</span> <!---->
    </div> 
    <div class="_1H1Z49Dr_0">
     2019-10-11
    </div>
   </div> <!---->
  </div> 
  <div>
   <div class="_3M6kV3zb_0">
     其实任何都是一个过程吧：其实更多的是根据现状去补充吧；其实自己说不上自己的选择是对还是错，不过确实全栈和DevOps两门课的学习补了我的典型短板，现在又在适当的扩展去强化算法-和Nosql相关。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;明确自己的主线然后不断的添砖加瓦吧：就像刘超老师在教授linux的系统的同时自己还在学徐老师的计算机原理然后补充到自己的课程中，明白自己的核心主线/主体然后强化自己周边的技能吧。数据系统和运维需要强化的是不同的，越往上越要明白核心然后逐渐补强典型的弱点吧；PY在学、GO也在学，不过适用场景是完全不一样的，当然深度不一样，全栈其实还是有核心的-这是跟老师的课程到现在的一点感悟吧。
    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可能有时会去理解全栈是什么都会什么都懂，其实这个同样有重点和非重点的；根据自己的核心去扩-不要为了全栈而全栈，选择几个核心技能然后其它适当轻之，从而让自己能更好的整体把握和解决问题，这是跟老师的课到现在明白的方向。
    <br>
   </div> 
   <div class="_2r3UB1GX_0">
    <span>展开</span><i class="iconfont"></i>
   </div> 
   <div class="_2xNIY4NG_0">
    <p class="_33BLbmw4_0">作者回复: 👍</p>
   </div> 
   <div class="_1w8H0ktn_0 _2A421P4G_0">
    <div class="_2jsFl-X0_0">
     <i class="iconfont"></i> <span></span>
    </div> 
    <div class="_2P4B1Hdm_0">
     <i class="iconfont"></i> <span class=""></span>
    </div> <!---->
   </div>
  </div>
 </div></li> |0     |full_html            |zh-hans  |36          |
|----------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|---------|------------|

2020-11-19 17:54:59.490 INFO  jdbc.sqltiming Line:373 - select bookfieldt0_.entity_id as entity_i1_9_, bookfieldt0_.bundle as bundle2_9_, bookfieldt0_.delta 
as delta3_9_, bookfieldt0_.langcode as langcode4_9_, bookfieldt0_.revision_id as revision5_9_, 
bookfieldt0_.field_thumb_value as field_th6_9_ from node__field_thumb bookfieldt0_ where bookfieldt0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.491 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|36        |book   |0     |zh-hans  |36          |https://static001.geekbang.org/resource/image/3c/cf/3c6b90557d664eda750323f6b44450cf.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:54:59.496 INFO  jdbc.sqltiming Line:373 - select nodefieldt0_.entity_id as entity_i1_18_0_, nodefieldt0_.bundle as bundle2_18_0_, nodefieldt0_.delta 
as delta3_18_0_, nodefieldt0_.langcode as langcode4_18_0_, nodefieldt0_.revision_id as revision5_18_0_, 
nodefieldt0_.field_thumb_value as field_th6_18_0_ from node_revision__field_thumb nodefieldt0_ 
where nodefieldt0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.496 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|entity_id |bundle |delta |langcode |revision_id |field_thumb_value                                                                        |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|
|[unread]  |book   |0     |zh-hans  |36          |https://static001.geekbang.org/resource/image/3c/cf/3c6b90557d664eda750323f6b44450cf.jpg |
|----------|-------|------|---------|------------|-----------------------------------------------------------------------------------------|

2020-11-19 17:54:59.501 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_6_0_, bookfieldf0_.bundle as bundle2_6_0_, bookfieldf0_.delta 
as delta3_6_0_, bookfieldf0_.field_fenlei_target_id as field_fe4_6_0_, bookfieldf0_.langcode 
as langcode5_6_0_, bookfieldf0_.revision_id as revision6_6_0_ from node__field_fenlei bookfieldf0_ 
where bookfieldf0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.501 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |36          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:59.506 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_15_0_, nodefieldf0_.bundle as bundle2_15_0_, nodefieldf0_.delta 
as delta3_15_0_, nodefieldf0_.field_fenlei_target_id as field_fe4_15_0_, nodefieldf0_.langcode 
as langcode5_15_0_, nodefieldf0_.revision_id as revision6_15_0_ from node_revision__field_fenlei 
nodefieldf0_ where nodefieldf0_.entity_id=36 
 {executed in 0 msec}
2020-11-19 17:54:59.507 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------------|---------|------------|
|entity_id |bundle |delta |field_fenlei_target_id |langcode |revision_id |
|----------|-------|------|-----------------------|---------|------------|
|[unread]  |book   |0     |1                      |zh-hans  |36          |
|----------|-------|------|-----------------------|---------|------------|

2020-11-19 17:54:59.512 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='556603380747239' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:54:59.512 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:55:35.847 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='556603380747239' 
and bookchecke0_.name='net_content' 
 {executed in 1 msec}
2020-11-19 17:55:35.848 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:55:35.850 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('556603380747239', 0, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:55:35.851 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('556603380747239', 
0, 'net_content') 
 {executed in 0 msec}
2020-11-19 17:55:35.852 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|61            |
|--------------|

2020-11-19 17:55:35.866 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='556603380747239' 
and bookchecke0_.name='media' 
 {executed in 0 msec}
2020-11-19 17:55:35.866 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:55:36.222 INFO  jdbc.sqltiming Line:373 - select bookchecke0_.item_id as item_id1_2_, bookchecke0_.fsid as fsid2_2_, bookchecke0_.got 
as got3_2_, bookchecke0_.name as name4_2_ from book_check bookchecke0_ where bookchecke0_.fsid='556603380747239' 
and bookchecke0_.name='media' 
 {executed in 1 msec}
2020-11-19 17:55:36.222 INFO  jdbc.resultsettable Line:610 - 
|--------|-----|----|-----|
|item_id |fsid |got |name |
|--------|-----|----|-----|
|--------|-----|----|-----|

2020-11-19 17:55:36.224 INFO  jdbc.sqltiming Line:373 - insert into book_check (fsid, got, name) values ('556603380747239', 1, 'media') 
 {executed in 1 msec}
2020-11-19 17:55:36.224 INFO  jdbc.sqltiming Line:373 - getGeneratedKeys on query: insert into book_check (fsid, got, name) values ('556603380747239', 
1, 'media') 
 {executed in 0 msec}
2020-11-19 17:55:36.224 INFO  jdbc.resultsettable Line:610 - 
|--------------|
|generated_key |
|--------------|
|62            |
|--------------|

2020-11-19 17:55:36.238 INFO  jdbc.sqltiming Line:373 - select bookfieldf0_.entity_id as entity_i1_7_, bookfieldf0_.bundle as bundle2_7_, bookfieldf0_.delta 
as delta3_7_, bookfieldf0_.field_fsid_value as field_fs4_7_, bookfieldf0_.langcode as langcode5_7_, 
bookfieldf0_.revision_id as revision6_7_ from node__field_fsid bookfieldf0_ where bookfieldf0_.field_fsid_value='556603380747239' 
 {executed in 0 msec}
2020-11-19 17:55:36.239 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|37        |book   |0     |556603380747239  |zh-hans  |37          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:55:36.239 INFO  jdbc.sqltiming Line:373 - select nodeentity0_.nid as nid1_3_, nodeentity0_.langcode as langcode2_3_, nodeentity0_.type 
as type3_3_, nodeentity0_.uuid as uuid4_3_, nodeentity0_.vid as vid5_3_ from node nodeentity0_ 
where nodeentity0_.nid=37 
 {executed in 0 msec}
2020-11-19 17:55:36.240 INFO  jdbc.resultsettable Line:610 - 
|----|---------|-----|-------------------------------------|----|
|nid |langcode |type |uuid                                 |vid |
|----|---------|-----|-------------------------------------|----|
|37  |zh-hans  |book |1b32ddf7-fa3e-448c-a689-545df6c40fc7 |37  |
|----|---------|-----|-------------------------------------|----|

2020-11-19 17:55:36.244 INFO  jdbc.sqltiming Line:373 - select nodefieldf0_.entity_id as entity_i1_16_0_, nodefieldf0_.bundle as bundle2_16_0_, nodefieldf0_.delta 
as delta3_16_0_, nodefieldf0_.field_fsid_value as field_fs4_16_0_, nodefieldf0_.langcode as 
langcode5_16_0_, nodefieldf0_.revision_id as revision6_16_0_ from node_revision__field_fsid 
nodefieldf0_ where nodefieldf0_.entity_id=37 
 {executed in 0 msec}
2020-11-19 17:55:36.245 INFO  jdbc.resultsettable Line:610 - 
|----------|-------|------|-----------------|---------|------------|
|entity_id |bundle |delta |field_fsid_value |langcode |revision_id |
|----------|-------|------|-----------------|---------|------------|
|[unread]  |book   |0     |556603380747239  |zh-hans  |37          |
|----------|-------|------|-----------------|---------|------------|

2020-11-19 17:55:36.250 INFO  jdbc.sqltiming Line:373 - select bookentity0_.nid as nid1_1_, bookentity0_.bid as bid2_1_, bookentity0_.depth as depth3_1_, 
bookentity0_.has_children as has_chil4_1_, bookentity0_.p1 as p5_1_, bookentity0_.p2 as p6_1_, 
bookentity0_.p3 as p7_1_, bookentity0_.p4 as p8_1_, bookentity0_.p5 as p9_1_, bookentity0_.pid 
as pid10_1_, bookentity0_.weight as weight11_1_ from book bookentity0_ where bookentity0_.nid=37 
 {executed in 0 msec}
2020-11-19 17:55:36.250 INFO  jdbc.resultsettable Line:610 - 
|----|----|------|-------------|---|---|---|---|---|----|-------|
|nid |bid |depth |has_children |p1 |p2 |p3 |p4 |p5 |pid |weight |
|----|----|------|-------------|---|---|---|---|---|----|-------|
|37  |1   |3     |0            |1  |35 |37 |0  |0  |35  |0      |
|----|----|------|-------------|---|---|---|---|---|----|-------|

2020-11-19 17:55:36.256 INFO  jdbc.sqltiming Line:373 - select nodebodyen0_.entity_id as entity_i1_4_, nodebodyen0_.body_value as body_val2_4_, nodebodyen0_.body_summary 
as body_sum3_4_, nodebodyen0_.bundle as bundle4_4_, nodebodyen0_.delta as delta5_4_, nodebodyen0_.body_format 
as body_for6_4_, nodebodyen0_.langcode as langcode7_4_, nodebodyen0_.revision_id as revision8_4_ 
from node__body nodebodyen0_ where nodebodyen0_.entity_id=37 
 {executed in 1 msec}
2020-11-19 17:55:36.263 INFO  jdbc.resultsettable Line:610 - 
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|37        |<p>你好，我是四火。</p>
<p>本章我们以 MVC 架构为核心，已经介绍了很多设计模式，今天我们将进一步泛化，谈论更多的 Java EE 模式。这些模式，就是我们在搭建全栈架构、设计的工作过程中，不断总结和应用的“套路”。</p>
<h2>背景和概念</h2>
<p>我相信很多人都接触过面向对象模式，可是，模式是个通用词，面向对象只是其中的一个分支而已。事实上，我们本章的重点 MVC 本身就是一种典型的模式，介绍过的 CQRS 是模式，学习过的 AOP、IoC，这些其实也都是模式。</p>
<p>因此，和其它领域的技术相比，作为全栈工程师的我们，更有机会接触到各种模式。这些模式可以帮助我们在设计开发工作中拓宽思路，使用精巧的代码结构来解决实际问题。</p>
<p>说到这里，你可能会问，为什么这次谈论模式的时候，要使用 Java EE 这个编程语言前缀？模式不是应该和语言无关吗？</p>
<p>一点都没错，模式就是和语言无关的，但是，诞生模式最多的温床，就是 Java 语言。</p>
<p>世界上没有任何一门语言，像 Java 一样，几乎一直被黑，但是生态圈一直在壮大，且在工业界具备如此统治力。<strong>很多人说，Java 是一门平庸的语言，这可能没错，但是它对于底层细节的封装和语言本身的难度做到了很好的平衡</strong>，它不一定会有多精巧、多出彩，但是新手也可以顺利完成工作，且不容易写出破坏性强、其他人难以接手的代码，这对于要规模、要量产的工业界来说，简直是超级福音。</p><!-- [[[read_end]]] -->
<p><strong>使用 Java 的人可以快速上手，也可以把精力专注在高层的架构和设计上面，这就是为什么使用 Java 的人往往对模式特别敏感的原因。</strong></p>
<p>当然，语言本身的江湖地位也和生态圈密切相关，更先进、更合理的语言一直在出现，但要把整个语言推翻另起炉灶，其难度可想而知，毕竟一门语言还涉及到社区、厂商、开源库、标准等等。</p>
<p>在互联网的战场上，我们一直能看到类似的例子，比如在前端领域 JavaScript 就是一个相对“草率”，有着诸多缺陷的语言，在它之后有许多更先进的语言尝试把它替代（比如 Google 强推的 <a href="https://dart.dev/">Dart</a>），但是这件事情是极其困难的。</p>
<p>那么，什么是 Java EE，为什么是 Java EE？</p>
<p>Java EE，全称为 Java Platform Enterprise Edition，即 Java 平台企业版，是 Java 的三大平台之一，另两大是 Java SE（标准版）和 Java ME（微型版）。企业市场对软件的需求和大众市场是完全不同的，尤其是在互联网的早些时候，对吞吐量、数据规模和服务质量等都有着更高级别的要求，而且企业花钱多，因而带来的回报也高得多。</p>
<p>但如今这个特点已经有了变化，但是从当时开始逐步确立下来的企业级规范和技术标准，直到现在还在广泛使用，并不断发展。它使得 Java EE 平台孕育了比其它语言和平台更多的软件架构和设计思想，而这些优秀的思想，以及通用的“套路”，在这个过程中不断被程序员总结成“模式”。</p>
<h2>概览</h2>
<p>Java EE 的模式涉及的面非常广泛，下图是来自经典的 <a href="http://www.corej2eepatterns.com/Patterns2ndEd/index.htm">Core J2EE Patterns: Best Practices and Design Strategies</a> 一书，对我们从宏观上理解 Java EE 模式有一定的指导意义。但是请不要以为这就是一个完整的 Java EE 的模式列表，它只是列出了在当时比较常见的那一些而已。</p>
<p><img src="https://static001.geekbang.org/resource/image/c6/e0/c62a84e1d65327d3d8a3cba204be07e0.gif" alt=""></p>
<p>从图中我们可以看到，这些“核心模式”大致分为呈现层（Presentation Tier，绿色部分）、业务层（Business Tier，紫色部分）和集成层（Integration Tier，红色部分）三大部分，模式之间有的通过实线箭头连接，表示着不同模式之间的单向关联关系，有的通过虚线箭头连接，表示着模式之间“使用包含”的依赖关系。</p>
<p>这里面的内容其实有很多在本章已经涉及到了，比如 Front Controller 和 Business Object，但是，我还想补充和细化其中的两个模式，它们在网站开发的项目中非常常用：Intercepting Filter 和 Data Access Object。</p>
<h2>拦截过滤器</h2>
<p>拦截过滤器（Intercepting Filter）正如图中的“Apply zero or more”和 Servlet 规范所述一样，应当具备一个链式结构。这个链式结构中的每个过滤器，互相之间应当是一个互不依赖的松耦合关系，以便于组合容易。这个过滤器链条，出现的位置通常在控制器 Front Controller 之前，在还没有进行到 Servlet 的 URL 映射前，请求需要先通过它的过滤逻辑。</p>
<h3>Tomcat 中配置过滤器</h3>
<p>还记得我们在 [第 10 讲] 的加餐中使用 Servlet、JSP 和 JavaBean 实现的简单 MVC 系统吗？现在，让我们来动动手，添加一个基于 URL 映射的过滤器。</p>
<p>首先，打开 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/web.xml，在我们原本的 BookServlet 配置前，添加如下内容：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;AuthFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-class&gt;AuthFilter&lt;/filter-class&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;AuthFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;BookFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-class&gt;BookFilter&lt;/filter-class&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;BookFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;url-pattern&gt;/books/*&lt;/url-pattern&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter-mapping&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，为了显示过滤器链的效果，我们配置了两个过滤器，第一个 AuthFilter 用来对所有的请求实施权限控制，因此 URL 使用 /* 匹配所有请求；第二个 BookFilter 我们希望它只对访问图书的请求实施权限控制。</p>
<p>现在建立 AuthFilter，创建 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/classes/AuthFilter.java，写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import javax.servlet.*;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.logging.Logger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.io.IOException;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       public class AuthFilter implements Filter {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private Logger logger = Logger.getLogger(AuthFilter.class.getName());
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        logger.info("Check permission...");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        chain.doFilter(request, response);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这个用于鉴权的过滤器，现在只打印日志，未来我们可以加入真正的鉴权逻辑。</p>
<p>接着建立 BookFilter，创建 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/classes/BookFilter.java，写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import javax.servlet.*;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.io.IOException;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.logging.Logger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.concurrent.atomic.AtomicInteger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       public class BookFilter implements Filter {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private Logger logger = Logger.getLogger(BookFilter.class.getName());
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private AtomicInteger count = new AtomicInteger();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        logger.info("Add book accessing count...");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        int current = this.count.incrementAndGet();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        request.setAttribute("count", current);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        chain.doFilter(request, response);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在这个过滤器中 ，我们先打印了日志，接着创建了一个计数器，使用 AtomicInteger 而不是 int 这个原语类型的目的是为了正确处理在多线程情况下并发计数器的情形，再把当前对 books 请求的计数放到 request 中。</p>
<p>编译一下：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       javac AuthFilter.java BookFilter.java -classpath ${CATALINA_HOME}/lib/servlet-api.jar
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们再回到曾经建立的 ${CATALINA_HOME}/webapps/ROOT/book.jsp，在页面尾部添加一行输出计数器的计数：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Count: ${count}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>现在启动 Tomcat：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       catalina run
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>最后在浏览器中访问 <a href="http://localhost:8080/books?category=art">http://localhost:8080/books?category=art</a>，你将看到类似这样的输出，并且每刷新一次页面，这个计数就加 1。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Category name: art, date: 2019-8-11 Count: 1
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>再回到控制台，你应该能看到类似这样的日志，从中可见过滤器的调用顺序：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       11-Aug-2019 11:08:50.131 INFO [http-nio-8080-exec-1] AuthFilter.doFilter Check permission...
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       11-Aug-2019 11:08:50.132 INFO [http-nio-8080-exec-1] BookFilter.doFilter Add book accessing count...
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>好，动手实践暂时就先到这里。就如同上面的例子这样，过滤器也是可以配置映射关系的，并且，在过滤器中，我们可以实现一组不同类型请求的处理所共有的逻辑。学到这里，不知道你有没有联想到一个相关的，且在这一讲之前我们才学过的模式？对，它就是 AOP，过滤器本质上就是面向切面编程这种模式的一种子模式。</p>
<h3>Struts 的拦截器</h3>
<p>Struts 提供了拦截器（Interceptor）这样功能更加强大的组件，对于一些常见的功能，它已经预置了数十种常见的拦截器，比如异常、参数验证、文件上传和国际化支持等等，既包括预处理（Action 执行之前），也包括后处理（Action 执行之后）的拦截逻辑，只需要配置使用即可。</p>
<p>举例来说，如果定义了这样一个的拦截器栈，它包含了两个拦截器，一个是异常拦截器，一个是校验拦截器，并且配置了 ping 方法不需要经过拦截器的校验，这两个拦截器组合成为 commonInterceptorStack 这个拦截器栈：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;interceptor-stack name="commonInterceptorStack"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="exception"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="validation"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;param name="excludeMethods"&gt;ping&lt;/param&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/interceptor-ref&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/interceptor-stack&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>配置完毕后就可以使用了，对于一个控制器层的 bookAction，我们规定请求必须经过一个 alias 拦截器，和刚才定义的 commonInterceptorStack 拦截器栈：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;action name="bookAction" class="BookAction"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="alias"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="commonInterceptorStack"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/action&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<h2>数据访问对象</h2>
<p>我们在 <a href="https://time.geekbang.org/column/article/141679">[第 08 讲]</a> 中介绍持久层框架的时候，已经谈到了 DAO（Data Access Object），今天让我们进一步学习一下。</p>
<p><strong>DAO 本质上是能够为某种特定数据持久化的机制提供抽象结构的对象。</strong>虽然我们谈论 DAO 基本上是默认这里的数据持久化的介质就是数据库，但需要明确的是，实际上并没有这样的约束。换句话说，DAO 可以把数据持久化到数据库中，但也可以持久化到文件里，甚至会以网络请求的方式把数据持久化到某个远程服务中去。</p>
<p>数据访问对象最大的好处依然是我们反复强调的“解耦”，业务代码不需要关心数据是怎样持久化的。在测试其上方的 Service 层的时候，只要把实际的 DAO 替换成“桩代码”，就可以不实际执行持久化逻辑而完成测试；如果哪一天希望更换 DAO 的实现，例如把关系数据库存储改为更一般的键值存储，其上方的 Service 层不修改逻辑就可以实现。</p>
<p>但事物都有两面性，DAO 也不是完美的，比如说，<strong>多加一层就会从额外的抽象层次上带来软件的复杂性，它经常和“抽象泄露（Leaky Abstraction）”这样的现象联系起来</strong>。</p>
<p>这里是说，理想状况下，程序员只需要关心“某一抽象层之上”的逻辑和调用，这也是我们分层的一大好处。可是，现实总是和理想有距离的，一旦抽象之下的部分出错，程序员很可能必须去了解和深入这部分的内容，这就违背了抽象分层的初衷，但是在很多情况下这是不可避免的，这也是整个软件体系日渐复杂，我们需要学习的内容越来越多的原因之一。</p>
<h2>总结思考</h2>
<p>今天我们了解了 Java EE 的各种模式，并且重点学习了拦截过滤器这个模式。模式的学习有一个特点，在理论学习的基础上，我们需要反复地实践强化，以及反复地思考。可以说，实践和思考这二者缺一不可。如果只有实践而没有思考，就没有办法灵活地将理论应用在复杂的实际项目中；如果只有思考而没有实践，那么到实际动手的时候还是很难顺利地实施想法。</p>
<p>对于今天的内容，留两个问题：</p>
<ul> 
 <li>我们介绍了 DAO 层的两面性，那么，在你经历的项目中，你是怎样访问数据存储设施（例如文件和数据库）的，能说说吗？</li> 
 <li>今天我们学到了，通过使用基于 URL 映射的过滤器，是可以给业务代码增加 AOP 的切面逻辑的。那么，为什么我们还需要之前所介绍的，通过匹配代码类和方法的表达式来嵌入切面逻辑的方式呢？</li> 
</ul>
<p>有道是，技术进程多风雨，唯有套路得人心。回看本章，从 MVC 开始，我们一直都在和“模式”打交道，不知道你是不是认真学习了，是不是收获一些代码设计上的“套路”了呢？</p>
<h2>选修课堂：MyBatis vs Hibernate</h2>
<p>在 DAO 的设计过程中，我们经常需要处理模型实体对象和关系数据库的表记录之间的双向转换问题，怎样将对象的属性和关联关系映射到数据库表上去？有许多持久化框架都给出了自己的解决办法，今天我就来介绍两种最经典的解决思路，MyBatis 和 Hibernate。</p>
<p><strong>MyBatis 的思路是使用 XML 或注解的方式来配置 ORM，把 SQL 用标签管理起来，但不关心，也不干涉实际 SQL 的书写。</strong></p>
<p>在这种思路下框架轻量，很容易集成，又因为我们可以使用 SQL 所有的特性，可以写存储过程，也可以写 SQL 方言（Dialect），所以灵活度相当高。当然，灵活也意味着在具体实现功能的时候，你需要做得更多，不但需要关心模型层、SQL，还需要关心这二者怎样映射起来，具体包括：</p>
<ul> 
 <li>请求参数映射，即模型的值怎样映射到 SQL 语句的变参里面；</li> 
 <li>返回值映射，即怎样将数据库查询的返回记录映射到模型对象。</li> 
</ul>
<p>我们来看一个最简单的 XML 配置片段：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;mapper namespace="xxx.BookDAO"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;insert id="add" parameterType="Book"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        insert into BOOKS(NAME, DESC) values(#{name}, #{desc})
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/insert&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;select id="get" resultType="Book" parameterType="java.lang.String"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        select * from BOOKS where ID=#{id}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/select&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/mapper&gt; 
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，SQL 原模原样地写在了配置文件里面。对于写入语句，比如这里的 insert，需要显式告知参数类型 Book 对象，接着就可以直接使用 Book 的 name 和 desc 对应的 get 方法来获得具体值并注入 SQL 了。对于简单的对象，默认的映射规则就可以解决问题，反之，也可以在 XML 中定义映射规则。</p>
<p><strong>Hibernate 则是另一种思路，如果你已经习惯于和模型层打交道，那么它就将 SQL 层对你隐藏起来了。</strong>换言之，你只需要写模型代码和 HQL（Hibernate Query Language）这种面向对象的查询语言就可以了，至于 SQL 的生成，框架可以帮你完成。</p>
<p>这种方式的一大好处就是具体数据库的透明性，你今天使用的数据库是 MySQL，明天就可以换成 Oracle，并且不用改代码。在分析设计的时候，你只需要做自己习惯的模型驱动编程就可以了。</p>
<p>但值得注意的是，Hibernate 是把双刃剑，有利也有弊。它也带来了很多问题，比如较高的学习曲线，在出现问题的时候，无论是功能问题还是性能问题，它需要更多的知识储备来进行问题的定位和性能的调试。</p>
<p>MyBatis 和 Hibernate 到这就讲解清楚了，再总结延伸一下。</p>
<p>从框架本身的角度来说，Hibernate 提供的特性远比 MyBatis 更丰富、更完整。如果你是一位有着一定 ORM 经验的程序员，那么 Hibernate 很可能会使你的开发效率更高。</p>
<p>可对于一个新项目而言，在技术选型的过程中，如果你的团队中没有非常多的经验丰富的程序员，我通常建议持久层的框架不要去考虑 Hibernate。简单说来，就是因为它的“水比较深”。我相信大多数程序员朋友还是更习惯于实打实地接触 SQL，流程到哪一步，执行了什么语句，该怎么调整，都十分清晰和直接。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>文中提到了 Java EE 平台的一系列标准和技术，维基百科上有一个<a href="https://zh.wikipedia.org/wiki/Jakarta_EE#%E7%BB%84%E4%BB%B6">简单的列表</a>供参考。</li> 
 <li><a href="http://www.corej2eepatterns.com/Patterns2ndEd/index.htm">Core J2EE Patterns: Best Practices and Design Strategies</a> 这本书对于你学习 Java EE 的模式会提供不错的指导性帮助，属于权威之一，但是内容比较抽象，如果你在设计方面有一定追求，它是很好的阅读材料。好几年前我曾经读过纸质的第一版，但这是第二版，已经可以在网上公开阅读。</li> 
 <li>如果对于文中提到的 Struts 拦截器感兴趣，请看 Struts 官方文档中<a href="https://struts.apache.org/core-developers/interceptors.html">对于拦截器的介绍</a>。</li> 
 <li>文中提到了抽象泄露的概念，如果你感兴趣的话，请阅读 <a href="https://www.joelonsoftware.com/2002/11/11/the-law-of-leaky-abstractions/">The Law of Leaky Abstractions</a>，作者 Joel Spolsky 就是那本著名的《软件随想录》的作者。</li> 
 <li><a href="http://www.mybatis.org/mybatis-3/zh/index.html">MyBatis 的官网</a>，是的，MyBatis 的教程我就推荐官网上的，清晰简洁，而且具备中文版，不需要去找什么第三方的资料了；如果是需要中文的 Hibernate 入门资料，我推荐 W3Cschool 上的 <a href="https://www.w3cschool.cn/hibernate/">Hibernate 教程</a>。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |37          |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:55:36.266 INFO  jdbc.sqltiming Line:373 - select nodebodyre0_.entity_id as entity_i1_13_0_, nodebodyre0_.body_value as body_val2_13_0_, 
nodebodyre0_.body_summary as body_sum3_13_0_, nodebodyre0_.bundle as bundle4_13_0_, nodebodyre0_.delta 
as delta5_13_0_, nodebodyre0_.body_format as body_for6_13_0_, nodebodyre0_.langcode as langcode7_13_0_, 
nodebodyre0_.revision_id as revision8_13_0_ from node_revision__body nodebodyre0_ where nodebodyre0_.entity_id=37 
 {executed in 1 msec}
2020-11-19 17:55:36.273 INFO  jdbc.resultsettable Line:610 - 
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|entity_id |body_value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |body_summary |bundle |delta |body_format |langcode |revision_id |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|
|[unread]  |<p>你好，我是四火。</p>
<p>本章我们以 MVC 架构为核心，已经介绍了很多设计模式，今天我们将进一步泛化，谈论更多的 Java EE 模式。这些模式，就是我们在搭建全栈架构、设计的工作过程中，不断总结和应用的“套路”。</p>
<h2>背景和概念</h2>
<p>我相信很多人都接触过面向对象模式，可是，模式是个通用词，面向对象只是其中的一个分支而已。事实上，我们本章的重点 MVC 本身就是一种典型的模式，介绍过的 CQRS 是模式，学习过的 AOP、IoC，这些其实也都是模式。</p>
<p>因此，和其它领域的技术相比，作为全栈工程师的我们，更有机会接触到各种模式。这些模式可以帮助我们在设计开发工作中拓宽思路，使用精巧的代码结构来解决实际问题。</p>
<p>说到这里，你可能会问，为什么这次谈论模式的时候，要使用 Java EE 这个编程语言前缀？模式不是应该和语言无关吗？</p>
<p>一点都没错，模式就是和语言无关的，但是，诞生模式最多的温床，就是 Java 语言。</p>
<p>世界上没有任何一门语言，像 Java 一样，几乎一直被黑，但是生态圈一直在壮大，且在工业界具备如此统治力。<strong>很多人说，Java 是一门平庸的语言，这可能没错，但是它对于底层细节的封装和语言本身的难度做到了很好的平衡</strong>，它不一定会有多精巧、多出彩，但是新手也可以顺利完成工作，且不容易写出破坏性强、其他人难以接手的代码，这对于要规模、要量产的工业界来说，简直是超级福音。</p><!-- [[[read_end]]] -->
<p><strong>使用 Java 的人可以快速上手，也可以把精力专注在高层的架构和设计上面，这就是为什么使用 Java 的人往往对模式特别敏感的原因。</strong></p>
<p>当然，语言本身的江湖地位也和生态圈密切相关，更先进、更合理的语言一直在出现，但要把整个语言推翻另起炉灶，其难度可想而知，毕竟一门语言还涉及到社区、厂商、开源库、标准等等。</p>
<p>在互联网的战场上，我们一直能看到类似的例子，比如在前端领域 JavaScript 就是一个相对“草率”，有着诸多缺陷的语言，在它之后有许多更先进的语言尝试把它替代（比如 Google 强推的 <a href="https://dart.dev/">Dart</a>），但是这件事情是极其困难的。</p>
<p>那么，什么是 Java EE，为什么是 Java EE？</p>
<p>Java EE，全称为 Java Platform Enterprise Edition，即 Java 平台企业版，是 Java 的三大平台之一，另两大是 Java SE（标准版）和 Java ME（微型版）。企业市场对软件的需求和大众市场是完全不同的，尤其是在互联网的早些时候，对吞吐量、数据规模和服务质量等都有着更高级别的要求，而且企业花钱多，因而带来的回报也高得多。</p>
<p>但如今这个特点已经有了变化，但是从当时开始逐步确立下来的企业级规范和技术标准，直到现在还在广泛使用，并不断发展。它使得 Java EE 平台孕育了比其它语言和平台更多的软件架构和设计思想，而这些优秀的思想，以及通用的“套路”，在这个过程中不断被程序员总结成“模式”。</p>
<h2>概览</h2>
<p>Java EE 的模式涉及的面非常广泛，下图是来自经典的 <a href="http://www.corej2eepatterns.com/Patterns2ndEd/index.htm">Core J2EE Patterns: Best Practices and Design Strategies</a> 一书，对我们从宏观上理解 Java EE 模式有一定的指导意义。但是请不要以为这就是一个完整的 Java EE 的模式列表，它只是列出了在当时比较常见的那一些而已。</p>
<p><img src="https://static001.geekbang.org/resource/image/c6/e0/c62a84e1d65327d3d8a3cba204be07e0.gif" alt=""></p>
<p>从图中我们可以看到，这些“核心模式”大致分为呈现层（Presentation Tier，绿色部分）、业务层（Business Tier，紫色部分）和集成层（Integration Tier，红色部分）三大部分，模式之间有的通过实线箭头连接，表示着不同模式之间的单向关联关系，有的通过虚线箭头连接，表示着模式之间“使用包含”的依赖关系。</p>
<p>这里面的内容其实有很多在本章已经涉及到了，比如 Front Controller 和 Business Object，但是，我还想补充和细化其中的两个模式，它们在网站开发的项目中非常常用：Intercepting Filter 和 Data Access Object。</p>
<h2>拦截过滤器</h2>
<p>拦截过滤器（Intercepting Filter）正如图中的“Apply zero or more”和 Servlet 规范所述一样，应当具备一个链式结构。这个链式结构中的每个过滤器，互相之间应当是一个互不依赖的松耦合关系，以便于组合容易。这个过滤器链条，出现的位置通常在控制器 Front Controller 之前，在还没有进行到 Servlet 的 URL 映射前，请求需要先通过它的过滤逻辑。</p>
<h3>Tomcat 中配置过滤器</h3>
<p>还记得我们在 [第 10 讲] 的加餐中使用 Servlet、JSP 和 JavaBean 实现的简单 MVC 系统吗？现在，让我们来动动手，添加一个基于 URL 映射的过滤器。</p>
<p>首先，打开 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/web.xml，在我们原本的 BookServlet 配置前，添加如下内容：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;AuthFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-class&gt;AuthFilter&lt;/filter-class&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;AuthFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;BookFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-class&gt;BookFilter&lt;/filter-class&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;filter-mapping&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;filter-name&gt;BookFilter&lt;/filter-name&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;url-pattern&gt;/books/*&lt;/url-pattern&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/filter-mapping&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，为了显示过滤器链的效果，我们配置了两个过滤器，第一个 AuthFilter 用来对所有的请求实施权限控制，因此 URL 使用 /* 匹配所有请求；第二个 BookFilter 我们希望它只对访问图书的请求实施权限控制。</p>
<p>现在建立 AuthFilter，创建 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/classes/AuthFilter.java，写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import javax.servlet.*;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.logging.Logger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.io.IOException;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       public class AuthFilter implements Filter {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private Logger logger = Logger.getLogger(AuthFilter.class.getName());
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        logger.info("Check permission...");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        chain.doFilter(request, response);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>这个用于鉴权的过滤器，现在只打印日志，未来我们可以加入真正的鉴权逻辑。</p>
<p>接着建立 BookFilter，创建 ${CATALINA_HOME}/webapps/ROOT/WEB-INF/classes/BookFilter.java，写入：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import javax.servlet.*;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.io.IOException;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.logging.Logger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       import java.util.concurrent.atomic.AtomicInteger;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       public class BookFilter implements Filter {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private Logger logger = Logger.getLogger(BookFilter.class.getName());
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        private AtomicInteger count = new AtomicInteger();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        logger.info("Add book accessing count...");
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        int current = this.count.incrementAndGet();
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        request.setAttribute("count", current);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        chain.doFilter(request, response);
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        }
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       }
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>在这个过滤器中 ，我们先打印了日志，接着创建了一个计数器，使用 AtomicInteger 而不是 int 这个原语类型的目的是为了正确处理在多线程情况下并发计数器的情形，再把当前对 books 请求的计数放到 request 中。</p>
<p>编译一下：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       javac AuthFilter.java BookFilter.java -classpath ${CATALINA_HOME}/lib/servlet-api.jar
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>我们再回到曾经建立的 ${CATALINA_HOME}/webapps/ROOT/book.jsp，在页面尾部添加一行输出计数器的计数：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Count: ${count}
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>现在启动 Tomcat：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       catalina run
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>最后在浏览器中访问 <a href="http://localhost:8080/books?category=art">http://localhost:8080/books?category=art</a>，你将看到类似这样的输出，并且每刷新一次页面，这个计数就加 1。</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       Category name: art, date: 2019-8-11 Count: 1
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>再回到控制台，你应该能看到类似这样的日志，从中可见过滤器的调用顺序：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       11-Aug-2019 11:08:50.131 INFO [http-nio-8080-exec-1] AuthFilter.doFilter Check permission...
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       11-Aug-2019 11:08:50.132 INFO [http-nio-8080-exec-1] BookFilter.doFilter Add book accessing count...
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>好，动手实践暂时就先到这里。就如同上面的例子这样，过滤器也是可以配置映射关系的，并且，在过滤器中，我们可以实现一组不同类型请求的处理所共有的逻辑。学到这里，不知道你有没有联想到一个相关的，且在这一讲之前我们才学过的模式？对，它就是 AOP，过滤器本质上就是面向切面编程这种模式的一种子模式。</p>
<h3>Struts 的拦截器</h3>
<p>Struts 提供了拦截器（Interceptor）这样功能更加强大的组件，对于一些常见的功能，它已经预置了数十种常见的拦截器，比如异常、参数验证、文件上传和国际化支持等等，既包括预处理（Action 执行之前），也包括后处理（Action 执行之后）的拦截逻辑，只需要配置使用即可。</p>
<p>举例来说，如果定义了这样一个的拦截器栈，它包含了两个拦截器，一个是异常拦截器，一个是校验拦截器，并且配置了 ping 方法不需要经过拦截器的校验，这两个拦截器组合成为 commonInterceptorStack 这个拦截器栈：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;interceptor-stack name="commonInterceptorStack"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="exception"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="validation"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;param name="excludeMethods"&gt;ping&lt;/param&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/interceptor-ref&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/interceptor-stack&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>配置完毕后就可以使用了，对于一个控制器层的 bookAction，我们规定请求必须经过一个 alias 拦截器，和刚才定义的 commonInterceptorStack 拦截器栈：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;action name="bookAction" class="BookAction"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="alias"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;interceptor-ref name="commonInterceptorStack"/&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/action&gt;
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<h2>数据访问对象</h2>
<p>我们在 <a href="https://time.geekbang.org/column/article/141679">[第 08 讲]</a> 中介绍持久层框架的时候，已经谈到了 DAO（Data Access Object），今天让我们进一步学习一下。</p>
<p><strong>DAO 本质上是能够为某种特定数据持久化的机制提供抽象结构的对象。</strong>虽然我们谈论 DAO 基本上是默认这里的数据持久化的介质就是数据库，但需要明确的是，实际上并没有这样的约束。换句话说，DAO 可以把数据持久化到数据库中，但也可以持久化到文件里，甚至会以网络请求的方式把数据持久化到某个远程服务中去。</p>
<p>数据访问对象最大的好处依然是我们反复强调的“解耦”，业务代码不需要关心数据是怎样持久化的。在测试其上方的 Service 层的时候，只要把实际的 DAO 替换成“桩代码”，就可以不实际执行持久化逻辑而完成测试；如果哪一天希望更换 DAO 的实现，例如把关系数据库存储改为更一般的键值存储，其上方的 Service 层不修改逻辑就可以实现。</p>
<p>但事物都有两面性，DAO 也不是完美的，比如说，<strong>多加一层就会从额外的抽象层次上带来软件的复杂性，它经常和“抽象泄露（Leaky Abstraction）”这样的现象联系起来</strong>。</p>
<p>这里是说，理想状况下，程序员只需要关心“某一抽象层之上”的逻辑和调用，这也是我们分层的一大好处。可是，现实总是和理想有距离的，一旦抽象之下的部分出错，程序员很可能必须去了解和深入这部分的内容，这就违背了抽象分层的初衷，但是在很多情况下这是不可避免的，这也是整个软件体系日渐复杂，我们需要学习的内容越来越多的原因之一。</p>
<h2>总结思考</h2>
<p>今天我们了解了 Java EE 的各种模式，并且重点学习了拦截过滤器这个模式。模式的学习有一个特点，在理论学习的基础上，我们需要反复地实践强化，以及反复地思考。可以说，实践和思考这二者缺一不可。如果只有实践而没有思考，就没有办法灵活地将理论应用在复杂的实际项目中；如果只有思考而没有实践，那么到实际动手的时候还是很难顺利地实施想法。</p>
<p>对于今天的内容，留两个问题：</p>
<ul> 
 <li>我们介绍了 DAO 层的两面性，那么，在你经历的项目中，你是怎样访问数据存储设施（例如文件和数据库）的，能说说吗？</li> 
 <li>今天我们学到了，通过使用基于 URL 映射的过滤器，是可以给业务代码增加 AOP 的切面逻辑的。那么，为什么我们还需要之前所介绍的，通过匹配代码类和方法的表达式来嵌入切面逻辑的方式呢？</li> 
</ul>
<p>有道是，技术进程多风雨，唯有套路得人心。回看本章，从 MVC 开始，我们一直都在和“模式”打交道，不知道你是不是认真学习了，是不是收获一些代码设计上的“套路”了呢？</p>
<h2>选修课堂：MyBatis vs Hibernate</h2>
<p>在 DAO 的设计过程中，我们经常需要处理模型实体对象和关系数据库的表记录之间的双向转换问题，怎样将对象的属性和关联关系映射到数据库表上去？有许多持久化框架都给出了自己的解决办法，今天我就来介绍两种最经典的解决思路，MyBatis 和 Hibernate。</p>
<p><strong>MyBatis 的思路是使用 XML 或注解的方式来配置 ORM，把 SQL 用标签管理起来，但不关心，也不干涉实际 SQL 的书写。</strong></p>
<p>在这种思路下框架轻量，很容易集成，又因为我们可以使用 SQL 所有的特性，可以写存储过程，也可以写 SQL 方言（Dialect），所以灵活度相当高。当然，灵活也意味着在具体实现功能的时候，你需要做得更多，不但需要关心模型层、SQL，还需要关心这二者怎样映射起来，具体包括：</p>
<ul> 
 <li>请求参数映射，即模型的值怎样映射到 SQL 语句的变参里面；</li> 
 <li>返回值映射，即怎样将数据库查询的返回记录映射到模型对象。</li> 
</ul>
<p>我们来看一个最简单的 XML 配置片段：</p>
<pre style="position: relative;"><code>
  <table class="hljs-ln">
   <tbody>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;mapper namespace="xxx.BookDAO"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;insert id="add" parameterType="Book"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        insert into BOOKS(NAME, DESC) values(#{name}, #{desc})
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/insert&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line"> 
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;select id="get" resultType="Book" parameterType="java.lang.String"&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        select * from BOOKS where ID=#{id}
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
        &lt;/select&gt;
      </div></td>
    </tr>
    <tr>
     <td class="hljs-ln-numbers">
      <div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></td>
     <td class="hljs-ln-code">
      <div class="hljs-ln-line">
       &lt;/mapper&gt; 
      </div></td>
    </tr>
   </tbody>
  </table></code>
 <div class="richcontent-pre-copy">
  <span class="iconfont"></span>复制代码
 </div></pre>
<p>你看，SQL 原模原样地写在了配置文件里面。对于写入语句，比如这里的 insert，需要显式告知参数类型 Book 对象，接着就可以直接使用 Book 的 name 和 desc 对应的 get 方法来获得具体值并注入 SQL 了。对于简单的对象，默认的映射规则就可以解决问题，反之，也可以在 XML 中定义映射规则。</p>
<p><strong>Hibernate 则是另一种思路，如果你已经习惯于和模型层打交道，那么它就将 SQL 层对你隐藏起来了。</strong>换言之，你只需要写模型代码和 HQL（Hibernate Query Language）这种面向对象的查询语言就可以了，至于 SQL 的生成，框架可以帮你完成。</p>
<p>这种方式的一大好处就是具体数据库的透明性，你今天使用的数据库是 MySQL，明天就可以换成 Oracle，并且不用改代码。在分析设计的时候，你只需要做自己习惯的模型驱动编程就可以了。</p>
<p>但值得注意的是，Hibernate 是把双刃剑，有利也有弊。它也带来了很多问题，比如较高的学习曲线，在出现问题的时候，无论是功能问题还是性能问题，它需要更多的知识储备来进行问题的定位和性能的调试。</p>
<p>MyBatis 和 Hibernate 到这就讲解清楚了，再总结延伸一下。</p>
<p>从框架本身的角度来说，Hibernate 提供的特性远比 MyBatis 更丰富、更完整。如果你是一位有着一定 ORM 经验的程序员，那么 Hibernate 很可能会使你的开发效率更高。</p>
<p>可对于一个新项目而言，在技术选型的过程中，如果你的团队中没有非常多的经验丰富的程序员，我通常建议持久层的框架不要去考虑 Hibernate。简单说来，就是因为它的“水比较深”。我相信大多数程序员朋友还是更习惯于实打实地接触 SQL，流程到哪一步，执行了什么语句，该怎么调整，都十分清晰和直接。</p>
<h2>扩展阅读</h2>
<ul> 
 <li>文中提到了 Java EE 平台的一系列标准和技术，维基百科上有一个<a href="https://zh.wikipedia.org/wiki/Jakarta_EE#%E7%BB%84%E4%BB%B6">简单的列表</a>供参考。</li> 
 <li><a href="http://www.corej2eepatterns.com/Patterns2ndEd/index.htm">Core J2EE Patterns: Best Practices and Design Strategies</a> 这本书对于你学习 Java EE 的模式会提供不错的指导性帮助，属于权威之一，但是内容比较抽象，如果你在设计方面有一定追求，它是很好的阅读材料。好几年前我曾经读过纸质的第一版，但这是第二版，已经可以在网上公开阅读。</li> 
 <li>如果对于文中提到的 Struts 拦截器感兴趣，请看 Struts 官方文档中<a href="https://struts.apache.org/core-developers/interceptors.html">对于拦截器的介绍</a>。</li> 
 <li>文中提到了抽象泄露的概念，如果你感兴趣的话，请阅读 <a href="https://www.joelonsoftware.com/2002/11/11/the-law-of-leaky-abstractions/">The Law of Leaky Abstractions</a>，作者 Joel Spolsky 就是那本著名的《软件随想录》的作者。</li> 
 <li><a href="http://www.mybatis.org/mybatis-3/zh/index.html">MyBatis 的官网</a>，是的，MyBatis 的教程我就推荐官网上的，清晰简洁，而且具备中文版，不需要去找什么第三方的资料了；如果是需要中文的 Hibernate 入门资料，我推荐 W3Cschool 上的 <a href="https://www.w3cschool.cn/hibernate/">Hibernate 教程</a>。</li> 
</ul>
<p><img src="https://static001.geekbang.org/resource/image/11/8b/1181246bbd51ce348d5729696d1dc28b.jpg" alt="unpreview"></p> |             |book   |0     |full_html   |zh-hans  |37          |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------|------|------------|---------|------------|

2020-11-19 17:55:36.284 INFO  jdbc.sqltiming Line:373 - select nodefiledd0_.nid as nid1_10_, nodefiledd0_.changed as changed2_10_, nodefiledd0_.created 
as created3_10_, nodefiledd0_.default_langcode as default_4_10_, nodefiledd0_.langcode as langcode5_10_, 
nodefiledd0_.promote as promote6_10_, nodefiledd0_.revision_translation_affected as revision7_10_, 
nodefiledd0_.status as status8_10_, nodefiledd0_.sticky as sticky9_10_, nodefiledd0_.title 
as title10_10_, nodefiledd0_.type as type11_10_, nodefiledd0_.uid as uid12_10_, nodefiledd0_.vid 
as vid13_10_ from node_field_data nodefiledd0_ where nodefiledd0_.nid=37 
 {executed in 0 msec}
2020-11-19 17:55:36.285 INFO  jdbc.resultsettable Line:610 - 
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|
|nid |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                    |type |uid |vid |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|
|37  |1605756133 |1605756133 |1                |zh-hans  |0       |1                             |1      |0      |12丨唯有套路得人心：谈谈JavaEE的那些模式 |book |1   |37  |
|----|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|-----|----|----|

2020-11-19 17:55:36.286 INFO  jdbc.sqltiming Line:373 - select nodefieldr0_.nid as nid1_11_0_, nodefieldr0_.changed as changed2_11_0_, nodefieldr0_.created 
as created3_11_0_, nodefieldr0_.default_langcode as default_4_11_0_, nodefieldr0_.langcode 
as langcode5_11_0_, nodefieldr0_.promote as promote6_11_0_, nodefieldr0_.revision_translation_affected 
as revision7_11_0_, nodefieldr0_.status as status8_11_0_, nodefieldr0_.sticky as sticky9_11_0_, 
nodefieldr0_.title as title10_11_0_, nodefieldr0_.uid as uid11_11_0_, nodefieldr0_.vid as vid12_11_0_ 
from node_field_revision nodefieldr0_ where nodefieldr0_.nid=37 
 {executed in 1 msec}
2020-11-19 17:55:36.286 INFO  jdbc.resultsettable Line:610 - 
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|
|nid      |changed    |created    |default_langcode |langcode |promote |revision_translation_affected |status |sticky |title                    |uid |vid |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|
|[unread] |1605756133 |1605756133 |1                |zh-hans  |0       |1                             |1      |0      |12丨唯有套路得人心：谈谈JavaEE的那些模式 |1   |37  |
|---------|-----------|-----------|-----------------|---------|--------|------------------------------|-------|-------|-------------------------|----|----|

2020-11-19 17:55:36.291 INFO  jdbc.sqltiming Line:373 - update node_field_data set changed=1605779736, created=1605779736, default_langcode=1, langcode='zh-hans', 
promote=0, revision_translation_affected=1, status=1, sticky=0, title='12丨唯有套路得人心：谈谈JavaEE的那些模式', 
type='book', uid=1, vid=37 where nid=37 
 {executed in 1 msec}
